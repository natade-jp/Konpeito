/*!
 * konpeito.js (version 5.1.0, 2020/2/24)
 * https://github.com/natade-jp/konpeito
 * Copyright 2013-2020 natade < https://github.com/natade-jp >
 *
 * The MIT license.
 * https://opensource.org/licenses/MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).konpeito=e()}(this,function(){"use strict";function t(){}t.run=function(){void 0===Math.imul&&(Math.imul=function(t,e){var r=(65535&t)*(65535&e)>>>0,n=(65535&t)*(e>>>16);return r=r+((65535&n)<<16)>>>0,4294967295&(r+=(65535&(n=(t>>>16)*(65535&e)))<<16)}),void 0===Math.trunc&&(Math.trunc=function(t){return 0<t?Math.floor(t):Math.ceil(t)}),void 0===Number.isFinite&&(Number.isFinite=isFinite),void 0===Number.isInteger&&(Number.isInteger=function(t){return isFinite(t)&&(0|t)===t}),void 0===Number.isNaN&&(Number.isNaN=isNaN),void 0===Number.NaN&&(Number.NaN=NaN),void 0===Number.EPSILON&&(Number.EPSILON=2220446049250313e-31),void 0===Number.MIN_SAFE_INTEGER&&(Number.MIN_SAFE_INTEGER=-9007199254740991),void 0===Number.MAX_SAFE_INTEGER&&(Number.MAX_SAFE_INTEGER=9007199254740991),void 0===Number.parseFloat&&(Number.parseFloat=parseFloat),void 0===Number.parseInt&&(Number.parseInt=parseInt)},t.run();function n(t){this.x=[];for(var e=0;e<521;e++)this.x[e]=0;if(void 0!==t)this.setSeed(t);else{var r=(new Date).getTime()+n.seedUniquifier&4294967295;n.seedUniquifier=n.seedUniquifier+1&4294967295,this.setSeed(r)}}n.prototype._rnd521=function(){for(var t=this.x,e=0;e<32;e++)t[e]^=t[e+489];for(var r=32;r<521;r++)t[r]^=t[r-32]},n.prototype.setSeed=function(t){for(var e=0,r=this.x,n=t,i=0;i<=16;i++){for(var o=0;o<32;o++)e=(e>>>1)+((n=Math.imul(n,1566083941)+1)<0?2147483648:0);r[i]=e}for(var a=16;a<521;a++)e=16===a?a:a-17,r[a]=r[e]<<23&4294967295^r[a-16]>>>9^r[a-1];for(var u=0;u<4;u++)this._rnd521();this.xi=0,this.haveNextNextGaussian=!1,this.nextNextGaussian=0},n.prototype.genrand_int32=function(){521===this.xi&&(this._rnd521(),this.xi=0);var t=this.x[this.xi]>>>0;return this.xi=this.xi+1,t},n.seedUniquifier=2271560481;function i(t){if(this.x=123456789,this.y=362436069,this.z=521288629,this.w=88675123,void 0!==t)this.setSeed(t);else{var e=(new Date).getTime()+i.seedUniquifier&4294967295;i.seedUniquifier=i.seedUniquifier+1&4294967295,this.setSeed(e)}}i.prototype.setSeed=function(t){var e=t;e=Math.imul(e,214013)+2531011>>>0,this.z=e,e=Math.imul(e,214013)+2531011>>>0,this.w=e,this.haveNextNextGaussian=!1,this.nextNextGaussian=0},i.prototype.genrand_int32=function(){var t=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.w^this.w>>>19^t^t>>>8,this.w},i.seedUniquifier=2271560481;function v(t){var e=void 0,r="fast";this.rand=null,this.haveNextNextGaussian=!1,this.nextNextGaussian=0,"number"==typeof t?e=t:"object"==typeof t&&(void 0!==t.seed&&(e=t.seed),void 0!==t.algorithm&&(r=t.algorithm)),/fast|xorshift/i.test(r)?this.rand=new i(e):this.rand=new n(e)}v.create=function(t){return new v(t)},v.prototype.setSeed=function(t){this.rand.setSeed(t)},v.prototype.genrand_int32=function(){return this.rand.genrand_int32()},v.prototype.next=function(t){return 0===t?0:32===t?this.genrand_int32():t<32?this.genrand_int32()>>>32-t:63===t?2147483648*this.genrand_int32()+this.genrand_int32():64===t?4294967296*this.genrand_int32()+this.genrand_int32():t<63?this.genrand_int32()*(1<<t-32)+(this.genrand_int32()>>>64-t):void 0},v.prototype.nextBytes=function(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=this.next(8);return e},v.prototype.nextShort=function(){return this.next(16)},v.prototype.nextInt=function(t){if(void 0===t||"number"!=typeof t)return 4294967295&this.next(32);for(var e,r;r=(e=this.genrand_int32()>>>0)%t,4294967296<e-r+t;);return r},v.prototype.nextLong=function(){return this.next(64)},v.prototype.nextBoolean=function(){return 0!==this.next(1)},v.prototype.nextFloat=function(){return this.next(24)/16777216},v.prototype.nextDouble=function(){return(134217728*this.next(26)+this.next(27))/9007199254740992},v.prototype.nextGaussian=function(){if(this.haveNextNextGaussian)return this.haveNextNextGaussian=!1,this.nextNextGaussian;var t=Math.sqrt(-2*Math.log(this.nextDouble())),e=2*Math.PI*this.nextDouble(),r=t*Math.sin(e);return this.nextNextGaussian=t*Math.cos(e),this.haveNextNextGaussian=!0,r};function e(){}e.toString=function(){return"NONE"},e.getAddNumber=function(t){return 0};function d(){}var o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"UP"},e.getAddNumber=function(t){var e=t%10;return 0==e?0:0<e?10-e:-(10+e)},e}(e),a=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"DOWN"},e.getAddNumber=function(t){return-t%10},e}(e),u=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"CEILING"},e.getAddNumber=function(t){var e=t%10;return 0==e?0:0<e?10-e:-e},e}(e),s=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"FLOOR"},e.getAddNumber=function(t){var e=t%10;return 0==e?0:0<e?-e:-(10+e)},e}(e),h=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"HALF_UP"},e.getAddNumber=function(t){var e=t%10,r=0<=e?1:-1;return Math.abs(e)<5?-1*e:r*(10-Math.abs(e))},e}(e),c=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"HALF_DOWN"},e.getAddNumber=function(t){var e=t%10,r=0<=e?1:-1;return Math.abs(e)<6?-1*e:r*(10-Math.abs(e))},e}(e),l=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"HALF_EVEN"},e.getAddNumber=function(t){var e,r,n=t%100;return r=1===(n<0?(e=-1,1&Math.ceil(n/10)):(e=1)&Math.floor(n/10))?5:6,n%=10,Math.abs(n)<r?-1*n:e*(10-Math.abs(n))},e}(e),f=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"UNNECESSARY"},e.getAddNumber=function(t){if(0==t%10)return 0;throw"ArithmeticException"},e}(e),r={UP:{configurable:!0},DOWN:{configurable:!0},CEILING:{configurable:!0},FLOOR:{configurable:!0},HALF_UP:{configurable:!0},HALF_DOWN:{configurable:!0},HALF_EVEN:{configurable:!0},UNNECESSARY:{configurable:!0}};d.valueOf=function(t){var e;if("string"==typeof t)e=t;else{if(!(t instanceof Object))throw"Unsupported argument "+t;e=t.toString()}for(var r=[o,a,s,u,h,c,l,f],n=e.toUpperCase(),i=0;i<r.length;i++)if(r[i].toString()===n)return r[i];throw"IllegalArgumentException : "+e},r.UP.get=function(){return o},r.DOWN.get=function(){return a},r.CEILING.get=function(){return u},r.FLOOR.get=function(){return s},r.HALF_UP.get=function(){return h},r.HALF_DOWN.get=function(){return c},r.HALF_EVEN.get=function(){return l},r.UNNECESSARY.get=function(){return f},Object.defineProperties(d,r);function I(t,e){if(this.precision=0,this.roundingMode=void 0===e?d.HALF_UP:e,"number"==typeof t)this.precision=t;else if(t instanceof I)this.roundingMode=void 0===e?t.roundingMode:e,this.precision=t.precision;else if("string"==typeof t){var r;null!==(r=t.match(/precision=\d+/))&&(r=r[0].substring("precision=".length,r[0].length),this.precision=parseInt(r,10)),null!==(r=t.match(/roundingMode=\w+/))&&(r=r[0].substring("roundingMode=".length,r[0].length),this.roundingMode=d.valueOf(r))}if(this.precision<0)throw"IllegalArgumentException"}var g={UNLIMITED:{configurable:!0},DECIMAL32:{configurable:!0},DECIMAL64:{configurable:!0},DECIMAL128:{configurable:!0},DECIMAL256:{configurable:!0}};I.create=function(t,e){return t instanceof I?t:new I(t,e)},I.prototype.getPrecision=function(){return this.precision},I.prototype.getRoundingMode=function(){return this.roundingMode},I.prototype.equals=function(t){return t instanceof I&&t.toString()===this.toString()},I.prototype.toString=function(){return"precision="+this.precision+" roundingMode="+this.roundingMode.toString()},I.prototype.increasePrecision=function(t){if(0===this.precision)return this;var e=this.precision+(void 0===t?1:t);return new I(Math.max(1,e),this.roundingMode)},I.prototype.decreasePrecision=function(t){if(0===this.precision)return this;var e=this.precision-(void 0===t?1:t);return new I(Math.max(1,e),this.roundingMode)},g.UNLIMITED.get=function(){return _.UNLIMITED},g.DECIMAL32.get=function(){return _.DECIMAL32},g.DECIMAL64.get=function(){return _.DECIMAL64},g.DECIMAL128.get=function(){return _.DECIMAL128},g.DECIMAL256.get=function(){return _.DECIMAL256},Object.defineProperties(I,g);function p(t){return t-Math.trunc(t)!=0}function m(){}var _={UNLIMITED:new I(0,d.HALF_UP),DECIMAL32:new I(7,d.HALF_EVEN),DECIMAL64:new I(16,d.HALF_EVEN),DECIMAL128:new I(34,d.HALF_EVEN),DECIMAL256:new I(72,d.HALF_EVEN)};m.gammaln=function(t){if(!isFinite(t))return isNaN(t)?NaN:1/0;for(var e=Math.log(2*Math.PI),r=[-15238221.539407417,691472.268851313,-36108.77125372499,8553103/6/650,-156.84828462600203,854513/138/462,-174611/330/380,43867/798/306,-3617/510/240,7/6/182,-691/2730/132,5/66/90,-1/30/56,1/42/30,-1/30/12,1/6/2],n=1,i=t;i<r.length;)n*=i,i++;for(var o=1/(i*i),a=r[0],u=1;u<r.length;u++)a*=o,a+=r[u];return a/=i,a+=.5*e,a+=-Math.log(n)-i+(i-.5)*Math.log(i)},m.q_gamma=function(t,e,r){if(!isFinite(t))return t===1/0?0:NaN;var n,i,o,a,u,s=1,h=1+t-e;if(t<1+e)return 1-m.p_gamma(t,e,r);for(i=(o=Math.exp(e*Math.log(t)-t-r))/h,n=2;n<1e3;n++)if(a=((n-1-e)*(h-s)+(n+t)*h)/n,u=i,(i+=a=(o*=(n-1-e)/n)/((s=h)*(h=a)))==u)return i;return Number.NaN},m.p_gamma=function(t,e,r){if(!isFinite(t))return t===1/0?1:NaN;var n,i,o,a;if(1+e<=t)return 1-m.q_gamma(t,e,r);if(0===t)return 0;for(i=o=Math.exp(e*Math.log(t)-t-r)/e,n=1;n<1e3;n++)if(a=i,(i+=o*=t/(e+n))==a)return i;return Number.NaN},m.gamma=function(t){return t<0?Math.PI/(Math.sin(Math.PI*t)*Math.exp(m.gammaln(1-t))):Math.exp(m.gammaln(t))},m.gammainc=function(t,e,r){if("lower"===r)return m.p_gamma(t,e,m.gammaln(e));if("upper"===r)return m.q_gamma(t,e,m.gammaln(e));if(void 0===r)return m.gammainc(t,e,"lower");throw"gammainc unsupported argument ["+r+"]"},m.gampdf=function(t,e,r){if(t===-1/0)return 0;var n=1/(m.gamma(e)*Math.pow(r,e));return n*=Math.pow(t,e-1),n*=Math.exp(-t/r)},m.gamcdf=function(t,e,r){return t<0?0:m.gammainc(t/r,e)},m.gaminv=function(t,e,r){if(t<0||1<t)return Number.NaN;if(0==t)return 0;if(1==t)return Number.POSITIVE_INFINITY;for(var n,i,o=e*r,a=0;a<100&&(n=(i=o-(m.gamcdf(o,e,r)-t)/m.gampdf(o,e,r))-o,!(Math.abs(n)<=1e-12));a++)(o=i)<0&&(o=1e-12);return o},m.beta=function(t,e){return Math.exp(m.gammaln(t)+m.gammaln(e)-m.gammaln(t+e))},m.p_beta=function(t,e,r){var n,i,o,a;if(e<=0)return Number.POSITIVE_INFINITY;if(r<=0)return t<1?0:1===t?1:Number.POSITIVE_INFINITY;if((e+1)/(e+r+2)<t)return 1-m.p_beta(1-t,r,e);if(t<=0)return 0;for(o=e*Math.log(t),o+=r*Math.log(1-t),o+=m.gammaln(e+r),o-=m.gammaln(e)+m.gammaln(r),o=Math.exp(o),i=o/=e,n=1;n<1e3;n++)if(o*=e+r+n-1,o*=t,a=i,(i+=o/=e+n)===a)return i;return Number.NaN},m.q_beta=function(t,e,r){return 1-m.p_beta(t,e,r)},m.betainc=function(t,e,r,n){if("lower"===n)return m.p_beta(t,e,r);if("upper"===n)return m.q_beta(t,e,r);if(void 0===n)return m.betainc(t,e,r,"lower");throw"betainc unsupported argument ["+n+"]"},m.betapdf=function(t,e,r){return t<0&&p(r-1)||1-t<0&&p(r-1)?0:Math.pow(t,e-1)*Math.pow(1-t,r-1)/m.beta(e,r)},m.betacdf=function(t,e,r){return m.betainc(t,e,r)},m.betainv=function(t,e,r){if(t<0||1<t)return Number.NaN;if(0==t&&0<e&&0<r)return 0;if(1==t&&0<e&&0<r)return 1;var n,i,o,a=1e-14;n=0==r?1-a:0==e?a:e/(e+r);for(var u=0;u<100&&(i=(o=n-(m.betacdf(n,e,r)-t)/m.betapdf(n,e,r))-n,!(Math.abs(i)<=a));u++)1<(n=o)?n=1-a:n<0&&(n=a);return n},m.factorial=function(t){var e=m.gamma(t+1);return Math.trunc(t)===t?Math.round(e):e},m.nchoosek=function(t,e){for(var r=1,n=Math.min(e,t-e),i=1;i<=n;i++)if((r*=(t+1-i)/i)>=Number.MAX_SAFE_INTEGER)return 1/0;return r},m.erf=function(t){return m.p_gamma(t*t,.5,.5*Math.log(Math.PI))*(0<=t?1:-1)},m.erfc=function(t){return 1-m.erf(t)},m.erfinv=function(t){return m.erfcinv(1-t)},m.erfcinv=function(t){return-m.norminv(.5*t)/Math.sqrt(2)},m.normpdf=function(t,e,r){var n="number"==typeof e?e:0,i="number"==typeof r?r:1,o=1/Math.sqrt(2*Math.PI*i*i);return o*=Math.exp(-(t-n)*(t-n)/(2*i*i))},m.normcdf=function(t,e,r){return(1+m.erf((t-("number"==typeof e?e:0))/(("number"==typeof r?r:1)*Math.sqrt(2))))/2},m.norminv=function(t,e,r){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;for(var n,i,o="number"==typeof e?e:0,a="number"==typeof r?r:1,u=o,s=0;s<200&&(n=(i=u-(m.normcdf(u,o,a)-t)/m.normpdf(u,o,a))-u,!(Math.abs(n)<=1e-12));s++)u=i;return u},m.binopdf=function(t,e,r){return isFinite(r)?m.nchoosek(e,t)*Math.pow(r,t)*Math.pow(1-r,e-t):isNaN(r)?NaN:0},m.binocdf=function(t,e,r,n){return m.betainc(1-r,e-Math.floor(t),1+Math.floor(t),n)},m.binoinv=function(t,e,r){if(t<0||1<t||r<0||1<r)return Number.NaN;if(0==t||0==r)return 0;if(1==r)return e;for(var n=1,i=e,o=0,a=0,u=0;u<200;u++){o=Math.round((n+i)/2);var s=m.binocdf(o,e,r);if(o===a)break;t<s?i=o:n=o,a=o}return o},m.poisspdf=function(t,e){if(!isFinite(t))return isNaN(t)?Number.NaN:0;for(var r=1/Math.E,n=1,i=0,o=1;o<=t;o++)n=n*e/o,i<e&&(n*=r,i++);for(;i<e;i++)n*=r;return n},m.poisscdf=function(t,e){return t<0?0:1-m.gammainc(e,Math.floor(t+1))},m.poissinv=function(t,e){if(t<0||1<t)return Number.NaN;if(0==t)return 0;if(1==t)return Number.POSITIVE_INFINITY;for(var r=1,n=20*e,i=0,o=0,a=0;a<200;a++){i=Math.round((r+n)/2);var u=m.poisscdf(i,e);if(i===o)break;t<u?n=i:r=i,o=i}return i},m.tpdf=function(t,e){var r=1/(Math.sqrt(e)*m.beta(.5,.5*e));return r*=Math.pow(1+t*t/e,.5*-(e+1))},m.tcdf=function(t,e){return.5*(1+m.betainc(t*t/(e+t*t),.5,.5*e)*(t<0?-1:1))},m.tinv=function(t,e){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;if(t<.5){var r=m.betainv(2*t,.5*e,.5);return-Math.sqrt(e/r-e)}var n=m.betainv(2*(1-t),.5*e,.5);return Math.sqrt(e/n-e)},m.tdist=function(t,e,r){return(1-m.tcdf(Math.abs(t),e))*r},m.tinv2=function(t,e){return-m.tinv(.5*t,e)},m.chi2pdf=function(t,e){if(t<0)return 0;if(0===t)return.5;var r=Math.pow(t,e/2-1)*Math.exp(-t/2);return r/=Math.pow(2,e/2)*m.gamma(e/2)},m.chi2cdf=function(t,e){return m.gammainc(t/2,e/2)},m.chi2inv=function(t,e){return m.gaminv(t,e/2,2)},m.fpdf=function(t,e,r){if(e<0||r<0)return Number.NaN;if(t<=0)return 0;var n=1;return n*=Math.pow(e*t/(e*t+r),e/2),n*=Math.pow(1-e*t/(e*t+r),r/2),n/=t*m.beta(e/2,r/2)},m.fcdf=function(t,e,r){return m.betacdf(e*t/(e*t+r),e/2,r/2)},m.finv=function(t,e,r){return(1/m.betainv(1-t,r/2,e/2)-1)*r/e};function N(){}var y=new v;N.toHexadecimalArrayFromPlainString=function(t,e){for(var r=Math.floor(Math.log(1073741823)/Math.log(e)),n=[],i=[],o=Math.ceil(t.length/r),a=t.length,u=0;u<o;u++)a-=r,n[u]=0<=a?parseInt(t.substring(a,a+r),e):parseInt(t.substring(0,a+r),e);for(var s=Math.round(Math.pow(e,r));0!==n.length;){for(var h=0,c=n.length-1;0<=c;c--){var l=n[c]+h*s;n[c]=l>>>1,h=1&l}i[i.length]=h,0===n[n.length-1]&&n.pop()}n=[];for(var f=0;f<i.length;f++)n[f>>>4]|=i[f]<<(15&f);return n},N.toPlainStringFromString=function(t){var e,r,n=0,i=t.replace(/\s/g,"").toLowerCase(),o=[];if(null!==(e=i.match(/^[0-9]+/))&&(e=e[0],i=i.substr(e.length),o.push(e)),null!==(e=i.match(/^\.[0-9]+/))&&(e=e[0],i=i.substr(e.length),n+=(e=e.substr(1)).length,o.push(e)),null!==(e=i.match(/^e[+-]?[0-9]+/))&&(e=e[0].substr(1),n-=parseInt(e,10)),0===n&&(r=o.join("")),n<0){for(var a=0;a<-n;a++)o.push("0");r=o.join("")}else 0<n&&(r=0!==(r=(r=o.join("")).substring(0,r.length-n)).length?r:"0");return r},N.toBigIntegerFromNumber=function(t){if(!isFinite(t))return t===Number.POSITIVE_INFINITY?{state:b.POSITIVE_INFINITY,element:[]}:t===Number.NEGATIVE_INFINITY?{state:b.NEGATIVE_INFINITY,element:[]}:{state:b.NOT_A_NUMBER,element:[]};var e,r;if(4294967295<(e=0===t?(r=b.ZERO,0):0<t?(r=b.POSITIVE_NUMBER,t):(r=b.NEGATIVE_NUMBER,-t)))return{element:N.toHexadecimalArrayFromPlainString(N.toPlainStringFromString(e.toFixed()),10),state:r};for(var n=[];0!==e;)n[n.length]=1&e,e>>>=1;for(var i=[],o=0;o<n.length;o++)i[o>>>4]|=n[o]<<(15&o);return{element:i,state:r}},N.toPlainStringFromHexadecimalArray=function(t,a){for(var e=function(t,e,r){for(var n=t.length,i=0,o=0;o<n;o++)r[o]=t[o]+(e.length>=o+1?e[o]:0)+i,r[o]>=a?(i=1,r[o]-=a):i=0;1===i&&(r[n]=1)},r=[0],n=[1],i=0;i<t.length;i++)for(var o=0;o<16;o++)t[i]>>>o&1&&e(n,r,r),e(n,n,n);return r},N.isZeroElement=function(t){return 0===t.length||1===t.length&&0===t[0]},N.toBigIntegerFromString=function(t,e){var r=t.replace(/\s/g,"").toLowerCase();if(/nan/.test(t))return{state:b.NOT_A_NUMBER,element:[]};if(/inf/.test(t))return/-/.test(t)?{state:b.NEGATIVE_INFINITY,element:[]}:{state:b.POSITIVE_INFINITY,element:[]};var n=r.match(/^[-+]+/),i=[],o=b.POSITIVE_NUMBER;if(null!==n){var a=n[0];r=r.substring(a.length,r.length),-1!==a.indexOf("-")&&(o=b.NEGATIVE_NUMBER)}return i=e?N.toHexadecimalArrayFromPlainString(r,e):/^0x/.test(r)?N.toHexadecimalArrayFromPlainString(r.substring(2,r.length),16):/^0b/.test(r)?N.toHexadecimalArrayFromPlainString(r.substring(2,r.length),2):/^0o/.test(r)?N.toHexadecimalArrayFromPlainString(r.substring(2,r.length),8):(r=N.toPlainStringFromString(r),N.toHexadecimalArrayFromPlainString(r,10)),N.isZeroElement(i)&&(i=[],o=b.ZERO),{element:i,state:o}};function w(t){if(this.state=b.ZERO,0===arguments.length)this.element=[];else{if(1!==arguments.length)throw"BigInteger Unsupported argument "+t;if(t instanceof w)this.element=t.element.slice(0),this.state=t.state;else if("number"==typeof t){var e=N.toBigIntegerFromNumber(t);this.element=e.element,this.state=e.state}else if("string"==typeof t){var r=N.toBigIntegerFromString(t);this.element=r.element,this.state=r.state}else if(t instanceof Array){if(2!==t.length||"string"!=typeof t[0]||"number"!=typeof t[1])throw"BigInteger Unsupported argument "+arguments;var n=N.toBigIntegerFromString(t[0],t[1]);this.element=n.element,this.state=n.state}else if("object"==typeof t)if("toBigInteger"in t){var i=t.toBigInteger();this.element=i.element,this.state=i.state}else if("intValue"in t){var o=N.toBigIntegerFromNumber(t.intValue);this.element=o.element,this.state=o.state}else{var a=N.toBigIntegerFromString(t.toString());this.element=a.element,this.state=a.state}else{if("boolean"!=typeof t)throw"BigInteger Unsupported argument "+t;var u=N.toBigIntegerFromNumber(t?1:0);this.element=u.element,this.state=u.state}}}var b={ZERO:0,POSITIVE_NUMBER:1,NEGATIVE_NUMBER:2,NOT_A_NUMBER:3,POSITIVE_INFINITY:4,NEGATIVE_INFINITY:5},E={booleanValue:{configurable:!0},intValue:{configurable:!0},longValue:{configurable:!0},doubleValue:{configurable:!0}},x={MINUS_ONE:{configurable:!0},ZERO:{configurable:!0},ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};w.create=function(t){return t instanceof w?t:new w(t)},w.valueOf=function(t){return w.create(t)},w._toBigInteger=function(t){return t instanceof w?t:new w(t)},w._toFloat=function(t){return"number"==typeof t?t:t instanceof w?t.doubleValue:new w(t).doubleValue},w._toInteger=function(t){return"number"==typeof t?Math.trunc(t):t instanceof w?t.intValue:new w(t).intValue},w.createRandomBigInteger=function(t,e){var r,n=void 0!==e&&e instanceof v?e:y,i=new w,o=w._toInteger(t),a=1+(o-1>>4);if(0===o)return w.ZERO;for(var u=0,s=0;u<a;u++)s=0===s?(r=n.nextInt(),i.element[u]=65535&r,1):(i.element[u]=r>>>16&65535,0);return o%16!=0&&(i.element[i.element.length-1]&=(1<<o%16)-1),i.state=b.POSITIVE_NUMBER,i._memory_reduction(),i},w.prototype.toString=function(t){if(!this.isFinite())return this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity";for(var e=t?w._toInteger(t):10,r=Math.floor(Math.log(1073741823)/Math.log(e)),n=Math.round(Math.pow(e,r)),i=[],o=0;o<r;o++)i[o]="0";var a=i.join(""),u=N.toPlainStringFromHexadecimalArray(this.element,n),s=[],h="";this.sign()<0&&(s[s.length]="-");for(var c=u.length-1;0<=c;c--)h=u[c].toString(e),c<u.length-1&&(s[s.length]=a.substring(0,r-h.length)),s[s.length]=h;return s.join("")},w.prototype.clone=function(){return new w(this)},w.prototype.getTwosComplement=function(t){var e=this.clone();if(!this.isFinite())return e;if(e.isNotNegative())return e;e.state=b.POSITIVE_NUMBER;for(var r=void 0!==t?t:e.bitLength(),n=e.element,i=0;i<n.length;i++)n[i]^=65535;return r%16!=0&&(n[n.length-1]&=(1<<r%16)-1),e._add(new w(1)),e},w.prototype._memory_allocation=function(t){if(this.isFinite()){var e=w._toInteger(t),r=this.element.length<<4;if(r<e)for(var n=1+((e-r-1&4294967280)>>>4),i=0;i<n;i++)this.element[this.element.length]=0}},w.prototype._memory_reduction=function(){if(this.isFinite()){for(var t=this.element.length-1;0<=t;t--)if(0!==this.element[t])return void(t<this.element.length-1&&this.element.splice(t+1,this.element.length-t-1));this.state=b.ZERO,this.element=[]}},w.prototype._abs=function(){return this.state===b.NEGATIVE_NUMBER?this.state=b.POSITIVE_NUMBER:this.state===b.NEGATIVE_INFINITY&&(this.state=b.POSITIVE_INFINITY),this},w.prototype.abs=function(){return this.clone()._abs()},w.prototype._negate=function(){return this.state===b.POSITIVE_NUMBER?this.state=b.NEGATIVE_NUMBER:this.state===b.NEGATIVE_NUMBER?this.state=b.POSITIVE_NUMBER:this.state===b.POSITIVE_INFINITY?this.state=b.NEGATIVE_INFINITY:this.state===b.NEGATIVE_INFINITY&&(this.state=b.POSITIVE_INFINITY),this},w.prototype.negate=function(){return this.clone()._negate()},w.prototype.sign=function(){return this.isNaN()?NaN:this.isZero()?0:this.isPositive()?1:-1},w.prototype._add=function(t){var e,r=this,n=w._toBigInteger(t);if(!r.isFinite()||!n.isFinite())return e=r.isNaN()||n.isNaN()||r.isInfinite()&&n.isInfinite()&&!r.equalsState(n)?w.NaN.clone():r.isPositiveInfinity()||n.isPositiveInfinity()?w.POSITIVE_INFINITY.clone():w.NEGATIVE_INFINITY.clone(),this.element=e.element,this.state=e.state,this;var i=r.element,o=n.element;if(r.sign()===n.sign()){this._memory_allocation(o.length<<4);for(var a=0,u=0;u<i.length;u++)i[u]+=(o.length>=u+1?o[u]:0)+a,65535<i[u]?(a=1,i[u]&=65535):a=0;0!==a&&(i[i.length]=a)}else{var s=r.compareToAbs(n);if(0===s)return this.element=[],this.state=b.ZERO,this;if(-1===s){this.state=n.state;var h=i;i=o.slice(0),o=h}for(var c=0,l=0;l<i.length;l++)i[l]-=(o.length>=l+1?o[l]:0)+c,c=i[l]<0?(i[l]+=65536,1):0;this.element=i,this._memory_reduction()}return this},w.prototype.add=function(t){return this.clone()._add(t)},w.prototype._sub=function(t){var e=w._toBigInteger(t),r=e.state,n=this._add(e._negate());return e.state=r,n},w.prototype.sub=function(t){return this.clone()._sub(t)},w.prototype._mul=function(t){var e=this.mul(t);return this.element=e.element,this.state=e.state,this},w.prototype.mul=function(t){var e=w._toBigInteger(t),r=this,n=e;if(!r.isFinite()||!n.isFinite())return r.isNaN()||n.isNaN()||r.isZero()||n.isZero()?w.NaN.clone():0<r.sign()*n.sign()?w.POSITIVE_INFINITY.clone():w.NEGATIVE_INFINITY.clone();for(var i=r.element,o=n.element,a=new w,u=new w,s=a.element,h=0;h<i.length;h++){u.element=[];for(var c=u.element,l=0,f=0;f<o.length;f++)c[f]=i[h]*o[f]+l,65535<c[f]?(l=c[f]>>>16,c[f]&=65535):l=0;0!==l&&(c[c.length]=l);for(var g=c.length-1;0<=g;g--)c[g+h]=c[g];for(var p=h-1;0<=p;p--)c[p]=0;l=0,a._memory_allocation(c.length<<4);for(var m=h;m<s.length;m++)s[m]+=(c.length>=m+1?c[m]:0)+l,65535<s[m]?(l=1,s[m]&=65535):l=0;0!==l&&(s[s.length]=l)}var _=this.sign()*e.sign();return a.state=0==_?b.ZERO:1==_?b.POSITIVE_NUMBER:b.NEGATIVE_NUMBER,a},w.prototype._divideAndRemainder=function(t){var e=this,r=w._toBigInteger(t);if(!e.isFinite()||!r.isFinite())return e.isNaN()||r.isNaN()||e.isInfinite()&&r.isInfinite()?[w.NaN,w.NaN]:e.isInfinite()?0<=e.sign()*r.sign()?[w.POSITIVE_INFINITY,w.NaN]:[w.NEGATIVE_INFINITY,w.NaN]:[w.ZERO,w.NaN];if(r.isZero())return e.isZero()?[w.NaN,w.NaN]:[0<=e.sign()?w.POSITIVE_INFINITY:w.NEGATIVE_INFINITY,w.NaN];var n=[],i=e.compareToAbs(r),o=e.sign()*r.sign();if(i<0)return n[0]=new w(0),n[1]=e.clone(),n;if(0===i)return n[0]=new w(1),n[0].state=1==o?b.POSITIVE_NUMBER:b.NEGATIVE_NUMBER,n[1]=new w(0),n;for(var a=new w(1),u=e.bitLength()-r.bitLength(),s=e.clone()._abs(),h=r.shift(u)._abs(),c=new w,l=0;l<=u&&(0<=s.compareToAbs(h)&&(s._sub(h),c._add(a)),l!==u);l++)h._shift(-1),c._shift(1);return n[0]=c,n[0].state=1==o?b.POSITIVE_NUMBER:b.NEGATIVE_NUMBER,n[1]=s,n[1].state=s.state!==b.ZERO?e.state:s.state,n},w.prototype.divideAndRemainder=function(t){return this.clone()._divideAndRemainder(t)},w.prototype._div=function(t){return this._divideAndRemainder(t)[0]},w.prototype.div=function(t){return this.clone()._div(t)},w.prototype._rem=function(t){var e=this._divideAndRemainder(t)[1];return this.element=e.element,this.state=e.state,this},w.prototype.rem=function(t){return this.clone()._rem(t)},w.prototype._mod=function(t){var e=w._toBigInteger(t);if(e.isZero())return this;var r=this._divideAndRemainder(e)[1];return this.state!==e.state&&r._add(e),this.element=r.element,this.state=r.state,this},w.prototype.mod=function(t){return this.clone()._mod(t)},w.prototype.modPow=function(t,e){var r=w._toBigInteger(e),n=new w(this),i=new w(1),o=new w(t);if(!n.isFinite()||!o.isFinite())return w.NaN;for(;0!==o.element.length;)0!=(1&o.element[0])&&(i=i.multiply(n).mod(r)),n=n.multiply(n).mod(r),o._shift(-1);return i},w.prototype.modInverse=function(t){var e=w._toBigInteger(t);if(!this.isFinite()||!e.isFinite())return w.NaN;var r=this.extgcd(t),n=new w(1);return 0!==r[2].compareTo(n)?w.NaN:r[0]._add(e).rem(e)},w.prototype.factorial=function(){if(!this.isFinite())return this;if(this.isNegative())return w.NaN;for(var t=w._toInteger(this),e=w.ONE,r=2;r<=t;r++)e=e.multiply(r);return e},w.prototype.scaleByPowerOfTen=function(t){var e=w._toInteger(t);return 0===e?this:0<e?this.mul(w.TEN.pow(e)):this.div(w.TEN.pow(e))},w.prototype.pow=function(t){var e=new w(t);if(this.isNaN()||e.isNaN())return w.NaN;if(e.isZero())return w.ONE;if(this.isZero())return e.isNegativeInfinity()?w.POSITIVE_INFINITY:w.ZERO;if(this.isOne())return this;if(this.isInfinite())return this.isPositiveInfinity()?w.POSITIVE_INFINITY:e.isPositiveInfinity()?w.NaN:w.create(1/0*Math.pow(-1,Math.round(e.doubleValue)));if(e.isInfinite()){if(this.isNegative())return w.NaN;if(this.compareTo(w.ONE)<0){if(e.isPositiveInfinity())return w.ZERO;if(e.isNegativeInfinity())return w.POSITIVE_INFINITY}else{if(e.isPositiveInfinity())return w.POSITIVE_INFINITY;if(e.isNegativeInfinity())return w.ZERO}}for(var r=w._toBigInteger(this),n=w._toBigInteger(1);0!==e.element.length;)0!=(1&e.element[0])&&(n=n.multiply(r)),r=r.multiply(r),e._shift(-1);return n},w.prototype.square=function(){return this.mul(this)},w.prototype.sqrt=function(){if(this.isZero())return w.ZERO;if(this.isNaN())return w.NaN;if(this.isNegative())return w.NaN;if(this.isInfinite())return w.POSITIVE_INFINITY;for(var t=w.ONE,e=this;-1===t.compareToAbs(e);)t=t.shiftLeft(1),e=e.shiftRight(1);for(var r=e,n=0;n<300;n++){var i=r.add(this.div(r)).shiftRight(1);if(i.sub(r).isZero())break;r=i}return r},w.prototype.cbrt=function(){if(this.isZero())return w.ZERO;if(this.isNaN())return w.NaN;if(this.isInfinite())return this;for(var t=w.ONE,e=this;-1===t.compareToAbs(e);)t=t.shiftLeft(1),e=e.shiftRight(2);for(var r=e,n=0;n<300;n++){var i=r.mul(r),o=r.shiftLeft(1).add(this.div(i)).div(3);if(o.sub(r).isZero())break;r=o}return r},w.prototype.log2=function(){return this.isZero()?w.ZERO:this.isNaN()?w.NaN:this.isNegative()?w.NaN:this.isInfinite()?w.POSITIVE_INFINITY:w.create(this.bitLength()-1)},w.prototype.log10=function(){return this.isZero()?w.ZERO:this.isNaN()?w.NaN:this.isNegative()?w.NaN:this.isInfinite()?w.POSITIVE_INFINITY:w.create(this.toString(10).length-1)},w.setDefaultRandom=function(t){y=t},w.getDefaultRandom=function(){return y},w.prototype.getShort=function(t){if(this.isZero())return 0;var e=w._toInteger(t);return 0<=e&&e<=this.element.length?this.element[e]:NaN},E.booleanValue.get=function(){return!this.isZero()&&!this.isNaN()},E.intValue.get=function(){if(!this.isFinite())return this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0;var t=this.getShort(0)+(this.getShort(1)<<16);return 0<(t&=4294967295)&&this.isNegative()&&(t=-t),t},E.longValue.get=function(){if(!this.isFinite())return this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0;for(var t=0,e=Math.min(3,this.element.length-1);0<=e;e--)t*=65536,t+=this.getShort(e);return this.isNegative()&&(t=-t),t},E.doubleValue.get=function(){return this.isFinite()?parseFloat(this.toString()):this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0},w.prototype.gcd=function(t){var e=w._toBigInteger(t);if(!this.isFinite()||!e.isFinite())return w.NaN;for(var r,n=this,i=e,o=10;0!==i.sign()&&o;)r=n.rem(i),n=i,i=r,o--;return n},w.prototype.extgcd=function(t){var e=w._toBigInteger(t);if(!this.isFinite()||!e.isFinite())return[w.NaN,w.NaN,w.NaN];for(var r,n,i,o,a=new w(1),u=new w(0),s=this,h=e,c=a,l=u,f=u,g=a;0!==h.sign();){var p=s.divideAndRemainder(h);n=p[0],r=p[1],i=c.subtract(n.multiply(l)),o=f.subtract(n.multiply(g)),c=l,l=i,f=g,g=o,s=h,h=r}return[c,f,s]},w.prototype.lcm=function(t){var e=w._toBigInteger(t);return this.isFinite()&&e.isFinite()?this.mul(e).div(this.gcd(e)):w.NaN},w.prototype.equals=function(t){var e=this,r=w._toBigInteger(t);if(!e.isFinite()||!r.isFinite())return!e.isNaN()&&!r.isNaN()&&e.state===r.state;if(e.state!==r.state)return!1;if(e.element.length!==r.element.length)return!1;for(var n=0;n<r.element.length;n++)if(e.element[n]!==r.element[n])return!1;return!0},w.prototype.compareToAbs=function(t){var e=this,r=w._toBigInteger(t);if(!e.isFinite()||!r.isFinite())return e.isNaN()||r.isNaN()?NaN:e.isInfinite()||r.isInfinite()?0:r.isInfinite()?-1:1;if(e.element.length<r.element.length)return-1;if(e.element.length>r.element.length)return 1;for(var n=e.element.length-1;0<=n;n--)if(e.element[n]!==r.element[n]){var i=e.element[n]-r.element[n];return 0==i?0:0<i?1:-1}return 0},w.prototype.compareTo=function(t){var e=this,r=w._toBigInteger(t);if(!e.isFinite()||!r.isFinite())return e.isNaN()||r.isNaN()?NaN:e.state===r.state?0:e.isPositiveInfinity()||r.isNegativeInfinity()?1:-1;var n=e.sign(),i=r.sign();return n!==i?i<n?1:-1:0===n?0:e.compareToAbs(r)*n},w.prototype.equalsState=function(t){var e=w._toBigInteger(t);return this.state===e.state},w.prototype.max=function(t){var e=w._toBigInteger(t);return 0<=this.compareTo(e)?this.clone():e.clone()},w.prototype.min=function(t){var e=w._toBigInteger(t);return 0<=this.compareTo(e)?e.clone():this.clone()},w.prototype.clip=function(t,e){var r=w._toBigInteger(t),n=w._toBigInteger(e);if(this.isNaN()||r.isNaN()||n.isNaN())return w.NaN;var i=r.compareTo(n);if(1===i)throw"clip(min, max) error. (min > max)->("+r+" > "+n+")";return 0===i?r:1===this.compareTo(n)?n:-1===this.compareTo(r)?r:this},w.probablePrime=function(t,e,r,n){for(var i=r?w._toInteger(r):100,o=n?w._toInteger(n):500,a=0;a<o;a++){var u=w.createRandomBigInteger(t,e);if(u.isProbablePrime(i))return u}return console.log("probablePrime "+n),w.NaN},w.prototype.isPrime=function(){if(!this.isFinite())return!1;if(this.sign()<=0)return!1;var t=Math.sqrt(Math.pow(2,51)),e=this.doubleValue,r=Math.ceil(Math.sqrt(e));if(e<=2)return!0;if(t<r)return null;for(var n=2;n<=r;n++)if(e%n==0)return!1;return!0},w.prototype.isProbablePrime=function(t){if(!this.isFinite())return!1;var e=this.element;if(this.sign()<=0)return!1;if(1===e.length&&e[0]<=2)return!0;if(0==(1&e[0]))return!1;var r=void 0!==t?w._toInteger(t):100,n=w.ZERO,i=w.ONE,o=this,a=o.bitLength(),u=o.subtract(i),s=u.getLowestSetBit(),h=u.shift(-s);if(r<=0)return!1;for(var c=0;c<r;c++){for(var l=void 0;0===(l=w.createRandomBigInteger(a)).compareTo(n)||-1!==l.compareTo(o););for(var f=h,g=l.modPow(f,o);!(f.equals(u)||g.equals(i)||g.equals(u));)g=g.mul(g)._mod(o),f=f.shiftLeft(1);if(!g.equals(u)&&0==(1&f.element[0]))return!1}return!0},w.prototype.nextProbablePrime=function(t,e){if(!this.isFinite())return w.NaN;for(var r=void 0!==t?w._toInteger(t)>>1:50,n=void 0!==e?w._toInteger(e):1e5,i=this.clone(),o=0;o<n;o++)if(i._add(w.ONE),i.isProbablePrime(r))return i;throw"nextProbablePrime ["+n+"]"},w.prototype._shift=function(t){if(!this.isFinite())return this;var e=w._toInteger(t);if(0===e)return this;var r=this.element;if(1===e){var n=r.length-1;for(0!=(32768&r[n])&&(r[r.length]=1);0<=n;n--)r[n]<<=1,r[n]&=65535,0<n&&0!=(32768&r[n-1])&&(r[n]+=1)}else if(-1===e){for(var i=0;i<r.length;i++)r[i]>>>=1,i<r.length-1&&0!=(1&r[i+1])&&(r[i]|=32768);0===r[r.length-1]&&r.pop()}else{if(16<=e){for(var o=e>>>4,a=r.length-1;0<=a;a--)r[a+o]=r[a];for(var u=o-1;0<=u;u--)r[u]=0;e&=15}else if(e<=-16){var s=-e>>>4;r.splice(0,s),e+=s<<4}if(0!==e)if(0<e){for(var h=0,c=0;c<r.length;c++)r[c]=(r[c]<<e)+h,65535<r[c]?(h=r[c]>>>16,r[c]&=65535):h=0;0!==h&&(r[r.length]=h)}else{e=-e;for(var l=0;l<r.length;l++)l!==r.length-1?(r[l]+=r[l+1]<<16,r[l]>>>=e,r[l]&=65535):r[l]>>>=e;0===r[r.length-1]&&r.pop()}}return this},w.prototype.shift=function(t){return this.clone()._shift(t)},w.prototype.shiftLeft=function(t){return this.shift(t)},w.prototype.shiftRight=function(t){return this.shift(-t)},w.prototype.getLowestSetBit=function(){if(!this.isFinite())return NaN;for(var t=0;t<this.element.length;t++)if(0!==this.element[t])for(var e=this.element[t],r=0;r<16;r++)if(0!=(e>>>r&1))return 16*t+r;return-1},w.prototype.bitLength=function(){if(!this.isFinite())return NaN;for(var t=this.element.length-1;0<=t;t--)if(0!==this.element[t])for(var e=this.element[t],r=15;0<=r;r--)if(0!=(e>>>r&1))return 16*t+r+1;return 0},w.prototype.bitCount=function(){if(!this.isFinite())return NaN;for(var t,e=(t=0<=this.sign()?this:this.add(new w(1))).bitLength(),r=0,n=0,i=0;r<e;i++)for(var o=t.element[i],a=0;a<16&&r<e;a++,r++)0!=(o>>>a&1)&&(n+=1);return n},w.prototype._and=function(t){var e,r=this,n=w._toBigInteger(t);if(!r.isFinite()||!n.isFinite())return e=(e=r.isNaN()||n.isNaN()?w.NaN:w.ZERO).clone(),this.element=e.element,this.state=e.state,this;var i=r.sign(),o=n.sign(),a=Math.max(r.bitLength(),n.bitLength()),u=r.getTwosComplement(a).element,s=n.getTwosComplement(a).element,h=Math.max(u.length,s.length);this.element=[];for(var c=0;c<h;c++){var l=c>=u.length?0:u[c],f=c>=s.length?0:s[c];this.element[c]=l&f}return this._memory_reduction(),1===i||1===o?this.state=b.POSITIVE_NUMBER:this.state===b.NEGATIVE_NUMBER&&(this.element=this.getTwosComplement(a).element,this._memory_reduction()),this},w.prototype.and=function(t){return this.clone()._and(t)},w.prototype._or=function(t){var e,r=this,n=w._toBigInteger(t);if(!r.isFinite()||!n.isFinite())return e=(e=r.isNaN()||n.isNaN()?w.NaN.clone():r.isInfinite()||n.isInfinite()?w.ZERO:r.isInfinite()?n:r).clone(),this.element=e.element,this.state=e.state,this;var i=r.sign(),o=n.sign(),a=Math.max(r.bitLength(),n.bitLength()),u=r.getTwosComplement(a).element,s=n.getTwosComplement(a).element,h=Math.max(u.length,s.length);this.element=[];for(var c=0;c<h;c++){var l=c>=u.length?0:u[c],f=c>=s.length?0:s[c];this.element[c]=l|f}return this.state=-1===i||-1===o?b.NEGATIVE_NUMBER:0===Math.max(i,o)?b.ZERO:b.POSITIVE_NUMBER,this.state===b.NEGATIVE_NUMBER&&(this.element=this.getTwosComplement(a).element,this._memory_reduction()),this},w.prototype.or=function(t){return this.clone()._or(t)},w.prototype._xor=function(t){var e,r=this,n=w._toBigInteger(t);if(!r.isFinite()||!n.isFinite())return e=(e=r.isNaN()||n.isNaN()?w.NaN:r.isInfinite()||n.isInfinite()?w.ZERO:r.isInfinite()?n:r).clone(),this.element=e.element,this.state=e.state,this;var i=r.sign(),o=n.sign(),a=Math.max(r.bitLength(),n.bitLength()),u=r.getTwosComplement(a).element,s=n.getTwosComplement(a).element,h=Math.max(u.length,s.length);this.element=[];for(var c=0;c<h;c++){var l=c>=u.length?0:u[c],f=c>=s.length?0:s[c];this.element[c]=l^f}return this._memory_reduction(),this.state=0!==i&&i!==o?b.NEGATIVE_NUMBER:b.POSITIVE_NUMBER,this.state===b.NEGATIVE_NUMBER&&(this.element=this.getTwosComplement(a).element,this._memory_reduction()),this},w.prototype.xor=function(t){return this.clone()._xor(t)},w.prototype._not=function(){return this._add(new w(1))._negate()},w.prototype.not=function(){return this.clone()._not()},w.prototype._setBit=function(t){var e=w._toInteger(t);return this._memory_allocation(e+1),this.element[e>>>4]|=1<<(15&e),this.state=b.POSITIVE_NUMBER,this},w.prototype.setBit=function(t){var e=w._toInteger(t);return this.clone()._setBit(e)},w.prototype._flipBit=function(t){var e=w._toInteger(t);return this._memory_allocation(e+1),this.element[e>>>4]^=1<<(15&e),this._memory_reduction(),this},w.prototype.flipBit=function(t){var e=w._toInteger(t);return this.clone()._flipBit(e)},w.prototype.clearBit=function(t){var e=w._toInteger(t),r=this.clone();return r.element[e>>>4]&=~(1<<(15&e)),r._memory_reduction(),r},w.prototype.testBit=function(t){var e=w._toInteger(t);return 0!=(this.element[e>>>4]>>>(15&e)&1)},w.prototype.isZero=function(){return this.state===b.ZERO},w.prototype.isOne=function(){return this.state===b.POSITIVE_NUMBER&&1===this.element.length&&1===this.element[0]},w.prototype.isPositive=function(){return this.state===b.POSITIVE_NUMBER||this.state===b.POSITIVE_INFINITY},w.prototype.isNegative=function(){return this.state===b.NEGATIVE_NUMBER||this.state===b.NEGATIVE_INFINITY},w.prototype.isNotNegative=function(){return this.state===b.ZERO||this.state===b.POSITIVE_NUMBER||this.state===b.POSITIVE_INFINITY},w.prototype.isNaN=function(){return this.state===b.NOT_A_NUMBER},w.prototype.isPositiveInfinity=function(){return this.state===b.POSITIVE_INFINITY},w.prototype.isNegativeInfinity=function(){return this.state===b.NEGATIVE_INFINITY},w.prototype.isInfinite=function(){return this.isPositiveInfinity()||this.isNegativeInfinity()},w.prototype.isFinite=function(){return!this.isNaN()&&!this.isInfinite()},x.MINUS_ONE.get=function(){return M.MINUS_ONE},x.ZERO.get=function(){return M.ZERO},x.ONE.get=function(){return M.ONE},x.TWO.get=function(){return M.TWO},x.TEN.get=function(){return M.TEN},x.POSITIVE_INFINITY.get=function(){return M.POSITIVE_INFINITY},x.NEGATIVE_INFINITY.get=function(){return M.NEGATIVE_INFINITY},x.NaN.get=function(){return M.NaN},w.prototype.signum=function(){return this.sign()},w.prototype.subtract=function(t){return this.sub(t)},w.prototype.multiply=function(t){return this.mul(t)},w.prototype.divide=function(t){return this.div(t)},w.prototype.remainder=function(t){return this.rem(t)},Object.defineProperties(w.prototype,E),Object.defineProperties(w,x);var M={MINUS_ONE:new w(-1),ZERO:new w(0),ONE:new w(1),TWO:new w(2),TEN:new w(10),POSITIVE_INFINITY:new w(Number.POSITIVE_INFINITY),NEGATIVE_INFINITY:new w(Number.NEGATIVE_INFINITY),NaN:new w(Number.NaN)},T=[];T[0]=I.DECIMAL128;function O(){}O.ToBigDecimalFromString=function(t){var e,r=0,n=t.replace(/\s/g,"").toLowerCase();if(/nan/.test(n))return{scale:0,integer:w.NaN};if(/inf/.test(n))return/-/.test(n)?{scale:0,integer:w.NEGATIVE_INFINITY}:{scale:0,integer:w.POSITIVE_INFINITY};var i="";return null!==(e=n.match(/^[+-]+/))&&(e=e[0],n=n.substr(e.length),-1!==e.indexOf("-")&&(i+="-")),null!==(e=n.match(/^[0-9]+/))&&(e=e[0],n=n.substr(e.length),i+=e),null!==(e=n.match(/^\.[0-9]+/))&&(e=e[0],n=n.substr(e.length),r+=(e=e.substr(1)).length,i+=e),null!==(e=n.match(/^e[+-]?[0-9]+/))&&(e=e[0].substr(1),r-=parseInt(e,10)),{scale:r,integer:new w([i,10])}},O.ToBigDecimalFromNumber=function(t){var e="boolean"!=typeof t?t:t?1:0;if(!isFinite(e))return e===1/0?{scale:0,integer:w.POSITIVE_INFINITY}:e===-1/0?{scale:0,integer:w.NEGATIVE_INFINITY}:{scale:0,integer:w.NaN};if(e===Math.floor(e))return{scale:0,integer:new w(Math.round(e))};var r=Math.trunc(Math.log(Math.abs(e))/Math.log(10)),n=e/Math.pow(10,r);r=-r;for(var i=0;i<14&&(n*=10,r+=1,!(Math.abs(n-Math.round(n))<=Number.EPSILON));i++);return n=Math.round(1e14*n)/1e14,{scale:r,integer:new w(n)}};function F(t){this._scale=0,this.context=F.getDefaultContext();var e=!1;if(1<arguments.length)throw"BigDecimal Unsupported argument["+arguments.length+"]";if(t instanceof F)this.integer=t.integer.clone(),this.int_string=t.int_string,this._scale=t._scale,this.context=t.context;else if("number"==typeof t||"boolean"==typeof t){var r=O.ToBigDecimalFromNumber(t);this.integer=r.integer,this._scale=r.scale}else if("string"==typeof t){var n=O.ToBigDecimalFromString(t);this.integer=n.integer,this._scale=n.scale}else if(t instanceof Array){if(1<=t.length){var i=t[0];if("number"==typeof i||"boolean"==typeof i){var o=O.ToBigDecimalFromNumber(i);this.integer=o.integer,this._scale=o.scale}else if("string"==typeof i){var a=O.ToBigDecimalFromString(i);this.integer=a.integer,this._scale=a.scale}else if(i instanceof F)this.integer=i.integer.clone(),this._scale=i._scale;else if(i instanceof w)this.integer=i.clone();else{if("object"!=typeof i)throw"BigDecimal Unsupported argument "+i+"("+typeof i+")";if("toBigDecimal"in i){var u=i.toBigDecimal();this.integer=u.integer,this._scale=u._scale}else if("doubleValue"in i){var s=O.ToBigDecimalFromNumber(i.doubleValue);this.integer=s.integer,this._scale=s.scale}else{var h=O.ToBigDecimalFromString(i.toString());this.integer=h.integer,this._scale=h.scale}}}2<=t.length&&("number"==typeof t[1]?(this._scale=t[1],3<=t.length&&(this.context=void 0!==t[2]&&t[2]instanceof I?t[2]:F.getDefaultContext(),e=!0)):2<=t.length&&(this.context=void 0!==t[1]&&t[1]instanceof I?t[1]:F.getDefaultContext(),e=!0))}else if(t instanceof w)this.integer=t.clone();else{if("object"!=typeof t)throw"BigDecimal Unsupported argument "+arguments;if("toBigDecimal"in t){var c=t.toBigDecimal();this.integer=c.integer,this._scale=c._scale,this.context=c.context}else if("doubleValue"in t){var l=O.ToBigDecimalFromNumber(t.doubleValue);this.integer=l.integer,this._scale=l.scale}else if("integer"in t&&"scale"in t&&"context"in t)this.integer=new w(t.integer),t.scale&&(this._scale=t.scale),t.context&&(this.context=t.context,e=!0);else if(t instanceof Object){var f=O.ToBigDecimalFromString(t.toString());this.integer=f.integer,this._scale=f.scale}}if(e){var g=this.round(this.context);this.integer=g.integer,this._scale=g._scale,delete this.int_string}if(!(this.integer instanceof w&&this.context instanceof I))throw"BigDecimal Unsupported argument "+arguments}var P={booleanValue:{configurable:!0},intValue:{configurable:!0},intValueExact:{configurable:!0},floatValue:{configurable:!0},doubleValue:{configurable:!0}},D={MINUS_ONE:{configurable:!0},ZERO:{configurable:!0},HALF:{configurable:!0},ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},PI:{configurable:!0},QUARTER_PI:{configurable:!0},HALF_PI:{configurable:!0},TWO_PI:{configurable:!0},E:{configurable:!0},LN2:{configurable:!0},LN10:{configurable:!0},LOG2E:{configurable:!0},LOG10E:{configurable:!0},SQRT2:{configurable:!0},SQRT1_2:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};F.create=function(t){return t instanceof F?t:new F(t)},F.valueOf=function(t,e){return new F(1===arguments.length?t:[t,e])},F._toBigDecimal=function(t){return t instanceof F?t:new F(t)},F._toBigInteger=function(t){return t instanceof w?t:t instanceof F?t.toBigInteger():new w(t)},F._toFloat=function(t){return"number"==typeof t?t:t instanceof F?t.doubleValue:new F(t).doubleValue},F._toInteger=function(t){return"number"==typeof t?Math.trunc(t):t instanceof w?t.intValue:new w(t).intValue},F.prototype._getUnsignedIntegerString=function(){return void 0===this.int_string&&(this.int_string=this.integer.toString(10).replace(/^-/,"")),this.int_string},F.prototype.clone=function(){return new F(this)},F.prototype.scale=function(){return this._scale},F.prototype.sign=function(){return this.isFinite()?this.integer.sign():this.isNaN()?NaN:this.isPositiveInfinity()?1:-1},F.prototype.precision=function(){return this._getUnsignedIntegerString().length},F.prototype.unscaledValue=function(){return new w(this.integer)},F.prototype.ulp=function(){return new F([w.ONE,this.scale()])},F.prototype.abs=function(){var t=this.clone();return t.integer=t.integer.abs(),t},F.prototype.plus=function(){return this},F.prototype.negate=function(){var t=this.clone();return t.integer=t.integer.negate(),t},F.prototype.movePointLeft=function(t){if(!this.isFinite())return this;var e=F._toInteger(t),r=this.scaleByPowerOfTen(-e);return r=r.setScale(Math.max(this.scale()+e,0))},F.prototype.movePointRight=function(t){return this.movePointLeft(-t)},F.prototype.stripTrailingZeros=function(){if(!this.isFinite())return this;var t=0<=this.sign()?"":"-",e=this.integer.toString(10).replace(/^-/,""),r=e.match(/0+$/),n=null!==r?r[0].length:0;n===e.length&&(n=e.length-1);var i=this.scale()-n;return new F([new w(t+e.substring(0,e.length-n)),i])},F.prototype.add=function(t){var e=this,r=F._toBigDecimal(t);if(!e.isFinite()||!r.isFinite())return e.isNaN()||r.isNaN()||e.isInfinite()&&r.isInfinite()&&!e.equalsState(r)?F.NaN:e.isPositiveInfinity()||r.isPositiveInfinity()?F.POSITIVE_INFINITY:F.NEGATIVE_INFINITY;var n=F.getDefaultContext(),i=Math.max(e._scale,r._scale);if(e._scale===r._scale)return new F([e.integer.add(r.integer),i,n]);if(e._scale>r._scale){var o=r.setScale(e._scale);return new F([e.integer.add(o.integer),i,n])}var a=e.setScale(r._scale);return new F([a.integer.add(r.integer),i,n])},F.prototype.sub=function(t){var e=F._toBigDecimal(t);return this.add(e.negate())},F.prototype.mul=function(t){var e=this,r=F._toBigDecimal(t);if(!e.isFinite()||!r.isFinite())return e.isNaN()||r.isNaN()||e.isZero()||r.isZero()?F.NaN:0<e.sign()*r.sign()?F.POSITIVE_INFINITY:F.NEGATIVE_INFINITY;var n=F.getDefaultContext(),i=e.integer.mul(r.integer),o=e._scale+r._scale;return new F([i,o,n])},F.prototype.divideToIntegralValue=function(t){var e=this,r=F._toBigDecimal(t);if(!e.isFinite()||!r.isFinite())return e.isNaN()||r.isNaN()||e.isInfinite()&&r.isInfinite()?F.NaN:e.isInfinite()?0<=e.sign()*r.sign()?F.POSITIVE_INFINITY:F.NEGATIVE_INFINITY:F.ZERO;if(r.isZero())return e.isZero()?F.NaN:0<=e.sign()?F.POSITIVE_INFINITY:F.NEGATIVE_INFINITY;function n(t){var e,r="1";for(e=0;e<t;e++)r+="0";return new w(r)}var i=F.getDefaultContext();if(0===r.compareTo(F.ZERO))throw"ArithmeticException";var o=e.integer,a=r.integer,u=e._scale-r._scale;e._scale>r._scale?a=a.mul(n(u)):e._scale<r._scale&&(o=o.mul(n(-u)));var s=o.div(a),h=s.sign();if(0!==h){var c=s.toString(10).replace(/^-/,"");if(0!==i.getPrecision()&&c.length>i.getPrecision())throw"ArithmeticException";if(c.length<=-u){var l=c.match(/0+$/),f=null!==l?l[0].length:0;return new F([new w((0<=h?"":"-")+c.substring(0,c.length-f)),-f,i])}}var g=new F(s);return(g=(g=g.setScale(u,d.UP)).round(i)).context=i,g},F.prototype.divideAndRemainder=function(t){var e=F._toBigDecimal(t);if(!this.isFinite()||!e.isFinite())return this.isNaN()||e.isNaN()||this.isInfinite()&&e.isInfinite()?[F.NaN,F.NaN]:this.isInfinite()?0<=this.sign()*e.sign()?[F.POSITIVE_INFINITY,F.NaN]:[F.NEGATIVE_INFINITY,F.NaN]:[F.ZERO,F.NaN];if(e.isZero())return this.isZero()?[F.NaN,F.NaN]:[0<=this.sign()?F.POSITIVE_INFINITY:F.NEGATIVE_INFINITY,F.NaN];var r=this.divideToIntegralValue(e),n=this.sub(r.mul(e));return[r,n]},F.prototype.rem=function(t){return this.divideAndRemainder(t)[1]},F.prototype.mod=function(t){var e=F._toBigDecimal(t);if(e.isZero())return this;var r=this.rem(e);return this.equalsState(e)?r:r.add(e)},F.prototype.div=function(t,e){var r=this,n=F._toBigDecimal(t);if(!r.isFinite()||!n.isFinite())return r.isNaN()||n.isNaN()||r.isInfinite()&&n.isInfinite()?F.NaN:r.isInfinite()?0<=r.sign()*n.sign()?F.POSITIVE_INFINITY:F.NEGATIVE_INFINITY:F.ZERO;if(n.isZero())return r.isZero()?F.NaN:0<=r.sign()?F.POSITIVE_INFINITY:F.NEGATIVE_INFINITY;var i=null,o=null,a=0,u=!1;if(e?e instanceof I?(i=(o=e).getRoundingMode(),a=o.getPrecision()):(a=e&&e.scale?e.scale:(u=!0,e&&(e.roundingMode||e.context)?r.scale():r.scale()-n.scale()),e&&e.context?(i=(o=e.context).getRoundingMode(),a=o.getPrecision()):o=this.context,i=e&&e.roundingMode?e.roundingMode:o.getRoundingMode()):(i=(o=F.getDefaultContext()).getRoundingMode(),a=o.getPrecision()),0===n.compareTo(F.ZERO))throw"ArithmeticException";var s,h=o.getPrecision();if(0===h||h<=100){var c,l,f,g,p={};s=F.ZERO;var m=0!==h?h+8:262143;c=r,F.pushDefaultContext(I.UNLIMITED);for(var _,v=!1,N=0;N<m&&(f=(l=c.divideAndRemainder(n))[0],g=l[1],s=s.add(f.scaleByPowerOfTen(-N)),0!==g.compareTo(F.ZERO));N++){if(0===h){if(p[g._getUnsignedIntegerString()]){v=!0,_="ArithmeticException "+s+"["+g._getUnsignedIntegerString()+"]";break}p[g._getUnsignedIntegerString()]=!0}c=g.scaleByPowerOfTen(1)}if(F.popDefaultContext(),v)throw _}else F.pushDefaultContext(new I(h+4,d.HALF_UP)),s=this.mul(n.inv()),F.popDefaultContext();if(s.context=o,u)try{s=s.setScale(a,i)}catch(t){}else s=s.setScale(a,i);return s=s.round(F.getDefaultContext())},F.prototype.inv=function(){if(F.getDefaultContext().equals(I.UNLIMITED))return F.ONE.div(this);if(!this.isFinite())return this.isNaN()?F.NaN:F.ZERO;if(this.isZero())return F.NaN;var t=this.isNegative(),e=t?this.negate():this,r=F.create(1),n=-e.scale()+(e.precision()-1),i=new F([1,1+n]);if(i.isZero())return null;for(var o=i,a=0;a<20;a++){var u=r.sub(e.mul(o));if(u.isZero())break;o=o.mul(r.add(u).add(u.square()))}return t?o.negate():o},F.prototype.factorial=function(){return this.isFinite()?new F(new w(this).factorial()):this},F.prototype.scaleByPowerOfTen=function(t){if(!this.isFinite())return this;var e=F._toInteger(t),r=this.clone();return r._scale=this.scale()-e,r},F.setDefaultContext=function(t){T[T.length-1]=t||I.DECIMAL128},F.getDefaultContext=function(){return T[T.length-1]},F.pushDefaultContext=function(t){T.push(t)},F.popDefaultContext=function(){T.pop()},P.booleanValue.get=function(){return this.integer.booleanValue},P.intValue.get=function(){return this.isFinite()?4294967295&this.toBigInteger().intValue:this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0},P.intValueExact.get=function(){if(!this.isFinite())throw"ArithmeticException";var t=this.toBigInteger().intValue;if(t<-2147483648||2147483647<t)throw"ArithmeticException";return t},P.floatValue.get=function(){if(!this.isFinite())return this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0;var t=this.precision();return I.DECIMAL32.getPrecision()<t?0<=this.sign()?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:parseFloat(this.toEngineeringString())},P.doubleValue.get=function(){return this.isFinite()?parseFloat(this.toEngineeringString()):this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0},F.prototype.toBigInteger=function(){return this.integer.scaleByPowerOfTen(-this.scale())},F.prototype.equals=function(t,e){if(e)return 0===this.compareTo(t,e);if(t instanceof F||"string"==typeof t){var r=t instanceof F?t:F._toBigDecimal(t);return!this.isNaN()&&!r.isNaN()&&(this.equalsState(r)&&this._scale===r._scale&&this.integer.equals(r.integer))}return 0===this.compareTo(t)},F.prototype.equalsState=function(t){var e=F._toBigDecimal(t);return this.integer.equalsState(e.integer)},F.prototype.compareTo=function(t,e){var r=this,n=F._toBigDecimal(t);if(!r.isFinite()||!n.isFinite())return r.integer.compareTo(n.integer);if(e){var i=F._toBigDecimal(e);F.pushDefaultContext(I.UNLIMITED);var o=r.sub(n);return F.popDefaultContext(),o.abs().compareTo(i)<=0?0:o.sign()}var a=r.sign(),u=n.sign();if(0===a&&a===u)return 0;if(0===a)return-u;if(0===u)return a;if(r._scale===n._scale)return r.integer.compareTo(n.integer);if(r._scale>n._scale){var s=n.setScale(r._scale);return r.integer.compareTo(s.integer)}return r.setScale(n._scale).integer.compareTo(n.integer)},F.prototype.max=function(t){var e=F._toBigDecimal(t);return this.isNaN()||e.isNaN()?F.NaN:0<=this.compareTo(e)?this.clone():e.clone()},F.prototype.min=function(t){var e=F._toBigDecimal(t);return this.isNaN()||e.isNaN()?F.NaN:this.compareTo(e)<=0?this.clone():e.clone()},F.prototype.clip=function(t,e){var r=F._toBigDecimal(t),n=F._toBigDecimal(e);if(this.isNaN()||r.isNaN()||n.isNaN())return F.NaN;var i=r.compareTo(n);if(1===i)throw"clip(min, max) error. (min > max)->("+r+" > "+n+")";return 0===i?r:1===this.compareTo(n)?n:-1===this.compareTo(r)?r:this},F.prototype.toString=function(){if(!this.isFinite())return this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity";var t=-this.scale()+(this.precision()-1);return 0<=this.scale()&&-6<=t?this.toPlainString():this.toScientificNotation(t)},F.prototype.toScientificNotation=function(t){if(!this.isFinite())return this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity";var e,r,n=F._toInteger(t),i=this._getUnsignedIntegerString(),o=this.scale(),a=[];if(-1===this.sign()&&(a[a.length]="-"),0<=(o=-n-o))for(a[a.length]=i,e=0;e<o;e++)a[a.length]="0";else if(0<(r=this.precision()+o))a[a.length]=i.substring(0,r),a[a.length]=".",a[a.length]=i.substring(r,i.length);else{for(r=-r,a[a.length]="0.",e=0;e<r;e++)a[a.length]="0";a[a.length]=i}return a[a.length]="E",0<=n&&(a[a.length]="+"),a[a.length]=n,a.join("")},F.prototype.toEngineeringString=function(){if(!this.isFinite())return this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity";var t=-this.scale()+(this.precision()-1);return 0<=this.scale()&&-6<=t?this.toPlainString():this.toScientificNotation(3*Math.floor(t/3))},F.prototype.toPlainString=function(){return this.isFinite()?0===this.scale()?this.sign()<0?"-"+this._getUnsignedIntegerString():this._getUnsignedIntegerString():this.toScientificNotation(0).match(/^[^E]*/)[0]:this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity"},F.prototype.setScale=function(t,e){if(!this.isFinite())return this;var r=F._toInteger(t);if(this.scale()===r)return this.clone();var n=void 0!==e?d.valueOf(e):d.UNNECESSARY,i=this._getUnsignedIntegerString(),o=this.sign(),a=0<=o?"":"-",u=r-this.scale();if(0<=u){var s;for(s=0;s<u;s++)i+="0";return new F([new w(a+i),r])}var h=i.length+u,c=h+1;if(h<=0){var l=(o+n.getAddNumber(o))/10;return new F([new w(l),r])}var f=i.match(/0+$/);if(0<=(null!==f?f[0].length:0)+u||n===d.DOWN)return new F([new w(a+i.substring(0,h)),r]);var g=1<(i=i.substring(0,c)).length?2:1,p=parseInt(i.substring(i.length-g,i.length))*o,m=new w(a+i),_=new w(n.getAddNumber(p));return i=m.add(_).toString(),new F([new w(i.substring(0,i.length-1)),r])},F.prototype.round=function(t){if(!this.isFinite())return this;if(1!==arguments.length)return this.setScale(0,d.HALF_UP);if(void 0===t)return this;if(!(t instanceof I))throw"not MathContext";var e=t.getPrecision(),r=e-this.precision();if(0==r||0===e)return this.clone();var n=this.setScale(this.scale()+r,t.getRoundingMode());if(0<r)return n;if(n.precision()===t.getPrecision())return n;var i=0<=n.integer.sign()?"":"-",o=n._getUnsignedIntegerString(),a=i+o.substring(0,o.length-1);return new F([new w(a),n.scale()-1])},F.prototype.floor=function(){return this.isFinite()?this.setScale(0,d.FLOOR):this},F.prototype.ceil=function(){return this.isFinite()?this.setScale(0,d.CEILING):this},F.prototype.fix=function(){return this.isFinite()?this.setScale(0,d.DOWN):this},F.prototype.fract=function(){return this.isFinite()?this.sub(this.floor()):F.NaN},F.prototype.pow=function(t){var e=this,r=F._toBigDecimal(t);if(e.isNaN()||r.isNaN())return F.NaN;if(r.isZero())return F.ONE;if(e.isZero())return F.ZERO;if(e.isOne())return e;if(e.isInfinite())return e.isPositiveInfinity()?F.POSITIVE_INFINITY:r.isPositiveInfinity()?F.NaN:F.create(1/0*Math.pow(-1,Math.round(r.doubleValue)));if(r.isInfinite()){if(e.isNegative())return F.NaN;if(e.compareTo(F.ONE)<0){if(r.isPositiveInfinity())return F.ZERO;if(r.isNegativeInfinity())return F.POSITIVE_INFINITY}else{if(r.isPositiveInfinity())return F.POSITIVE_INFINITY;if(r.isNegativeInfinity())return F.ZERO}}var n=F.getDefaultContext(),i=r.intValue;if(1e3<Math.abs(i))throw F.POSITIVE_INFINITY;if(0===n.getPrecision()&&r.isNegative())return F.NaN;if(r.isInteger()){var o,a,u=r.isNegative(),s=Math.round(Math.abs(i));for(o=this.clone(),a=F.ONE,F.pushDefaultContext(I.UNLIMITED);0!==s;)0!=(1&s)&&(a=a.mul(o)),o=o.square(),s>>>=1;return F.popDefaultContext(),a.context=n,u&&(a=a.inv()),a=a.round(n)}var h=F.getDefaultContext();F.pushDefaultContext(F.getDefaultContext().increasePrecision());var c=this.log().mul(t).exp().round(h);return F.popDefaultContext(),c},F.prototype.square=function(){return this.mul(this)},F.prototype.sqrt=function(){if(this.isZero())return F.ZERO;if(this.isNaN())return F.NaN;if(this.isNegative())return F.NaN;if(this.isInfinite())return F.POSITIVE_INFINITY;if(this.isZero())return F.ZERO;var t=F.getDefaultContext();F.pushDefaultContext(F.getDefaultContext().increasePrecision());var e=this.rsqrt().inv().round(t);return F.popDefaultContext(),e},F.prototype.cbrt=function(){if(this.isZero())return F.ZERO;if(this.isNaN())return F.NaN;if(this.isInfinite())return this;var t,e=-this.scale()+(this.precision()-1)+1,r=this.sign(),n=this.abs();if(e<30){var i=F.getDefaultContext();F.pushDefaultContext(F.getDefaultContext().increasePrecision()),t=n.log().div(3).exp().round(i),F.popDefaultContext()}else{for(var o=1===n.compareTo(F.ONE)?n:F.ONE,a=0;a<1e3;a++){var u=o.mul(o),s=o.mul(2).add(n.div(u)).div(3);if(s.sub(o).isZero())break;o=s}t=o}return 1===r?t:t.negate()},F.prototype.rsqrt=function(){if(this.isZero())return F.POSITIVE_INFINITY;if(this.isNaN())return F.NaN;if(this.isInfinite())return F.ZERO;if(this.isNegative())return F.NaN;var t=F.create(1),e=F.create(5),r=F.create(6),n=F.create(8),i=F.create(16).inv(),o=this.inv();if(o.isZero())throw"ArithmeticException";for(var a=o,u=0;u<50;u++){var s=t.sub(this.mul(a.square()));if(s.isZero())break;a=a.mul(t.add(s.mul(n.add(s.mul(r.add(e.mul(s))))).mul(i)))}return a},F.prototype.log=function(){if(this.isZero())return F.NEGATIVE_INFINITY;if(this.isNaN())return F.NaN;if(this.isNegative())return F.NaN;if(this.isInfinite())return F.POSITIVE_INFINITY;if(this.isOne())return F.ZERO;var t=F.getDefaultContext(),e=-this.scale()+(this.precision()-1)+1;F.pushDefaultContext(new I(t.getPrecision()+e,d.HALF_UP));var r=this,n=0,i=F.E,o=r.compareTo(i);if(0===o)return F.popDefaultContext(),F.ONE;if(0<o)for(;n<300&&!(r.compareTo(i)<=0);n++)r=r.div(i);else{var a=new F(1);if(r.compareTo(a)<0)for(;-300<n&&!(0<r.compareTo(a));n--)r=r.mul(i)}F.popDefaultContext();for(var u=(r=r.round(F.getDefaultContext())).sub(F.ONE).div(r.add(F.ONE)),s=u.mul(u),h=u,c=u,l=F.ONE,f=0;f<300;f++){l=l.add(F.TWO),h=h.mul(s);var g=c.add(h.div(l)),p=g.sub(c);if(c=g,p.isZero())break}return(r=c.mul(F.TWO)).add(n)},F.prototype.exp=function(){if(this.isZero())return F.ONE;if(this.isNaN())return F.NaN;if(this.isNegativeInfinity())return F.ZERO;if(this.isPositiveInfinity())return F.POSITIVE_INFINITY;var t=this.isNegative(),e=this;t&&(e=e.negate());var r=-e.scale()+(e.precision()-1)+1,n=F.getDefaultContext();F.pushDefaultContext(new I(n.getPrecision()+r,d.HALF_UP));var i=0,o=1,a=e.doubleValue;10<=a&&(i=Math.floor(Math.log(Math.floor(a))/Math.log(10)),o=Math.pow(10,i));for(var u,s=e.div(o,n),h=s,c=F.ONE.add(s),l=F.ONE,f=2;f<300;f++){l=l.mul(f),h=h.mul(s);var g=c.add(h.div(l)),p=g.sub(c);if(c=g,p.isZero())break}return u=(u=c).pow(o),F.popDefaultContext(),u=u.round(F.getDefaultContext()),t?u.inv():u},F.prototype.expm1=function(){return this.exp().sub(1)},F.prototype.log1p=function(){return this.add(1).log()},F.prototype.log2=function(){return this.log().div(F.LN2)},F.prototype.log10=function(){return this.log().div(F.LN10)},F.prototype.sin=function(){if(!this.isFinite())return F.NaN;var t=-this.scale()+(this.precision()-1)+1,e=new I(F.getDefaultContext().getPrecision()+t,d.HALF_UP);F.pushDefaultContext(e);var r=this.mod(F.TWO_PI);F.popDefaultContext();for(var n=r,i=r.mul(r),o=r,a=F.ONE,u=-1,s=2;s<300;s++)if(a=a.mul(s),s%2==1){o=o.mul(i);var h=void 0;u=u<0?(h=n.sub(o.div(a)),1):(h=n.add(o.div(a)),-1);var c=h.sub(n);if(n=h,c.isZero())break}return n},F.prototype.cos=function(){if(!this.isFinite())return F.NaN;var t=-this.scale()+(this.precision()-1)+1,e=new I(F.getDefaultContext().getPrecision()+t,d.HALF_UP);F.pushDefaultContext(e);var r=this.mod(F.TWO_PI);F.popDefaultContext();for(var n=F.ONE,i=F.ONE,o=r.mul(r),a=F.ONE,u=-1,s=2;s<300;s++)if(a=a.mul(s),s%2==0){i=i.mul(o);var h=void 0;u=u<0?(h=n.sub(i.div(a)),1):(h=n.add(i.div(a)),-1);var c=h.sub(n);if(n=h,c.isZero())break}return n},F.prototype.tan=function(){return this.isFinite()?this.sin().div(this.cos()):F.NaN},F.prototype.atan=function(){if(!this.isFinite())return this.isNaN()?F.NaN:this.isPositiveInfinity()?F.HALF_PI:F.HALF_PI.negate();if(this.isZero())return F.ZERO;if(0===this.compareTo(F.ONE))return F.QUARTER_PI;if(0===this.compareTo(F.MINUS_ONE))return F.QUARTER_PI.negate();var t,e=this.sign(),r=this.abs();1===r.compareTo(F.TWO)?(t=1,r=r.inv()):1===r.compareTo(F.HALF)?(t=2,r=F.ONE.sub(r).div(F.ONE.add(r))):t=3;for(var n=r,i=r.mul(r),o=r,a=F.ONE,u=-1,s=0;s<300;s++){o=o.mul(i),a=a.add(F.TWO);var h=void 0;u=u<0?(h=n.sub(o.div(a)),1):(h=n.add(o.div(a)),-1);var c=h.sub(n);if(n=h,c.isZero())break}return 1===t?n=F.HALF_PI.sub(n):2===t&&(n=F.QUARTER_PI.sub(n)),e<0&&(n=n.negate()),n},F.prototype.atan2=function(t,e){var r,n=F.getDefaultContext(),i=this.round(e),o=new F([t,e]);if(o.isNaN()||i.isNaN())return F.NaN;if(o.isPositive())r=i.div(o).atan();else if(i.isNotNegative()&&o.isNegative())r=i.div(o).atan().add(F.PI);else if(i.isNegative()&&o.isNegative())r=i.div(o).atan().sub(F.PI);else if(i.isPositive())r=F.HALF_PI;else{if(!i.isNegative())throw"ArithmeticException";r=F.HALF_PI.negate()}return F.setDefaultContext(n),r},F.prototype.asin=function(){var t=this.square().negate().add(1).sqrt(),e=t.square().add(this.square()).sqrt(),r=this.atan2(t);return e.log().add(r)},F.prototype.acos=function(){var t=this.square().negate().add(1).sqrt(),e=this.square().add(t.square()).sqrt(),r=t.atan2(this);return e.log().add(r)},F.prototype.sinh=function(){if(this.isInfinite())return this;var t=this.exp();return t.sub(t.inv()).mul(.5)},F.prototype.asinh=function(){return this.isInfinite()?this:this.add(this.mul(this).add(1).sqrt()).log()},F.prototype.cosh=function(){return this.isInfinite()?F.POSITIVE_INFINITY:this.exp().add(this.negate().exp()).mul(.5)},F.prototype.acosh=function(){return this.isInfinite()?F.NaN:this.add(this.mul(this).sub(1).sqrt()).log()},F.prototype.tanh=function(){if(this.isInfinite())return F.create(this.sign());var t=this.mul(2).exp();return t.sub(1).div(t.add(1))},F.prototype.atanh=function(){return this.add(1).div(this.negate().add(1)).log().mul(.5)},F.prototype.sec=function(){return this.cos().inv()},F.prototype.asec=function(){return this.inv().acos()},F.prototype.sech=function(){return this.isNegativeInfinity()?F.ZERO:this.exp().add(this.negate().exp()).inv().mul(2)},F.prototype.asech=function(){return this.inv().add(this.square().inv().sub(1).sqrt()).log()},F.prototype.cot=function(){return this.isZero()?F.POSITIVE_INFINITY:this.tan().inv()},F.prototype.acot=function(){return this.isZero()?F.HALF_PI:this.inv().atan()},F.prototype.coth=function(){if(this.isInfinite())return F.create(this.sign());var t=this.mul(2).exp();return t.add(1).div(t.sub(1))},F.prototype.acoth=function(){return this.isInfinite()?F.ZERO:this.add(1).div(this.sub(1)).log().mul(.5)},F.prototype.csc=function(){return this.isZero()?F.POSITIVE_INFINITY:this.sin().inv()},F.prototype.acsc=function(){return this.inv().asin()},F.prototype.csch=function(){return this.isInfinite()?F.ZERO:this.isZero()?F.POSITIVE_INFINITY:this.exp().sub(this.negate().exp()).inv().mul(2)},F.prototype.acsch=function(){return this.isZero()?F.POSITIVE_INFINITY:this.inv().add(this.square().inv().add(1).sqrt()).log()},F.prototype.sinc=function(){if(this.isZero())return F.ONE;var t=F.PI.mul(this);return t.sin().div(t)},F.rand=function(t){var e=F.getDefaultContext().getPrecision();e<=0&&(e=100);var r=Math.ceil(e*Math.log(10)/Math.log(2)),n=w.ONE.shiftLeft(r),i=w.createRandomBigInteger(r,t);return new F(i).div(n)},F.randn=function(t){var e=F.rand(t).log().mul(-2).sqrt(),r=F.rand(t).mul(2).mul(F.PI);return e.mul(r.sin())},F.prototype.isInteger=function(t){return!!this.isFinite()&&this.sub(this.fix()).isZero(t)},F.prototype.isZero=function(t){return!!this.isFinite()&&(t?this.equals(F.ZERO,t):this.integer.isZero())},F.prototype.isOne=function(t){return!!this.isFinite()&&0===this.compareTo(F.ONE,t)},F.prototype.isPositive=function(){return this.integer.isPositive()},F.prototype.isNegative=function(){return this.integer.isNegative()},F.prototype.isNotNegative=function(){return this.integer.isNotNegative()},F.prototype.isNaN=function(){return this.integer.isNaN()},F.prototype.isPositiveInfinity=function(){return this.integer.isPositiveInfinity()},F.prototype.isNegativeInfinity=function(){return this.integer.isNegativeInfinity()},F.prototype.isInfinite=function(){return this.integer.isInfinite()},F.prototype.isFinite=function(){return this.integer.isFinite()},F.prototype.and=function(t){var e=F._toBigDecimal(t),r=this.round().toBigInteger(),n=e.round().toBigInteger();return new F(r.and(n))},F.prototype.or=function(t){var e=F._toBigDecimal(t),r=this.round().toBigInteger(),n=e.round().toBigInteger();return new F(r.or(n))},F.prototype.xor=function(t){var e=F._toBigDecimal(t),r=this.round().toBigInteger(),n=e.round().toBigInteger();return new F(r.xor(n))},F.prototype.not=function(){var t=this.round().toBigInteger();return new F(t.not())},F.prototype.shift=function(t){var e=this.round().toBigInteger(),r=F._toInteger(t);return new F(e.shift(r))},F.prototype.gcd=function(t){var e=this.round().toBigInteger(),r=F._toBigDecimal(t).toBigInteger(),n=e.gcd(r);return new F(n)},F.prototype.extgcd=function(t){var e=this.round().toBigInteger(),r=F._toBigDecimal(t).toBigInteger(),n=e.extgcd(r);return[new F(n[0]),new F(n[1]),new F(n[2])]},F.prototype.lcm=function(t){var e=this.round().toBigInteger(),r=F._toBigDecimal(t).toBigInteger(),n=e.lcm(r);return new F(n)},F.prototype.modPow=function(t,e){var r=this.round().toBigInteger(),n=F._toBigDecimal(t).toBigInteger(),i=F._toBigDecimal(e).toBigInteger(),o=r.modPow(n,i);return new F(o)},F.prototype.modInverse=function(t){var e=this.round().toBigInteger(),r=F._toBigDecimal(t).toBigInteger(),n=e.modInverse(r);return new F(n)},F.prototype.isPrime=function(){return this.round().toBigInteger().isPrime()},F.prototype.isProbablePrime=function(t){return this.round().toBigInteger().isProbablePrime(void 0!==t?F._toInteger(t):void 0)},F.prototype.nextProbablePrime=function(t,e){var r=this.round().toBigInteger(),n=void 0!==t?F._toInteger(t):void 0,i=void 0!==e?F._toInteger(e):void 0;return F.create(r.nextProbablePrime(n,i))},D.MINUS_ONE.get=function(){return R.MINUS_ONE.get()},D.ZERO.get=function(){return R.ZERO.get()},D.HALF.get=function(){return R.HALF.get()},D.ONE.get=function(){return R.ONE.get()},D.TWO.get=function(){return R.TWO.get()},D.TEN.get=function(){return R.TEN.get()},D.PI.get=function(){return R.PI.get()},D.QUARTER_PI.get=function(){return R.QUARTER_PI.get()},D.HALF_PI.get=function(){return R.HALF_PI.get()},D.TWO_PI.get=function(){return R.TWO_PI.get()},D.E.get=function(){return R.E.get()},D.LN2.get=function(){return R.LN2.get()},D.LN10.get=function(){return R.LN10.get()},D.LOG2E.get=function(){return R.LOG2E.get()},D.LOG10E.get=function(){return R.LOG10E.get()},D.SQRT2.get=function(){return R.SQRT2.get()},D.SQRT1_2.get=function(){return R.SQRT1_2.get()},D.POSITIVE_INFINITY.get=function(){return S.POSITIVE_INFINITY},D.NEGATIVE_INFINITY.get=function(){return S.NEGATIVE_INFINITY},D.NaN.get=function(){return S.NaN},F.prototype.signum=function(){return this.sign()},F.prototype.subtract=function(t){return this.sub(t)},F.prototype.multiply=function(t){return this.mul(t)},F.prototype.divide=function(t,e){return this.div(t,e)},F.prototype.remainder=function(t){return this.rem(t)},F.prototype.trunc=function(){return this.fix()},Object.defineProperties(F.prototype,P),Object.defineProperties(F,D),F.RoundingMode=d,F.MathContext=I;function A(t,e){this.method_name=t,this.table=[],this.table_max=e}var S={MINUS_ONE:function(){return new F(-1)},ZERO:function(){return new F(0)},HALF:function(){return new F(.5)},ONE:function(){return new F(1)},TWO:function(){return new F(2)},TEN:function(){return new F(10)},PI:function(){var t=F.getDefaultContext();if(t.getPrecision()<=78)return new F("3.1415926535897932384626433832795028841971693993751058209749445923078164062862").round(t);for(var e=F.create(1),r=F.create(2),n=F.create(4),i=e,o=r.sqrt().inv(),a=n.inv(),u=e,s=e,h=0;h<10;h++){var c=i.add(o).div(r),l=i.mul(o).sqrt(),f=a.sub(u.mul(i.sub(c).square())),g=u.mul(r),p=c.add(l).square().div(f.mul(n)),m=p.sub(s);if(s=p,m.isZero())break;i=c,o=l,a=f,u=g}return s},QUARTER_PI:function(){return S.PI().div(4)},HALF_PI:function(){return S.PI().div(2)},TWO_PI:function(){return S.PI().mul(2)},E:function(){var t=F.getDefaultContext();if(t.getPrecision()<=83)return new F("2.71828182845904523536028747135266249775724709369995957496696762772407663035354759").round(t);for(var e=F.create(2),r=F.create(1),n=2;n<300;n++){r=r.mul(n);var i=e.add(r.inv()),o=i.sub(e);if(e=i,o.isZero())break}return e},LN2:function(){return new F(2).log()},LN10:function(){return new F(10).log()},LOG2E:function(){return new F(2).log().inv()},LOG10E:function(){return new F(10).log().inv()},SQRT2:function(){return new F(2).sqrt()},SQRT1_2:function(){return new F(.5).sqrt()},POSITIVE_INFINITY:new F(Number.POSITIVE_INFINITY),NEGATIVE_INFINITY:new F(Number.NEGATIVE_INFINITY),NaN:new F(Number.NaN)};A.prototype.get=function(){for(var t=F.getDefaultContext().toString(),e=0;e<this.table.length;e++)if(this.table[e].name===t){var r=this.table.splice(e,1)[0];return this.table.unshift(r),r.number}var n=S[this.method_name]();return this.table.length===this.table_max&&this.table.pop(),this.table.unshift({name:t,number:n}),n};function V(){}var R=new function(){this.MINUS_ONE=new A("MINUS_ONE",10),this.ZERO=new A("ZERO",10),this.HALF=new A("HALF",10),this.ONE=new A("ONE",10),this.TWO=new A("TWO",10),this.TEN=new A("TEN",10),this.PI=new A("PI",10),this.QUARTER_PI=new A("QUARTER_PI",10),this.HALF_PI=new A("HALF_PI",10),this.TWO_PI=new A("TWO_PI",10),this.E=new A("E",10),this.LN2=new A("LN2",10),this.LN10=new A("LN10",10),this.LOG2E=new A("LOG2E",10),this.LOG10E=new A("LOG10E",10),this.SQRT2=new A("SQRT2",10),this.SQRT1_2=new A("SQRT1_2",10)};V.to_fraction_data_from_number_string=function(t){var e,r=0,n=!1,i=t.replace(/\s/g,"").toLowerCase(),o=[];if(null!==(e=i.match(/^[+-]+/))&&(e=e[0],i=i.substr(e.length),-1!==e.indexOf("-")&&(n=!0,o.push("-"))),null!==(e=i.match(/^[0-9]+/))&&(e=e[0],i=i.substr(e.length),o.push(e)),0===i.length)return new C([new w([o.join(""),10]),w.ONE]);var a=null;if(/[()'"[\]]/.test(i)){var u=i.match(/([^.]*)\.(\d*)[(['"](\d+)[)\]'"](.*)/);if(null===u)throw"Fraction Unsupported argument "+i;var s=u[2].length,h=u[3];i=0===s?u[1]+u[4]:u[1]+"."+u[2]+u[4];for(var c=new w([h,10]),l=[],f=0;f<h.length;f++)l.push("9");var g=new w([l.join(""),10]);a=(a=new C([c,g])).scaleByPowerOfTen(-s)}null!==(e=i.match(/^\.[0-9]+/))&&(e=e[0],i=i.substr(e.length),r+=(e=e.substr(1)).length,o.push(e)),null!==(e=i.match(/^e[+-]?[0-9]+/))&&(e=e[0].substr(1),r-=parseInt(e,10));var p=null,m=null,_=null;if(0===r&&(m=new w([o.join(""),10]),_=w.ONE),r<0){for(var v=0;v<-r;v++)o.push("0");m=new w([o.join(""),10]),_=w.ONE}else if(0<r){m=new w([o.join(""),10]);for(var N=["1"],d=0;d<r;d++)N.push("0");_=new w([N.join(""),10])}return p=new C([m,_]),a&&(p=n?p.sub(a):p.add(a)),p},V.to_fraction_data_from_fraction_string=function(t){if(/nan|inf/i.test(t)){var e=new C;return e.denominator=w.ONE,/nan/i.test(t)?e.numerator=w.NaN:/-/.test(t)?e.numerator=w.NEGATIVE_INFINITY:e.numerator=w.POSITIVE_INFINITY,e}if(-1===t.indexOf("/"))return V.to_fraction_data_from_number_string(t);var r=t.split("/"),n=V.to_fraction_data_from_number_string(r[0]),i=V.to_fraction_data_from_number_string(r[1]);return n.div(i)},V.to_fraction_data_from_number=function(t){var e="boolean"!=typeof t?t:t?1:0,r=null,n=null;if(!isFinite(e)){var i=new C;return i.denominator=w.ONE,i.numerator=e===1/0?w.POSITIVE_INFINITY:e===-1/0?w.NEGATIVE_INFINITY:w.NaN,i}if(e===Math.floor(e))r=new w(e),n=w.ONE;else{var o=Math.trunc(Math.log(Math.abs(e))/Math.log(10)),a=e/Math.pow(10,o);o=-o;for(var u=0;u<14&&(a*=10,o+=1,!(Math.abs(a-Math.round(a))<=Number.EPSILON));u++);if(a=Math.round(1e14*a)/1e14,o<=0)r=new w(e),n=w.ONE;else{r=new w(a);for(var s=["1"],h=0;h<o;h++)s.push("0");n=new w([s.join(""),10])}}return new C([r,n])},V.normalization=function(t){if(!t.denominator.equals(w.ONE)){if(t.denominator.equals(w.MINUS_ONE))return t.numerator=t.numerator.negate(),void(t.denominator=w.ONE);if(t.numerator.equals(w.ZERO))t.denominator=w.ONE;else{var e=t.numerator.gcd(t.denominator),r=t.numerator.div(e),n=t.denominator.div(e);n.sign()<0&&(r=r.negate(),n=n.negate()),t.numerator=r,t.denominator=n}}};var C=function t(e){if(this.numerator=null,this.denominator=null,0===arguments.length)this.numerator=w.ZERO,this.denominator=w.ONE;else{if(1!==arguments.length)throw"Fraction Unsupported argument "+e;var r=!1;if("number"==typeof e||"boolean"==typeof e){var n=V.to_fraction_data_from_number(e);this.numerator=n.numerator,this.denominator=n.denominator}else if("string"==typeof e){var i=V.to_fraction_data_from_fraction_string(e);this.numerator=i.numerator,this.denominator=i.denominator}else if(e instanceof w)this.numerator=e,this.denominator=w.ONE;else if(e instanceof t)this.numerator=e.numerator,this.denominator=e.denominator;else if(e instanceof Array&&2===e.length)this.numerator=e[0]instanceof w?e[0]:new w(e[0]),this.denominator=e[1]instanceof w?e[1]:new w(e[1]),r=!0;else if(e instanceof F){var o=e.unscaledValue();if(o.isFinite()){var a=new t(e.unscaledValue()).scaleByPowerOfTen(-e.scale());this.numerator=a.numerator,this.denominator=a.denominator}else this.numerator=o,this.denominator=w.ONE}else{if("object"!=typeof e)throw"Fraction Unsupported argument "+e;if("doubleValue"in e){var u=V.to_fraction_data_from_number(e.doubleValue);this.numerator=u.numerator,this.denominator=u.denominator}else if("numerator"in e&&"denominator"in e)this.numerator=e.numerator instanceof w?e.numerator:new w(e.numerator),this.denominator=e.denominator instanceof w?e.denominator:new w(e.denominator),r=!0;else{var s=V.to_fraction_data_from_fraction_string(e.toString());this.numerator=s.numerator,this.denominator=s.denominator}}r&&V.normalization(this)}},Z={booleanValue:{configurable:!0},intValue:{configurable:!0},doubleValue:{configurable:!0}},L={MINUS_ONE:{configurable:!0},ZERO:{configurable:!0},HALF:{configurable:!0},ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};C.create=function(t){return t instanceof C?t:new C(t)},C.valueOf=function(t){return C.create(t)},C._toFraction=function(t){return t instanceof C?t:new C(t)},C._toFloat=function(t){return"number"==typeof t?t:t instanceof C?t.doubleValue:new C(t).doubleValue},C._toInteger=function(t){return"number"==typeof t?Math.trunc(t):t instanceof C?t.intValue:new C(t).intValue},C.prototype.clone=function(){return new C(this)},C.prototype.abs=function(){return this.isFinite()?0<=this.sign()?this:this.negate():this.isNegativeInfinity()?C.POSITIVE_INFINITY:this},C.prototype.negate=function(){return this.isFinite()?new C([this.numerator.negate(),this.denominator]):this.isPositiveInfinity()?C.NEGATIVE_INFINITY:this.isNegativeInfinity()?C.POSITIVE_INFINITY:this},C.prototype.sign=function(){return this.isFinite()?this.numerator.sign():this.isNaN()?NaN:this.isPositiveInfinity()?1:-1},C.prototype.toString=function(){return this.isFinite()?this.numerator.toString()+" / "+this.denominator.toString():this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity"},C.prototype.add=function(t){var e=this,r=C._toFraction(t);return e.isFinite()&&r.isFinite()?e.isInteger()&&r.isInteger()?new C([e.numerator.add(r.numerator),w.ONE]):new C([e.numerator.mul(r.denominator).add(r.numerator.mul(e.denominator)),e.denominator.mul(r.denominator)]):e.isNaN()||r.isNaN()||e.isInfinite()&&r.isInfinite()&&!e.equalsState(r)?C.NaN:e.isPositiveInfinity()||r.isPositiveInfinity()?C.POSITIVE_INFINITY:C.NEGATIVE_INFINITY},C.prototype.sub=function(t){var e=this,r=C._toFraction(t);return e.isFinite()&&r.isFinite()?e.isInteger()&&r.isInteger()?new C([e.numerator.sub(r.numerator),w.ONE]):new C([e.numerator.mul(r.denominator).sub(r.numerator.mul(e.denominator)),e.denominator.mul(r.denominator)]):e.isNaN()||r.isNaN()||e.equalsState(r)?C.NaN:e.isNegativeInfinity()||r.isPositiveInfinity()?C.NEGATIVE_INFINITY:C.POSITIVE_INFINITY},C.prototype.mul=function(t){var e=this,r=C._toFraction(t);return e.isFinite()&&r.isFinite()?e.isInteger()&&r.isInteger()?new C([e.numerator.mul(r.numerator),w.ONE]):new C([e.numerator.mul(r.numerator),e.denominator.mul(r.denominator)]):e.isNaN()||r.isNaN()||e.isZero()||r.isZero()?C.NaN:0<e.sign()*r.sign()?C.POSITIVE_INFINITY:C.NEGATIVE_INFINITY},C.prototype.div=function(t){var e=this,r=C._toFraction(t);return e.isFinite()&&r.isFinite()?r.isZero()?e.isZero()?C.NaN:0<=e.sign()?C.POSITIVE_INFINITY:C.NEGATIVE_INFINITY:e.isInteger()&&r.isInteger()?new C([e.numerator,r.numerator]):new C([e.numerator.mul(r.denominator),r.numerator.mul(e.denominator)]):e.isNaN()||r.isNaN()||e.isInfinite()&&r.isInfinite()?C.NaN:e.isInfinite()?0<=e.sign()*r.sign()?C.POSITIVE_INFINITY:C.NEGATIVE_INFINITY:C.ZERO},C.prototype.inv=function(){return this.isFinite()?this.isZero()?C.NaN:new C([this.denominator,this.numerator]):this.isNaN()?C.NaN:C.ZERO},C.prototype.rem=function(t){var e=C._toFraction(t);return this.isFinite()&&e.isFinite()&&!e.isZero()?this.sub(e.mul(this.div(e).fix())):C.NaN},C.prototype.mod=function(t){var e=C._toFraction(t);if(e.isZero())return this;var r=this.rem(e);return this.equalsState(e)?r:r.add(e)},C.prototype.pow=function(t){var e=this,r=C._toFraction(t);if(e.isNaN()||r.isNaN())return C.NaN;if(r.isZero())return C.ONE;if(e.isZero())return C.ZERO;if(e.isOne())return C.ONE;if(e.isInfinite())return e.isPositiveInfinity()?C.POSITIVE_INFINITY:r.isPositiveInfinity()?C.NaN:new C(1/0*Math.pow(-1,Math.round(r.doubleValue)));if(r.isInfinite()){if(e.isNegative())return C.NaN;if(e.compareTo(C.ONE)<0){if(r.isPositiveInfinity())return C.ZERO;if(r.isNegativeInfinity())return C.POSITIVE_INFINITY}else{if(r.isPositiveInfinity())return C.POSITIVE_INFINITY;if(r.isNegativeInfinity())return C.ZERO}}var n=e.numerator.pow(r.intValue),i=e.denominator.pow(r.intValue);return new C([n,i])},C.prototype.factorial=function(){return this.isFinite()?new C([this.toBigInteger().factorial(),C.ONE]):this},C.prototype.scaleByPowerOfTen=function(t){if(!this.isFinite())return this;var e,r=C._toInteger(t);return 0===r?this:(0<r?e=new C([this.numerator.scaleByPowerOfTen(r),this.denominator]):r<0&&(e=new C([this.numerator,this.denominator.scaleByPowerOfTen(-r)])),e)},Z.booleanValue.get=function(){return this.numerator.booleanValue},Z.intValue.get=function(){return this.isFinite()?this.isInteger()?Math.trunc(this.numerator.doubleValue):Math.trunc(this.doubleValue):this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0},Z.doubleValue.get=function(){if(!this.isFinite())return this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0;if(this.isInteger())return this.numerator.doubleValue;var t=new F([this.numerator,I.UNLIMITED]),e=new F([this.denominator,I.UNLIMITED]);return t.div(e,{context:I.DECIMAL64}).doubleValue},C.prototype.toBigInteger=function(){return new w(this.fix().numerator)},C.prototype.toBigDecimal=function(t){if(!this.isFinite())return new F(this.doubleValue);if(this.isInteger())return new F(this.numerator);var e=new F([this.numerator,I.UNLIMITED]),r=new F([this.denominator,I.UNLIMITED]);return t?e.div(r,{context:t}):e.div(r,{context:F.getDefaultContext()})},C.prototype.equals=function(t){var e=this,r=C._toFraction(t);return e.isFinite()&&r.isFinite()?e.numerator.equals(r.numerator)&&e.denominator.equals(r.denominator):!e.isNaN()&&!r.isNaN()&&!!e.equalsState(r)},C.prototype.equalsState=function(t){var e=C._toFraction(t);return this.numerator.equalsState(e.numerator)},C.prototype.compareTo=function(t){var e=C._toFraction(t);return this.isFinite()&&e.isFinite()?this.sub(e).sign():this.numerator.compareTo(e.numerator)},C.prototype.max=function(t){var e=C._toFraction(t);return this.isNaN()||e.isNaN()?C.NaN:0<=this.compareTo(e)?this:e},C.prototype.min=function(t){var e=C._toFraction(t);return this.isNaN()||e.isNaN()?C.NaN:0<=this.compareTo(e)?e:this},C.prototype.clip=function(t,e){var r=C._toFraction(t),n=C._toFraction(e);if(this.isNaN()||r.isNaN()||n.isNaN())return C.NaN;var i=r.compareTo(n);if(1===i)throw"clip(min, max) error. (min > max)->("+r+" > "+n+")";return 0===i?r:1===this.compareTo(n)?n:-1===this.compareTo(r)?r:this},C.prototype.floor=function(){if(this.isInteger()||!this.isFinite())return this;var t=this.fix();return 0<this.sign()?t:new C([t.numerator.sub(w.ONE),C.ONE])},C.prototype.ceil=function(){if(this.isInteger()||!this.isFinite())return this;var t=this.fix();return 0<this.sign()?new C([t.numerator.add(w.ONE),C.ONE]):t},C.prototype.round=function(){if(this.isInteger()||!this.isFinite())return this;var t=this.floor();return 0<=this.sub(t).compareTo(C.HALF)?new C([t.numerator.add(w.ONE),C.ONE]):t},C.prototype.fix=function(){return this.isInteger()||!this.isFinite()?this:new C([this.numerator.div(this.denominator),C.ONE])},C.prototype.fract=function(){return this.isFinite()?this.isInteger()?C.ZERO:this.sub(this.floor()):C.NaN},C.prototype.isInteger=function(){return!!this.isFinite()&&this.denominator.equals(w.ONE)},C.prototype.isZero=function(){return!!this.isFinite()&&this.numerator.isZero()},C.prototype.isOne=function(){return!!this.isFinite()&&(this.numerator.equals(w.ONE)&&this.denominator.equals(w.ONE))},C.prototype.isPositive=function(){return this.numerator.isPositive()},C.prototype.isNegative=function(){return this.numerator.isNegative()},C.prototype.isNotNegative=function(){return this.numerator.isNotNegative()},C.prototype.isNaN=function(){return this.numerator.isNaN()},C.prototype.isPositiveInfinity=function(){return this.numerator.isPositiveInfinity()},C.prototype.isNegativeInfinity=function(){return this.numerator.isNegativeInfinity()},C.prototype.isInfinite=function(){return this.numerator.isInfinite()},C.prototype.isFinite=function(){return this.numerator.isFinite()},C.prototype.and=function(t){var e=C._toFraction(t),r=this.round().toBigInteger(),n=e.round().toBigInteger();return new C(r.and(n))},C.prototype.or=function(t){var e=C._toFraction(t),r=this.round().toBigInteger(),n=e.round().toBigInteger();return new C(r.or(n))},C.prototype.xor=function(t){var e=C._toFraction(t),r=this.round().toBigInteger(),n=e.round().toBigInteger();return new C(r.xor(n))},C.prototype.not=function(){var t=this.round().toBigInteger();return new C(t.not())},C.prototype.shift=function(t){var e=this.round().toBigInteger(),r=F._toInteger(t);return new C(e.shift(r))},C.prototype.gcd=function(t){var e=this.round().toBigInteger(),r=C._toFraction(t).toBigInteger(),n=e.gcd(r);return new C(n)},C.prototype.extgcd=function(t){var e=this.round().toBigInteger(),r=C._toFraction(t).toBigInteger(),n=e.extgcd(r);return[new C(n[0]),new C(n[1]),new C(n[2])]},C.prototype.lcm=function(t){var e=this.round().toBigInteger(),r=C._toFraction(t).toBigInteger(),n=e.lcm(r);return new C(n)},C.prototype.modPow=function(t,e){var r=this.round().toBigInteger(),n=C._toFraction(t).toBigInteger(),i=C._toFraction(e).toBigInteger(),o=r.modPow(n,i);return new C(o)},C.prototype.modInverse=function(t){var e=this.round().toBigInteger(),r=C._toFraction(t).toBigInteger(),n=e.modInverse(r);return new C(n)},C.prototype.isPrime=function(){return this.round().toBigInteger().isPrime()},C.prototype.isProbablePrime=function(t){return this.round().toBigInteger().isProbablePrime(void 0!==t?F._toInteger(t):void 0)},C.prototype.nextProbablePrime=function(t,e){var r=this.round().toBigInteger(),n=void 0!==t?C._toInteger(t):void 0,i=void 0!==e?C._toInteger(e):void 0;return new C(r.nextProbablePrime(n,i))},L.MINUS_ONE.get=function(){return q.MINUS_ONE},L.ZERO.get=function(){return q.ZERO},L.HALF.get=function(){return q.HALF},L.ONE.get=function(){return q.ONE},L.TWO.get=function(){return q.TWO},L.TEN.get=function(){return q.TEN},L.POSITIVE_INFINITY.get=function(){return q.POSITIVE_INFINITY},L.NEGATIVE_INFINITY.get=function(){return q.NEGATIVE_INFINITY},L.NaN.get=function(){return q.NaN},C.prototype.signum=function(){return this.sign()},C.prototype.subtract=function(t){return this.sub(t)},C.prototype.multiply=function(t){return this.mul(t)},C.prototype.divide=function(t){return this.div(t)},C.prototype.remainder=function(t){return this.rem(t)},Object.defineProperties(C.prototype,Z),Object.defineProperties(C,L);function B(){}var q={MINUS_ONE:new C([w.MINUS_ONE,w.ONE]),ZERO:new C([w.ZERO,w.ONE]),ONE:new C([w.ONE,w.ONE]),HALF:new C([w.ONE,w.TWO]),TWO:new C([w.TWO,w.ONE]),TEN:new C([w.TEN,w.ONE]),POSITIVE_INFINITY:new C(Number.POSITIVE_INFINITY),NEGATIVE_INFINITY:new C(Number.NEGATIVE_INFINITY),NaN:new C(Number.NaN)};B.tridiagonalize=function(t){for(var e=X._toMatrix(t).getNumberMatrixArray(),c=function(t,e,r,n){for(var i=0,o=r||0,a=n||t.length,u=o;u<a;u++)i+=t[u]*e[u];return i},r=function(t,e,r){var n=e||0,i=r||t.length,o=Math.sqrt(c(t,t,n,i)),a=[];if(1e-10<=Math.abs(o)){var u;t[n]<0&&(o=-o);for(var s=n,h=0;s<i;s++,h++)s===n?(a[h]=t[s]+o,u=1/Math.sqrt(a[h]*o),a[h]=a[h]*u):a[h]=t[s]*u}return{y1:-o,v:a}},n=e.length,i=[],o=[],a=0;a<n-2;a++){var u=e[a];i[a]=u[a];var s=r(u,a+1,n);o[a]=s.y1;for(var h=0;h<s.v.length;h++)u[a+1+h]=s.v[h];if(!(Math.abs(o[a])<1e-10)){for(var l=a+1;l<n;l++){for(var f=0,g=a+1;g<l;g++)f+=e[g][l]*u[g];for(var p=l;p<n;p++)f+=e[l][p]*u[p];i[l]=f}for(var m=c(u,i,a+1,n)/2,_=n-1;a<_;_--){var v=u[_],N=i[_]-m*v;i[_]=N;for(var d=_;d<n;d++){var I=v*i[d]+N*u[d];e[_][d]=e[_][d]-I}}}}2<=n&&(i[n-2]=e[n-2][n-2],o[n-2]=e[n-2][n-1]),1<=n&&(i[n-1]=e[n-1][n-1]);for(var y=n-1;0<=y;y--){var w=e[y];if(y<n-2)for(var b=y+1;b<n;b++)for(var E=e[b],x=c(w,E,y+1,n),M=y+1;M<n;M++)E[M]-=x*w[M];for(var T=0;T<n;T++)w[T]=0;w[y]=1}var O=X.createMatrixDoEachCalculation(function(t,e){return t===e?new rt(i[t]):1===Math.abs(t-e)?new rt(o[Math.trunc(.5*(t+e))]):rt.ZERO},n,n);return{P:new X(e).T(),H:O}},B.eig=function(t){for(var e=X._toMatrix(t),r=!1,n=B.tridiagonalize(e),i=n.P.getNumberMatrixArray(),o=n.H.getNumberMatrixArray(),a=e.row_length,u=[],s=[],h=0;h<a;h++)u[h]=o[h][h],s[h]=0===h?0:o[h][h-1];for(var c=a-1;0<c;c--){var l=c;for(l=c;1<=l&&!(Math.abs(s[l])<=1e-10*(Math.abs(u[l-1])+Math.abs(u[l])));l--);if(l!=c){for(var f=0;;){if(100<++f){r=!0;break}var g=(u[c-1]-u[c])/2,p=s[c]*s[c],m=Math.sqrt(g*g+p);g<0&&(m=-m);for(var _=u[l]-u[c]+p/(g+m),v=s[l+1],N=l;N<c;N++){var d=void 0,I=void 0;Math.abs(_)>=Math.abs(v)?I=(p=-v/_)*(d=1/Math.sqrt(p*p+1)):d=(p=-_/v)*(I=1/Math.sqrt(p*p+1)),p=((g=u[N]-u[N+1])*I+2*d*s[N+1])*I,u[N]-=p,u[N+1]+=p,l<N&&(s[N]=d*s[N]-I*v),s[N+1]+=I*(d*g-2*I*s[N+1]);for(var y=0;y<a;y++)_=i[y][N],v=i[y][N+1],i[y][N]=d*_-I*v,i[y][N+1]=I*_+d*v;N<c-1&&(_=s[N+1],v=-I*s[N+2],s[N+2]*=d)}if(Math.abs(s[c])<=1e-10*(Math.abs(u[c-1])+Math.abs(u[c])))break}if(r)break}}return function(t,e){for(var r=e.length,n=[],i=0;i<r;i++)n[i]={sigma:e[i],index:i};n.sort(function(t,e){return t.sigma===e.sigma?0:t.sigma<e.sigma?1:-1});for(var o=X.zeros(r),a=X.zeros(r),u=0;u<r;u++)a.matrix_array[u][u]=new rt(n[u].sigma),o.matrix_array[u][n[u].index]=rt.ONE;return{V:t.mul(o),D:a}}(new X(i),u)},B.doGramSchmidtOrthonormalization=function(t){for(var e=X._toMatrix(t),r=e.column_length,n=e.matrix_array,i=X.zeros(r),o=X.zeros(r),a=i.matrix_array,u=o.matrix_array,s=[],h=new Array(r),c=0;c<r;c++){for(var l=0;l<r;l++)h[l]=n[l][c];if(0<c){for(var f=0;f<c;f++)for(var g=0;g<r;g++)u[f][c]=u[f][c].add(n[g][c].dot(a[g][f]));for(var p=0;p<c;p++)for(var m=0;m<r;m++)h[m]=h[m].sub(u[p][c].mul(a[m][p]))}for(var _=0;_<r;_++)u[c][c]=u[c][c].add(h[_].square());if(u[c][c]=u[c][c].sqrt(),u[c][c].isZero(1e-10)){s.push(c);for(var v=0;v<r;v++)a[v][c]=rt.ZERO}else for(var N=0;N<r;N++)a[N][c]=h[N].div(u[c][c])}return{Q:i,R:o,non_orthogonalized:s}},B.createOrthogonalVector=function(t,e){for(var r=new X(t),n=r.column_length,i=r.matrix_array,o=B.getLinearDependenceVector(r,e||1e-10),a=o.length-1;0<=a;a--)i.splice(o[a],1),r.row_length--;var u=n-i.length;if(u<=0)return null;for(var s=new v(0),h=null,c=0;c<100;c++){var l=r.T(),f=X.createMatrixDoEachCalculation(function(){return new rt(s.nextGaussian())},l.row_length,u);if(l._concatRight(f),0===(h=B.doGramSchmidtOrthonormalization(l)).non_orthogonalized.length)break}if(0!==h.non_orthogonalized.length)return console.log("miss"),null;for(var g=new Array(u),p=h.Q.matrix_array,m=0;m<u;m++){g[m]=new Array(n);for(var _=0;_<n;_++)g[m][_]=p[_][n-u+m]}return new X(g)},B.getMaxRowNumber=function(t,e,r,n){for(var i=X._toMatrix(t),o=0,a=0,u=r||0,s=n||i.row_length;u<s;u++){var h=i.matrix_array[u][e].norm;a<h&&(a=h,o=u)}return{index:o,max:a}},B.getLinearDependenceVector=function(t,e){for(var r=new X(t),n=r.matrix_array,i=e?X._toDouble(e):1e-10,o=new Array(r.row_length),a=0;a<r.row_length;a++)o[a]=a;for(var u=0;u<r.column_length;u++){var s=0,h=0,c=0;for(var l in o){var f=o[l],g=n[f][u].norm;h<g&&(h=g,c=parseInt(l,10),s=f)}if(!(h<=i)){if(o.splice(c,1),u===r.column_length-1)break;for(var p in o)for(var m=o[p],_=n[m][u].div(n[s][u]),v=u;v<r.column_length;v++)n[m][v]=n[m][v].sub(n[s][v].mul(_))}}return o};function Y(){}Y.inner=function(t,e,r){var n=X._toMatrix(t),i=X._toMatrix(e),o=n.matrix_array,a=i.matrix_array,u=r?X._toInteger(r):1;if(n.isScalar()&&i.isScalar())return new X(n.scalar.dot(i.scalar));if(n.isVector()&&i.isVector()){for(var s=rt.ZERO,h=0;h<n.length;h++)s=s.add(n.getComplex(h).dot(i.getComplex(h)));return new X(s)}if(n.row_length!==i.row_length||n.column_length!==i.column_length)throw"Matrix size does not match";if(1===u){var c=new Array(1);c[0]=new Array(n.column_length);for(var l=0;l<n.column_length;l++){for(var f=rt.ZERO,g=0;g<n.row_length;g++)f=f.add(o[g][l].dot(a[g][l]));c[0][l]=f}return new X(c)}if(2!==u)throw"dim";for(var p=new Array(n.row_length),m=0;m<n.row_length;m++){for(var _=rt.ZERO,v=0;v<n.column_length;v++)_=_.add(o[m][v].dot(a[m][v]));p[m]=[_]}return new X(p)},Y.norm=function(t,e){var r=X._toMatrix(t),n=void 0===e?2:X._toDouble(e);if(1===n){var i=r.matrix_array;if(r.isRow()){for(var o=0,a=0;a<r.column_length;a++)o+=i[0][a].norm;return o}if(r.isColumn()){for(var u=0,s=0;s<r.row_length;s++)u+=i[s][0].norm;return u}for(var h=0,c=0;c<r.column_length;c++){for(var l=0,f=0;f<r.row_length;f++)l+=i[f][c].norm;h<l&&(h=l)}return h}if(2===n){var g=r.matrix_array;if(r.isRow()){for(var p=0,m=0;m<r.column_length;m++)p+=g[0][m].square().real;return Math.sqrt(p)}if(r.isColumn()){for(var _=0,v=0;v<r.row_length;v++)_+=g[v][0].square().real;return Math.sqrt(_)}return r.svd().S.diag().max().scalar.real}if(n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY){var N=r.matrix_array,d=n===Number.POSITIVE_INFINITY?0:Number.POSITIVE_INFINITY,I=n===Number.POSITIVE_INFINITY?Math.max:Math.min;if(r.isRow()){for(var y=0;y<r.column_length;y++)d=I(d,N[0][y].norm);return d}if(r.isColumn()){for(var w=0;w<r.row_length;w++)d=I(d,N[w][0].norm);return d}for(var b=d=0;b<r.row_length;b++){for(var E=0,x=0;x<r.column_length;x++)E+=N[b][x].norm;d=Math.max(d,E)}return d}if(r.isVector()){for(var M=0,T=0;T<r.length;T++)M+=Math.pow(r.getComplex(T).norm,n);return Math.pow(M,1/n)}throw"norm"},Y.cond=function(t,e){var r=X._toMatrix(t);if(2!==(void 0===e?2:X._toInteger(e)))return r.norm(e)*r.pinv().norm(e);if(r.isZeros())return Number.POSITIVE_INFINITY;if(r.isVector())return 1;if(r.isUnitary())return 1;var n=r.svd().S.diag();return n.max().scalar.real/n.min().scalar.real},Y.rcond=function(t){return 1/Y.cond(X._toMatrix(t),1)},Y.rank=function(t,e){var r=X._toMatrix(t),n=void 0!==e?X._toDouble(e):void 0;return r.row_length<=r.column_length?Math.min(r.row_length,r.column_length)-B.getLinearDependenceVector(r,n).length:r.row_length-B.getLinearDependenceVector(r,n).length},Y.trace=function(t){for(var e=X._toMatrix(t),r=Math.min(e.row_length,e.column_length),n=rt.ZERO,i=0;i<r;i++)n=n.add(e.matrix_array[i][i]);return n},Y.det=function(t){var e=X._toMatrix(t);if(!e.isSquare())throw"not square";var r=e.length;if(r<5){var h=function(t){if(2===t.length)return t[0][0].mul(t[1][1]).sub(t[0][1].mul(t[1][0]));for(var e=rt.ZERO,r=0;r<t.length;r++){for(var n=[],i=t[r][0],o=0,a=0;o<t.length;o++)if(r!==o){n[a]=[];for(var u=1,s=0;u<t.length;u++,s++)n[a][s]=t[o][u];a++}e=r%2==0?e.add(i.mul(h(n))):e.sub(i.mul(h(n)))}return e};return new X(h(e.matrix_array))}var n=Y.lup(e),i=(r-n.P.diag().sum().scalar.real)/2,o=n.U.diag().prod();return i%2==1&&(o=o.negate()),new X(o)},Y.lup=function(t){for(var e=new X(t),r=X.zeros(e.row_length),n=e,i=X.eye(e.row_length),o=r.matrix_array,a=n.matrix_array,u=0;u<e.column_length;u++){var s,h=B.getMaxRowNumber(n,u,u);if(s=h.index,0!==h.max){u!==s&&(r._exchangeRow(u,s),n._exchangeRow(u,s),i._exchangeRow(u,s));for(var c=u+1;c<e.row_length;c++){var l=a[c][u].div(a[u][u]);o[c][u]=l;for(var f=u;f<e.column_length;f++)a[c][f]=a[c][f].sub(a[u][f].mul(l))}}}return r._resize(e.row_length,Math.min(e.row_length,e.column_length)),n._resize(Math.min(e.row_length,e.column_length),e.column_length),r._each(function(t,e,r){return e===r?rt.ONE:t}),{L:r,U:n,P:i}},Y.lu=function(t){var e=Y.lup(t);return{L:e.P.T().mul(e.L),U:e.U}},Y.linsolve=function(t,e){var r=X._toMatrix(t),n=X._toMatrix(e);if(!r.isSquare())throw"Matrix size does not match";var i=n;if(n.row_length!==r.row_length||1<n.column_length)throw"Matrix size does not match";var o=new X(r);o._concatRight(i);for(var a=o.matrix_array,u=o.column_length,s=r.column_length,h=0;h<s-1;h++){var c=B.getMaxRowNumber(o,h,h).index;o._exchangeRow(h,c);for(var l=a[h][h].inv(),f=h,g=h;g<u;g++)a[f][g]=a[f][g].mul(l);for(var p=h+1;p<s;p++)for(var m=a[p][h],_=h;_<u;_++)a[p][_]=a[p][_].sub(a[h][_].mul(m))}var v=new Array(s);v[s-1]=a[s-1][s].div(a[s-1][s-1]);for(var N=s-2;0<=N;N--){v[N]=a[N][u-1];for(var d=N+1;d<s;d++)v[N]=v[N].sub(a[N][d].mul(v[d]));v[N]=v[N].div(a[N][N])}for(var I=new Array(r.row_length),y=0;y<r.row_length;y++)I[y]=[v[y]];return new X(I)},Y.qr=function(t){var e=new X(t),r=e.row_length,n=e.row_length,i=e.row_length,o=e.column_length,a=Math.max(e.row_length,e.column_length);e._resize(a,a);var u=B.doGramSchmidtOrthonormalization(e),s=u.Q,h=u.R,c=u.non_orthogonalized;if(c.length===e.row_length)s=X.eye(e.row_length);else if(0!==c.length){for(var l={},f=0;f<c.length;f++)l[c[f]]=1;for(var g=[],p=0;p<a;p++)if(!l[p]){for(var m=[],_=0;_<a;_++)m[_]=s.matrix_array[_][p];g.push(m)}for(var v=B.createOrthogonalVector(g),N=0;N<c.length;N++)for(var d=c[N],I=0;I<a;I++)s.matrix_array[I][d]=v.matrix_array[N][I]}return s._resize(r,n),h._resize(i,o),{Q:s,R:h}},Y.tridiagonalize=function(t){var e=new X(t);if(!e.isSquare())throw"not square matrix";if(!e.isSymmetric())throw"not Symmetric";if(e.isComplex())throw"not Real Matrix";return B.tridiagonalize(e)},Y.eig=function(t){var e=new X(t);if(!e.isSquare())throw"not square matrix";if(!e.isSymmetric())throw"not Symmetric";if(e.isComplex())throw"not Real Matrix";return B.eig(e)},Y.svd=function(t){var e=new X(t);if(e.isComplex())throw"Unimplemented";var n=Y.rank(e),i=Y.eig(e.T().mul(e)),o=X.zeros(e.row_length,e.column_length);o._each(function(t,e,r){if(e===r&&e<n)return i.D.getComplex(e,e).sqrt()});var r=Math.min(e.row_length,e.column_length),a=X.createMatrixDoEachCalculation(function(t,e){if(t!==e)return rt.ZERO;var r=o.matrix_array[t][t];return r.isZero()?rt.ZERO:r.inv()},r),u=i.V.resize(i.V.row_length,r),s=e.mul(u).mul(a);return{U:Y.qr(s).Q,S:o,V:i.V}},Y.inv=function(t){var e=new X(t);if(e.isScalar())return new X(rt.ONE.div(e.scalar));if(!e.isSquare())throw"not square";if(e.isDiagonal()){for(var r=e.T(),n=Math.min(r.row_length,r.column_length),i=0;i<n;i++)r.matrix_array[i][i]=r.matrix_array[i][i].inv();return r}var o=e.column_length,a=new X(e);a._concatRight(X.eye(o));for(var u=a.matrix_array,s=a.column_length,h=0;h<o;h++){var c=B.getMaxRowNumber(a,h,h).index;a._exchangeRow(h,c);for(var l=u[h][h].inv(),f=h,g=h;g<s;g++)u[f][g]=u[f][g].mul(l);for(var p=0;p<o;p++)if(p!==h)for(var m=u[p][h],_=h;_<s;_++)u[p][_]=u[p][_].sub(u[h][_].mul(m))}for(var v=new Array(o),N=0;N<o;N++){v[N]=new Array(o);for(var d=0;d<o;d++)v[N][d]=u[N][o+d]}return new X(v)},Y.pinv=function(t){var e=new X(t),r=Y.svd(e),n=r.U,i=r.S,o=r.V,a=X.createMatrixDoEachCalculation(function(t,e){if(t!==e)return rt.ZERO;var r=i.matrix_array[t][t];return r.isZero()?rt.ZERO:r.inv()},e.column_length,e.row_length);return o.mul(a).mul(n.T())};function U(){}U.max=function(t,e){var r=X._toMatrix(t),n=e&&e.dimension?e.dimension:"auto";return r.eachVector(function(t){for(var e=t[0],r=1;r<t.length;r++)e.compareTo(t[r])<0&&(e=t[r]);return[e]},n)},U.min=function(t,e){var r=X._toMatrix(t),n=e&&e.dimension?e.dimension:"auto";return r.eachVector(function(t){for(var e=t[0],r=1;r<t.length;r++)0<e.compareTo(t[r])&&(e=t[r]);return[e]},n)},U.sum=function(t,e){var r=X._toMatrix(t),n=e&&e.dimension?e.dimension:"auto";return r.eachVector(function(t){for(var e=rt.ZERO,r=rt.ZERO,n=0;n<t.length;n++){var i=t[n].add(r),o=e.add(i);r=o.sub(e).sub(i),e=o}return[e]},n)},U.mean=function(t,e){var r=X._toMatrix(t),n=e&&e.dimension?e.dimension:"auto";return r.eachVector(function(t){for(var e=rt.ZERO,r=rt.ZERO,n=0;n<t.length;n++){var i=t[n].add(r),o=e.add(i);r=o.sub(e).sub(i),e=o}return[e.div(t.length)]},n)},U.prod=function(t,e){var r=X._toMatrix(t),n=e&&e.dimension?e.dimension:"auto";return r.eachVector(function(t){for(var e=rt.ONE,r=0;r<t.length;r++)e=e.mul(t[r]);return[e]},n)},U.geomean=function(t,e){var r=X._toMatrix(t),n=e&&e.dimension?e.dimension:"auto";return r.eachVector(function(t){for(var e=rt.ONE,r=0;r<t.length;r++)e=e.mul(t[r]);return[e.pow(rt.create(t.length).inv())]},n)},U.median=function(t,e){function i(t,e){return t.compareTo(e)}var r=X._toMatrix(t),n=e&&e.dimension?e.dimension:"auto";return r.eachVector(function(t){var e;if(t.sort(i),t.length%2==1)e=t[Math.floor(t.length/2)];else{var r=t[Math.floor(t.length/2)-1],n=t[Math.floor(t.length/2)];e=r.add(n).div(rt.TWO)}return[e]},n)},U.mode=function(t,e){function s(t,e){return t.compareTo(e)}var r=X._toMatrix(t),n=e&&e.dimension?e.dimension:"auto";return r.eachVector(function(t){t.sort(s);for(var e={},r=0;r<t.length;r++){var n=t[r].real+" "+t[r].imag;e[n]?e[n].value++:e[n]={complex:t[r],value:1}}var i=rt.ZERO,o=Number.NEGATIVE_INFINITY;for(var a in e){var u=e[a];u.value>o&&(o=u.value,i=u.complex)}return[i]},n)},U.moment=function(t,e,r){var n=X._toMatrix(t),o=U.mean(n),a=r&&"number"==typeof r.correction?X._toDouble(r.correction):1,i=r&&r.dimension?r.dimension:"auto",u=X._toComplex(e),s=0;return n.eachVector(function(t){var e;e=o.isScalar()?o.scalar:o.getComplex(s++);for(var r=rt.ZERO,n=0;n<t.length;n++){var i=t[n].sub(e);r=r.add(i.pow(u))}return 1===t.length?[r.div(t.length)]:[r.div(t.length-1+a)]},i)},U.var=function(t,e){var r=X._toMatrix(t),o=U.mean(r),a=e&&"number"==typeof e.correction?X._toDouble(e.correction):0,n=e&&e.dimension?e.dimension:"auto",u=0;return r.eachVector(function(t){if(1===t.length)return[rt.ZERO];for(var e=o.getComplex(u++),r=0,n=0;n<t.length;n++){var i=t[n].sub(e).norm;r+=i*i}return[rt.create(r/(t.length-1+a))]},n)},U.std=function(t,e){var r=X._toMatrix(t),n=e&&"number"==typeof e.correction?X._toDouble(e.correction):0,i=e&&e.dimension?e.dimension:"auto",o=U.var(r,{correction:n,dimension:i});return o._each(function(t){return t.sqrt()}),o},U.mad=function(t,e,r){var n=X._toMatrix(t),i=e?"string"==typeof e?e:X._toInteger(e):"mean",o=r&&r.dimension?r.dimension:"auto";if("mean"===i||0===i)return U.mean(n.sub(U.mean(n,{dimension:o})).abs(),{dimension:o});if("median"===i||1===i)return U.median(n.sub(U.median(n,{dimension:o})).abs(),{dimension:o});throw"mad unsupported argument "+i},U.skewness=function(t,e){var r=X._toMatrix(t),n=e&&"number"==typeof e.correction?X._toDouble(e.correction):1,i=e&&e.dimension?e.dimension:"auto",o=U.moment(r,3,{correction:n,dimension:i}),a=U.std(r,{correction:n,dimension:i});return 1===n?o.dotdiv(a.dotpow(3)):o.dotdiv(a.dotpow(3)).dotmul(2)},U.cov=function(t,e,r){var n=X._toMatrix(t),i=0,o=null;if(void 0!==e&&(void 0!==r?(i=r&&"number"==typeof r.correction?X._toDouble(r.correction):0,o=X._toMatrix(e)):"object"==typeof e&&"correction"in e?i=X._toDouble(e.correction):o=X._toMatrix(e)),null===o){if(n.isVector())return U.var(n,{correction:i});for(var a=1===n.row_length?1:i,u=n.matrix_array,s=U.mean(n).matrix_array[0],h=new Array(n.column_length),c=0;c<n.column_length;c++){var l=s[c];h[c]=new Array(n.column_length);for(var f=c;f<n.column_length;f++){for(var g=s[f],p=rt.ZERO,m=0;m<n.row_length;m++)p=p.add(u[m][c].sub(l).dot(u[m][f].sub(g)));h[c][f]=p.div(n.row_length-1+a)}}for(var _=1;_<h[0].length;_++)for(var v=0;v<_;v++)h[_][v]=h[v][_];return new X(h)}if(!n.isVector()&&!o.isVector())throw"vector not specified";if(n.length!==o.length)throw"X.length !== Y.length";for(var N=U.mean(n).scalar,d=U.mean(o).scalar,I=n.length,y=1===I?1:i,w=rt.ZERO,b=0;b<I;b++)w=w.add(n.getComplex(b).sub(N).dot(o.getComplex(b).sub(d)));return new X(w.div(I-1+y))},U.standardization=function(t,e){var r=X._toMatrix(t),n=r.sub(U.mean(r,e));return n.dotdiv(U.std(n,e))},U.corrcoef=function(t,e,r){var n=X._toMatrix(t),i=null;if(void 0!==e&&(void 0!==r?i=X._toMatrix(e):"object"==typeof e&&"correction"in e||(i=X._toMatrix(e))),null===i)return U.cov(U.standardization(n,r),r);if(!n.isVector()&&!i.isVector())throw"vector not specified";if(n.length!==i.length)throw"X.length["+n.length+"] !== Y.length["+i.length+"]";var o=U.cov(n,i,r),a=n.std(r),u=i.std(r);return o.div(a.mul(u))},U.sort=function(t,e,r){var n,i=X._toMatrix(t),o=r&&r.dimension?r.dimension:"auto";n="ascend"===(e||"ascend")?function(t,e){return t.compareTo(e)}:function(t,e){return e.compareTo(t)};return i.eachVector(function(t){return t.sort(n),t},o)};function z(t){this.size=t,this.inv_size=1/this.size,this.bit_size=Math.round(Math.log(this.size)/Math.log(2)),this.is_fast=1<<this.bit_size===this.size,this.bitrv=null,this.fft_re=new Array(this.size),this.fft_im=new Array(this.size);for(var e=-2*Math.PI/this.size,r=0,n=0,i=0;n<this.size;n++){this.fft_re[n]=Math.cos(i),this.fft_im[n]=Math.sin(i);var o=e+r,a=i+o;r=a-i-o,i=a}this.is_fast&&(this.bitrv=z.create_bit_reverse_table(this.bit_size))}z.bit_reverse_32=function(t){var e=4294967295&t;return e=(65535&(e=(16711935&(e=(252645135&(e=(858993459&(e=(1431655765&e)<<1|e>>1&1431655765))<<2|e>>2&858993459))<<4|e>>4&252645135))<<8|e>>8&16711935))<<16|e>>16&65535},z.create_bit_reverse_table=function(t){for(var e=1<<t,r=[],n=0;n<e;n++)r[n]=z.bit_reverse_32(n)>>>32-t;return r},z.prototype.delete=function(){delete this.size,delete this.inv_size,delete this.bit_size,delete this.is_fast,delete this.bitrv,delete this.fft_re,delete this.fft_im},z.prototype.fft=function(t,e){var r=new Array(this.size),n=new Array(this.size);if(this.is_fast){for(var i=0;i<this.size;i++)r[i]=t[this.bitrv[i]],n[i]=e[this.bitrv[i]];for(var o=1,a=this.size/2,u=2,s=1<<this.bit_size-1;0<s;s>>=1){for(var h=0;h<a;h++)for(var c=h*u,l=0,f=0;l<o;l++,c++,f+=s){var g=r[c+o]*this.fft_re[f]-n[c+o]*this.fft_im[f],p=n[c+o]*this.fft_re[f]+r[c+o]*this.fft_im[f];r[c+o]=r[c]-g,n[c+o]=n[c]-p,r[c]+=g,n[c]+=p}a/=2,u*=2,o*=2}}else if(W.isContainsZero(e))for(var m=0;m<this.size;m++){r[m]=0;for(var _=n[m]=0,v=0;_<this.size;v=++_*m%this.size)r[m]+=t[_]*this.fft_re[v]-e[_]*this.fft_im[v],n[m]+=t[_]*this.fft_im[v]+e[_]*this.fft_re[v]}else for(var N=0;N<this.size;N++){r[N]=0;for(var d=n[N]=0,I=0;d<this.size;I=++d*N%this.size)r[N]+=t[d]*this.fft_re[I],n[N]+=t[d]*this.fft_im[I]}return{real:r,imag:n}},z.prototype.ifft=function(t,e){var r=new Array(this.size),n=new Array(this.size);if(this.is_fast){for(var i=0;i<this.size;i++)r[i]=t[this.bitrv[i]],n[i]=e[this.bitrv[i]];for(var o,a,u=1,s=this.size/2,h=2,c=1<<this.bit_size-1;0<c;c>>=1){for(var l=0;l<s;l++)for(var f=l*h,g=0,p=0;g<u;g++,f++,p+=c)o=r[f+u]*this.fft_re[p]+n[f+u]*this.fft_im[p],a=n[f+u]*this.fft_re[p]-r[f+u]*this.fft_im[p],r[f+u]=r[f]-o,n[f+u]=n[f]-a,r[f]+=o,n[f]+=a;s/=2,h*=2,u*=2}}else if(W.isContainsZero(e))for(var m=0;m<this.size;m++){r[m]=0;for(var _=n[m]=0,v=0;_<this.size;v=m*++_%this.size)r[m]+=t[_]*this.fft_re[v]+e[_]*this.fft_im[v],n[m]+=-t[_]*this.fft_im[v]+e[_]*this.fft_re[v]}else for(var N=0;N<this.size;N++){r[N]=0;for(var d=n[N]=0,I=0;d<this.size;I=N*++d%this.size)r[N]+=t[d]*this.fft_re[I],n[N]+=-t[d]*this.fft_im[I]}for(var y=0;y<this.size;y++)r[y]*=this.inv_size,n[y]*=this.inv_size;return{real:r,imag:n}};function G(t,e){this.object=t,this.table=[],this.table_max=e}G.prototype.get=function(t){for(var e=0;e<this.table.length;e++)if(this.table[e].size===t){var r=this.table.splice(e,1)[0];return this.table.unshift(r),r}var n=new this.object(t);this.table.length===this.table_max&&this.table.pop().delete();return this.table.unshift(n),n};function H(t){this.size=t,this.dct_size=2*t,this.dct_re=new Array(this.size),this.dct_im=new Array(this.size);for(var e=1/Math.sqrt(this.size),r=e*Math.sqrt(2),n=0;n<this.size;n++){var i=-Math.PI*n/this.dct_size;this.dct_re[n]=Math.cos(i)*(0===n?e:r),this.dct_im[n]=Math.sin(i)*(0===n?e:r)}}var j=new G(z,4);H.prototype.delete=function(){delete this.size,delete this.dct_size,delete this.dct_re,delete this.dct_im},H.prototype.dct=function(t){for(var e=new Array(this.dct_size),r=new Array(this.dct_size),n=0;n<this.dct_size;n++)e[n]=n<this.size?t[n]:0,r[n]=0;for(var i=j.get(this.dct_size).fft(e,r),o=0;o<this.size;o++)e[o]=i.real[o]*this.dct_re[o]-i.imag[o]*this.dct_im[o];return e.splice(this.size),e},H.prototype.idct=function(t){for(var e=new Array(this.dct_size),r=new Array(this.dct_size),n=2*this.size,i=0;i<this.dct_size;i++)e[i]=i<this.size?n*t[i]*this.dct_re[i]:0,r[i]=i<this.size?n*t[i]*-this.dct_im[i]:0;var o=j.get(this.dct_size).ifft(e,r);return o.real.splice(this.size),o.real};var k=new G(H,4),W=function(){};W.isContainsZero=function(t){for(var e=0;e<t.length;e++)if(0!==t[e])return!0;return!1},W.fft=function(t,e){return j.get(t.length).fft(t,e)},W.ifft=function(t,e){return j.get(t.length).ifft(t,e)},W.dct=function(t){return k.get(t.length).dct(t)},W.idct=function(t){return k.get(t.length).idct(t)},W.powerfft=function(t,e){for(var r=t.length,n=W.fft(t,e),i=new Array(r),o=0;o<r;o++)i[o]=n.real[o]*n.real[o]+n.imag[o]*n.imag[o];return i},W.conv=function(t,e,r,n){var i=!1;if(t.length===r.length){i=!0;for(var o=0;o<t.length;o++)if(t[o]!==r[o]||e[o]!==n[o]){i=!1;break}}var a=t.length,u=2*a;if(1<<Math.round(Math.log(a)/Math.log(2))===a){if(i){for(var s=t.length,h=new Array(u),c=new Array(u),l=0;l<u;l++)h[l]=l<s?t[l]:0,c[l]=l<s?e[l]:0;for(var f=W.fft(h,c),g=0;g<u;g++)h[g]=f.real[g]*f.real[g]-f.imag[g]*f.imag[g],c[g]=f.real[g]*f.imag[g]+f.imag[g]*f.real[g];var p=W.ifft(h,c);return p.real.splice(u-1),p.imag.splice(u-1),p}if(t.length===r.length){for(var m=t.length,_=new Array(u),v=new Array(u),N=new Array(u),d=new Array(u),I=0;I<u;I++)_[I]=I<m?t[I]:0,v[I]=I<m?e[I]:0,N[I]=I<m?r[I]:0,d[I]=I<m?n[I]:0;for(var y=W.fft(_,v),w=W.fft(N,d),b=new Array(u),E=new Array(u),x=0;x<u;x++)b[x]=y.real[x]*w.real[x]-y.imag[x]*w.imag[x],E[x]=y.real[x]*w.imag[x]+y.imag[x]*w.real[x];var M=W.ifft(b,E);return M.real.splice(u-1),M.imag.splice(u-1),M}}var T=!W.isContainsZero(e);T=T&&!W.isContainsZero(n);for(var O=new Array(t.length+r.length-1),F=new Array(t.length+r.length-1),P=0;P<O.length;P++)O[P]=0,F[P]=0;if(T)for(var D=0;D<r.length;D++)for(var A=0;A<t.length;A++)O[D+A]+=t[A]*r[D];else for(var S=0;S<r.length;S++)for(var V=0;V<t.length;V++)O[S+V]+=t[V]*r[S]-e[V]*n[S],F[S+V]+=t[V]*n[S]+e[V]*r[S];return{real:O,imag:F}},W.xcorr=function(t,e,r,n){var i=!1;if(t.length===r.length){i=!0;for(var o=0;o<t.length;o++)if(t[o]!==r[o]||e[o]!==n[o]){i=!1;break}}if(t.length===r.length){var a=t.length,u=2*a;if(1<<Math.round(Math.log(a)/Math.log(2))===a){var s=null;if(i){for(var h=new Array(u),c=new Array(u),l=0;l<u;l++)h[l]=l<a?t[l]:0,c[l]=l<a?e[l]:0;var f=W.powerfft(h,c);s=W.ifft(f,c),h.pop(),c.pop();for(var g=0,p=a+1;g<h.length;g++,p++)u<=p&&(p=0),h[g]=s.real[p],c[g]=s.imag[p];return{real:h,imag:c}}for(var m=new Array(u),_=new Array(u),v=new Array(u),N=new Array(u),d=0;d<u;d++)m[d]=d<a?t[d]:0,_[d]=d<a?e[d]:0,v[d]=d<a?r[a-d-1]:0,N[d]=d<a?-n[a-d-1]:0;for(var I=W.fft(m,_),y=W.fft(v,N),w=new Array(u),b=new Array(u),E=0;E<u;E++)w[E]=I.real[E]*y.real[E]-I.imag[E]*y.imag[E],b[E]=I.real[E]*y.imag[E]+I.imag[E]*y.real[E];return(s=W.ifft(w,b)).real.splice(u-1),s.imag.splice(u-1),s}}var x=!W.isContainsZero(e);if(x=x&&!W.isContainsZero(n),i){var M=t.length,T=2*M;if(x){for(var O=new Array(M),F=0;F<M;F++)for(var P=M-F,D=O[F]=0;D<P;D++)O[F]+=t[D]*r[D+F];for(var A=new Array(T-1),S=new Array(T-1),V=0,R=M-1;V<M;V++,R--)A[V]=O[R],A[M+V-1]=O[V];for(var C=0;C<S.length;C++)S[C]=0;return{real:A,imag:S}}}for(var Z=new Array(r.length),L=new Array(r.length),B=0;B<r.length;B++)Z[B]=r[r.length-B-1],L[B]=-n[r.length-B-1];var q=W.conv(t,e,Z,L);if(t.length===r.length)return q;for(var Y=Math.abs(t.length-r.length),U=new Array(Y),z=0;z<Y;z++)U[z]=0;return t.length>r.length?{real:U.concat(q.real),imag:U.concat(q.imag)}:{real:q.real.concat(U),imag:q.imag.concat(U)}},W.window=function(t,e,r){var a,n=void 0!==r?r:"symmetric",i=t.toLocaleLowerCase(),u=e,s=new Array(u);"symmetric"===n||0===n?a=function(t){return t/(u-1)*(2*Math.PI)}:"periodic"!==n&&0===n||(a=function(t){return t/u*(2*Math.PI)});function o(t,e,r,n,i){for(var o=0;o<u;o++)s[o]=t,s[o]-=e*Math.cos(1*a(o)),s[o]+=r*Math.cos(2*a(o)),s[o]-=n*Math.cos(3*a(o)),s[o]+=i*Math.cos(4*a(o))}switch(i){case"rectangle":o(1,0,0,0,0);break;case"hann":o(.5,.5,0,0,0);break;case"hamming":o(.54,.46,0,0,0);break;case"blackman":o(.42,.5,.08,0,0);break;case"blackmanharris":o(.35875,.48829,.14128,.01168,0);break;case"blackmannuttall":o(.3635819,.4891775,.1365995,.0106411,0);break;case"flattop":o(1,1.93,1.29,.388,.032);break;case"sin":for(var h=0;h<u;h++)s[h]=Math.sin(.5*a(h));break;case"vorbis":for(var c=0;c<u;c++){var l=Math.sin(.5*a(c));s[c]=Math.sin(.5*Math.PI*l*l)}}return s},W.hann=function(t,e){return W.window("hann",t,e)},W.hamming=function(t,e){return W.window("hamming",t,e)};function Q(){}Q.fft=function(t,e){var r=e&&e.dimension?e.dimension:"auto";return X._toMatrix(t).eachVector(function(t){for(var e=new Array(t.length),r=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n].real,r[n]=t[n].imag;for(var i=W.fft(e,r),o=new Array(t.length),a=0;a<t.length;a++)o[a]=new rt([i.real[a],i.imag[a]]);return o},r)},Q.ifft=function(t,e){var r=e&&e.dimension?e.dimension:"auto";return X._toMatrix(t).eachVector(function(t){for(var e=new Array(t.length),r=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n].real,r[n]=t[n].imag;for(var i=W.ifft(e,r),o=new Array(t.length),a=0;a<t.length;a++)o[a]=new rt([i.real[a],i.imag[a]]);return o},r)},Q.powerfft=function(t,e){var r=e&&e.dimension?e.dimension:"auto";return X._toMatrix(t).eachVector(function(t){for(var e=new Array(t.length),r=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n].real,r[n]=t[n].imag;for(var i=W.powerfft(e,r),o=new Array(t.length),a=0;a<t.length;a++)o[a]=new rt(i[a]);return o},r)},Q.dct=function(t,e){var r=e&&e.dimension?e.dimension:"auto",n=X._toMatrix(t);if(n.isComplex())throw"dct don't support complex numbers.";return n.eachVector(function(t){for(var e=new Array(t.length),r=0;r<t.length;r++)e[r]=t[r].real;for(var n=W.dct(e),i=new Array(t.length),o=0;o<t.length;o++)i[o]=new rt(n[o]);return i},r)},Q.idct=function(t,e){var r=e&&e.dimension?e.dimension:"auto",n=X._toMatrix(t);if(n.isComplex())throw"idct don't support complex numbers.";return n.eachVector(function(t){for(var e=new Array(t.length),r=0;r<t.length;r++)e[r]=t[r].real;for(var n=W.idct(e),i=new Array(t.length),o=0;o<t.length;o++)i[o]=new rt(n[o]);return i},r)},Q.fft2=function(t){return Q.fft(t,{dimension:"both"})},Q.ifft2=function(t){return Q.ifft(t,{dimension:"both"})},Q.dct2=function(t){return Q.dct(t,{dimension:"both"})},Q.idct2=function(t){return Q.idct(t,{dimension:"both"})},Q.conv=function(t,e){var r=X._toMatrix(t),n=X._toMatrix(e);if(r.isMatrix()||n.isMatrix())throw"conv don't support matrix numbers.";var i=new Array(r.length),o=new Array(r.length),a=new Array(n.length),u=new Array(n.length);if(r.isRow())for(var s=0;s<r.column_length;s++)i[s]=r.matrix_array[0][s].real,o[s]=r.matrix_array[0][s].imag;else for(var h=0;h<r.row_length;h++)i[h]=r.matrix_array[h][0].real,o[h]=r.matrix_array[h][0].imag;if(n.isRow())for(var c=0;c<n.column_length;c++)a[c]=n.matrix_array[0][c].real,u[c]=n.matrix_array[0][c].imag;else for(var l=0;l<n.row_length;l++)a[l]=n.matrix_array[l][0].real,u[l]=n.matrix_array[l][0].imag;for(var f=W.conv(i,o,a,u),g=new Array(f.real.length),p=0;p<f.real.length;p++)g[p]=new rt([f.real[p],f.imag[p]]);var m=new X([g]);return n.isRow()?m:m.transpose()},Q.xcorr=function(t,e){var r=X._toMatrix(t);if(!e)return r.xcorr(r);var n=X._toMatrix(e);if(r.isMatrix()||n.isMatrix())throw"conv don't support matrix numbers.";var i=new Array(r.length),o=new Array(r.length),a=new Array(n.length),u=new Array(n.length);if(r.isRow())for(var s=0;s<r.column_length;s++)i[s]=r.matrix_array[0][s].real,o[s]=r.matrix_array[0][s].imag;else for(var h=0;h<r.row_length;h++)i[h]=r.matrix_array[h][0].real,o[h]=r.matrix_array[h][0].imag;if(n.isRow())for(var c=0;c<n.column_length;c++)a[c]=n.matrix_array[0][c].real,u[c]=n.matrix_array[0][c].imag;else for(var l=0;l<n.row_length;l++)a[l]=n.matrix_array[l][0].real,u[l]=n.matrix_array[l][0].imag;for(var f=W.xcorr(i,o,a,u),g=new Array(f.real.length),p=0;p<f.real.length;p++)g[p]=new rt([f.real[p],f.imag[p]]);var m=new X([g]);return r.isRow()?m:m.transpose()},Q.window=function(t,e,r){var n=X._toInteger(e),i=W.window(t,n,r);return new X(i).transpose()},Q.hann=function(t,e){return Q.window("hann",t,e)},Q.hamming=function(t,e){return Q.window("hamming",t,e)},Q.fftshift=function(t,e){var r=X._toMatrix(t);if(r.isVector()){var n=Math.floor(r.length/2);return r.circshift(n,e)}var i=Math.floor(r.column_length/2),o=Math.floor(r.row_length/2);if(void 0!==e){var a=e.dimension;if("row"===a||1===a)return r.circshift(i,e);if("column"===a||2===a)return r.circshift(o,e)}return r.circshift(i,{dimension:"row"}).circshift(o,{dimension:"column"})};function $(){}$.toPositionArrayFromObject=function(t,e,r){if("string"==typeof t){var n=$.toArrayFromString(t);if(":"===n){for(var i=new Array(e),o=0;o<e;o++)i[o]=o+r;return i}if(n instanceof Array){for(var a=n,u=new Array(a.length),s=0;s<a.length;s++)u[s]=Math.trunc(a[s].real);return u}throw"toArrayFromString["+t+"]["+n+"]"}var h=t;if(h instanceof X||h instanceof rt||"number"==typeof h||(h=X._toMatrix(h)),h instanceof X){if(!h.isVector())throw"getMatrix argument "+h;var c=h.length,l=new Array(h.length);if(h.isRow())for(var f=0;f<c;f++)l[f]=Math.trunc(h.matrix_array[0][f].real);else if(h.isColumn())for(var g=0;g<c;g++)l[g]=Math.trunc(h.matrix_array[g][0].real);return l}return[X._toInteger(h)]},$.match2=function(t,e){for(var r=[],n=t,i=0;i<1e3;i++){var o=n.match(e);if(null===o){n.length&&r.push([!1,n]);break}0<o.index&&r.push([!1,n.substr(0,o.index)]),r.push([!0,o[0]]),n=n.substr(o.index+o[0].length)}return r},$.trimBracket=function(t){var e=t,r=!1;if(/'$/.test(e)){var n=e.match(/(\s*')*$/g)[0];r=(n.split("'").length-1)%2==1,e=e.substring(0,e.length-n.length)}return/^\[/.test(e)&&/\]$/.test(e)?{text:e.substring(1,e.length-1),is_transpose:r}:null},$.toMatrixArrayFromStringForArrayJSON=function(t){var e=[],r=t.match(/\[[^\]]+\]/g);null===r&&(r=[t]);for(var n=0;n<r.length;n++){for(var i=r[n],o=i.substring(1,i.length-1).split(","),a=[],u=0;u<o.length;u++){var s=o[u];a[u]=new rt(s)}e[n]=a}return e},$.InterpolationCalculation=function(t,e,r,n){var i=t.compareTo(r),o=void 0===n||n;if(0===i)return[t];if(e.isZero())throw"IllegalArgumentException";if(e.isNegative()&&-1===i)throw"IllegalArgumentException";var a=[],u=t;a[0]=u;for(var s=1;s<65536;s++){if(u=u.add(e),o){if(r.compareTo(u)===i)break}else if(0<=r.compareTo(u)*i)break;a[s]=u}return a},$.toArrayFromMatch2String=function(t){for(var e=t,r=[],n=0;n<e.length;n++){var i=e[n];if(i[0])if(n<e.length-2&&!e[n+1][0]&&/:/.test(e[n+1][1])){var o=void 0,a=void 0,u=void 0;n<e.length-4&&!e[n+3][0]&&/:/.test(e[n+3][1])?(o=new rt(i[1]),a=new rt(e[n+2][1]),u=new rt(e[n+4][1]),n+=4):(o=new rt(i[1]),a=rt.ONE,u=new rt(e[n+2][1]),n+=2);for(var s=$.InterpolationCalculation(o,a,u,!0),h=0;h<s.length;h++)r.push(s[h])}else r.push(new rt(i[1]))}return r},$.toArrayFromString=function(t){if(":"===t.trim())return":";var e=t.toLowerCase().replace(/infinity|inf/g,"1e100000"),r=new RegExp("("+/[+-]? *(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij]( *[+] *[- ]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan)))?/.source+")|("+/[+-]? *(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))( *[+-] *[- ]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij])?/.source+")","i");return $.toArrayFromMatch2String($.match2(e,r))},$.toMatrixArrayFromStringForArraySPACE=function(t){for(var e=t.split(";"),r=new Array(e.length),n=0;n<e.length;n++)r[n]=$.toArrayFromString(e[n]);return r},$.toMatrixArrayFromStringInBracket=function(t){return/[[\]]/.test(t)?$.toMatrixArrayFromStringForArrayJSON(t):$.toMatrixArrayFromStringForArraySPACE(t)},$.toMatrixArrayFromString=function(t){var e=t.replace(/^\s*|\s*$/g,""),r=$.trimBracket(e);if(r){var n=$.toMatrixArrayFromStringInBracket(r.text);return r.is_transpose&&(n=new X(n).T().matrix_array),n}return[[new rt(t)]]},$.isCorrectMatrixArray=function(t){if(0===t.length)return!1;var e=t[0].length;if(0===e)return!1;for(var r=1;r<t.length;r++)if(t[r].length!==e)return!1;return!0};var X=function t(e){var r=null,n=!1;if(1!==arguments.length)throw"Matrix : Many arguments ["+arguments.length+"]";var i=e;if(i instanceof t){r=new Array(i.row_length);for(var o=0;o<i.row_length;o++){r[o]=new Array(i.column_length);for(var a=0;a<i.column_length;a++)r[o][a]=i.matrix_array[o][a]}}else if(i instanceof rt)r=[[i]];else if(i instanceof Array){r=[];for(var u=0;u<i.length;u++){var s=i[u];if(s instanceof Array){for(var h=new Array(s.length),c=0;c<s.length;c++){var l=s[c];if(l instanceof rt)h[c]=l;else if(l instanceof t){if(!l.isScalar())throw"Matrix in matrix";h[c]=l.scalar}else h[c]=new rt(l)}r[u]=h}else if(0===u&&(r[0]=new Array(i.length)),s instanceof rt)r[0][u]=s;else if(s instanceof t){if(!s.isScalar())throw"Matrix in matrix";r[0][u]=s.scalar}else r[0][u]=new rt(s)}}else r="string"==typeof i?(n=!0,$.toMatrixArrayFromString(i)):i instanceof Object&&"doubleValue"in i?[[new rt(i.doubleValue)]]:i instanceof Object?(n=!0,$.toMatrixArrayFromString(i.toString())):[[new rt(i)]];if(n)for(var f=0;f<r.length;f++)":"===r[f]&&r.splice(f--,1);if(!$.isCorrectMatrixArray(r))throw console.log(r),"new Matrix IllegalArgumentException";this.matrix_array=r,this.row_length=this.matrix_array.length,this.column_length=this.matrix_array[0].length,this.string_cash=null},J={booleanValue:{configurable:!0},intValue:{configurable:!0},doubleValue:{configurable:!0},scalar:{configurable:!0},length:{configurable:!0},width:{configurable:!0},height:{configurable:!0},norm1:{configurable:!0},norm2:{configurable:!0}},K={ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},ZERO:{configurable:!0},MINUS_ONE:{configurable:!0},I:{configurable:!0},PI:{configurable:!0},QUARTER_PI:{configurable:!0},HALF_PI:{configurable:!0},TWO_PI:{configurable:!0},E:{configurable:!0},LN2:{configurable:!0},LN10:{configurable:!0},LOG2E:{configurable:!0},LOG10E:{configurable:!0},SQRT2:{configurable:!0},SQRT1_2:{configurable:!0},HALF:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};X.create=function(t){return 1===arguments.length&&t instanceof X?t:new X(t)},X.valueOf=function(t){return X.create(t)},X._toMatrix=function(t){return t instanceof X?t:new X(t)},X._toComplex=function(t){if(t instanceof rt)return t;var e=X._toMatrix(t);if(e.isScalar())return e.scalar;throw"not scalar. ["+t+"]"},X._toDouble=function(t){if("number"==typeof t)return t;var e=X._toComplex(t);if(e.isReal())return e.real;throw"not support complex numbers."},X._toInteger=function(t){return Math.trunc(X._toDouble(t))},X.prototype._clearCash=function(){this.string_cash&&delete this.string_cash},X.prototype.clone=function(){return new X(this.matrix_array)},X.prototype.toString=function(){if(this.string_cash)return this.string_cash;var n=Math.pow(10,9),o=!1,i=!1,a=0;this._each(function(t,e,r){t.isReal()||(o=!0),Number.isFinite(t.real)&&Math.abs(t.real)>=n&&(i=!0),Number.isFinite(t.imag)&&Math.abs(t.imag)>=n&&(i=!0),a=Math.max(a,t.getDecimalPosition())}),0<a&&(a=4);function u(t){var e=i?t.toExponential(4):t.toFixed(a);if(/inf/i.test(e))return t===Number.POSITIVE_INFINITY?"Inf":"-Inf";if(/nan/i.test(e))return"NaN";if(!i)return e;var r=e.split("e"),n=r[1];return 2===n.length?n=n.substr(0,1)+"00"+n.substr(1):3===n.length&&(n=n.substr(0,1)+"0"+n.substr(1)),r[0]+"e"+n}var s=0,h=[];this._each(function(t){var e={},r=t.real;if(e.re_sign=r<0?"-":" ",r=Math.abs(r),e.re_str=u(r),s=Math.max(s,e.re_str.length+1),o){var n=t.imag;e.im_sign=n<0?"-":"+",n=Math.abs(n),e.im_str=u(n),s=Math.max(s,e.im_str.length+1)}h.push(e)});function c(t,e){return"                                        ".substr(0,e-t.length)+t}var l=[],f=this;return this._each(function(t,e,r){var n=h.shift(),i=c(n.re_sign+n.re_str,s);o&&(i+=" "+n.im_sign+c(n.im_str,s)+"i"),l.push(i),l.push(r<f.column_length-1?" ":"\n")}),this.string_cash=l.join(""),this.string_cash},X.prototype.toOneLineString=function(){if(this.isScalar())return this.scalar.toString();for(var t="[ ",e=0;e<this.row_length;e++)for(var r=0;r<this.column_length;r++)t+=this.matrix_array[e][r].toString(),r<this.column_length-1?t+=", ":e<this.row_length-1&&(t+="; ");return t+=" ]"},X.prototype.equals=function(t,e){var r=this,n=X._toMatrix(t);if(r.row_length!==n.row_length||r.column_length!==n.column_length)return!1;if(1===r.row_length&&1===r.column_length)return r.scalar.equals(n.scalar,e);for(var i=r.matrix_array,o=n.matrix_array,a=0;a<this.row_length;a++)for(var u=0;u<this.column_length;u++)if(!i[a][u].equals(o[a][u],e))return!1;return!0},X.prototype.getNumberMatrixArray=function(){for(var t=new Array(this.row_length),e=0;e<this.row_length;e++){t[e]=new Array(this.column_length);for(var r=0;r<this.column_length;r++)t[e][r]=this.matrix_array[e][r].real}return t},X.prototype.getComplexMatrixArray=function(){for(var t=new Array(this.row_length),e=0;e<this.row_length;e++){t[e]=new Array(this.column_length);for(var r=0;r<this.column_length;r++)t[e][r]=this.matrix_array[e][r]}return t},X.prototype._each=function(t){for(var e=!1,r=0;r<this.row_length;r++)for(var n=0;n<this.column_length;n++){var i=t(this.matrix_array[r][n],r,n);void 0!==i&&(this.matrix_array[r][n]=i instanceof rt?i:i instanceof X?i.scalar:new rt(i),e=!0)}return e&&this._clearCash(),this},X.prototype.cloneMatrixDoEachCalculation=function(t){return this.clone()._each(t)},X.createMatrixDoEachCalculation=function(t,e,r){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";for(var n=X._toInteger(e),i=r?X._toInteger(r):n,o=new Array(n),a=0;a<n;a++){o[a]=new Array(i);for(var u=0;u<i;u++){var s=t(a,u);o[a][u]=void 0===s?rt.ZERO:X._toComplex(s)}}return new X(o)},X.prototype.eachVectorAuto=function(t){if(this.isRow()){for(var e=new Array(this.row_length),r=0;r<this.column_length;r++)e[r]=this.matrix_array[0][r];return new X(t(e))}var n=X.ZERO;n._resize(1,this.column_length);for(var i=0;i<this.column_length;i++){for(var o=new Array(this.row_length),a=0;a<this.row_length;a++)o[a]=this.matrix_array[a][i];var u=t(o);n._resize(Math.max(n.row_length,u.length),n.column_length);for(var s=0;s<u.length;s++)n.matrix_array[s][i]=u[s]}return n},X.prototype.eachVectorBoth=function(t){var e=X.ZERO;e._resize(this.row_length,1);for(var r=0;r<this.row_length;r++){for(var n=new Array(this.column_length),i=0;i<this.column_length;i++)n[i]=this.matrix_array[r][i];var o=t(n);e._resize(e.row_length,Math.max(e.column_length,o.length));for(var a=0;a<o.length;a++)e.matrix_array[r][a]=o[a]}var u=X.ZERO;u._resize(1,e.column_length);for(var s=0;s<e.column_length;s++){for(var h=new Array(e.row_length),c=0;c<e.row_length;c++)h[c]=e.matrix_array[c][s];var l=t(h);u._resize(Math.max(u.row_length,l.length),u.column_length);for(var f=0;f<l.length;f++)u.matrix_array[f][s]=l[f]}return u},X.prototype.eachVectorRow=function(t){var e=X.ZERO;e._resize(this.row_length,1);for(var r=0;r<this.row_length;r++){for(var n=new Array(this.column_length),i=0;i<this.column_length;i++)n[i]=this.matrix_array[r][i];var o=t(n);e._resize(e.row_length,Math.max(e.column_length,o.length));for(var a=0;a<o.length;a++)e.matrix_array[r][a]=o[a]}return e},X.prototype.eachVectorColumn=function(t){var e=X.ZERO;e._resize(1,this.column_length);for(var r=0;r<this.column_length;r++){for(var n=new Array(this.row_length),i=0;i<this.row_length;i++)n[i]=this.matrix_array[i][r];var o=t(n);e._resize(Math.max(e.row_length,o.length),e.column_length);for(var a=0;a<o.length;a++)e.matrix_array[a][r]=o[a]}return e},X.prototype.eachVector=function(t,e){var r=void 0!==e?e:"auto";if("string"==typeof r?r=r.toLocaleLowerCase():"number"!=typeof r&&(r=X._toInteger(r)),"auto"===r||0===r)return this.eachVectorAuto(t);if("row"===r||1===r)return this.eachVectorRow(t);if("column"===r||2===r)return this.eachVectorColumn(t);if("both"===r||3===r)return this.eachVectorBoth(t);throw"eachVector argument "+e},X.prototype.getMatrix=function(t,e,r){void 0===r&&(r=!1);for(var n=r?1:0,i=$.toPositionArrayFromObject(t,this.row_length,n),o=$.toPositionArrayFromObject(e,this.column_length,n),a=this.matrix_array,u=new Array(i.length),s=0;s<i.length;s++){for(var h=new Array(o.length),c=0;c<o.length;c++)h[c]=a[i[s]-n][o[c]-n];u[s]=h}return new X(u)},X.prototype.setMatrix=function(t,e,r,n){void 0===n&&(n=!1);for(var i=n?1:0,o=$.toPositionArrayFromObject(t,this.row_length,i),a=$.toPositionArrayFromObject(e,this.column_length,i),u=new X(this).matrix_array,s=X._toMatrix(r),h=s.matrix_array,c=0;c<o.length;c++)for(var l=0;l<a.length;l++)u[o[c]-i][a[l]-i]=h[c%s.row_length][l%s.column_length];return new X(u)},X.prototype.getComplex=function(t,e){var r=null,n=null;return 1===arguments.length?r=X._toInteger(t):2===arguments.length&&(r=X._toInteger(t),n=X._toInteger(e)),this.isRow()?this.matrix_array[0][r]:this.isColumn()?this.matrix_array[r][0]:this.matrix_array[r][n]},J.booleanValue.get=function(){return this.matrix_array[0][0].booleanValue},J.intValue.get=function(){return Math.trunc(this.matrix_array[0][0].real)},J.doubleValue.get=function(){return this.matrix_array[0][0].real},J.scalar.get=function(){return this.matrix_array[0][0]},J.length.get=function(){return this.row_length>this.column_length?this.row_length:this.column_length},J.width.get=function(){return this.column_length},J.height.get=function(){return this.row_length},J.norm1.get=function(){return Y.norm(this,1)},J.norm2.get=function(){return Y.norm(this,2)},X.prototype.norm=function(t){return Y.norm(this,t)},X.prototype.cond=function(t){return Y.cond(this,t)},X.prototype.rcond=function(){return Y.rcond(this)},X.prototype.rank=function(t){return Y.rank(this,t)},X.prototype.trace=function(){return Y.trace(this)},X.prototype.det=function(){return Y.det(this)},X.memset=function(t,e,r){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";var n=X._toMatrix(t);if(n.isScalar()){var i=n.scalar;return X.createMatrixDoEachCalculation(function(){return i},e,r)}var o=n.matrix_array,a=n.row_length,u=n.column_length;return X.createMatrixDoEachCalculation(function(t,e){return o[t%a][e%u]},e,r)},X.eye=function(t,e){return X.createMatrixDoEachCalculation(function(t,e){return t===e?rt.ONE:rt.ZERO},t,e)},X.zeros=function(t,e){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return X.memset(rt.ZERO,t,e)},X.ones=function(t,e){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return X.memset(rt.ONE,t,e)},X.prototype.diag=function(){if(this.isVector()){var r=this;return X.createMatrixDoEachCalculation(function(t,e){return t===e?r.getComplex(t):rt.ZERO},this.length)}for(var t=Math.min(this.row_length,this.column_length),e=new Array(t),n=0;n<t;n++)e[n]=new Array(1),e[n][0]=this.matrix_array[n][n];return new X(e)},X.prototype.isScalar=function(){return 1===this.row_length&&1==this.column_length},X.prototype.isRow=function(){return 1===this.row_length},X.prototype.isColumn=function(){return 1===this.column_length},X.prototype.isVector=function(){return 1===this.row_length||1===this.column_length},X.prototype.isMatrix=function(){return 1!==this.row_length&&1!==this.column_length},X.prototype.isSquare=function(){return this.row_length===this.column_length},X.prototype.isReal=function(e){var r=!0;return this._each(function(t){r&&t.isComplex(e)&&(r=!1)}),r},X.prototype.isComplex=function(t){return!this.isReal(t)},X.prototype.isZeros=function(t){var e=!0,r=t||1e-10;return this._each(function(t){e&&!t.isZero(r)&&(e=!1)}),e},X.prototype.isIdentity=function(t){var n=!0,i=t||1e-10;return this._each(function(t,e,r){n&&(e===r?t.isOne(i)||(n=!1):t.isZero(i)||(n=!1))}),n},X.prototype.isDiagonal=function(t){var n=!0,i=t||1e-10;return this._each(function(t,e,r){n&&e!==r&&!t.isZero(i)&&(n=!1)}),n},X.prototype.isTridiagonal=function(t){var n=!0,i=t||1e-10;return this._each(function(t,e,r){n&&1<Math.abs(e-r)&&!t.isZero(i)&&(n=!1)}),n},X.prototype.isRegular=function(t){if(!this.isSquare())return!1;var e=t||1e-10;return this.rank(e)===this.row_length},X.prototype.isOrthogonal=function(t){if(!this.isSquare())return!1;var e=t||1e-10;return this.mul(this.transpose()).isIdentity(e)},X.prototype.isUnitary=function(t){if(!this.isSquare())return!1;var e=t||1e-10;return this.mul(this.ctranspose()).isIdentity(e)},X.prototype.isSymmetric=function(t){if(!this.isSquare())return!1;for(var e=t||1e-10,r=0;r<this.row_length;r++)for(var n=r+1;n<this.column_length;n++)if(!this.matrix_array[r][n].equals(this.matrix_array[n][r],e))return!1;return!0},X.prototype.isHermitian=function(t){if(!this.isSquare())return!1;for(var e=t||1e-10,r=0;r<this.row_length;r++)for(var n=r;n<this.column_length;n++)if(r===n){if(!this.matrix_array[r][n].isReal(e))return!1}else if(!this.matrix_array[r][n].equals(this.matrix_array[n][r].conj(),e))return!1;return!0},X.prototype.isTriangleUpper=function(t){var n=!0,i=t||1e-10;return this._each(function(t,e,r){n&&r<e&&!t.isZero(i)&&(n=!1)}),n},X.prototype.isTriangleLower=function(t){var n=!0,i=t||1e-10;return this._each(function(t,e,r){n&&e<r&&!t.isZero(i)&&(n=!1)}),n},X.prototype.isPermutation=function(t){if(!this.isSquare())return!1;for(var e=t||1e-10,r=new Array(this.row_length),n=new Array(this.column_length),i=0;i<this.row_length;i++)for(var o=0;o<this.column_length;o++){var a=this.matrix_array[i][o];if(a.isOne(e)){if(r[i]||n[o])return!1;r[i]=1,n[o]=1}else if(!a.isZero(e))return!1}for(var u=0;u<this.row_length;u++)if(void 0===r[u]||void 0===n[u])return!1;return!0},X.prototype.size=function(t){if(void 0!==t){var e=t;if("string"==typeof e?e=e.toLocaleLowerCase():"number"!=typeof e&&(e=X._toInteger(e)),"row"===e||1===e)return new X(this.row_length);if("column"===e||2===e)return new X(this.column_length)}return new X([[this.row_length,this.column_length]])},X.prototype.compareTo=function(t,e){var r=this,n=X._toMatrix(t);if(r.isScalar()&&n.isScalar())return r.scalar.compareTo(n.scalar,e);var i=r.matrix_array,o=n.matrix_array,a=Math.max(r.row_length,n.row_length),u=Math.max(r.column_length,n.column_length);return X.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].compareTo(o[t%n.row_length][e%n.column_length])},a,u)},X.prototype.add=function(t){var r=this,n=X._toMatrix(t);if(r.row_length!==n.row_length&&r.column_length!==n.column_length)throw"Matrix size does not match";var i=r.matrix_array,o=n.matrix_array,e=Math.max(r.row_length,n.row_length),a=Math.max(r.column_length,n.column_length);return X.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].add(o[t%n.row_length][e%n.column_length])},e,a)},X.prototype.sub=function(t){var r=this,n=X._toMatrix(t);if(r.row_length!==n.row_length&&r.column_length!==n.column_length)throw"Matrix size does not match";var i=r.matrix_array,o=n.matrix_array,e=Math.max(r.row_length,n.row_length),a=Math.max(r.column_length,n.column_length);return X.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].sub(o[t%n.row_length][e%n.column_length])},e,a)},X.prototype.mul=function(t){var e=this,r=X._toMatrix(t),n=e.matrix_array,i=r.matrix_array;if(e.isScalar()&&r.isScalar())return new X(e.scalar.mul(r.scalar));if(e.isScalar()){for(var o=new Array(r.row_length),a=0;a<r.row_length;a++){o[a]=new Array(r.column_length);for(var u=0;u<r.column_length;u++)o[a][u]=e.scalar.mul(i[a][u])}return new X(o)}if(r.isScalar()){for(var s=new Array(e.row_length),h=0;h<e.row_length;h++){s[h]=new Array(e.column_length);for(var c=0;c<e.column_length;c++)s[h][c]=n[h][c].mul(r.scalar)}return new X(s)}if(e.column_length!==r.row_length)throw"Matrix size does not match";for(var l=new Array(e.row_length),f=0;f<e.row_length;f++){l[f]=new Array(r.column_length);for(var g=0;g<r.column_length;g++){for(var p=rt.ZERO,m=0;m<e.column_length;m++)p=p.add(n[f][m].mul(i[m][g]));l[f][g]=p}}return new X(l)},X.prototype.div=function(t){var e=this,r=X._toMatrix(t),n=e.matrix_array;if(e.isScalar()&&r.isScalar())return new X(e.scalar.div(r.scalar));if(r.isScalar()){for(var i=new Array(e.row_length),o=0;o<e.row_length;o++){i[o]=new Array(e.column_length);for(var a=0;a<e.column_length;a++)i[o][a]=n[o][a].div(r.scalar)}return new X(i)}if(r.row_length===r.column_length){return 1e-10<r.det().scalar.norm?this.mul(r.inv()):this.mul(r.pinv())}if(e.column_length!==r.column_length)throw"Matrix size does not match";throw"warning"},X.prototype.inv=function(){return Y.inv(this)},X.prototype.dotmul=function(t){var r=this,n=X._toMatrix(t);if(!r.isScalar()&&!n.isScalar()&&r.row_length!==n.row_length&&r.column_length!==n.column_length)throw"Matrix size does not match";var i=r.matrix_array,o=n.matrix_array,e=Math.max(r.row_length,n.row_length),a=Math.max(r.column_length,n.column_length);return X.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].mul(o[t%n.row_length][e%n.column_length])},e,a)},X.prototype.dotdiv=function(t){var r=this,n=X._toMatrix(t);if(!r.isScalar()&&!n.isScalar()&&r.row_length!==n.row_length&&r.column_length!==n.column_length)throw"Matrix size does not match";var i=r.matrix_array,o=n.matrix_array,e=Math.max(r.row_length,n.row_length),a=Math.max(r.column_length,n.column_length);return X.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].div(o[t%n.row_length][e%n.column_length])},e,a)},X.prototype.dotinv=function(){var r=this.matrix_array;return X.createMatrixDoEachCalculation(function(t,e){return r[t][e].inv()},this.row_length,this.column_length)},X.prototype.nmul=function(t){return this.dotmul(t)},X.prototype.ndiv=function(t){return this.dotdiv(t)},X.prototype.ninv=function(){return this.dotinv()},X.prototype.npow=function(t){return this.dotpow(t)},X.prototype.rem=function(t){var r=this,n=X._toMatrix(t);if(!r.isScalar()&&!n.isScalar()&&r.row_length!==n.row_length&&r.column_length!==n.column_length)throw"Matrix size does not match";var i=r.matrix_array,o=n.matrix_array,e=Math.max(r.row_length,n.row_length),a=Math.max(r.column_length,n.column_length);return X.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].rem(o[t%n.row_length][e%n.column_length])},e,a)},X.prototype.mod=function(t){var r=this,n=X._toMatrix(t);if(!r.isScalar()&&!n.isScalar()&&r.row_length!==n.row_length&&r.column_length!==n.column_length)throw"Matrix size does not match";var i=r.matrix_array,o=n.matrix_array,e=Math.max(r.row_length,n.row_length),a=Math.max(r.column_length,n.column_length);return X.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].mod(o[t%n.row_length][e%n.column_length])},e,a)},X.prototype.real=function(){return this.cloneMatrixDoEachCalculation(function(t){return new rt(t.real)})},X.prototype.imag=function(){return this.cloneMatrixDoEachCalculation(function(t){return new rt(t.imag)})},X.prototype.arg=function(){return this.cloneMatrixDoEachCalculation(function(t){return new rt(t.arg)})},X.prototype.sign=function(){return this.cloneMatrixDoEachCalculation(function(t){return new rt(t.sign())})},X.prototype.floor=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.floor()})},X.prototype.ceil=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.ceil()})},X.prototype.round=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.round()})},X.prototype.fix=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fix()})},X.prototype.fract=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fract()})},X.prototype.abs=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.abs()})},X.prototype.conj=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.conj()})},X.prototype.negate=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.negate()})},X.prototype.pow=function(t){if(this.isScalar())return new X(this.scalar.pow(X._toDouble(t)));if(!this.isSquare())throw"not square "+this;var e,r,n=X._toInteger(t);if(n<0)throw"error negative number "+n;for(e=this.clone(),r=X.eye(this.length);0!==n;)0!=(1&n)&&(r=r.mul(e)),e=e.mul(e),n>>>=1;return r},X.prototype.dotpow=function(t){var r=this,n=X._toMatrix(t);if(!r.isScalar()&&!n.isScalar()&&r.row_length!==n.row_length&&r.column_length!==n.column_length)throw"Matrix size does not match";var i=r.matrix_array,o=n.matrix_array,e=Math.max(r.row_length,n.row_length),a=Math.max(r.column_length,n.column_length);return X.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].pow(o[t%n.row_length][e%n.column_length])},e,a)},X.prototype.sqrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sqrt()})},X.prototype.cbrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cbrt()})},X.prototype.rsqrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.rsqrt()})},X.prototype.log=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log()})},X.prototype.exp=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.exp()})},X.prototype.expm1=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.expm1()})},X.prototype.log1p=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log1p()})},X.prototype.log2=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log2()})},X.prototype.log10=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log10()})},X.prototype.sin=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sin()})},X.prototype.cos=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cos()})},X.prototype.tan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.tan()})},X.prototype.atan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.atan()})},X.prototype.atan2=function(t){var e=X._toComplex(t);return this.cloneMatrixDoEachCalculation(function(t){return t.atan2(e)})},X.prototype.asin=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asin()})},X.prototype.acos=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acos()})},X.prototype.sinh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sinh()})},X.prototype.asinh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asinh()})},X.prototype.cosh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cosh()})},X.prototype.acosh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acosh()})},X.prototype.tanh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.tanh()})},X.prototype.atanh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.atanh()})},X.prototype.sec=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sec()})},X.prototype.asec=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asec()})},X.prototype.sech=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sech()})},X.prototype.asech=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asech()})},X.prototype.cot=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cot()})},X.prototype.acot=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acot()})},X.prototype.coth=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.coth()})},X.prototype.acoth=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acoth()})},X.prototype.csc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.csc()})},X.prototype.acsc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acsc()})},X.prototype.csch=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.csch()})},X.prototype.acsch=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acsch()})},X.prototype.sinc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sinc()})},X.rand=function(t,e,r){return X.createMatrixDoEachCalculation(function(){return rt.rand(r)},t,e)},X.randn=function(t,e,r){return X.createMatrixDoEachCalculation(function(){return rt.randn(r)},t,e)},X.prototype.testInteger=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isInteger(e)?rt.ONE:rt.ZERO})},X.prototype.testComplexInteger=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplexInteger(e)?rt.ONE:rt.ZERO})},X.prototype.testZero=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isZero(e)?rt.ONE:rt.ZERO})},X.prototype.testOne=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isOne(e)?rt.ONE:rt.ZERO})},X.prototype.testComplex=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplex(e)?rt.ONE:rt.ZERO})},X.prototype.testReal=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isReal(e)?rt.ONE:rt.ZERO})},X.prototype.testNaN=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNaN()?rt.ONE:rt.ZERO})},X.prototype.testPositive=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isPositive()?rt.ONE:rt.ZERO})},X.prototype.testNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNegative()?rt.ONE:rt.ZERO})},X.prototype.testNotNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNotNegative()?rt.ONE:rt.ZERO})},X.prototype.testPositiveInfinity=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isPositiveInfinity()?rt.ONE:rt.ZERO})},X.prototype.testNegativeInfinity=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNegativeInfinity()?rt.ONE:rt.ZERO})},X.prototype.testInfinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isInfinite()?rt.ONE:rt.ZERO})},X.prototype.testFinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isFinite()?rt.ONE:rt.ZERO})},X.prototype._rot90=function(t){var e=X._toInteger(t),r=1;if(1===arguments.length&&(r=(e%4+4)%4),0===r)return this;for(var n=new Array(this.row_length),i=0;i<this.row_length;i++){n[i]=new Array(this.column_length);for(var o=0;o<this.column_length;o++)n[i][o]=this.matrix_array[i][o]}var a=this.matrix_array;if(1===r){a.splice(this.column_length);for(var u=0;u<this.column_length;u++){u<this.row_length?a[u].splice(this.row_length):a[u]=new Array(this.row_length);for(var s=0;s<this.row_length;s++)a[u][s]=n[this.row_length-s-1][u]}}else if(2===r)for(var h=0;h<this.row_length;h++)for(var c=0;c<this.column_length;c++)a[h][c]=n[this.row_length-h-1][this.column_length-c-1];else if(3===r){a.splice(this.column_length);for(var l=0;l<this.column_length;l++){l<this.row_length?a[l].splice(this.row_length):a[l]=new Array(this.row_length);for(var f=0;f<this.row_length;f++)a[l][f]=n[f][this.column_length-l-1]}}return this.row_length=a.length,this.column_length=a[0].length,this._clearCash(),this},X.prototype.rot90=function(t){return this.clone()._rot90(t)},X.prototype._resize=function(t,e){var r=X._toInteger(t),n=X._toInteger(e);if(r===this.row_length&&n===this.column_length)return this;if(r<=0||n<=0)throw"_resize";for(var i=Math.max(this.row_length,r),o=Math.max(this.column_length,n),a=this.matrix_array,u=0;u<i;u++){u>=this.row_length&&(a[u]=new Array(o));for(var s=0;s<o;s++)(u>=this.row_length||s>=this.column_length)&&(a[u][s]=rt.ZERO)}if(this.row_length>r&&a.splice(r),this.column_length>n)for(var h=0;h<a.length;h++)a[h].splice(n);return this.row_length=r,this.column_length=n,this._clearCash(),this},X.prototype.resize=function(t,e){return this.clone()._resize(t,e)},X.prototype._deleteRow=function(t){var e=X._toInteger(t);if(1===this.row_length||this.row_length<=e)throw"_deleteRow";return this.matrix_array.splice(e,1),this.row_length--,this._clearCash(),this},X.prototype._deleteColumn=function(t){var e=X._toInteger(t);if(1===this.column_length||this.column_length<=e)throw"_deleteColumn";for(var r=0;r<this.row_length;r++)this.matrix_array[r].splice(e,1);return this.column_length--,this._clearCash(),this},X.prototype.deleteRow=function(t){return this.clone()._deleteRow(t)},X.prototype.deleteColumn=function(t){return this.clone()._deleteColumn(t)},X.prototype._exchangeRow=function(t,e){var r=X._toInteger(t),n=X._toInteger(e);if(1===this.row_length||this.row_length<=r||this.row_length<=n)throw"_exchangeRow";if(r===n)return this;var i=this.matrix_array[r];return this.matrix_array[r]=this.matrix_array[n],this.matrix_array[n]=i,this._clearCash(),this},X.prototype._exchangeColumn=function(t,e){var r=X._toInteger(t),n=X._toInteger(e);if(1===this.column_length||this.column_length<=r||this.column_length<=n)throw"_exchangeColumn";if(r===n)return this;for(var i=0;i<this.row_length;i++){var o=this.matrix_array[i][r];this.matrix_array[i][r]=this.matrix_array[i][n],this.matrix_array[i][n]=o}return this._clearCash(),this},X.prototype.exchangeRow=function(t,e){return this.clone()._exchangeRow(t,e)},X.prototype.exchangeColumn=function(t,e){return this.clone()._exchangeColumn(t,e)},X.prototype._concatRight=function(t){var e=X._toMatrix(t);if(this.row_length!=e.row_length)throw"_concatRight";for(var r=0;r<this.row_length;r++)for(var n=0;n<e.column_length;n++)this.matrix_array[r].push(e.matrix_array[r][n]);return this.column_length+=e.column_length,this._clearCash(),this},X.prototype._concatBottom=function(t){var e=X._toMatrix(t);if(this.column_length!=e.column_length)throw"_concatBottom";for(var r=0;r<e.row_length;r++)this.matrix_array.push(e.matrix_array[r]);return this.row_length+=e.row_length,this._clearCash(),this},X.prototype.concatRight=function(t){return this.clone()._concatRight(t)},X.prototype.concatBottom=function(t){return this.clone()._concatBottom(t)},X.prototype.clip=function(t,e){var o=X._toMatrix(t),a=X._toMatrix(e),u=o.matrix_array,s=a.matrix_array;return this.cloneMatrixDoEachCalculation(function(t,e,r){var n=u[e%o.row_length][r%o.column_length],i=s[e%a.row_length][r%a.column_length];return t.clip(n,i)})},X.arange=function(t,e,r){var n=void 0!==e?X._toComplex(t):rt.ZERO,i=void 0!==e?X._toComplex(e):X._toComplex(t),o=void 0!==r?X._toComplex(r):rt.ONE;return new X($.InterpolationCalculation(n,o,i,!1))},X.prototype.circshift=function(t,e){var i=X._toInteger(t),r=e&&e.dimension?e.dimension:"auto";return this.eachVector(function(t){for(var e=new Array(t.length),r=(-i%t.length+t.length)%t.length,n=0;n<t.length;n++)e[n]=t[r++],r===t.length&&(r=0);return e},r)},X.prototype.roll=function(t,e){return this.circshift(t,e)},X.prototype.reshape=function(t,e){var r=X._toInteger(t),n=X._toInteger(e),i=this.row_length*this.column_length,o=r*n;if(i!=o)throw"reshape error. (this_size !== new_size)->("+i+" !== "+o+")";for(var a=this.matrix_array,u=0,s=0,h=new Array(r),c=0;c<r;c++){h[c]=new Array(n);for(var l=0;l<n;l++)h[c][l]=a[s][u],++u===this.column_length&&(u=0,s++)}return new X(h)},X.prototype.fliplr=function(){return this.flip({dimension:"row"})},X.prototype.flipud=function(){return this.flip({dimension:"column"})},X.prototype.flip=function(t){var e=t&&t.dimension?t.dimension:"auto";return this.eachVector(function(t){for(var e=new Array(t.length),r=0,n=t.length-1;r<t.length;r++,n--)e[r]=t[n];return e},e)},X.prototype.indexsort=function(t){var e=X._toMatrix(t);if(e.isMatrix())throw"argsort error. argsort is not vector. ("+e.toOneLineString+")";var r=!1,n=null,i=null;if(e.isRow()){if(this.column_length!==e.column_length)throw"argsort error. (this_size !== new_size)->("+this.column_length+" !== "+e.column_length+")";r=!0,n=this.transpose().matrix_array,i=e.matrix_array[0]}if(e.isColumn()){if(this.row_length!==e.row_length)throw"argsort error. (this_size !== new_size)->("+this.row_length+" !== "+e.row_length+")";n=this.matrix_array,i=e.transpose().matrix_array[0]}for(var o=new Array(i.length),a=0;a<i.length;a++)o[a]={index:i[a],data:n[a]};var h=[],c=function(t,e,r,n){if(e<r){var i=Math.floor((e+r)/2);c(t,e,i,n),c(t,i+1,r,n);var o,a,u,s=0;for(o=e;o<=i;o++)h[s++]=t[o];for(o=i+1,a=0,u=e;o<=r&&a<s;)0<=n(t[o],h[a])?t[u++]=h[a++]:t[u++]=t[o++];for(;a<s;)t[u++]=h[a++]}return!0};c(o,0,o.length-1,function(t,e){return t.index.compareTo(e.index)});for(var u=new Array(i.length),s=0;s<i.length;s++)u[s]=o[s].data;var l=new X(u);return r?l.transpose():l},X.prototype.transpose=function(){for(var t=new Array(this.column_length),e=0;e<this.column_length;e++){t[e]=new Array(this.row_length);for(var r=0;r<this.row_length;r++)t[e][r]=this.matrix_array[r][e]}return new X(t)},X.prototype.ctranspose=function(){return this.transpose().conj()},X.prototype.T=function(){return this.ctranspose()},X.prototype.inner=function(t,e){return void 0===e&&(e=1),Y.inner(this,t,e)},X.prototype.lup=function(){return Y.lup(this)},X.prototype.lu=function(){return Y.lu(this)},X.prototype.linsolve=function(t){return Y.linsolve(this,t)},X.prototype.qr=function(){return Y.qr(this)},X.prototype.tridiagonalize=function(){return Y.tridiagonalize(this)},X.prototype.eig=function(){return Y.eig(this)},X.prototype.svd=function(){return Y.svd(this)},X.prototype.pinv=function(){return Y.pinv(this)},X.prototype.gammaln=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.gammaln()})},X.prototype.gamma=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.gamma()})},X.prototype.gammainc=function(t,e){var r=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.gammainc(r,e)})},X.prototype.gampdf=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.gampdf(r,n)})},X.prototype.gamcdf=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.gamcdf(r,n)})},X.prototype.gaminv=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.gaminv(r,n)})},X.prototype.beta=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.beta(e)})},X.prototype.betainc=function(t,e,r){var n=X._toDouble(t),i=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.betainc(n,i,r)})},X.prototype.betacdf=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.betacdf(r,n)})},X.prototype.betapdf=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.betapdf(r,n)})},X.prototype.betainv=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.betainv(r,n)})},X.prototype.factorial=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.factorial()})},X.prototype.nchoosek=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.nchoosek(e)})},X.prototype.erf=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erf()})},X.prototype.erfc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erfc()})},X.prototype.erfinv=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erfinv()})},X.prototype.erfcinv=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erfcinv()})},X.prototype.normpdf=function(t,e){var r=void 0!==t?X._toDouble(t):0,n=void 0!==e?X._toDouble(e):1;return this.cloneMatrixDoEachCalculation(function(t){return t.normpdf(r,n)})},X.prototype.normcdf=function(t,e){var r=void 0!==t?X._toDouble(t):0,n=void 0!==e?X._toDouble(e):1;return this.cloneMatrixDoEachCalculation(function(t){return t.normcdf(r,n)})},X.prototype.norminv=function(t,e){var r=void 0!==t?X._toDouble(t):0,n=void 0!==e?X._toDouble(e):1;return this.cloneMatrixDoEachCalculation(function(t){return t.norminv(r,n)})},X.prototype.binopdf=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.binopdf(r,n)})},X.prototype.binocdf=function(t,e,r){var n=X._toDouble(t),i=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.binocdf(n,i,r)})},X.prototype.binoinv=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.binoinv(r,n)})},X.prototype.poisspdf=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.poisspdf(e)})},X.prototype.poisscdf=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.poisscdf(e)})},X.prototype.poissinv=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.poissinv(e)})},X.prototype.tpdf=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tpdf(e)})},X.prototype.tcdf=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tcdf(e)})},X.prototype.tinv=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tinv(e)})},X.prototype.tdist=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.tdist(r,n)})},X.prototype.tinv2=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tinv2(e)})},X.prototype.chi2pdf=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.chi2pdf(e)})},X.prototype.chi2cdf=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.chi2cdf(e)})},X.prototype.chi2inv=function(t){var e=X._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.chi2inv(e)})},X.prototype.fpdf=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.fpdf(r,n)})},X.prototype.fcdf=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.fcdf(r,n)})},X.prototype.finv=function(t,e){var r=X._toDouble(t),n=X._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.finv(r,n)})},X.prototype.and=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.and(X._toDouble(e))})},X.prototype.or=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.or(X._toDouble(e))})},X.prototype.xor=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.xor(X._toDouble(e))})},X.prototype.not=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.not()})},X.prototype.shift=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.shift(X._toDouble(e))})},X.prototype.gcd=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.gcd(X._toDouble(e))})},X.prototype.extgcd=function(t){if(!this.isScalar())throw"IllegalArgumentException";var e=this.scalar,r=X._toDouble(t),n=e.extgcd(r);return[new X(n[0]),new X(n[1]),new X(n[2])]},X.prototype.lcm=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.lcm(X._toDouble(e))})},X.prototype.modPow=function(e,r){return this.cloneMatrixDoEachCalculation(function(t){return t.modPow(X._toDouble(e),X._toDouble(r))})},X.prototype.modInverse=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.modInverse(X._toDouble(e))})},X.prototype.testPrime=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isPrime()?rt.ONE:rt.ZERO})},X.prototype.testProbablePrime=function(t){var e=void 0!==t?Math.round(rt._toDouble(t)):void 0;return this.cloneMatrixDoEachCalculation(function(t){return t.isProbablePrime(e)?rt.ONE:rt.ZERO})},X.prototype.nextProbablePrime=function(t,e){var r=void 0!==t?Math.round(X._toDouble(t)):void 0,n=void 0!==e?Math.round(X._toDouble(e)):void 0;return this.cloneMatrixDoEachCalculation(function(t){return t.nextProbablePrime(r,n)})},X.prototype.max=function(t){return U.max(this,t)},X.prototype.min=function(t){return U.min(this,t)},X.prototype.sum=function(t){return U.sum(this,t)},X.prototype.mean=function(t){return U.mean(this,t)},X.prototype.prod=function(t){return U.prod(this,t)},X.prototype.geomean=function(t){return U.geomean(this,t)},X.prototype.median=function(t){return U.median(this,t)},X.prototype.mode=function(t){return U.mode(this,t)},X.prototype.moment=function(t,e){return U.moment(this,t,e)},X.prototype.var=function(t){return U.var(this,t)},X.prototype.std=function(t){return U.std(this,t)},X.prototype.mad=function(t,e){return U.mad(this,t,e)},X.prototype.skewness=function(t){return U.skewness(this,t)},X.prototype.cov=function(t,e){return U.cov(this,t,e)},X.prototype.standardization=function(t){return U.standardization(this,t)},X.prototype.corrcoef=function(t,e){return U.corrcoef(this,t,e)},X.prototype.sort=function(t,e){return U.sort(this,t,e)},X.prototype.fft=function(t){return Q.fft(this,t)},X.prototype.ifft=function(t){return Q.ifft(this,t)},X.prototype.powerfft=function(t){return Q.powerfft(this,t)},X.prototype.dct=function(t){return Q.dct(this,t)},X.prototype.idct=function(t){return Q.idct(this,t)},X.prototype.fft2=function(){return Q.fft2(this)},X.prototype.ifft2=function(){return Q.ifft2(this)},X.prototype.dct2=function(){return Q.dct2(this)},X.prototype.idct2=function(){return Q.idct2(this)},X.prototype.conv=function(t){return Q.conv(this,t)},X.prototype.xcorr=function(t){return Q.xcorr(this,t)},X.window=function(t,e,r){return Q.window(t,e,r)},X.hann=function(t,e){return Q.hann(t,e)},X.hamming=function(t,e){return Q.hamming(t,e)},X.prototype.fftshift=function(t){return Q.fftshift(this,t)},K.ONE.get=function(){return new X(1)},K.TWO.get=function(){return new X(2)},K.TEN.get=function(){return new X(10)},K.ZERO.get=function(){return new X(0)},K.MINUS_ONE.get=function(){return new X(-1)},K.I.get=function(){return new X(rt.I)},K.PI.get=function(){return new X(Math.PI)},K.QUARTER_PI.get=function(){return new X(.25*Math.PI)},K.HALF_PI.get=function(){return new X(.5*Math.PI)},K.TWO_PI.get=function(){return new X(2*Math.PI)},K.E.get=function(){return new X(Math.E)},K.LN2.get=function(){return new X(Math.LN2)},K.LN10.get=function(){return new X(Math.LN10)},K.LOG2E.get=function(){return new X(Math.LOG2E)},K.LOG10E.get=function(){return new X(Math.LOG10E)},K.SQRT2.get=function(){return new X(Math.SQRT2)},K.SQRT1_2.get=function(){return new X(Math.SQRT1_2)},K.HALF.get=function(){return new X(.5)},K.POSITIVE_INFINITY.get=function(){return new X(Number.POSITIVE_INFINITY)},K.NEGATIVE_INFINITY.get=function(){return new X(Number.NEGATIVE_INFINITY)},K.NaN.get=function(){return new X(Number.NaN)},X.prototype.signum=function(){return this.sign()},X.prototype.subtract=function(t){return this.sub(t)},X.prototype.multiply=function(t){return this.mul(t)},X.prototype.divide=function(t){return this.div(t)},X.prototype.remainder=function(t){return this.rem(t)},X.prototype.trunc=function(){return this.fix()},Object.defineProperties(X.prototype,J),Object.defineProperties(X,K);function tt(){}var et=new v;tt.ToComplexFromString=function(t){var e=t.replace(/\s/g,"").toLowerCase();if(e=e.replace(/infinity|inf/g,"1e100000"),!/[ij]/.test(e))return{real:parseFloat(e),imag:0};var r,n=0,i=0;return(r=e.match(/[+-]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))($|[+-])/))&&(n=parseFloat(r[0])),(r=e.match(/[+-]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij]/))&&(r=r[0].substring(0,r[0].length-1),i=/^[-+]$/.test(r)||0===r.length?"-"===r?-1:1:parseFloat(r)),{real:n,imag:i}};var rt=function t(e){if(1!==arguments.length)throw"Complex Many arguments : "+arguments.length;var r=e;if(r instanceof t)this._re=r._re,this._im=r._im;else if("number"==typeof r)this._re=r,this._im=0;else if("string"==typeof r){var n=tt.ToComplexFromString(r);this._re=n.real,this._im=n.imag}else if(r instanceof Array){if(2!==r.length)throw"Complex Unsupported argument "+arguments;this._re=r[0],this._im=r[1]}else if("boolean"==typeof r)this._re=r?1:0,this._im=0;else if("doubleValue"in r)this._re=r.doubleValue,this._im=0;else if("_re"in r&&"_im"in r)this._re=r._re,this._im=r._im;else{if(!(r instanceof Object))throw"Complex Unsupported argument "+arguments;var i=tt.ToComplexFromString(r.toString());this._re=i.real,this._im=i.imag}},nt={booleanValue:{configurable:!0},intValue:{configurable:!0},doubleValue:{configurable:!0},real:{configurable:!0},imag:{configurable:!0},norm:{configurable:!0},arg:{configurable:!0}},it={ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},ZERO:{configurable:!0},MINUS_ONE:{configurable:!0},I:{configurable:!0},MINUS_I:{configurable:!0},PI:{configurable:!0},QUARTER_PI:{configurable:!0},HALF_PI:{configurable:!0},TWO_PI:{configurable:!0},E:{configurable:!0},LN2:{configurable:!0},LN10:{configurable:!0},LOG2E:{configurable:!0},LOG10E:{configurable:!0},SQRT2:{configurable:!0},SQRT1_2:{configurable:!0},HALF:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};rt.create=function(t){return t instanceof rt?t:new rt(t)},rt.valueOf=function(t){return rt.create(t)},rt._toComplex=function(t){return t instanceof rt?t:t instanceof X?X._toComplex(t):new rt(t)},rt._toDouble=function(t){if("number"==typeof t)return t;var e=rt._toComplex(t);if(e.isReal())return e.real;throw"not support complex numbers.["+t+"]"},rt._toInteger=function(t){return Math.trunc(rt._toDouble(t))},nt.booleanValue.get=function(){return 0!==this._re||0!==this._im},nt.intValue.get=function(){return Math.trunc(this._re)},nt.doubleValue.get=function(){return this._re},rt.prototype.clone=function(){return this},rt.prototype.toString=function(){function t(t){var e=t.toPrecision(6);if(-1!==e.indexOf("."))e=(e=e.replace(/\.?0+$/,"")).replace(/\.?0+e/,"e");else{if(/inf/i.test(e))return t===Number.POSITIVE_INFINITY?"Inf":"-Inf";if(/nan/i.test(e))return"NaN"}return e}return this.isReal()?t(this._re):0===this._re?t(this._im)+"i":0<=this._im||Number.isNaN(this._im)?t(this._re)+" + "+t(this._im)+"i":t(this._re)+" - "+t(-this._im)+"i"},nt.real.get=function(){return this._re},nt.imag.get=function(){return this._im},nt.norm.get=function(){return 0===this._im?Math.abs(this._re):0===this._re?Math.abs(this._im):Math.sqrt(this._re*this._re+this._im*this._im)},nt.arg.get=function(){return 0===this._im?0<=this._re?0:Math.PI:0===this._re?Math.PI*(0<=this._im?.5:-.5):Math.atan2(this._im,this._re)},rt.prototype.getDecimalPosition=function(){function t(t){if(!Number.isFinite(t))return 0;for(var e=t,r=0,n=0;n<20&&!(Math.abs(e-Math.round(e))<=Number.EPSILON);n++)e*=10,r++;return r}return Math.max(t(this.real),t(this.imag))},rt.prototype.sign=function(){return this.isFinite()?0===this._im?0===this._re?rt.ZERO:new rt(0<this._re?1:-1):this.div(this.norm):this.isNaN()||this._im===1/0||this._im===-1/0?rt.NaN:this._re===1/0?rt.ONE:rt.MINUS_ONE},rt.prototype.add=function(t){var e=new rt(t);return e._re=this._re+e._re,e._im=this._im+e._im,e},rt.prototype.sub=function(t){var e=new rt(t);return e._re=this._re-e._re,e._im=this._im-e._im,e},rt.prototype.mul=function(t){var e=new rt(t);if(0===this._im&&0===e._im)return e._re=this._re*e._re,e;if(0===this._re&&0===e._re)return e._re=-this._im*e._im,e._im=0,e;var r=this._re*e._re-this._im*e._im,n=this._im*e._re+this._re*e._im;return e._re=r,e._im=n,e},rt.prototype.dot=function(t){var e=new rt(t);if(0===this._im&&0===e._im)return e._re=this._re*e._re,e;if(0===this._re&&0===e._re)return e._re=this._im*e._im,e._im=0,e;var r=this._re*e._re+this._im*e._im,n=-this._im*e._re+this._re*e._im;return e._re=r,e._im=n,e},rt.prototype.div=function(t){var e=new rt(t);if(0===this._im&&0===e._im)return e._re=this._re/e._re,e;if(0===this._re&&0===e._re)return e._re=this._im/e._im,e._im=0,e;var r=this._re*e._re+this._im*e._im,n=this._im*e._re-this._re*e._im,i=1/(e._re*e._re+e._im*e._im);return e._re=r*i,e._im=n*i,e},rt.prototype.rem=function(t){var e=new rt(t);if(0!==this._im||0!==e._im)throw"calculation method is undefined.";return this.isFinite()&&e.isFinite()&&!e.isZero()?(e._re=this._re-e._re*Math.trunc(this._re/e._re),e):rt.NaN},rt.prototype.mod=function(t){var e=new rt(t);if(0!==this._im||0!==e._im)throw"calculation method is undefined.";if(e.isZero())return this;var r=this.rem(e);return this.equalsState(e)?r:r.add(e)},rt.prototype.inv=function(){return 0===this._im?new rt(1/this._re):0===this._re?new rt([0,-1/this._im]):rt.ONE.div(this)},rt.prototype.equals=function(t,e){var r=rt._toComplex(t);if(this.isNaN()||r.isNaN())return!1;if(this._re===r._re&&this._im===r._im)return!0;var n=e?rt._toDouble(e):Number.EPSILON;return Math.abs(this._re-r._re)<n&&Math.abs(this._im-r._im)<n},rt.prototype.equalsState=function(t){function e(t){return t.isZero()?0:t.isFinite()?t.isPositive()?1:2:t.isPositiveInfinity()?4:t.isNegativeInfinity()?5:3}var r=rt._toComplex(t);return e(this)===e(r)},rt.prototype.compareTo=function(t,e){var r=this,n=rt._toComplex(t);if(!r.isFinite()||!n.isFinite())return r.equals(n)?0:r.isNaN()||n.isNaN()||r.real===1/0&&r.imag===-1/0||r.real===-1/0&&r.imag===1/0||n.real===1/0&&n.imag===-1/0||n.real===-1/0&&n.imag===1/0?NaN:r.isFinite()?n.real+n.imag<0?1:-1:n.isFinite()?0<r.real+r.imag?1:-1:NaN;var i=e?rt._toDouble(e):Number.EPSILON,o=r.real+r.imag,a=n.real+n.imag;return Math.abs(o-a)<=i?0:a<o?1:-1},rt.prototype.max=function(t){var e=rt._toComplex(t);return 0<=this.compareTo(e)?this:e},rt.prototype.min=function(t){var e=rt._toComplex(t);return this.compareTo(e)<=0?this:e},rt.prototype.clip=function(t,e){var r=rt._toComplex(t),n=rt._toComplex(e),i=r.compareTo(n);if(1===i)throw"clip(min, max) error. (min > max)->("+r+" > "+n+")";return 0===i?r:1===this.compareTo(n)?n:-1===this.compareTo(r)?r:this},rt.prototype.floor=function(){return new rt([Math.floor(this._re),Math.floor(this._im)])},rt.prototype.ceil=function(){return new rt([Math.ceil(this._re),Math.ceil(this._im)])},rt.prototype.round=function(){return new rt([Math.round(this._re),Math.round(this._im)])},rt.prototype.fix=function(){return new rt([Math.trunc(this._re),Math.trunc(this._im)])},rt.prototype.fract=function(){return new rt([this._re-Math.floor(this._re),this._im-Math.floor(this._im)])},rt.prototype.abs=function(){return new rt(this.norm)},rt.prototype.conj=function(){return 0===this._im?this:new rt([this._re,-this._im])},rt.prototype.negate=function(){return new rt([-this._re,-this._im])},rt.prototype.pow=function(t){var e=new rt(t);if(e.isReal()){if(this.isReal()&&(this.isNotNegative()||e.isInteger()))return e._re=Math.pow(this._re,e._re),e;var r=Math.pow(this.norm,e._re),n=this.arg*e._re;return e._re=r*Math.cos(n),e._im=r*Math.sin(n),e}return e.mul(this.log()).exp()},rt.prototype.square=function(){return 0===this._im?new rt(this._re*this._re):this.mul(this)},rt.prototype.sqrt=function(){if(this.isReal())return this.isNotNegative()?new rt(Math.sqrt(this._re)):new rt([0,Math.sqrt(-this._re)]);var t=Math.sqrt(this.norm),e=.5*this.arg;return new rt([t*Math.cos(e),t*Math.sin(e)])},rt.prototype.cbrt=function(t){var e=rt._toInteger(void 0!==t?t:0),r=this.log().div(3).exp();return 0===e?r:1===e?r.mul([-.5,.5*Math.sqrt(3)]):r.mul([-.5,.5*-Math.sqrt(3)])},rt.prototype.rsqrt=function(){return this.isReal()?this.isNotNegative()?new rt(1/Math.sqrt(this._re)):new rt([0,-1/Math.sqrt(-this._re)]):this.sqrt().inv()},rt.prototype.log=function(){return this.isReal()&&this.isNotNegative()?new rt(Math.log(this._re)):new rt([Math.log(this.norm),this.arg])},rt.prototype.exp=function(){if(this.isReal())return new rt(Math.exp(this._re));var t=Math.exp(this._re);return new rt([t*Math.cos(this._im),t*Math.sin(this._im)])},rt.prototype.expm1=function(){return this.exp().sub(1)},rt.prototype.log1p=function(){return this.add(1).log()},rt.prototype.log2=function(){return this.log().div(rt.LN2)},rt.prototype.log10=function(){return this.log().div(rt.LN10)},rt.prototype.sin=function(){if(this.isReal())return new rt(Math.sin(this._re));var t=this.mul(rt.I).exp(),e=this.mul(rt.I.negate()).exp();return t.sub(e).div([0,2])},rt.prototype.cos=function(){if(this.isReal())return new rt(Math.cos(this._re));var t=this.mul(rt.I).exp(),e=this.mul(rt.I.negate()).exp();return t.add(e).div(2)},rt.prototype.tan=function(){return this.isReal()?new rt(Math.tan(this._re)):this.sin().div(this.cos())},rt.prototype.atan=function(){return this.isReal()?new rt(Math.atan(this._re)):rt.I.div(rt.TWO).mul(rt.I.add(this).div(rt.I.sub(this)).log())},rt.prototype.atan2=function(t){if(0===arguments.length)return new rt(this.arg);var e=rt._toComplex(t);if(this.isReal()&&e.isReal())return new rt(Math.atan2(this._re,e._re));throw"calculation method is undefined."},rt.prototype.asin=function(){return this.mul(rt.I).add(rt.ONE.sub(this.square()).sqrt()).log().mul(rt.MINUS_I)},rt.prototype.acos=function(){return this.add(rt.I.mul(rt.ONE.sub(this.square()).sqrt())).log().mul(rt.MINUS_I)},rt.prototype.sinh=function(){var t=this.exp();return t.sub(t.inv()).mul(.5)},rt.prototype.asinh=function(){return this.isInfinite()?this:this.add(this.mul(this).add(1).sqrt()).log()},rt.prototype.cosh=function(){return this.exp().add(this.negate().exp()).mul(.5)},rt.prototype.acosh=function(){return this.isZero()?new rt([0,.5*Math.PI]):1<=this.compareTo(rt.ONE)?this.add(this.square().sub(1).sqrt()).log():this.sub(this.square().sub(1).sqrt()).log()},rt.prototype.tanh=function(){if(this.isNaN())return rt.NaN;var t=this.mul(2).exp();return t.isZero()?rt.MINUS_ONE:t.isPositiveInfinity()?rt.ONE:t.sub(1).div(t.add(1))},rt.prototype.atanh=function(){return this.isInfinite()&&this.isReal()?new rt([0,.5*Math.PI]):this.add(1).div(this.negate().add(1)).log().mul(.5)},rt.prototype.sec=function(){return this.cos().inv()},rt.prototype.asec=function(){return this.inv().acos()},rt.prototype.sech=function(){return this.exp().add(this.negate().exp()).inv().mul(2)},rt.prototype.asech=function(){return this.isInfinite()&&this.isReal()?new rt([0,.5*Math.PI]):this.isPositive()||-1==this.compareTo(rt.MINUS_ONE)?this.inv().add(this.square().inv().sub(1).sqrt()).log():this.inv().sub(this.square().inv().sub(1).sqrt()).log()},rt.prototype.cot=function(){return this.tan().inv()},rt.prototype.acot=function(){return this.inv().atan()},rt.prototype.coth=function(){return this.isZero()?rt.POSITIVE_INFINITY:this.tanh().inv()},rt.prototype.acoth=function(){return this.isInfinite()?rt.ZERO:this.add(1).div(this.sub(1)).log().mul(.5)},rt.prototype.csc=function(){return this.sin().inv()},rt.prototype.acsc=function(){return this.inv().asin()},rt.prototype.csch=function(){return this.exp().sub(this.negate().exp()).inv().mul(2)},rt.prototype.acsch=function(){return this.inv().add(this.square().inv().add(1).sqrt()).log()},rt.prototype.sinc=function(){if(this.isReal()){if(0===this._re)return rt.ONE;var t=Math.PI*this._re;return new rt(Math.sin(t)/t)}var e=this.mul(rt.PI);return new rt(e.sin().div(e))},rt.rand=function(t){var e=void 0!==t&&t instanceof v?t:et;return new rt(e.nextDouble())},rt.randn=function(t){return new rt((void 0!==t&&t instanceof v?t:et).nextGaussian())},rt.prototype.isInteger=function(t){var e=t?rt._toDouble(t):Number.EPSILON;return this.isReal()&&Math.abs(this._re-Math.trunc(this._re))<e},rt.prototype.isComplexInteger=function(t){var e=t?rt._toDouble(t):Number.EPSILON;return Math.abs(this._re-Math.trunc(this._re))<e&&Math.abs(this._im-Math.trunc(this._im))<e},rt.prototype.isZero=function(t){var e=t?rt._toDouble(t):Number.EPSILON;return Math.abs(this._re)<e&&Math.abs(this._im)<e},rt.prototype.isOne=function(t){var e=t?rt._toDouble(t):Number.EPSILON;return Math.abs(this._re-1)<e&&Math.abs(this._im)<e},rt.prototype.isComplex=function(t){var e=t?rt._toDouble(t):Number.EPSILON;return Math.abs(this._im)>=e},rt.prototype.isReal=function(t){var e=t?rt._toDouble(t):Number.EPSILON;return Math.abs(this._im)<e},rt.prototype.isNaN=function(){return isNaN(this._re)||isNaN(this._im)},rt.prototype.isPositive=function(){return 0<this._re},rt.prototype.isNegative=function(){return this._re<0},rt.prototype.isNotNegative=function(){return 0<=this._re},rt.prototype.isPositiveInfinity=function(){return this._re===Number.POSITIVE_INFINITY||this._im===Number.POSITIVE_INFINITY},rt.prototype.isNegativeInfinity=function(){return this._re===Number.NEGATIVE_INFINITY||this._im===Number.NEGATIVE_INFINITY},rt.prototype.isInfinite=function(){return this.isPositiveInfinity()||this.isNegativeInfinity()},rt.prototype.isFinite=function(){return!this.isNaN()&&!this.isInfinite()},rt.prototype.gammaln=function(){return new rt(m.gammaln(this._re))},rt.prototype.gamma=function(){return new rt(m.gamma(this._re))},rt.prototype.gammainc=function(t,e){var r=rt._toDouble(t);return new rt(m.gammainc(this._re,r,e))},rt.prototype.gampdf=function(t,e){var r=rt._toDouble(t),n=rt._toDouble(e);return new rt(m.gampdf(this._re,r,n))},rt.prototype.gamcdf=function(t,e){var r=rt._toDouble(t),n=rt._toDouble(e);return new rt(m.gamcdf(this._re,r,n))},rt.prototype.gaminv=function(t,e){var r=rt._toDouble(t),n=rt._toDouble(e);return new rt(m.gaminv(this._re,r,n))},rt.prototype.beta=function(t){var e=rt._toDouble(t);return new rt(m.beta(this._re,e))},rt.prototype.betainc=function(t,e,r){var n=rt._toDouble(t),i=rt._toDouble(e);return new rt(m.betainc(this._re,n,i,r))},rt.prototype.betapdf=function(t,e){var r=rt._toDouble(t),n=rt._toDouble(e);return new rt(m.betapdf(this._re,r,n))},rt.prototype.betacdf=function(t,e){var r=rt._toDouble(t),n=rt._toDouble(e);return new rt(m.betacdf(this._re,r,n))},rt.prototype.betainv=function(t,e){var r=rt._toDouble(t),n=rt._toDouble(e);return new rt(m.betainv(this._re,r,n))},rt.prototype.factorial=function(){return new rt(m.factorial(this._re))},rt.prototype.nchoosek=function(t){var e=rt._toDouble(t);return new rt(m.nchoosek(this._re,e))},rt.prototype.erf=function(){return new rt(m.erf(this._re))},rt.prototype.erfc=function(){return new rt(m.erfc(this._re))},rt.prototype.erfinv=function(){return new rt(m.erfinv(this._re))},rt.prototype.erfcinv=function(){return new rt(m.erfcinv(this._re))},rt.prototype.normpdf=function(t,e){var r=void 0!==t?rt._toDouble(t):0,n=void 0!==e?rt._toDouble(e):1;return new rt(m.normpdf(this._re,r,n))},rt.prototype.normcdf=function(t,e){var r=void 0!==t?rt._toDouble(t):0,n=void 0!==e?rt._toDouble(e):1;return new rt(m.normcdf(this._re,r,n))},rt.prototype.norminv=function(t,e){var r=void 0!==t?rt._toDouble(t):0,n=void 0!==e?rt._toDouble(e):1;return new rt(m.norminv(this._re,r,n))},rt.prototype.binopdf=function(t,e){var r=rt._toDouble(t),n=rt._toDouble(e);return new rt(m.binopdf(this._re,r,n))},rt.prototype.binocdf=function(t,e,r){var n=rt._toDouble(t),i=rt._toDouble(e);return new rt(m.binocdf(this._re,n,i,r))},rt.prototype.binoinv=function(t,e){var r=rt._toDouble(t),n=rt._toDouble(e);return new rt(m.binoinv(this._re,r,n))},rt.prototype.poisspdf=function(t){var e=rt._toDouble(t);return new rt(m.poisspdf(this._re,e))},rt.prototype.poisscdf=function(t){var e=rt._toDouble(t);return new rt(m.poisscdf(this._re,e))},rt.prototype.poissinv=function(t){var e=rt._toDouble(t);return new rt(m.poissinv(this._re,e))},rt.prototype.tpdf=function(t){var e=rt._toDouble(t);return new rt(m.tpdf(this._re,e))},rt.prototype.tcdf=function(t){var e=rt._toDouble(t);return new rt(m.tcdf(this._re,e))},rt.prototype.tinv=function(t){var e=rt._toDouble(t);return new rt(m.tinv(this._re,e))},rt.prototype.tdist=function(t,e){var r=rt._toDouble(t),n=rt._toInteger(e);return new rt(m.tdist(this._re,r,n))},rt.prototype.tinv2=function(t){var e=rt._toDouble(t);return new rt(m.tinv2(this._re,e))},rt.prototype.chi2pdf=function(t){var e=rt._toDouble(t);return new rt(m.chi2pdf(this._re,e))},rt.prototype.chi2cdf=function(t){var e=rt._toDouble(t);return new rt(m.chi2cdf(this._re,e))},rt.prototype.chi2inv=function(t){var e=rt._toDouble(t);return new rt(m.chi2inv(this._re,e))},rt.prototype.fpdf=function(t,e){var r=rt._toDouble(t),n=rt._toDouble(e);return new rt(m.fpdf(this._re,r,n))},rt.prototype.fcdf=function(t,e){var r=rt._toDouble(t),n=rt._toDouble(e);return new rt(m.fcdf(this._re,r,n))},rt.prototype.finv=function(t,e){var r=rt._toDouble(t),n=rt._toDouble(e);return new rt(m.finv(this._re,r,n))},rt.prototype.and=function(t){var e=Math.round(this.real),r=Math.round(rt._toDouble(t));return new rt(e&r)},rt.prototype.or=function(t){var e=Math.round(this.real),r=Math.round(rt._toDouble(t));return new rt(e|r)},rt.prototype.xor=function(t){var e=Math.round(this.real),r=Math.round(rt._toDouble(t));return new rt(e^r)},rt.prototype.not=function(){var t=Math.round(this.real);return new rt(!t)},rt.prototype.shift=function(t){var e=Math.round(this.real),r=Math.round(rt._toDouble(t));return new rt(e<<r)},rt.prototype.gcd=function(t){var e=Math.round(this.real),r=Math.round(rt._toDouble(t)),n=new w(e).gcd(r);return new rt(n)},rt.prototype.extgcd=function(t){var e=Math.round(this.real),r=Math.round(rt._toDouble(t)),n=new w(e).extgcd(r);return[new rt(n[0]),new rt(n[1]),new rt(n[2])]},rt.prototype.lcm=function(t){var e=Math.round(this.real),r=Math.round(rt._toDouble(t)),n=new w(e).lcm(r);return new rt(n)},rt.prototype.modPow=function(t,e){var r=Math.round(this.real),n=Math.round(rt._toDouble(t)),i=Math.round(rt._toDouble(e)),o=new w(r).modPow(n,i);return new rt(o)},rt.prototype.modInverse=function(t){var e=Math.round(this.real),r=Math.round(rt._toDouble(t)),n=new w(e).modInverse(r);return new rt(n)},rt.prototype.isPrime=function(){return new w(Math.round(this.real)).isPrime()},rt.prototype.isProbablePrime=function(t){return new w(Math.round(this.real)).isProbablePrime(void 0!==t?Math.round(rt._toDouble(t)):void 0)},rt.prototype.nextProbablePrime=function(t,e){var r=new w(Math.round(this.real)),n=void 0!==t?Math.round(rt._toDouble(t)):void 0,i=void 0!==e?Math.round(rt._toDouble(e)):void 0;return new rt(r.nextProbablePrime(n,i))},it.ONE.get=function(){return at.ONE},it.TWO.get=function(){return at.TWO},it.TEN.get=function(){return at.TEN},it.ZERO.get=function(){return at.ZERO},it.MINUS_ONE.get=function(){return at.MINUS_ONE},it.I.get=function(){return at.I},it.MINUS_I.get=function(){return at.MINUS_I},it.PI.get=function(){return at.PI},it.QUARTER_PI.get=function(){return at.QUARTER_PI},it.HALF_PI.get=function(){return at.HALF_PI},it.TWO_PI.get=function(){return at.TWO_PI},it.E.get=function(){return at.E},it.LN2.get=function(){return at.LN2},it.LN10.get=function(){return at.LN10},it.LOG2E.get=function(){return at.LOG2E},it.LOG10E.get=function(){return at.LOG10E},it.SQRT2.get=function(){return at.SQRT2},it.SQRT1_2.get=function(){return at.SQRT1_2},it.HALF.get=function(){return at.HALF},it.POSITIVE_INFINITY.get=function(){return at.POSITIVE_INFINITY},it.NEGATIVE_INFINITY.get=function(){return at.NEGATIVE_INFINITY},it.NaN.get=function(){return at.NaN},rt.prototype.signum=function(){return this.sign()},rt.prototype.subtract=function(t){return this.sub(t)},rt.prototype.multiply=function(t){return this.mul(t)},rt.prototype.divide=function(t){return this.div(t)},rt.prototype.remainder=function(t){return this.rem(t)},rt.prototype.trunc=function(){return this.fix()},Object.defineProperties(rt.prototype,nt),Object.defineProperties(rt,it);function ot(){}var at={ZERO:new rt(0),ONE:new rt(1),TWO:new rt(2),TEN:new rt(10),MINUS_ONE:new rt(-1),I:new rt([0,1]),MINUS_I:new rt([0,-1]),PI:new rt(Math.PI),QUARTER_PI:new rt(.25*Math.PI),HALF_PI:new rt(.5*Math.PI),TWO_PI:new rt(2*Math.PI),E:new rt(Math.E),LN2:new rt(Math.LN2),LN10:new rt(Math.LN10),LOG2E:new rt(Math.LOG2E),LOG10E:new rt(Math.LOG10E),SQRT2:new rt(Math.SQRT2),SQRT1_2:new rt(Math.SQRT1_2),HALF:new rt(.5),POSITIVE_INFINITY:new rt(Number.POSITIVE_INFINITY),NEGATIVE_INFINITY:new rt(Number.NEGATIVE_INFINITY),NaN:new rt(Number.NaN)};ot.runMultipleRegressionAnalysis=function(t){var e=X.create(t.samples),r=X.create(t.target),n={correction:1};t.is_standardised&&(e=e.standardization(),r=r.standardization());var i=X.create(e.width),o=X.create(e.height),a=e.cov(n),u=a.rcond();if(u<=1e-10)return console.log("Analysis failed due to highly correlated explanatory variables.(rcond : "+u+")"),null;for(var s=[],h=i.intValue,c=0;c<h;c++)s[c]=[e.getMatrix(":",c).cov(r,n)];for(var l=X.create(s),f=a.inv().mul(l),g=r.mean().sub(e.mean().mul(f)),p=e.mul(f).add(g),m=p.var(n),_=r.var(n),v=p.corrcoef(r,n),N=m.div(_),d=i,I=p.sub(r.mean()).dotpow(2).sum(),y=I.div(d),w=o.sub(i).sub(1),b=p.sub(r).dotpow(2).sum(),E=b.div(w),x=o.sub(1),M=r.sub(r.mean()).dotpow(2).sum(),T=M.div(x),O=E,F=O.sqrt(),P=y.div(E),D=X.ONE.sub(P.fcdf(d,w)),A=X.ONE.sub(E.div(T)),S=o.mul(b.div(o).mul(2*Math.PI).log().add(1)).add(i.add(2).mul(2)),V=a.dotmul(o).inv(),R={coefficient:X.ZERO,standard_error:X.ZERO,t_stat:X.ZERO,p_value:X.ZERO,lower_95:X.ZERO,upper_95:X.ZERO},C=[],Z=0;Z<h;Z++)C[Z]={coefficient:X.ZERO,standard_error:X.ZERO,t_stat:X.ZERO,p_value:X.ZERO,lower_95:X.ZERO,upper_95:X.ZERO};R.coefficient=g;for(var L=0;L<h;L++)C[L].coefficient=new X(f.getComplex(L));for(var B=i.intValue,q=o.inv(),Y=0;Y<B;Y++)for(var U=0;U<B;U++)q=q.add(e.getMatrix(":",Y).mean().mul(e.getMatrix(":",U).mean()).mul(V.getMatrix(Y,U)));R.standard_error=q.mul(O).sqrt();for(var z=0;z<h;z++)C[z].standard_error=V.getMatrix(z,z).mul(O).sqrt();function G(t){t.t_stat=t.coefficient.div(t.standard_error),t.p_value=t.t_stat.tdist(w,2);var e=new X(1-.95);t.lower_95=t.coefficient.sub(e.tinv2(w).mul(t.standard_error)),t.upper_95=t.coefficient.add(e.tinv2(w).mul(t.standard_error))}G(R);for(var H=0;H<h;H++)G(C[H]);for(var j,k={coefficient:R.coefficient.doubleValue,standard_error:R.standard_error.doubleValue,t_stat:R.t_stat.doubleValue,p_value:R.p_value.doubleValue,lower_95:R.lower_95.doubleValue,upper_95:R.upper_95.doubleValue},W=[],Q=0;Q<h;Q++)W.push({coefficient:C[Q].coefficient.doubleValue,standard_error:C[Q].standard_error.doubleValue,t_stat:C[Q].t_stat.doubleValue,p_value:C[Q].p_value.doubleValue,lower_95:C[Q].lower_95.doubleValue,upper_95:C[Q].upper_95.doubleValue});return j={intercept:k,parameters:W},{q:i.doubleValue,n:o.doubleValue,predicted_values:p.getNumberMatrixArray(),sY:m.doubleValue,sy:_.doubleValue,multiple_R:v.doubleValue,R_square:N.doubleValue,adjusted_R_square:A.doubleValue,ANOVA:{regression:{df:d.doubleValue,SS:I.doubleValue,MS:y.doubleValue},residual:{df:w.doubleValue,SS:b.doubleValue,MS:E.doubleValue},total:{df:x.doubleValue,SS:M.doubleValue,MS:T.doubleValue},F:P.doubleValue,significance_F:D.doubleValue},Ve:O.doubleValue,standard_error:F.doubleValue,AIC:S.doubleValue,regression_table:j}};function ut(){}ut.runMultipleRegressionAnalysis=function(t){return ot.runMultipleRegressionAnalysis(t)};function st(){}var ht={BigInteger:{configurable:!0},BigDecimal:{configurable:!0},RoundingMode:{configurable:!0},MathContext:{configurable:!0},Fraction:{configurable:!0},Complex:{configurable:!0},Matrix:{configurable:!0},Random:{configurable:!0},DataAnalysis:{configurable:!0},Probability:{configurable:!0}};return ht.BigInteger.get=function(){return w},ht.BigDecimal.get=function(){return F},ht.RoundingMode.get=function(){return d},ht.MathContext.get=function(){return I},ht.Fraction.get=function(){return C},ht.Complex.get=function(){return rt},ht.Matrix.get=function(){return X},ht.Random.get=function(){return v},ht.DataAnalysis.get=function(){return ut},ht.Probability.get=function(){return m},Object.defineProperties(st,ht),st});
