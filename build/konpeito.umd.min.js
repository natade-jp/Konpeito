/*!
 * konpeito.js (version 6.0.2, 2021/5/25)
 * https://github.com/natade-jp/konpeito
 * Copyright 2013-2021 natade < https://github.com/natade-jp >
 *
 * The MIT license.
 * https://opensource.org/licenses/MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).konpeito=e()}(this,function(){"use strict";function t(){}t.run=function(){void 0===Math.imul&&(Math.imul=function(t,e){var n=(65535&t)*(65535&e)>>>0,r=(65535&t)*(e>>>16);return n=n+((65535&r)<<16)>>>0,4294967295&(n+=(65535&(r=(t>>>16)*(65535&e)))<<16)}),void 0===Math.trunc&&(Math.trunc=function(t){return 0<t?Math.floor(t):Math.ceil(t)}),void 0===Number.isFinite&&(Number.isFinite=isFinite),void 0===Number.isInteger&&(Number.isInteger=function(t){return isFinite(t)&&Math.trunc(t)===t}),void 0===Number.isNaN&&(Number.isNaN=isNaN),void 0===Number.NaN&&(Number.NaN=NaN),void 0===Number.EPSILON&&(Number.EPSILON=2220446049250313e-31),void 0===Number.MIN_SAFE_INTEGER&&(Number.MIN_SAFE_INTEGER=-9007199254740991),Number.MAX_SAFE_INTEGER,Number.parseFloat,Number.parseInt,Number.isSafeInteger},t.run();function e(t){}e.prototype.setSeed=function(t){},e.prototype.genrand_int32=function(){return 0};var r=function(r){function i(t){r.call(this),this.x=[];for(var e=0;e<521;e++)this.x[e]=0;if(void 0!==t)this.setSeed(t);else{var n=(new Date).getTime()+i.seedUniquifier&4294967295;i.seedUniquifier=i.seedUniquifier+1&4294967295,this.setSeed(n)}}return r&&(i.__proto__=r),((i.prototype=Object.create(r&&r.prototype)).constructor=i).prototype._rnd521=function(){for(var t=this.x,e=0;e<32;e++)t[e]^=t[e+489];for(var n=32;n<521;n++)t[n]^=t[n-32]},i.prototype.setSeed=function(t){for(var e=0,n=this.x,r=t,i=0;i<=16;i++){for(var o=0;o<32;o++)e=(e>>>1)+((r=Math.imul(r,1566083941)+1)<0?2147483648:0);n[i]=e}for(var a=16;a<521;a++)e=16===a?a:a-17,n[a]=n[e]<<23&4294967295^n[a-16]>>>9^n[a-1];for(var u=0;u<4;u++)this._rnd521();this.xi=0,this.haveNextNextGaussian=!1,this.nextNextGaussian=0},i.prototype.genrand_int32=function(){521===this.xi&&(this._rnd521(),this.xi=0);var t=this.x[this.xi]>>>0;return this.xi=this.xi+1,t},i}(e);r.seedUniquifier=2271560481;var i=function(n){function r(t){if(n.call(this),this.x=123456789,this.y=362436069,this.z=521288629,this.w=88675123,void 0!==t)this.setSeed(t);else{var e=(new Date).getTime()+r.seedUniquifier&4294967295;r.seedUniquifier=r.seedUniquifier+1&4294967295,this.setSeed(e)}}return n&&(r.__proto__=n),((r.prototype=Object.create(n&&n.prototype)).constructor=r).prototype.setSeed=function(t){var e=t;e=Math.imul(e,214013)+2531011>>>0,this.z=e,e=Math.imul(e,214013)+2531011>>>0,this.w=e,this.haveNextNextGaussian=!1,this.nextNextGaussian=0},r.prototype.genrand_int32=function(){var t=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.w^this.w>>>19^t^t>>>8,this.w},r}(e);i.seedUniquifier=2271560481;function v(t){var e=void 0,n="fast";this.rand=null,this.haveNextNextGaussian=!1,this.nextNextGaussian=0,"number"==typeof t?e=t:"object"==typeof t&&(void 0!==t.seed&&(e=t.seed),void 0!==t.algorithm&&(n=t.algorithm)),/fast|xorshift/i.test(n)?this.rand=new i(e):this.rand=new r(e)}v.create=function(t){return new v(t)},v.prototype.setSeed=function(t){this.rand.setSeed(t)},v.prototype.genrand_int32=function(){return this.rand.genrand_int32()},v.prototype.next=function(t){return 0===t?0:32===t?this.genrand_int32():t<32?this.genrand_int32()>>>32-t:63===t?2147483648*this.genrand_int32()+this.genrand_int32():64===t?4294967296*this.genrand_int32()+this.genrand_int32():t<63?this.genrand_int32()*(1<<t-32)+(this.genrand_int32()>>>64-t):void 0},v.prototype.nextBytes=function(t){for(var e=new Array(t),n=0;n<e.length;n++)e[n]=this.next(8);return e},v.prototype.nextInt=function(t){if(void 0===t||"number"!=typeof t)return 4294967295&this.next(32);for(var e,n;n=(e=this.genrand_int32()>>>0)%t,4294967296<e-n+t;);return n},v.prototype.nextBoolean=function(){return 0!==this.next(1)},v.prototype.nextDouble=function(){return(134217728*this.next(26)+this.next(27))/9007199254740992},v.prototype.nextGaussian=function(){if(this.haveNextNextGaussian)return this.haveNextNextGaussian=!1,this.nextNextGaussian;var t=Math.sqrt(-2*Math.log(this.nextDouble())),e=2*Math.PI*this.nextDouble(),n=t*Math.sin(e);return this.nextNextGaussian=t*Math.cos(e),this.haveNextNextGaussian=!0,n};function n(){}n.toString=function(){return"NONE"},n.getAddNumber=function(t){return 0};function d(){}var o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"UP"},e.getAddNumber=function(t){var e=t%10;return 0==e?0:0<e?10-e:-(10+e)},e}(n),a=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"DOWN"},e.getAddNumber=function(t){return-t%10},e}(n),u=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"CEILING"},e.getAddNumber=function(t){var e=t%10;return 0==e?0:0<e?10-e:-e},e}(n),s=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"FLOOR"},e.getAddNumber=function(t){var e=t%10;return 0==e?0:0<e?-e:-(10+e)},e}(n),l=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"HALF_UP"},e.getAddNumber=function(t){var e=t%10,n=0<=e?1:-1;return Math.abs(e)<5?-1*e:n*(10-Math.abs(e))},e}(n),c=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"HALF_DOWN"},e.getAddNumber=function(t){var e=t%10,n=0<=e?1:-1;return Math.abs(e)<6?-1*e:n*(10-Math.abs(e))},e}(n),h=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"HALF_EVEN"},e.getAddNumber=function(t){var e,n,r=t%100;return n=1===(r<0?(e=-1,1&Math.ceil(r/10)):(e=1)&Math.floor(r/10))?5:6,r%=10,Math.abs(r)<n?-1*r:e*(10-Math.abs(r))},e}(n),f=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).toString=function(){return"UNNECESSARY"},e.getAddNumber=function(t){if(0==t%10)return 0;throw"ArithmeticException"},e}(n),g={UP:{configurable:!0},DOWN:{configurable:!0},CEILING:{configurable:!0},FLOOR:{configurable:!0},HALF_UP:{configurable:!0},HALF_DOWN:{configurable:!0},HALF_EVEN:{configurable:!0},UNNECESSARY:{configurable:!0}};d.valueOf=function(t){var e;if("string"==typeof t)e=t;else{if(!(t instanceof Object))throw"Unsupported argument "+t;e=t.toString()}for(var n=[o,a,s,u,l,c,h,f],r=e.toUpperCase(),i=0;i<n.length;i++)if(n[i].toString()===r)return n[i];throw"IllegalArgumentException : "+e},g.UP.get=function(){return o},g.DOWN.get=function(){return a},g.CEILING.get=function(){return u},g.FLOOR.get=function(){return s},g.HALF_UP.get=function(){return l},g.HALF_DOWN.get=function(){return c},g.HALF_EVEN.get=function(){return h},g.UNNECESSARY.get=function(){return f},Object.defineProperties(d,g);function y(t,e){if(this.precision=0,this.roundingMode=void 0===e?d.HALF_UP:e,"number"==typeof t)this.precision=t;else if(t instanceof y)this.roundingMode=void 0===e?t.roundingMode:e,this.precision=t.precision;else if("string"==typeof t){var n;null!==(n=t.match(/precision=\d+/))&&(n=n[0].substring("precision=".length,n[0].length),this.precision=parseInt(n,10)),null!==(n=t.match(/roundingMode=\w+/))&&(n=n[0].substring("roundingMode=".length,n[0].length),this.roundingMode=d.valueOf(n))}if(this.precision<0)throw"IllegalArgumentException"}var p={UNLIMITED:{configurable:!0},DECIMAL32:{configurable:!0},DECIMAL64:{configurable:!0},DECIMAL128:{configurable:!0},DECIMAL256:{configurable:!0}};y.create=function(t,e){return t instanceof y?t:new y(t,e)},y.prototype.getPrecision=function(){return this.precision},y.prototype.getRoundingMode=function(){return this.roundingMode},y.prototype.equals=function(t){return t instanceof y&&t.toString()===this.toString()},y.prototype.toString=function(){return"precision="+this.precision+" roundingMode="+this.roundingMode.toString()},y.prototype.increasePrecision=function(t){if(0===this.precision)return this;var e=this.precision+(void 0===t?1:t);return new y(Math.max(1,e),this.roundingMode)},y.prototype.decreasePrecision=function(t){if(0===this.precision)return this;var e=this.precision-(void 0===t?1:t);return new y(Math.max(1,e),this.roundingMode)},p.UNLIMITED.get=function(){return N.UNLIMITED},p.DECIMAL32.get=function(){return N.DECIMAL32},p.DECIMAL64.get=function(){return N.DECIMAL64},p.DECIMAL128.get=function(){return N.DECIMAL128},p.DECIMAL256.get=function(){return N.DECIMAL256},Object.defineProperties(y,p);function m(t){return t-Math.trunc(t)!=0}function _(){}var N={UNLIMITED:new y(0,d.HALF_UP),DECIMAL32:new y(7,d.HALF_EVEN),DECIMAL64:new y(16,d.HALF_EVEN),DECIMAL128:new y(34,d.HALF_EVEN),DECIMAL256:new y(72,d.HALF_EVEN)};_.gammaln=function(t){if(!isFinite(t))return isNaN(t)?NaN:1/0;for(var e=Math.log(2*Math.PI),n=[-15238221.539407417,691472.268851313,-36108.77125372499,8553103/6/650,-156.84828462600203,854513/138/462,-174611/330/380,43867/798/306,-3617/510/240,7/6/182,-691/2730/132,5/66/90,-1/30/56,1/42/30,-1/30/12,1/6/2],r=1,i=t;i<n.length;)r*=i,i++;for(var o=1/(i*i),a=n[0],u=1;u<n.length;u++)a*=o,a+=n[u];return a/=i,a+=.5*e,a+=-Math.log(r)-i+(i-.5)*Math.log(i)},_.q_gamma=function(t,e,n){if(!isFinite(t))return t===1/0?0:NaN;var r,i,o,a,u,s=1,l=1+t-e;if(t<1+e)return 1-_.p_gamma(t,e,n);for(i=(o=Math.exp(e*Math.log(t)-t-n))/l,r=2;r<1e3;r++)if(a=((r-1-e)*(l-s)+(r+t)*l)/r,u=i,(i+=a=(o*=(r-1-e)/r)/((s=l)*(l=a)))==u)return i;return Number.NaN},_.p_gamma=function(t,e,n){if(!isFinite(t))return t===1/0?1:NaN;var r,i,o,a;if(1+e<=t)return 1-_.q_gamma(t,e,n);if(0===t)return 0;for(i=o=Math.exp(e*Math.log(t)-t-n)/e,r=1;r<1e3;r++)if(a=i,(i+=o*=t/(e+r))==a)return i;return Number.NaN},_.gamma=function(t){return t<0?Math.PI/(Math.sin(Math.PI*t)*Math.exp(_.gammaln(1-t))):Math.exp(_.gammaln(t))},_.gammainc=function(t,e,n){if("lower"===n)return _.p_gamma(t,e,_.gammaln(e));if("upper"===n)return _.q_gamma(t,e,_.gammaln(e));if(void 0===n)return _.gammainc(t,e,"lower");throw"gammainc unsupported argument ["+n+"]"},_.gampdf=function(t,e,n){if(t===-1/0)return 0;var r=1/(_.gamma(e)*Math.pow(n,e));return r*=Math.pow(t,e-1),r*=Math.exp(-t/n)},_.gamcdf=function(t,e,n){return t<0?0:_.gammainc(t/n,e)},_.gaminv=function(t,e,n){if(t<0||1<t)return Number.NaN;if(0==t)return 0;if(1==t)return Number.POSITIVE_INFINITY;for(var r,i,o=e*n,a=0;a<100&&(r=(i=o-(_.gamcdf(o,e,n)-t)/_.gampdf(o,e,n))-o,!(Math.abs(r)<=1e-12));a++)(o=i)<0&&(o=1e-12);return o},_.beta=function(t,e){return Math.exp(_.gammaln(t)+_.gammaln(e)-_.gammaln(t+e))},_.p_beta=function(t,e,n){var r,i,o,a;if(e<=0)return Number.POSITIVE_INFINITY;if(n<=0)return t<1?0:1===t?1:Number.POSITIVE_INFINITY;if((e+1)/(e+n+2)<t)return 1-_.p_beta(1-t,n,e);if(t<=0)return 0;for(o=e*Math.log(t),o+=n*Math.log(1-t),o+=_.gammaln(e+n),o-=_.gammaln(e)+_.gammaln(n),o=Math.exp(o),i=o/=e,r=1;r<1e3;r++)if(o*=e+n+r-1,o*=t,a=i,(i+=o/=e+r)===a)return i;return Number.NaN},_.q_beta=function(t,e,n){return 1-_.p_beta(t,e,n)},_.betainc=function(t,e,n,r){if("lower"===r)return _.p_beta(t,e,n);if("upper"===r)return _.q_beta(t,e,n);if(void 0===r)return _.betainc(t,e,n,"lower");throw"betainc unsupported argument ["+r+"]"},_.betapdf=function(t,e,n){return t<0&&m(n-1)||1-t<0&&m(n-1)?0:Math.pow(t,e-1)*Math.pow(1-t,n-1)/_.beta(e,n)},_.betacdf=function(t,e,n){return _.betainc(t,e,n)},_.betainv=function(t,e,n){if(t<0||1<t)return Number.NaN;if(0==t&&0<e&&0<n)return 0;if(1==t&&0<e&&0<n)return 1;var r,i,o,a=1e-14;r=0==n?1-a:0==e?a:e/(e+n);for(var u=0;u<100&&(i=(o=r-(_.betacdf(r,e,n)-t)/_.betapdf(r,e,n))-r,!(Math.abs(i)<=a));u++)1<(r=o)?r=1-a:r<0&&(r=a);return r},_.factorial=function(t){var e=_.gamma(t+1);return Math.trunc(t)===t?Math.round(e):e},_.nchoosek=function(t,e){for(var n=1,r=Math.min(e,t-e),i=1;i<=r;i++)if((n*=(t+1-i)/i)>=Number.MAX_SAFE_INTEGER)return 1/0;return n},_.erf=function(t){return _.p_gamma(t*t,.5,.5*Math.log(Math.PI))*(0<=t?1:-1)},_.erfc=function(t){return 1-_.erf(t)},_.erfinv=function(t){return _.erfcinv(1-t)},_.erfcinv=function(t){return-_.norminv(.5*t)/Math.sqrt(2)},_.normpdf=function(t,e,n){var r="number"==typeof e?e:0,i="number"==typeof n?n:1,o=1/Math.sqrt(2*Math.PI*i*i);return o*=Math.exp(-(t-r)*(t-r)/(2*i*i))},_.normcdf=function(t,e,n){return(1+_.erf((t-("number"==typeof e?e:0))/(("number"==typeof n?n:1)*Math.sqrt(2))))/2},_.norminv=function(t,e,n){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;for(var r,i,o="number"==typeof e?e:0,a="number"==typeof n?n:1,u=o,s=0;s<200&&(r=(i=u-(_.normcdf(u,o,a)-t)/_.normpdf(u,o,a))-u,!(Math.abs(r)<=1e-12));s++)u=i;return u},_.binopdf=function(t,e,n){return isFinite(n)?_.nchoosek(e,t)*Math.pow(n,t)*Math.pow(1-n,e-t):isNaN(n)?NaN:0},_.binocdf=function(t,e,n,r){return _.betainc(1-n,e-Math.floor(t),1+Math.floor(t),r)},_.binoinv=function(t,e,n){if(t<0||1<t||n<0||1<n)return Number.NaN;if(0==t||0==n)return 0;if(1==n)return e;for(var r=1,i=e,o=0,a=0,u=0;u<200;u++){o=Math.round((r+i)/2);var s=_.binocdf(o,e,n);if(o===a)break;t<s?i=o:r=o,a=o}return o},_.poisspdf=function(t,e){if(!isFinite(t))return isNaN(t)?Number.NaN:0;for(var n=1/Math.E,r=1,i=0,o=1;o<=t;o++)r=r*e/o,i<e&&(r*=n,i++);for(;i<e;i++)r*=n;return r},_.poisscdf=function(t,e){return t<0?0:1-_.gammainc(e,Math.floor(t+1))},_.poissinv=function(t,e){if(t<0||1<t)return Number.NaN;if(0==t)return 0;if(1==t)return Number.POSITIVE_INFINITY;for(var n=1,r=20*e,i=0,o=0,a=0;a<200;a++){i=Math.round((n+r)/2);var u=_.poisscdf(i,e);if(i===o)break;t<u?r=i:n=i,o=i}return i},_.tpdf=function(t,e){var n=1/(Math.sqrt(e)*_.beta(.5,.5*e));return n*=Math.pow(1+t*t/e,.5*-(e+1))},_.tcdf=function(t,e){return.5*(1+_.betainc(t*t/(e+t*t),.5,.5*e)*(t<0?-1:1))},_.tinv=function(t,e){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;if(t<.5){var n=_.betainv(2*t,.5*e,.5);return-Math.sqrt(e/n-e)}var r=_.betainv(2*(1-t),.5*e,.5);return Math.sqrt(e/r-e)},_.tdist=function(t,e,n){return(1-_.tcdf(Math.abs(t),e))*n},_.tinv2=function(t,e){return-_.tinv(.5*t,e)},_.chi2pdf=function(t,e){if(t<0)return 0;if(0===t)return.5;var n=Math.pow(t,e/2-1)*Math.exp(-t/2);return n/=Math.pow(2,e/2)*_.gamma(e/2)},_.chi2cdf=function(t,e){return _.gammainc(t/2,e/2)},_.chi2inv=function(t,e){return _.gaminv(t,e/2,2)},_.fpdf=function(t,e,n){if(e<0||n<0)return Number.NaN;if(t<=0)return 0;var r=1;return r*=Math.pow(e*t/(e*t+n),e/2),r*=Math.pow(1-e*t/(e*t+n),n/2),r/=t*_.beta(e/2,n/2)},_.fcdf=function(t,e,n){return _.betacdf(e*t/(e*t+n),e/2,n/2)},_.finv=function(t,e,n){return(1/_.betainv(1-t,n/2,e/2)-1)*n/e};function b(){}b.tridiagonalize=function(t){for(var e=J._toMatrix(t).getNumberMatrixArray(),c=function(t,e,n,r){for(var i=0,o=n||0,a=r||t.length,u=o;u<a;u++)i+=t[u]*e[u];return i},n=function(t,e,n){var r=e||0,i=n||t.length,o=Math.sqrt(c(t,t,r,i)),a=[];if(1e-10<=Math.abs(o)){var u;t[r]<0&&(o=-o);for(var s=r,l=0;s<i;s++,l++)s===r?(a[l]=t[s]+o,u=1/Math.sqrt(a[l]*o),a[l]=a[l]*u):a[l]=t[s]*u}return{y1:-o,v:a}},r=e.length,i=[],o=[],a=0;a<r-2;a++){var u=e[a];i[a]=u[a];var s=n(u,a+1,r);o[a]=s.y1;for(var l=0;l<s.v.length;l++)u[a+1+l]=s.v[l];if(!(Math.abs(o[a])<1e-10)){for(var h=a+1;h<r;h++){for(var f=0,g=a+1;g<h;g++)f+=e[g][h]*u[g];for(var p=h;p<r;p++)f+=e[h][p]*u[p];i[h]=f}for(var m=c(u,i,a+1,r)/2,_=r-1;a<_;_--){var N=u[_],v=i[_]-m*N;i[_]=v;for(var I=_;I<r;I++){var d=N*i[I]+v*u[I];e[_][I]=e[_][I]-d}}}}2<=r&&(i[r-2]=e[r-2][r-2],o[r-2]=e[r-2][r-1]),1<=r&&(i[r-1]=e[r-1][r-1]);for(var y=r-1;0<=y;y--){var b=e[y];if(y<r-2)for(var w=y+1;w<r;w++)for(var E=e[w],x=c(b,E,y+1,r),M=y+1;M<r;M++)E[M]-=x*b[M];for(var O=0;O<r;O++)b[O]=0;b[y]=1}var T=J.createMatrixDoEachCalculation(function(t,e){return t===e?new L(i[t]):1===Math.abs(t-e)?new L(o[Math.trunc(.5*(t+e))]):L.ZERO},r,r);return{P:new J(e).T(),H:T}},b.eig=function(t){for(var e=J._toMatrix(t),n=!1,r=b.tridiagonalize(e),i=r.P.getNumberMatrixArray(),o=r.H.getNumberMatrixArray(),a=e.row_length,u=[],s=[],l=0;l<a;l++)u[l]=o[l][l],s[l]=0===l?0:o[l][l-1];for(var c=a-1;0<c;c--){var h=c;for(h=c;1<=h&&!(Math.abs(s[h])<=1e-10*(Math.abs(u[h-1])+Math.abs(u[h])));h--);if(h!=c){for(var f=0;;){if(100<++f){n=!0;break}var g=(u[c-1]-u[c])/2,p=s[c]*s[c],m=Math.sqrt(g*g+p);g<0&&(m=-m);for(var _=u[h]-u[c]+p/(g+m),N=s[h+1],v=h;v<c;v++){var I=void 0,d=void 0;Math.abs(_)>=Math.abs(N)?d=(p=-N/_)*(I=1/Math.sqrt(p*p+1)):I=(p=-_/N)*(d=1/Math.sqrt(p*p+1)),p=((g=u[v]-u[v+1])*d+2*I*s[v+1])*d,u[v]-=p,u[v+1]+=p,h<v&&(s[v]=I*s[v]-d*N),s[v+1]+=d*(I*g-2*d*s[v+1]);for(var y=0;y<a;y++)_=i[y][v],N=i[y][v+1],i[y][v]=I*_-d*N,i[y][v+1]=d*_+I*N;v<c-1&&(_=s[v+1],N=-d*s[v+2],s[v+2]*=I)}if(Math.abs(s[c])<=1e-10*(Math.abs(u[c-1])+Math.abs(u[c])))break}if(n)break}}return function(t,e){for(var n=e.length,r=[],i=0;i<n;i++)r[i]={sigma:e[i],index:i};r.sort(function(t,e){return t.sigma===e.sigma?0:t.sigma<e.sigma?1:-1});for(var o=J.zeros(n),a=J.zeros(n),u=0;u<n;u++)a.matrix_array[u][u]=new L(r[u].sigma),o.matrix_array[u][r[u].index]=L.ONE;return{V:t.mul(o),D:a}}(new J(i),u)},b.doGramSchmidtOrthonormalization=function(t){for(var e=J._toMatrix(t),n=e.column_length,r=e.matrix_array,i=J.zeros(n),o=J.zeros(n),a=i.matrix_array,u=o.matrix_array,s=[],l=new Array(n),c=0;c<n;c++){for(var h=0;h<n;h++)l[h]=r[h][c];if(0<c){for(var f=0;f<c;f++)for(var g=0;g<n;g++)u[f][c]=u[f][c].add(r[g][c].dot(a[g][f]));for(var p=0;p<c;p++)for(var m=0;m<n;m++)l[m]=l[m].sub(u[p][c].mul(a[m][p]))}for(var _=0;_<n;_++)u[c][c]=u[c][c].add(l[_].square());if(u[c][c]=u[c][c].sqrt(),u[c][c].isZero(1e-10)){s.push(c);for(var N=0;N<n;N++)a[N][c]=L.ZERO}else for(var v=0;v<n;v++)a[v][c]=l[v].div(u[c][c])}return{Q:i,R:o,non_orthogonalized:s}},b.createOrthogonalVector=function(t,e){for(var n=new J(t),r=n.column_length,i=n.matrix_array,o=b.getLinearDependenceVector(n,e||1e-10),a=o.length-1;0<=a;a--)i.splice(o[a],1),n.row_length--;var u=r-i.length;if(u<=0)return null;for(var s=new v(0),l=null,c=0;c<100;c++){var h=n.T(),f=J.createMatrixDoEachCalculation(function(){return new L(s.nextGaussian())},h.row_length,u);if(h._concatRight(f),0===(l=b.doGramSchmidtOrthonormalization(h)).non_orthogonalized.length)break}if(0!==l.non_orthogonalized.length)return console.log("miss"),null;for(var g=new Array(u),p=l.Q.matrix_array,m=0;m<u;m++){g[m]=new Array(r);for(var _=0;_<r;_++)g[m][_]=p[_][r-u+m]}return new J(g)},b.getMaxRowNumber=function(t,e,n,r){for(var i=J._toMatrix(t),o=0,a=0,u=n||0,s=r||i.row_length;u<s;u++){var l=i.matrix_array[u][e].norm;a<l&&(a=l,o=u)}return{index:o,max:a}},b.getLinearDependenceVector=function(t,e){for(var n=new J(t),r=n.matrix_array,i=e?J._toDouble(e):1e-10,o=new Array(n.row_length),a=0;a<n.row_length;a++)o[a]=a;for(var u=0;u<n.column_length;u++){var s=0,l=0,c=0;for(var h in o){var f=o[h],g=r[f][u].norm;l<g&&(l=g,c=parseInt(h,10),s=f)}if(!(l<=i)){if(o.splice(c,1),u===n.column_length-1)break;for(var p in o)for(var m=o[p],_=r[m][u].div(r[s][u]),N=u;N<n.column_length;N++)r[m][N]=r[m][N].sub(r[s][N].mul(_))}}return o};function I(){}I.inner=function(t,e,n){var r=J._toMatrix(t),i=J._toMatrix(e),o=r.matrix_array,a=i.matrix_array,u=n?J._toInteger(n):1;if(r.isScalar()&&i.isScalar())return new J(r.scalar.dot(i.scalar));if(r.isVector()&&i.isVector()){for(var s=L.ZERO,l=0;l<r.length;l++)s=s.add(r.getComplex(l).dot(i.getComplex(l)));return new J(s)}if(r.row_length!==i.row_length||r.column_length!==i.column_length)throw"Matrix size does not match";if(1===u){var c=new Array(1);c[0]=new Array(r.column_length);for(var h=0;h<r.column_length;h++){for(var f=L.ZERO,g=0;g<r.row_length;g++)f=f.add(o[g][h].dot(a[g][h]));c[0][h]=f}return new J(c)}if(2!==u)throw"dim";for(var p=new Array(r.row_length),m=0;m<r.row_length;m++){for(var _=L.ZERO,N=0;N<r.column_length;N++)_=_.add(o[m][N].dot(a[m][N]));p[m]=[_]}return new J(p)},I.norm=function(t,e){var n=J._toMatrix(t),r=void 0===e?2:J._toDouble(e);if(1===r){var i=n.matrix_array;if(n.isRow()){for(var o=0,a=0;a<n.column_length;a++)o+=i[0][a].norm;return o}if(n.isColumn()){for(var u=0,s=0;s<n.row_length;s++)u+=i[s][0].norm;return u}for(var l=0,c=0;c<n.column_length;c++){for(var h=0,f=0;f<n.row_length;f++)h+=i[f][c].norm;l<h&&(l=h)}return l}if(2===r){var g=n.matrix_array;if(n.isRow()){for(var p=0,m=0;m<n.column_length;m++)p+=g[0][m].square().real;return Math.sqrt(p)}if(n.isColumn()){for(var _=0,N=0;N<n.row_length;N++)_+=g[N][0].square().real;return Math.sqrt(_)}return n.svd().S.diag().max().scalar.real}if(r===Number.POSITIVE_INFINITY||r===Number.NEGATIVE_INFINITY){var v=n.matrix_array,I=r===Number.POSITIVE_INFINITY?0:Number.POSITIVE_INFINITY,d=r===Number.POSITIVE_INFINITY?Math.max:Math.min;if(n.isRow()){for(var y=0;y<n.column_length;y++)I=d(I,v[0][y].norm);return I}if(n.isColumn()){for(var b=0;b<n.row_length;b++)I=d(I,v[b][0].norm);return I}for(var w=I=0;w<n.row_length;w++){for(var E=0,x=0;x<n.column_length;x++)E+=v[w][x].norm;I=Math.max(I,E)}return I}if(n.isVector()){for(var M=0,O=0;O<n.length;O++)M+=Math.pow(n.getComplex(O).norm,r);return Math.pow(M,1/r)}throw"norm"},I.cond=function(t,e){var n=J._toMatrix(t);if(2!==(void 0===e?2:J._toInteger(e)))return n.norm(e)*n.pinv().norm(e);if(n.isZeros())return Number.POSITIVE_INFINITY;if(n.isVector())return 1;if(n.isUnitary())return 1;var r=n.svd().S.diag();return r.max().scalar.real/r.min().scalar.real},I.rcond=function(t){return 1/I.cond(J._toMatrix(t),1)},I.rank=function(t,e){var n=J._toMatrix(t),r=void 0!==e?J._toDouble(e):void 0;return n.row_length<=n.column_length?Math.min(n.row_length,n.column_length)-b.getLinearDependenceVector(n,r).length:n.row_length-b.getLinearDependenceVector(n,r).length},I.trace=function(t){for(var e=J._toMatrix(t),n=Math.min(e.row_length,e.column_length),r=L.ZERO,i=0;i<n;i++)r=r.add(e.matrix_array[i][i]);return r},I.det=function(t){var e=J._toMatrix(t);if(!e.isSquare())throw"not square";var n=e.length;if(n<5){var l=function(t){if(2===t.length)return t[0][0].mul(t[1][1]).sub(t[0][1].mul(t[1][0]));for(var e=L.ZERO,n=0;n<t.length;n++){for(var r=[],i=t[n][0],o=0,a=0;o<t.length;o++)if(n!==o){r[a]=[];for(var u=1,s=0;u<t.length;u++,s++)r[a][s]=t[o][u];a++}e=n%2==0?e.add(i.mul(l(r))):e.sub(i.mul(l(r)))}return e};return new J(l(e.matrix_array))}var r=I.lup(e),i=(n-r.P.diag().sum().scalar.real)/2,o=r.U.diag().prod();return i%2==1&&(o=o.negate()),new J(o)},I.lup=function(t){for(var e=new J(t),n=J.zeros(e.row_length),r=e,i=J.eye(e.row_length),o=n.matrix_array,a=r.matrix_array,u=0;u<e.column_length;u++){var s,l=b.getMaxRowNumber(r,u,u);if(s=l.index,0!==l.max){u!==s&&(n._exchangeRow(u,s),r._exchangeRow(u,s),i._exchangeRow(u,s));for(var c=u+1;c<e.row_length;c++){var h=a[c][u].div(a[u][u]);o[c][u]=h;for(var f=u;f<e.column_length;f++)a[c][f]=a[c][f].sub(a[u][f].mul(h))}}}return n._resize(e.row_length,Math.min(e.row_length,e.column_length)),r._resize(Math.min(e.row_length,e.column_length),e.column_length),n._each(function(t,e,n){return e===n?L.ONE:t}),{L:n,U:r,P:i}},I.lu=function(t){var e=I.lup(t);return{L:e.P.T().mul(e.L),U:e.U}},I.linsolve=function(t,e){var n=J._toMatrix(t),r=J._toMatrix(e);if(!n.isSquare())throw"Matrix size does not match";var i=r;if(r.row_length!==n.row_length||1<r.column_length)throw"Matrix size does not match";var o=new J(n);o._concatRight(i);for(var a=o.matrix_array,u=o.column_length,s=n.column_length,l=0;l<s-1;l++){var c=b.getMaxRowNumber(o,l,l).index;o._exchangeRow(l,c);for(var h=a[l][l].inv(),f=l,g=l;g<u;g++)a[f][g]=a[f][g].mul(h);for(var p=l+1;p<s;p++)for(var m=a[p][l],_=l;_<u;_++)a[p][_]=a[p][_].sub(a[l][_].mul(m))}var N=new Array(s);N[s-1]=a[s-1][s].div(a[s-1][s-1]);for(var v=s-2;0<=v;v--){N[v]=a[v][u-1];for(var I=v+1;I<s;I++)N[v]=N[v].sub(a[v][I].mul(N[I]));N[v]=N[v].div(a[v][v])}for(var d=new Array(n.row_length),y=0;y<n.row_length;y++)d[y]=[N[y]];return new J(d)},I.qr=function(t){var e=new J(t),n=e.row_length,r=e.row_length,i=e.row_length,o=e.column_length,a=Math.max(e.row_length,e.column_length);e._resize(a,a);var u=b.doGramSchmidtOrthonormalization(e),s=u.Q,l=u.R,c=u.non_orthogonalized;if(c.length===e.row_length)s=J.eye(e.row_length);else if(0!==c.length){for(var h={},f=0;f<c.length;f++)h[c[f]]=1;for(var g=[],p=0;p<a;p++)if(!h[p]){for(var m=[],_=0;_<a;_++)m[_]=s.matrix_array[_][p];g.push(m)}for(var N=b.createOrthogonalVector(g),v=0;v<c.length;v++)for(var I=c[v],d=0;d<a;d++)s.matrix_array[d][I]=N.matrix_array[v][d]}return s._resize(n,r),l._resize(i,o),{Q:s,R:l}},I.tridiagonalize=function(t){var e=new J(t);if(!e.isSquare())throw"not square matrix";if(!e.isSymmetric())throw"not Symmetric";if(e.isComplex())throw"not Real Matrix";return b.tridiagonalize(e)},I.eig=function(t){var e=new J(t);if(!e.isSquare())throw"not square matrix";if(!e.isSymmetric())throw"not Symmetric";if(e.isComplex())throw"not Real Matrix";return b.eig(e)},I.svd=function(t){var e=new J(t);if(e.isComplex())throw"Unimplemented";var r=I.rank(e),i=I.eig(e.T().mul(e)),o=J.zeros(e.row_length,e.column_length);o._each(function(t,e,n){if(e===n&&e<r)return i.D.getComplex(e,e).sqrt()});var n=Math.min(e.row_length,e.column_length),a=J.createMatrixDoEachCalculation(function(t,e){if(t!==e)return L.ZERO;var n=o.matrix_array[t][t];return n.isZero()?L.ZERO:n.inv()},n),u=i.V.resize(i.V.row_length,n),s=e.mul(u).mul(a);return{U:I.qr(s).Q,S:o,V:i.V}},I.inv=function(t){var e=new J(t);if(e.isScalar())return new J(L.ONE.div(e.scalar));if(!e.isSquare())throw"not square";if(e.isDiagonal()){for(var n=e.T(),r=Math.min(n.row_length,n.column_length),i=0;i<r;i++)n.matrix_array[i][i]=n.matrix_array[i][i].inv();return n}var o=e.column_length,a=new J(e);a._concatRight(J.eye(o));for(var u=a.matrix_array,s=a.column_length,l=0;l<o;l++){var c=b.getMaxRowNumber(a,l,l).index;a._exchangeRow(l,c);for(var h=u[l][l].inv(),f=l,g=l;g<s;g++)u[f][g]=u[f][g].mul(h);for(var p=0;p<o;p++)if(p!==l)for(var m=u[p][l],_=l;_<s;_++)u[p][_]=u[p][_].sub(u[l][_].mul(m))}for(var N=new Array(o),v=0;v<o;v++){N[v]=new Array(o);for(var I=0;I<o;I++)N[v][I]=u[v][o+I]}return new J(N)},I.pinv=function(t){var e=new J(t),n=I.svd(e),r=n.U,i=n.S,o=n.V,a=J.createMatrixDoEachCalculation(function(t,e){if(t!==e)return L.ZERO;var n=i.matrix_array[t][t];return n.isZero()?L.ZERO:n.inv()},e.column_length,e.row_length);return o.mul(a).mul(r.T())};function E(){}E.max=function(t,e){var n=J._toMatrix(t),r=e&&e.dimension?e.dimension:"auto";return n.eachVector(function(t){for(var e=t[0],n=1;n<t.length;n++)e.compareTo(t[n])<0&&(e=t[n]);return[e]},r)},E.min=function(t,e){var n=J._toMatrix(t),r=e&&e.dimension?e.dimension:"auto";return n.eachVector(function(t){for(var e=t[0],n=1;n<t.length;n++)0<e.compareTo(t[n])&&(e=t[n]);return[e]},r)},E.sum=function(t,e){var n=J._toMatrix(t),r=e&&e.dimension?e.dimension:"auto";return n.eachVector(function(t){for(var e=L.ZERO,n=L.ZERO,r=0;r<t.length;r++){var i=t[r].add(n),o=e.add(i);n=o.sub(e).sub(i),e=o}return[e]},r)},E.mean=function(t,e){var n=J._toMatrix(t),r=e&&e.dimension?e.dimension:"auto";return n.eachVector(function(t){for(var e=L.ZERO,n=L.ZERO,r=0;r<t.length;r++){var i=t[r].add(n),o=e.add(i);n=o.sub(e).sub(i),e=o}return[e.div(t.length)]},r)},E.prod=function(t,e){var n=J._toMatrix(t),r=e&&e.dimension?e.dimension:"auto";return n.eachVector(function(t){for(var e=L.ONE,n=0;n<t.length;n++)e=e.mul(t[n]);return[e]},r)},E.geomean=function(t,e){var n=J._toMatrix(t),r=e&&e.dimension?e.dimension:"auto";return n.eachVector(function(t){for(var e=L.ONE,n=0;n<t.length;n++)e=e.mul(t[n]);return[e.pow(L.create(t.length).inv())]},r)},E.median=function(t,e){function i(t,e){return t.compareTo(e)}var n=J._toMatrix(t),r=e&&e.dimension?e.dimension:"auto";return n.eachVector(function(t){var e;if(t.sort(i),t.length%2==1)e=t[Math.floor(t.length/2)];else{var n=t[Math.floor(t.length/2)-1],r=t[Math.floor(t.length/2)];e=n.add(r).div(L.TWO)}return[e]},r)},E.mode=function(t,e){function s(t,e){return t.compareTo(e)}var n=J._toMatrix(t),r=e&&e.dimension?e.dimension:"auto";return n.eachVector(function(t){t.sort(s);for(var e={},n=0;n<t.length;n++){var r=t[n].real+" "+t[n].imag;e[r]?e[r].value++:e[r]={complex:t[n],value:1}}var i=L.ZERO,o=Number.NEGATIVE_INFINITY;for(var a in e){var u=e[a];u.value>o&&(o=u.value,i=u.complex)}return[i]},r)},E.moment=function(t,e,n){var r=J._toMatrix(t),o=E.mean(r),a=n&&"number"==typeof n.correction?J._toDouble(n.correction):1,i=n&&n.dimension?n.dimension:"auto",u=J._toComplex(e),s=0;return r.eachVector(function(t){var e;e=o.isScalar()?o.scalar:o.getComplex(s++);for(var n=L.ZERO,r=0;r<t.length;r++){var i=t[r].sub(e);n=n.add(i.pow(u))}return 1===t.length?[n.div(t.length)]:[n.div(t.length-1+a)]},i)},E.var=function(t,e){var n=J._toMatrix(t),o=E.mean(n),a=e&&"number"==typeof e.correction?J._toDouble(e.correction):0,r=e&&e.dimension?e.dimension:"auto",u=0;return n.eachVector(function(t){if(1===t.length)return[L.ZERO];for(var e=o.getComplex(u++),n=0,r=0;r<t.length;r++){var i=t[r].sub(e).norm;n+=i*i}return[L.create(n/(t.length-1+a))]},r)},E.std=function(t,e){var n=J._toMatrix(t),r=e&&"number"==typeof e.correction?J._toDouble(e.correction):0,i=e&&e.dimension?e.dimension:"auto",o=E.var(n,{correction:r,dimension:i});return o._each(function(t){return t.sqrt()}),o},E.mad=function(t,e,n){var r=J._toMatrix(t),i=e?"string"==typeof e?e:J._toInteger(e):"mean",o=n&&n.dimension?n.dimension:"auto";if("mean"===i||0===i)return E.mean(r.sub(E.mean(r,{dimension:o})).abs(),{dimension:o});if("median"===i||1===i)return E.median(r.sub(E.median(r,{dimension:o})).abs(),{dimension:o});throw"mad unsupported argument "+i},E.skewness=function(t,e){var n=J._toMatrix(t),r=e&&"number"==typeof e.correction?J._toDouble(e.correction):1,i=e&&e.dimension?e.dimension:"auto",o=E.moment(n,3,{correction:r,dimension:i}),a=E.std(n,{correction:r,dimension:i});return 1===r?o.dotdiv(a.dotpow(3)):o.dotdiv(a.dotpow(3)).dotmul(2)},E.cov=function(t,e,n){var r=J._toMatrix(t),i=0,o=null;if(void 0!==e&&(void 0!==n?(i=n&&"number"==typeof n.correction?J._toDouble(n.correction):0,o=J._toMatrix(e)):"object"==typeof e&&"correction"in e?i=J._toDouble(e.correction):o=J._toMatrix(e)),null===o){if(r.isVector())return E.var(r,{correction:i});for(var a=1===r.row_length?1:i,u=r.matrix_array,s=E.mean(r).matrix_array[0],l=new Array(r.column_length),c=0;c<r.column_length;c++){var h=s[c];l[c]=new Array(r.column_length);for(var f=c;f<r.column_length;f++){for(var g=s[f],p=L.ZERO,m=0;m<r.row_length;m++)p=p.add(u[m][c].sub(h).dot(u[m][f].sub(g)));l[c][f]=p.div(r.row_length-1+a)}}for(var _=1;_<l[0].length;_++)for(var N=0;N<_;N++)l[_][N]=l[N][_];return new J(l)}if(!r.isVector()&&!o.isVector())throw"vector not specified";if(r.length!==o.length)throw"X.length !== Y.length";for(var v=E.mean(r).scalar,I=E.mean(o).scalar,d=r.length,y=1===d?1:i,b=L.ZERO,w=0;w<d;w++)b=b.add(r.getComplex(w).sub(v).dot(o.getComplex(w).sub(I)));return new J(b.div(d-1+y))},E.standardization=function(t,e){var n=J._toMatrix(t),r=n.sub(E.mean(n,e));return r.dotdiv(E.std(r,e))},E.corrcoef=function(t,e,n){var r=J._toMatrix(t),i=null;if(void 0!==e&&(void 0!==n?i=J._toMatrix(e):"object"==typeof e&&"correction"in e||(i=J._toMatrix(e))),null===i)return E.cov(E.standardization(r,n),n);if(!r.isVector()&&!i.isVector())throw"vector not specified";if(r.length!==i.length)throw"X.length["+r.length+"] !== Y.length["+i.length+"]";var o=E.cov(r,i,n),a=r.std(n),u=i.std(n);return o.div(a.mul(u))},E.sort=function(t,e,n){var r,i=J._toMatrix(t),o=n&&n.dimension?n.dimension:"auto";r="ascend"===(e||"ascend")?function(t,e){return t.compareTo(e)}:function(t,e){return e.compareTo(t)};return i.eachVector(function(t){return t.sort(r),t},o)};function w(t){this.size=t,this.inv_size=1/this.size,this.bit_size=Math.round(Math.log(this.size)/Math.log(2)),this.is_fast=1<<this.bit_size===this.size,this.bitrv=null,this.fft_re=new Array(this.size),this.fft_im=new Array(this.size);for(var e=-2*Math.PI/this.size,n=0,r=0,i=0;r<this.size;r++){this.fft_re[r]=Math.cos(i),this.fft_im[r]=Math.sin(i);var o=e+n,a=i+o;n=a-i-o,i=a}this.is_fast&&(this.bitrv=w.create_bit_reverse_table(this.bit_size))}w.bit_reverse_32=function(t){var e=4294967295&t;return e=(65535&(e=(16711935&(e=(252645135&(e=(858993459&(e=(1431655765&e)<<1|e>>1&1431655765))<<2|e>>2&858993459))<<4|e>>4&252645135))<<8|e>>8&16711935))<<16|e>>16&65535},w.create_bit_reverse_table=function(t){for(var e=1<<t,n=[],r=0;r<e;r++)n[r]=w.bit_reverse_32(r)>>>32-t;return n},w.prototype.free=function(){delete this.size,delete this.inv_size,delete this.bit_size,delete this.is_fast,delete this.bitrv,delete this.fft_re,delete this.fft_im},w.prototype.fft=function(t,e){var n=new Array(this.size),r=new Array(this.size);if(this.is_fast){for(var i=0;i<this.size;i++)n[i]=t[this.bitrv[i]],r[i]=e[this.bitrv[i]];for(var o=1,a=this.size/2,u=2,s=1<<this.bit_size-1;0<s;s>>=1){for(var l=0;l<a;l++)for(var c=l*u,h=0,f=0;h<o;h++,c++,f+=s){var g=n[c+o]*this.fft_re[f]-r[c+o]*this.fft_im[f],p=r[c+o]*this.fft_re[f]+n[c+o]*this.fft_im[f];n[c+o]=n[c]-g,r[c+o]=r[c]-p,n[c]+=g,r[c]+=p}a/=2,u*=2,o*=2}}else if(z.isContainsZero(e))for(var m=0;m<this.size;m++){n[m]=0;for(var _=r[m]=0,N=0;_<this.size;N=++_*m%this.size)n[m]+=t[_]*this.fft_re[N]-e[_]*this.fft_im[N],r[m]+=t[_]*this.fft_im[N]+e[_]*this.fft_re[N]}else for(var v=0;v<this.size;v++){n[v]=0;for(var I=r[v]=0,d=0;I<this.size;d=++I*v%this.size)n[v]+=t[I]*this.fft_re[d],r[v]+=t[I]*this.fft_im[d]}return{real:n,imag:r}},w.prototype.ifft=function(t,e){var n=new Array(this.size),r=new Array(this.size);if(this.is_fast){for(var i=0;i<this.size;i++)n[i]=t[this.bitrv[i]],r[i]=e[this.bitrv[i]];for(var o,a,u=1,s=this.size/2,l=2,c=1<<this.bit_size-1;0<c;c>>=1){for(var h=0;h<s;h++)for(var f=h*l,g=0,p=0;g<u;g++,f++,p+=c)o=n[f+u]*this.fft_re[p]+r[f+u]*this.fft_im[p],a=r[f+u]*this.fft_re[p]-n[f+u]*this.fft_im[p],n[f+u]=n[f]-o,r[f+u]=r[f]-a,n[f]+=o,r[f]+=a;s/=2,l*=2,u*=2}}else if(z.isContainsZero(e))for(var m=0;m<this.size;m++){n[m]=0;for(var _=r[m]=0,N=0;_<this.size;N=m*++_%this.size)n[m]+=t[_]*this.fft_re[N]+e[_]*this.fft_im[N],r[m]+=-t[_]*this.fft_im[N]+e[_]*this.fft_re[N]}else for(var v=0;v<this.size;v++){n[v]=0;for(var I=r[v]=0,d=0;I<this.size;d=v*++I%this.size)n[v]+=t[I]*this.fft_re[d],r[v]+=-t[I]*this.fft_im[d]}for(var y=0;y<this.size;y++)n[y]*=this.inv_size,r[y]*=this.inv_size;return{real:n,imag:r}};function x(t,e){this.object=t,this.table=[],this.table_max=e}x.prototype.get=function(t){for(var e=0;e<this.table.length;e++)if(this.table[e].size===t){var n=this.table.splice(e,1)[0];return this.table.unshift(n),n}var r=new this.object(t);this.table.length===this.table_max&&this.table.pop().free();return this.table.unshift(r),r};function M(t){this.size=t,this.dct_size=2*t,this.dct_re=new Array(this.size),this.dct_im=new Array(this.size);for(var e=1/Math.sqrt(this.size),n=e*Math.sqrt(2),r=0;r<this.size;r++){var i=-Math.PI*r/this.dct_size;this.dct_re[r]=Math.cos(i)*(0===r?e:n),this.dct_im[r]=Math.sin(i)*(0===r?e:n)}}var O=new x(w,4);M.prototype.free=function(){delete this.size,delete this.dct_size,delete this.dct_re,delete this.dct_im},M.prototype.dct=function(t){for(var e=new Array(this.dct_size),n=new Array(this.dct_size),r=0;r<this.dct_size;r++)e[r]=r<this.size?t[r]:0,n[r]=0;for(var i=O.get(this.dct_size).fft(e,n),o=0;o<this.size;o++)e[o]=i.real[o]*this.dct_re[o]-i.imag[o]*this.dct_im[o];return e.splice(this.size),e},M.prototype.idct=function(t){for(var e=new Array(this.dct_size),n=new Array(this.dct_size),r=2*this.size,i=0;i<this.dct_size;i++)e[i]=i<this.size?r*t[i]*this.dct_re[i]:0,n[i]=i<this.size?r*t[i]*-this.dct_im[i]:0;var o=O.get(this.dct_size).ifft(e,n);return o.real.splice(this.size),o.real};var T=new x(M,4),z=function(){};z.isContainsZero=function(t){for(var e=0;e<t.length;e++)if(0!==t[e])return!0;return!1},z.fft=function(t,e){return O.get(t.length).fft(t,e)},z.ifft=function(t,e){return O.get(t.length).ifft(t,e)},z.dct=function(t){return T.get(t.length).dct(t)},z.idct=function(t){return T.get(t.length).idct(t)},z.powerfft=function(t,e){for(var n=t.length,r=z.fft(t,e),i=new Array(n),o=0;o<n;o++)i[o]=r.real[o]*r.real[o]+r.imag[o]*r.imag[o];return i},z.conv=function(t,e,n,r){var i=!1;if(t.length===n.length){i=!0;for(var o=0;o<t.length;o++)if(t[o]!==n[o]||e[o]!==r[o]){i=!1;break}}var a=t.length,u=2*a;if(1<<Math.round(Math.log(a)/Math.log(2))===a){if(i){for(var s=t.length,l=new Array(u),c=new Array(u),h=0;h<u;h++)l[h]=h<s?t[h]:0,c[h]=h<s?e[h]:0;for(var f=z.fft(l,c),g=0;g<u;g++)l[g]=f.real[g]*f.real[g]-f.imag[g]*f.imag[g],c[g]=f.real[g]*f.imag[g]+f.imag[g]*f.real[g];var p=z.ifft(l,c);return p.real.splice(u-1),p.imag.splice(u-1),p}if(t.length===n.length){for(var m=t.length,_=new Array(u),N=new Array(u),v=new Array(u),I=new Array(u),d=0;d<u;d++)_[d]=d<m?t[d]:0,N[d]=d<m?e[d]:0,v[d]=d<m?n[d]:0,I[d]=d<m?r[d]:0;for(var y=z.fft(_,N),b=z.fft(v,I),w=new Array(u),E=new Array(u),x=0;x<u;x++)w[x]=y.real[x]*b.real[x]-y.imag[x]*b.imag[x],E[x]=y.real[x]*b.imag[x]+y.imag[x]*b.real[x];var M=z.ifft(w,E);return M.real.splice(u-1),M.imag.splice(u-1),M}}var O=!z.isContainsZero(e);O=O&&!z.isContainsZero(r);for(var T=new Array(t.length+n.length-1),F=new Array(t.length+n.length-1),P=0;P<T.length;P++)T[P]=0,F[P]=0;if(O)for(var S=0;S<n.length;S++)for(var D=0;D<t.length;D++)T[S+D]+=t[D]*n[S];else for(var A=0;A<n.length;A++)for(var V=0;V<t.length;V++)T[A+V]+=t[V]*n[A]-e[V]*r[A],F[A+V]+=t[V]*r[A]+e[V]*n[A];return{real:T,imag:F}},z.xcorr=function(t,e,n,r){var i=!1;if(t.length===n.length){i=!0;for(var o=0;o<t.length;o++)if(t[o]!==n[o]||e[o]!==r[o]){i=!1;break}}if(t.length===n.length){var a=t.length,u=2*a;if(1<<Math.round(Math.log(a)/Math.log(2))===a){var s=null;if(i){for(var l=new Array(u),c=new Array(u),h=0;h<u;h++)l[h]=h<a?t[h]:0,c[h]=h<a?e[h]:0;var f=z.powerfft(l,c);s=z.ifft(f,c),l.pop(),c.pop();for(var g=0,p=a+1;g<l.length;g++,p++)u<=p&&(p=0),l[g]=s.real[p],c[g]=s.imag[p];return{real:l,imag:c}}for(var m=new Array(u),_=new Array(u),N=new Array(u),v=new Array(u),I=0;I<u;I++)m[I]=I<a?t[I]:0,_[I]=I<a?e[I]:0,N[I]=I<a?n[a-I-1]:0,v[I]=I<a?-r[a-I-1]:0;for(var d=z.fft(m,_),y=z.fft(N,v),b=new Array(u),w=new Array(u),E=0;E<u;E++)b[E]=d.real[E]*y.real[E]-d.imag[E]*y.imag[E],w[E]=d.real[E]*y.imag[E]+d.imag[E]*y.real[E];return(s=z.ifft(b,w)).real.splice(u-1),s.imag.splice(u-1),s}}var x=!z.isContainsZero(e);if(x=x&&!z.isContainsZero(r),i){var M=t.length,O=2*M;if(x){for(var T=new Array(M),F=0;F<M;F++)for(var P=M-F,S=T[F]=0;S<P;S++)T[F]+=t[S]*n[S+F];for(var D=new Array(O-1),A=new Array(O-1),V=0,R=M-1;V<M;V++,R--)D[V]=T[R],D[M+V-1]=T[V];for(var C=0;C<A.length;C++)A[C]=0;return{real:D,imag:A}}}for(var Z=new Array(n.length),L=new Array(n.length),B=0;B<n.length;B++)Z[B]=n[n.length-B-1],L[B]=-r[n.length-B-1];var Y=z.conv(t,e,Z,L);if(t.length===n.length)return Y;for(var q=Math.abs(t.length-n.length),U=new Array(q),G=0;G<q;G++)U[G]=0;return t.length>n.length?{real:U.concat(Y.real),imag:U.concat(Y.imag)}:{real:Y.real.concat(U),imag:Y.imag.concat(U)}},z.window=function(t,e,n){var a,r=void 0!==n?n:"symmetric",i=t.toLocaleLowerCase(),u=e,s=new Array(u);"symmetric"===r||0===r?a=function(t){return t/(u-1)*(2*Math.PI)}:"periodic"!==r&&0===r||(a=function(t){return t/u*(2*Math.PI)});function o(t,e,n,r,i){for(var o=0;o<u;o++)s[o]=t,s[o]-=e*Math.cos(1*a(o)),s[o]+=n*Math.cos(2*a(o)),s[o]-=r*Math.cos(3*a(o)),s[o]+=i*Math.cos(4*a(o))}switch(i){case"rectangle":o(1,0,0,0,0);break;case"hann":o(.5,.5,0,0,0);break;case"hamming":o(.54,.46,0,0,0);break;case"blackman":o(.42,.5,.08,0,0);break;case"blackmanharris":o(.35875,.48829,.14128,.01168,0);break;case"blackmannuttall":o(.3635819,.4891775,.1365995,.0106411,0);break;case"flattop":o(1,1.93,1.29,.388,.032);break;case"sin":for(var l=0;l<u;l++)s[l]=Math.sin(.5*a(l));break;case"vorbis":for(var c=0;c<u;c++){var h=Math.sin(.5*a(c));s[c]=Math.sin(.5*Math.PI*h*h)}}return s},z.hann=function(t,e){return z.window("hann",t,e)},z.hamming=function(t,e){return z.window("hamming",t,e)};function F(){}F.fft=function(t,e){var n=e&&e.dimension?e.dimension:"auto";return J._toMatrix(t).eachVector(function(t){for(var e=new Array(t.length),n=new Array(t.length),r=0;r<t.length;r++)e[r]=t[r].real,n[r]=t[r].imag;for(var i=z.fft(e,n),o=new Array(t.length),a=0;a<t.length;a++)o[a]=new L([i.real[a],i.imag[a]]);return o},n)},F.ifft=function(t,e){var n=e&&e.dimension?e.dimension:"auto";return J._toMatrix(t).eachVector(function(t){for(var e=new Array(t.length),n=new Array(t.length),r=0;r<t.length;r++)e[r]=t[r].real,n[r]=t[r].imag;for(var i=z.ifft(e,n),o=new Array(t.length),a=0;a<t.length;a++)o[a]=new L([i.real[a],i.imag[a]]);return o},n)},F.powerfft=function(t,e){var n=e&&e.dimension?e.dimension:"auto";return J._toMatrix(t).eachVector(function(t){for(var e=new Array(t.length),n=new Array(t.length),r=0;r<t.length;r++)e[r]=t[r].real,n[r]=t[r].imag;for(var i=z.powerfft(e,n),o=new Array(t.length),a=0;a<t.length;a++)o[a]=new L(i[a]);return o},n)},F.dct=function(t,e){var n=e&&e.dimension?e.dimension:"auto",r=J._toMatrix(t);if(r.isComplex())throw"dct don't support complex numbers.";return r.eachVector(function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n].real;for(var r=z.dct(e),i=new Array(t.length),o=0;o<t.length;o++)i[o]=new L(r[o]);return i},n)},F.idct=function(t,e){var n=e&&e.dimension?e.dimension:"auto",r=J._toMatrix(t);if(r.isComplex())throw"idct don't support complex numbers.";return r.eachVector(function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n].real;for(var r=z.idct(e),i=new Array(t.length),o=0;o<t.length;o++)i[o]=new L(r[o]);return i},n)},F.fft2=function(t){return F.fft(t,{dimension:"both"})},F.ifft2=function(t){return F.ifft(t,{dimension:"both"})},F.dct2=function(t){return F.dct(t,{dimension:"both"})},F.idct2=function(t){return F.idct(t,{dimension:"both"})},F.conv=function(t,e){var n=J._toMatrix(t),r=J._toMatrix(e);if(n.isMatrix()||r.isMatrix())throw"conv don't support matrix numbers.";var i=new Array(n.length),o=new Array(n.length),a=new Array(r.length),u=new Array(r.length);if(n.isRow())for(var s=0;s<n.column_length;s++)i[s]=n.matrix_array[0][s].real,o[s]=n.matrix_array[0][s].imag;else for(var l=0;l<n.row_length;l++)i[l]=n.matrix_array[l][0].real,o[l]=n.matrix_array[l][0].imag;if(r.isRow())for(var c=0;c<r.column_length;c++)a[c]=r.matrix_array[0][c].real,u[c]=r.matrix_array[0][c].imag;else for(var h=0;h<r.row_length;h++)a[h]=r.matrix_array[h][0].real,u[h]=r.matrix_array[h][0].imag;for(var f=z.conv(i,o,a,u),g=new Array(f.real.length),p=0;p<f.real.length;p++)g[p]=new L([f.real[p],f.imag[p]]);var m=new J([g]);return r.isRow()?m:m.transpose()},F.xcorr=function(t,e){var n=J._toMatrix(t);if(!e)return n.xcorr(n);var r=J._toMatrix(e);if(n.isMatrix()||r.isMatrix())throw"conv don't support matrix numbers.";var i=new Array(n.length),o=new Array(n.length),a=new Array(r.length),u=new Array(r.length);if(n.isRow())for(var s=0;s<n.column_length;s++)i[s]=n.matrix_array[0][s].real,o[s]=n.matrix_array[0][s].imag;else for(var l=0;l<n.row_length;l++)i[l]=n.matrix_array[l][0].real,o[l]=n.matrix_array[l][0].imag;if(r.isRow())for(var c=0;c<r.column_length;c++)a[c]=r.matrix_array[0][c].real,u[c]=r.matrix_array[0][c].imag;else for(var h=0;h<r.row_length;h++)a[h]=r.matrix_array[h][0].real,u[h]=r.matrix_array[h][0].imag;for(var f=z.xcorr(i,o,a,u),g=new Array(f.real.length),p=0;p<f.real.length;p++)g[p]=new L([f.real[p],f.imag[p]]);var m=new J([g]);return n.isRow()?m:m.transpose()},F.window=function(t,e,n){var r=J._toInteger(e),i=z.window(t,r,n);return new J(i).transpose()},F.hann=function(t,e){return F.window("hann",t,e)},F.hamming=function(t,e){return F.window("hamming",t,e)},F.fftshift=function(t,e){var n=J._toMatrix(t);if(n.isVector()){var r=Math.floor(n.length/2);return n.circshift(r,e)}var i=Math.floor(n.column_length/2),o=Math.floor(n.row_length/2);if(void 0!==e){var a=e.dimension;if("row"===a||1===a)return n.circshift(i,e);if("column"===a||2===a)return n.circshift(o,e)}return n.circshift(i,{dimension:"row"}).circshift(o,{dimension:"column"})};function P(t){}var S={booleanValue:{configurable:!0},intValue:{configurable:!0},doubleValue:{configurable:!0}},D={MINUS_ONE:{configurable:!0},ZERO:{configurable:!0},ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};P.create=function(t){return null},P.valueOf=function(t){return null},P.prototype.toString=function(){return"no"},P.prototype.toJSON=function(){return this.toString()},P.prototype.clone=function(){return null},P.prototype.abs=function(){return null},P.prototype.negate=function(){return null},P.prototype.sign=function(){return null},P.prototype.add=function(t){return null},P.prototype.sub=function(t){return null},P.prototype.mul=function(t){return null},P.prototype.div=function(t){return null},P.prototype.inv=function(){return null},P.prototype.rem=function(t){return null},P.prototype.mod=function(t){return null},P.prototype.modPow=function(t,e){return null},P.prototype.modInverse=function(t){return null},P.prototype.factorial=function(){return null},P.prototype.scaleByPowerOfTen=function(t){return null},P.prototype.pow=function(t){return null},P.prototype.square=function(){return null},S.booleanValue.get=function(){return null},S.intValue.get=function(){return null},S.doubleValue.get=function(){return null},P.prototype.toBigInteger=function(){return null},P.prototype.toBigDecimal=function(t){return null},P.prototype.toFraction=function(){return null},P.prototype.toComplex=function(){return null},P.prototype.toMatrix=function(){return null},P.prototype.equals=function(t){return null},P.prototype.compareTo=function(t){return null},P.prototype.floor=function(){return null},P.prototype.ceil=function(){return null},P.prototype.round=function(){return null},P.prototype.fix=function(){return null},P.prototype.fract=function(){return H.ZERO},P.prototype.factor=function(){return null},P.prototype.gcd=function(t){return null},P.prototype.extgcd=function(t){return null},P.prototype.lcm=function(t){return null},P.prototype.isPrime=function(){return null},P.prototype.isProbablePrime=function(t){return null},P.prototype.nextProbablePrime=function(t,e){return null},P.prototype.shift=function(t){return null},P.prototype.and=function(t){return null},P.prototype.or=function(t){return null},P.prototype.xor=function(t){return null},P.prototype.not=function(){return null},P.prototype.isZero=function(){return null},P.prototype.isOne=function(){return null},P.prototype.isPositive=function(){return null},P.prototype.isNegative=function(){return null},P.prototype.isNotNegative=function(){return null},P.prototype.isNaN=function(){return null},P.prototype.isPositiveInfinity=function(){return null},P.prototype.isNegativeInfinity=function(){return null},P.prototype.isInfinite=function(){return null},P.prototype.isFinite=function(){return null},D.MINUS_ONE.get=function(){return null},D.ZERO.get=function(){return null},D.ONE.get=function(){return null},D.TWO.get=function(){return null},D.TEN.get=function(){return null},D.POSITIVE_INFINITY.get=function(){return null},D.NEGATIVE_INFINITY.get=function(){return null},D.NaN.get=function(){return null},P.prototype.signum=function(){return this.sign()},P.prototype.subtract=function(t){return this.sub(t)},P.prototype.multiply=function(t){return this.mul(t)},P.prototype.divide=function(t){return this.div(t)},P.prototype.remainder=function(t){return this.rem(t)},Object.defineProperties(P.prototype,S),Object.defineProperties(P,D);function A(){}var V=function(e){function t(t){e.call(this)}e&&(t.__proto__=e);var n={PI:{configurable:!0},QUARTER_PI:{configurable:!0},HALF_PI:{configurable:!0},TWO_PI:{configurable:!0},E:{configurable:!0},LN2:{configurable:!0},LN10:{configurable:!0},LOG2E:{configurable:!0},LOG10E:{configurable:!0},SQRT2:{configurable:!0},SQRT1_2:{configurable:!0},HALF:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.sqrt=function(){return null},t.prototype.cbrt=function(){return null},t.prototype.rsqrt=function(){return null},t.prototype.log=function(){return null},t.prototype.exp=function(){return null},t.prototype.expm1=function(){return null},t.prototype.log1p=function(){return null},t.prototype.log2=function(){return null},t.prototype.log10=function(){return null},t.prototype.sin=function(){return null},t.prototype.cos=function(){return null},t.prototype.tan=function(){return null},t.prototype.atan=function(){return null},t.prototype.atan2=function(t){return null},t.prototype.asin=function(){return null},t.prototype.acos=function(){return null},t.prototype.sinh=function(){return null},t.prototype.asinh=function(){return null},t.prototype.cosh=function(){return null},t.prototype.acosh=function(){return null},t.prototype.tanh=function(){return null},t.prototype.atanh=function(){return null},t.prototype.sec=function(){return null},t.prototype.asec=function(){return null},t.prototype.sech=function(){return null},t.prototype.asech=function(){return null},t.prototype.cot=function(){return null},t.prototype.acot=function(){return null},t.prototype.coth=function(){return null},t.prototype.acoth=function(){return null},t.prototype.csc=function(){return null},t.prototype.acsc=function(){return null},t.prototype.csch=function(){return null},t.prototype.acsch=function(){return null},t.prototype.logit=function(){return null},t.prototype.sinc=function(){return null},n.PI.get=function(){return null},n.QUARTER_PI.get=function(){return null},n.HALF_PI.get=function(){return null},n.TWO_PI.get=function(){return null},n.E.get=function(){return null},n.LN2.get=function(){return null},n.LN10.get=function(){return null},n.LOG2E.get=function(){return null},n.LOG10E.get=function(){return null},n.SQRT2.get=function(){return null},n.SQRT1_2.get=function(){return null},n.HALF.get=function(){return null},Object.defineProperties(t,n),t}(P);A.toPositionArrayFromObject=function(t,e,n){if("string"==typeof t){var r=A.toArrayFromString(t);if(":"===r){for(var i=new Array(e),o=0;o<e;o++)i[o]=o+n;return i}if(r instanceof Array){for(var a=r,u=new Array(a.length),s=0;s<a.length;s++)u[s]=Math.trunc(a[s].real);return u}throw"toArrayFromString["+t+"]["+r+"]"}var l=t;if(l instanceof J||l instanceof L||"number"==typeof l||(l=J._toMatrix(l)),l instanceof J){if(!l.isVector())throw"getMatrix argument "+l;var c=l.length,h=new Array(l.length);if(l.isRow())for(var f=0;f<c;f++)h[f]=Math.trunc(l.matrix_array[0][f].real);else if(l.isColumn())for(var g=0;g<c;g++)h[g]=Math.trunc(l.matrix_array[g][0].real);return h}return[J._toInteger(l)]},A.match2=function(t,e){for(var n=[],r=t,i=0;i<1e3;i++){var o=r.match(e);if(null===o){r.length&&n.push([!1,r]);break}0<o.index&&n.push([!1,r.substr(0,o.index)]),n.push([!0,o[0]]),r=r.substr(o.index+o[0].length)}return n},A.trimBracket=function(t){var e=t,n=!1;if(/'$/.test(e)){var r=e.match(/(\s*')*$/g)[0];n=(r.split("'").length-1)%2==1,e=e.substring(0,e.length-r.length)}return/^\[/.test(e)&&/\]$/.test(e)?{text:e.substring(1,e.length-1),is_transpose:n}:null},A.toMatrixArrayFromStringForArrayJSON=function(t){var e=[],n=t.match(/\[[^\]]+\]/g);null===n&&(n=[t]);for(var r=0;r<n.length;r++){for(var i=n[r],o=i.substring(1,i.length-1).split(","),a=[],u=0;u<o.length;u++){var s=o[u];a[u]=new L(s)}e[r]=a}return e},A.InterpolationCalculation=function(t,e,n,r){var i=t.compareTo(n),o=void 0===r||r;if(0===i)return[t];if(e.isZero())throw"IllegalArgumentException";if(e.isNegative()&&-1===i)throw"IllegalArgumentException";var a=[],u=t;a[0]=u;for(var s=1;s<65536;s++){if(u=u.add(e),o){if(n.compareTo(u)===i)break}else if(0<=n.compareTo(u)*i)break;a[s]=u}return a},A.toArrayFromMatch2String=function(t){for(var e=t,n=[],r=0;r<e.length;r++){var i=e[r];if(i[0])if(r<e.length-2&&!e[r+1][0]&&/:/.test(e[r+1][1])){var o=void 0,a=void 0,u=void 0;r<e.length-4&&!e[r+3][0]&&/:/.test(e[r+3][1])?(o=new L(i[1]),a=new L(e[r+2][1]),u=new L(e[r+4][1]),r+=4):(o=new L(i[1]),a=L.ONE,u=new L(e[r+2][1]),r+=2);for(var s=A.InterpolationCalculation(o,a,u,!0),l=0;l<s.length;l++)n.push(s[l])}else n.push(new L(i[1]))}return n},A.toArrayFromString=function(t){if(":"===t.trim())return":";var e=t.toLowerCase().replace(/infinity|inf/g,"1e100000"),n=new RegExp("("+/[+-]? *(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij]( *[+] *[- ]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan)))?/.source+")|("+/[+-]? *(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))( *[+-] *[- ]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij])?/.source+")","i");return A.toArrayFromMatch2String(A.match2(e,n))},A.toMatrixArrayFromStringForArraySPACE=function(t){for(var e=t.split(";"),n=new Array(e.length),r=0;r<e.length;r++)n[r]=A.toArrayFromString(e[r]);return n},A.toMatrixArrayFromStringInBracket=function(t){return/[[\]]/.test(t)?A.toMatrixArrayFromStringForArrayJSON(t):A.toMatrixArrayFromStringForArraySPACE(t)},A.toMatrixArrayFromString=function(t){var e=t.replace(/^\s*|\s*$/g,""),n=A.trimBracket(e);if(n){var r=A.toMatrixArrayFromStringInBracket(n.text);return n.is_transpose&&(r=new J(r).T().matrix_array),r}return/[;,]|[0-9]\s+[0-9]/.test(t)?A.toMatrixArrayFromStringInBracket(t.replace(/[[\]]/g,"").replace(/,/g," ")):[[new L(t)]]},A.isCorrectMatrixArray=function(t){if(0===t.length)return!1;var e=t[0].length;if(0===e)return!1;for(var n=1;n<t.length;n++)if(t[n].length!==e)return!1;return!0};function R(){}var J=function(f){function _(t){f.call(this);var e=null,n=!1;if(1!==arguments.length)throw"Matrix : Many arguments ["+arguments.length+"]";var r=t;if(r instanceof _){e=new Array(r.row_length);for(var i=0;i<r.row_length;i++){e[i]=new Array(r.column_length);for(var o=0;o<r.column_length;o++)e[i][o]=r.matrix_array[i][o]}}else if(r instanceof L)e=[[r]];else if(r instanceof Array){e=[];for(var a=0;a<r.length;a++){var u=r[a];if(u instanceof Array){for(var s=new Array(u.length),l=0;l<u.length;l++){var c=u[l];if(c instanceof L)s[l]=c;else if(c instanceof _){if(!c.isScalar())throw"Matrix in matrix";s[l]=c.scalar}else s[l]=new L(c)}e[a]=s}else if(0===a&&(e[0]=new Array(r.length)),u instanceof L)e[0][a]=u;else if(u instanceof _){if(!u.isScalar())throw"Matrix in matrix";e[0][a]=u.scalar}else e[0][a]=new L(u)}}else e="string"==typeof r?(n=!0,A.toMatrixArrayFromString(r)):r instanceof Object&&"doubleValue"in r?[[new L(r.doubleValue)]]:r instanceof Object?(n=!0,A.toMatrixArrayFromString(r.toString())):[[new L(r)]];if(n)for(var h=0;h<e.length;h++)":"===e[h]&&e.splice(h--,1);if(!A.isCorrectMatrixArray(e))throw console.log(e),"new Matrix IllegalArgumentException";this.matrix_array=e,this.row_length=this.matrix_array.length,this.column_length=this.matrix_array[0].length,this.string_cash=null}f&&(_.__proto__=f);var t={booleanValue:{configurable:!0},intValue:{configurable:!0},doubleValue:{configurable:!0},scalar:{configurable:!0},length:{configurable:!0},width:{configurable:!0},height:{configurable:!0},norm1:{configurable:!0},norm2:{configurable:!0}},e={ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},ZERO:{configurable:!0},MINUS_ONE:{configurable:!0},I:{configurable:!0},PI:{configurable:!0},QUARTER_PI:{configurable:!0},HALF_PI:{configurable:!0},TWO_PI:{configurable:!0},E:{configurable:!0},LN2:{configurable:!0},LN10:{configurable:!0},LOG2E:{configurable:!0},LOG10E:{configurable:!0},SQRT2:{configurable:!0},SQRT1_2:{configurable:!0},HALF:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};return((_.prototype=Object.create(f&&f.prototype)).constructor=_).create=function(t){return 1===arguments.length&&t instanceof _?t:new _(t)},_.valueOf=function(t){return _.create(t)},_._toMatrix=function(t){return t instanceof _?t:new _(t)},_._toComplex=function(t){if(t instanceof L)return t;var e=_._toMatrix(t);if(e.isScalar())return e.scalar;throw"not scalar. ["+t+"]"},_._toDouble=function(t){if("number"==typeof t)return t;var e=_._toComplex(t);if(e.isReal())return e.real;throw"not support complex numbers."},_._toInteger=function(t){return Math.trunc(_._toDouble(t))},_.prototype._clearCash=function(){this.string_cash&&delete this.string_cash},_.prototype.clone=function(){return new _(this.matrix_array)},_.prototype.toString=function(){if(this.string_cash)return this.string_cash;if(this.isScalar())return this.scalar.toString();var r=Math.pow(10,9),o=!1,i=!1,a=0;this._each(function(t,e,n){t.isReal()||(o=!0),Number.isFinite(t.real)&&Math.abs(t.real)>=r&&(i=!0),Number.isFinite(t.imag)&&Math.abs(t.imag)>=r&&(i=!0),a=Math.max(a,t.getDecimalPosition())}),0<a&&(a=4);function u(t){var e=i?t.toExponential(4):t.toFixed(a);if(/inf/i.test(e))return t===Number.POSITIVE_INFINITY?"Inf":"-Inf";if(/nan/i.test(e))return"NaN";if(!i)return e;var n=e.split("e"),r=n[1];return 2===r.length?r=r.substr(0,1)+"00"+r.substr(1):3===r.length&&(r=r.substr(0,1)+"0"+r.substr(1)),n[0]+"e"+r}var s=0,l=[];this._each(function(t){var e={},n=t.real;if(e.re_sign=n<0?"-":" ",n=Math.abs(n),e.re_str=u(n),s=Math.max(s,e.re_str.length+1),o){var r=t.imag;e.im_sign=r<0?"-":"+",r=Math.abs(r),e.im_str=u(r),s=Math.max(s,e.im_str.length+1)}l.push(e)});function c(t,e){return"                                        ".substr(0,e-t.length)+t}var h=[],f=this;return this._each(function(t,e,n){var r=l.shift(),i=c(r.re_sign+r.re_str,s);o&&(i+=" "+r.im_sign+c(r.im_str,s)+"i"),h.push(i),h.push(n<f.column_length-1?" ":"\n")}),this.string_cash=h.join(""),this.string_cash},_.prototype.toOneLineString=function(){if(this.isScalar())return this.scalar.toString();for(var t="[ ",e=0;e<this.row_length;e++)for(var n=0;n<this.column_length;n++)t+=this.matrix_array[e][n].toString(),n<this.column_length-1?t+=", ":e<this.row_length-1&&(t+="; ");return t+=" ]"},_.prototype.toJSON=function(){if(this.isScalar())return this.scalar.toJSON();for(var t="[",e=0;e<this.row_length;e++)for(var n=0;n<this.column_length;n++)t+=this.matrix_array[e][n].toJSON(),n<this.column_length-1?t+=",":e<this.row_length-1&&(t+=";");return t+="]"},_.prototype.equals=function(t,e){var n=this,r=_._toMatrix(t);if(n.row_length!==r.row_length||n.column_length!==r.column_length)return!1;if(1===n.row_length&&1===n.column_length)return n.scalar.equals(r.scalar,e);for(var i=n.matrix_array,o=r.matrix_array,a=0;a<this.row_length;a++)for(var u=0;u<this.column_length;u++)if(!i[a][u].equals(o[a][u],e))return!1;return!0},_.prototype.getNumberMatrixArray=function(){for(var t=new Array(this.row_length),e=0;e<this.row_length;e++){t[e]=new Array(this.column_length);for(var n=0;n<this.column_length;n++)t[e][n]=this.matrix_array[e][n].real}return t},_.prototype.getComplexMatrixArray=function(){for(var t=new Array(this.row_length),e=0;e<this.row_length;e++){t[e]=new Array(this.column_length);for(var n=0;n<this.column_length;n++)t[e][n]=this.matrix_array[e][n]}return t},_.prototype._each=function(t){for(var e=!1,n=0;n<this.row_length;n++)for(var r=0;r<this.column_length;r++){var i=t(this.matrix_array[n][r],n,r);void 0!==i&&(this.matrix_array[n][r]=i instanceof L?i:i instanceof _?i.scalar:new L(i),e=!0)}return e&&this._clearCash(),this},_.prototype.cloneMatrixDoEachCalculation=function(t){return this.clone()._each(t)},_.createMatrixDoEachCalculation=function(t,e,n){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";for(var r=_._toInteger(e),i=n?_._toInteger(n):r,o=new Array(r),a=0;a<r;a++){o[a]=new Array(i);for(var u=0;u<i;u++){var s=t(a,u);o[a][u]=void 0===s?L.ZERO:_._toComplex(s)}}return new _(o)},_.prototype.eachVectorAuto=function(t){if(this.isRow()){for(var e=new Array(this.row_length),n=0;n<this.column_length;n++)e[n]=this.matrix_array[0][n];return new _(t(e))}var r=_.ZERO;r._resize(1,this.column_length);for(var i=0;i<this.column_length;i++){for(var o=new Array(this.row_length),a=0;a<this.row_length;a++)o[a]=this.matrix_array[a][i];var u=t(o);r._resize(Math.max(r.row_length,u.length),r.column_length);for(var s=0;s<u.length;s++)r.matrix_array[s][i]=u[s]}return r},_.prototype.eachVectorBoth=function(t){var e=_.ZERO;e._resize(this.row_length,1);for(var n=0;n<this.row_length;n++){for(var r=new Array(this.column_length),i=0;i<this.column_length;i++)r[i]=this.matrix_array[n][i];var o=t(r);e._resize(e.row_length,Math.max(e.column_length,o.length));for(var a=0;a<o.length;a++)e.matrix_array[n][a]=o[a]}var u=_.ZERO;u._resize(1,e.column_length);for(var s=0;s<e.column_length;s++){for(var l=new Array(e.row_length),c=0;c<e.row_length;c++)l[c]=e.matrix_array[c][s];var h=t(l);u._resize(Math.max(u.row_length,h.length),u.column_length);for(var f=0;f<h.length;f++)u.matrix_array[f][s]=h[f]}return u},_.prototype.eachVectorRow=function(t){var e=_.ZERO;e._resize(this.row_length,1);for(var n=0;n<this.row_length;n++){for(var r=new Array(this.column_length),i=0;i<this.column_length;i++)r[i]=this.matrix_array[n][i];var o=t(r);e._resize(e.row_length,Math.max(e.column_length,o.length));for(var a=0;a<o.length;a++)e.matrix_array[n][a]=o[a]}return e},_.prototype.eachVectorColumn=function(t){var e=_.ZERO;e._resize(1,this.column_length);for(var n=0;n<this.column_length;n++){for(var r=new Array(this.row_length),i=0;i<this.row_length;i++)r[i]=this.matrix_array[i][n];var o=t(r);e._resize(Math.max(e.row_length,o.length),e.column_length);for(var a=0;a<o.length;a++)e.matrix_array[a][n]=o[a]}return e},_.prototype.eachVector=function(t,e){var n=void 0!==e?e:"auto";if("string"==typeof n?n=n.toLocaleLowerCase():"number"!=typeof n&&(n=_._toInteger(n)),"auto"===n||0===n)return this.eachVectorAuto(t);if("row"===n||1===n)return this.eachVectorRow(t);if("column"===n||2===n)return this.eachVectorColumn(t);if("both"===n||3===n)return this.eachVectorBoth(t);throw"eachVector argument "+e},_.prototype.getMatrix=function(t,e,n){void 0===n&&(n=!1);for(var r=n?1:0,i=A.toPositionArrayFromObject(t,this.row_length,r),o=A.toPositionArrayFromObject(e,this.column_length,r),a=this.matrix_array,u=new Array(i.length),s=0;s<i.length;s++){for(var l=new Array(o.length),c=0;c<o.length;c++)l[c]=a[i[s]-r][o[c]-r];u[s]=l}return new _(u)},_.prototype.setMatrix=function(t,e,n,r){void 0===r&&(r=!1);for(var i=r?1:0,o=A.toPositionArrayFromObject(t,this.row_length,i),a=A.toPositionArrayFromObject(e,this.column_length,i),u=new _(this).matrix_array,s=_._toMatrix(n),l=s.matrix_array,c=0;c<o.length;c++)for(var h=0;h<a.length;h++)u[o[c]-i][a[h]-i]=l[c%s.row_length][h%s.column_length];return new _(u)},_.prototype.getComplex=function(t,e){var n=null,r=null;return 1===arguments.length?n=_._toInteger(t):2===arguments.length&&(n=_._toInteger(t),r=_._toInteger(e)),this.isRow()?this.matrix_array[0][n]:this.isColumn()?this.matrix_array[n][0]:this.matrix_array[n][r]},t.booleanValue.get=function(){return this.matrix_array[0][0].booleanValue},t.intValue.get=function(){return this.matrix_array[0][0].intValue},t.doubleValue.get=function(){return this.matrix_array[0][0].doubleValue},_.prototype.toBigInteger=function(){return new H(this.intValue)},_.prototype.toBigDecimal=function(t){return new $(t?[this.doubleValue,t]:this.doubleValue)},_.prototype.toFraction=function(){return new q(this.doubleValue)},_.prototype.toComplex=function(){return this.scalar},_.prototype.toMatrix=function(){return this},t.scalar.get=function(){return this.matrix_array[0][0]},t.length.get=function(){return this.row_length>this.column_length?this.row_length:this.column_length},t.width.get=function(){return this.column_length},t.height.get=function(){return this.row_length},t.norm1.get=function(){return I.norm(this,1)},t.norm2.get=function(){return I.norm(this,2)},_.prototype.norm=function(t){return I.norm(this,t)},_.prototype.cond=function(t){return I.cond(this,t)},_.prototype.rcond=function(){return I.rcond(this)},_.prototype.rank=function(t){return I.rank(this,t)},_.prototype.trace=function(){return I.trace(this)},_.prototype.det=function(){return I.det(this)},_.memset=function(t,e,n){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";var r=_._toMatrix(t);if(r.isScalar()){var i=r.scalar;return _.createMatrixDoEachCalculation(function(){return i},e,n)}var o=r.matrix_array,a=r.row_length,u=r.column_length;return _.createMatrixDoEachCalculation(function(t,e){return o[t%a][e%u]},e,n)},_.eye=function(t,e){return _.createMatrixDoEachCalculation(function(t,e){return t===e?L.ONE:L.ZERO},t,e)},_.zeros=function(t,e){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return _.memset(L.ZERO,t,e)},_.ones=function(t,e){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return _.memset(L.ONE,t,e)},_.prototype.diag=function(){if(this.isVector()){var n=this;return _.createMatrixDoEachCalculation(function(t,e){return t===e?n.getComplex(t):L.ZERO},this.length)}for(var t=Math.min(this.row_length,this.column_length),e=new Array(t),r=0;r<t;r++)e[r]=new Array(1),e[r][0]=this.matrix_array[r][r];return new _(e)},_.prototype.isScalar=function(){return 1===this.row_length&&1==this.column_length},_.prototype.isRow=function(){return 1===this.row_length},_.prototype.isColumn=function(){return 1===this.column_length},_.prototype.isVector=function(){return 1===this.row_length||1===this.column_length},_.prototype.isMatrix=function(){return 1!==this.row_length&&1!==this.column_length},_.prototype.isSquare=function(){return this.row_length===this.column_length},_.prototype.isReal=function(e){var n=!0;return this._each(function(t){n&&t.isComplex(e)&&(n=!1)}),n},_.prototype.isComplex=function(t){return!this.isReal(t)},_.prototype.isZeros=function(t){var e=!0,n=t||1e-10;return this._each(function(t){e&&!t.isZero(n)&&(e=!1)}),e},_.prototype.isIdentity=function(t){var r=!0,i=t||1e-10;return this._each(function(t,e,n){r&&(e===n?t.isOne(i)||(r=!1):t.isZero(i)||(r=!1))}),r},_.prototype.isDiagonal=function(t){var r=!0,i=t||1e-10;return this._each(function(t,e,n){r&&e!==n&&!t.isZero(i)&&(r=!1)}),r},_.prototype.isTridiagonal=function(t){var r=!0,i=t||1e-10;return this._each(function(t,e,n){r&&1<Math.abs(e-n)&&!t.isZero(i)&&(r=!1)}),r},_.prototype.isRegular=function(t){if(!this.isSquare())return!1;var e=t||1e-10;return this.rank(e)===this.row_length},_.prototype.isOrthogonal=function(t){if(!this.isSquare())return!1;var e=t||1e-10;return this.mul(this.transpose()).isIdentity(e)},_.prototype.isUnitary=function(t){if(!this.isSquare())return!1;var e=t||1e-10;return this.mul(this.ctranspose()).isIdentity(e)},_.prototype.isSymmetric=function(t){if(!this.isSquare())return!1;for(var e=t||1e-10,n=0;n<this.row_length;n++)for(var r=n+1;r<this.column_length;r++)if(!this.matrix_array[n][r].equals(this.matrix_array[r][n],e))return!1;return!0},_.prototype.isHermitian=function(t){if(!this.isSquare())return!1;for(var e=t||1e-10,n=0;n<this.row_length;n++)for(var r=n;r<this.column_length;r++)if(n===r){if(!this.matrix_array[n][r].isReal(e))return!1}else if(!this.matrix_array[n][r].equals(this.matrix_array[r][n].conj(),e))return!1;return!0},_.prototype.isTriangleUpper=function(t){var r=!0,i=t||1e-10;return this._each(function(t,e,n){r&&n<e&&!t.isZero(i)&&(r=!1)}),r},_.prototype.isTriangleLower=function(t){var r=!0,i=t||1e-10;return this._each(function(t,e,n){r&&e<n&&!t.isZero(i)&&(r=!1)}),r},_.prototype.isPermutation=function(t){if(!this.isSquare())return!1;for(var e=t||1e-10,n=new Array(this.row_length),r=new Array(this.column_length),i=0;i<this.row_length;i++)for(var o=0;o<this.column_length;o++){var a=this.matrix_array[i][o];if(a.isOne(e)){if(n[i]||r[o])return!1;n[i]=1,r[o]=1}else if(!a.isZero(e))return!1}for(var u=0;u<this.row_length;u++)if(void 0===n[u]||void 0===r[u])return!1;return!0},_.prototype.size=function(t){if(void 0!==t){var e=t;if("string"==typeof e?e=e.toLocaleLowerCase():"number"!=typeof e&&(e=_._toInteger(e)),"row"===e||1===e)return new _(this.row_length);if("column"===e||2===e)return new _(this.column_length)}return new _([[this.row_length,this.column_length]])},_.prototype.compareTo=function(t,e){var n=_._toMatrix(t);if(this.isScalar()&&n.isScalar())return this.scalar.compareTo(n.scalar,e);throw"IllegalArgumentException"},_.prototype.compareToMatrix=function(t,n){var r=this,i=_._toMatrix(t),o=r.matrix_array,a=i.matrix_array,e=Math.max(r.row_length,i.row_length),u=Math.max(r.column_length,i.column_length);return _.createMatrixDoEachCalculation(function(t,e){return o[t%r.row_length][e%r.column_length].compareTo(a[t%i.row_length][e%i.column_length],n)},e,u)},_.prototype.add=function(t){var n=this,r=_._toMatrix(t);if(n.row_length!==r.row_length&&n.column_length!==r.column_length)throw"Matrix size does not match";var i=n.matrix_array,o=r.matrix_array,e=Math.max(n.row_length,r.row_length),a=Math.max(n.column_length,r.column_length);return _.createMatrixDoEachCalculation(function(t,e){return i[t%n.row_length][e%n.column_length].add(o[t%r.row_length][e%r.column_length])},e,a)},_.prototype.sub=function(t){var n=this,r=_._toMatrix(t);if(n.row_length!==r.row_length&&n.column_length!==r.column_length)throw"Matrix size does not match";var i=n.matrix_array,o=r.matrix_array,e=Math.max(n.row_length,r.row_length),a=Math.max(n.column_length,r.column_length);return _.createMatrixDoEachCalculation(function(t,e){return i[t%n.row_length][e%n.column_length].sub(o[t%r.row_length][e%r.column_length])},e,a)},_.prototype.mul=function(t){var e=this,n=_._toMatrix(t),r=e.matrix_array,i=n.matrix_array;if(e.isScalar()&&n.isScalar())return new _(e.scalar.mul(n.scalar));if(e.isScalar()){for(var o=new Array(n.row_length),a=0;a<n.row_length;a++){o[a]=new Array(n.column_length);for(var u=0;u<n.column_length;u++)o[a][u]=e.scalar.mul(i[a][u])}return new _(o)}if(n.isScalar()){for(var s=new Array(e.row_length),l=0;l<e.row_length;l++){s[l]=new Array(e.column_length);for(var c=0;c<e.column_length;c++)s[l][c]=r[l][c].mul(n.scalar)}return new _(s)}if(e.column_length!==n.row_length)throw"Matrix size does not match";for(var h=new Array(e.row_length),f=0;f<e.row_length;f++){h[f]=new Array(n.column_length);for(var g=0;g<n.column_length;g++){for(var p=L.ZERO,m=0;m<e.column_length;m++)p=p.add(r[f][m].mul(i[m][g]));h[f][g]=p}}return new _(h)},_.prototype.div=function(t){var e=this,n=_._toMatrix(t),r=e.matrix_array;if(e.isScalar()&&n.isScalar())return new _(e.scalar.div(n.scalar));if(n.isScalar()){for(var i=new Array(e.row_length),o=0;o<e.row_length;o++){i[o]=new Array(e.column_length);for(var a=0;a<e.column_length;a++)i[o][a]=r[o][a].div(n.scalar)}return new _(i)}if(n.row_length===n.column_length){return 1e-10<n.det().scalar.norm?this.mul(n.inv()):this.mul(n.pinv())}if(e.column_length!==n.column_length)throw"Matrix size does not match";throw"warning"},_.prototype.inv=function(){return I.inv(this)},_.prototype.dotmul=function(t){var n=this,r=_._toMatrix(t);if(!n.isScalar()&&!r.isScalar()&&n.row_length!==r.row_length&&n.column_length!==r.column_length)throw"Matrix size does not match";var i=n.matrix_array,o=r.matrix_array,e=Math.max(n.row_length,r.row_length),a=Math.max(n.column_length,r.column_length);return _.createMatrixDoEachCalculation(function(t,e){return i[t%n.row_length][e%n.column_length].mul(o[t%r.row_length][e%r.column_length])},e,a)},_.prototype.dotdiv=function(t){var n=this,r=_._toMatrix(t);if(!n.isScalar()&&!r.isScalar()&&n.row_length!==r.row_length&&n.column_length!==r.column_length)throw"Matrix size does not match";var i=n.matrix_array,o=r.matrix_array,e=Math.max(n.row_length,r.row_length),a=Math.max(n.column_length,r.column_length);return _.createMatrixDoEachCalculation(function(t,e){return i[t%n.row_length][e%n.column_length].div(o[t%r.row_length][e%r.column_length])},e,a)},_.prototype.dotinv=function(){var n=this.matrix_array;return _.createMatrixDoEachCalculation(function(t,e){return n[t][e].inv()},this.row_length,this.column_length)},_.prototype.nmul=function(t){return this.dotmul(t)},_.prototype.ndiv=function(t){return this.dotdiv(t)},_.prototype.ninv=function(){return this.dotinv()},_.prototype.npow=function(t){return this.dotpow(t)},_.prototype.rem=function(t){var n=this,r=_._toMatrix(t);if(!n.isScalar()&&!r.isScalar()&&n.row_length!==r.row_length&&n.column_length!==r.column_length)throw"Matrix size does not match";var i=n.matrix_array,o=r.matrix_array,e=Math.max(n.row_length,r.row_length),a=Math.max(n.column_length,r.column_length);return _.createMatrixDoEachCalculation(function(t,e){return i[t%n.row_length][e%n.column_length].rem(o[t%r.row_length][e%r.column_length])},e,a)},_.prototype.mod=function(t){var n=this,r=_._toMatrix(t);if(!n.isScalar()&&!r.isScalar()&&n.row_length!==r.row_length&&n.column_length!==r.column_length)throw"Matrix size does not match";var i=n.matrix_array,o=r.matrix_array,e=Math.max(n.row_length,r.row_length),a=Math.max(n.column_length,r.column_length);return _.createMatrixDoEachCalculation(function(t,e){return i[t%n.row_length][e%n.column_length].mod(o[t%r.row_length][e%r.column_length])},e,a)},_.prototype.real=function(){return this.cloneMatrixDoEachCalculation(function(t){return new L(t.real)})},_.prototype.imag=function(){return this.cloneMatrixDoEachCalculation(function(t){return new L(t.imag)})},_.prototype.arg=function(){return this.cloneMatrixDoEachCalculation(function(t){return new L(t.arg)})},_.prototype.sign=function(){return this.cloneMatrixDoEachCalculation(function(t){return new L(t.sign())})},_.prototype.floor=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.floor()})},_.prototype.ceil=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.ceil()})},_.prototype.round=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.round()})},_.prototype.fix=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fix()})},_.prototype.fract=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fract()})},_.prototype.abs=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.abs()})},_.prototype.conj=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.conj()})},_.prototype.negate=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.negate()})},_.prototype.pow=function(t){if(this.isScalar())return new _(this.scalar.pow(_._toDouble(t)));if(!this.isSquare())throw"not square "+this;var e,n,r=_._toInteger(t);if(r<0)throw"error negative number "+r;for(e=this.clone(),n=_.eye(this.length);0!==r;)0!=(1&r)&&(n=n.mul(e)),e=e.mul(e),r>>>=1;return n},_.prototype.dotpow=function(t){var n=this,r=_._toMatrix(t);if(!n.isScalar()&&!r.isScalar()&&n.row_length!==r.row_length&&n.column_length!==r.column_length)throw"Matrix size does not match";var i=n.matrix_array,o=r.matrix_array,e=Math.max(n.row_length,r.row_length),a=Math.max(n.column_length,r.column_length);return _.createMatrixDoEachCalculation(function(t,e){return i[t%n.row_length][e%n.column_length].pow(o[t%r.row_length][e%r.column_length])},e,a)},_.prototype.square=function(){return this.pow(2)},_.prototype.sqrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sqrt()})},_.prototype.cbrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cbrt()})},_.prototype.rsqrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.rsqrt()})},_.prototype.log=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log()})},_.prototype.exp=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.exp()})},_.prototype.expm1=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.expm1()})},_.prototype.log1p=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log1p()})},_.prototype.log2=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log2()})},_.prototype.log10=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log10()})},_.prototype.sin=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sin()})},_.prototype.cos=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cos()})},_.prototype.tan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.tan()})},_.prototype.atan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.atan()})},_.prototype.atan2=function(t){var e=_._toComplex(t);return this.cloneMatrixDoEachCalculation(function(t){return t.atan2(e)})},_.prototype.asin=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asin()})},_.prototype.acos=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acos()})},_.prototype.sinh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sinh()})},_.prototype.asinh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asinh()})},_.prototype.cosh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cosh()})},_.prototype.acosh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acosh()})},_.prototype.tanh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.tanh()})},_.prototype.atanh=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.atanh()})},_.prototype.sec=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sec()})},_.prototype.asec=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asec()})},_.prototype.sech=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sech()})},_.prototype.asech=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.asech()})},_.prototype.cot=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cot()})},_.prototype.acot=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acot()})},_.prototype.coth=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.coth()})},_.prototype.acoth=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acoth()})},_.prototype.csc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.csc()})},_.prototype.acsc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acsc()})},_.prototype.csch=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.csch()})},_.prototype.acsch=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.acsch()})},_.prototype.logit=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.logit()})},_.prototype.sinc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sinc()})},_.rand=function(t,e,n){return _.createMatrixDoEachCalculation(function(){return L.rand(n)},t,e)},_.randn=function(t,e,n){return _.createMatrixDoEachCalculation(function(){return L.randn(n)},t,e)},_.prototype.testInteger=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isInteger(e)?L.ONE:L.ZERO})},_.prototype.testComplexInteger=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplexInteger(e)?L.ONE:L.ZERO})},_.prototype.testZero=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isZero(e)?L.ONE:L.ZERO})},_.prototype.testOne=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isOne(e)?L.ONE:L.ZERO})},_.prototype.testComplex=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplex(e)?L.ONE:L.ZERO})},_.prototype.testReal=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isReal(e)?L.ONE:L.ZERO})},_.prototype.testNaN=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNaN()?L.ONE:L.ZERO})},_.prototype.testPositive=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isPositive()?L.ONE:L.ZERO})},_.prototype.testNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNegative()?L.ONE:L.ZERO})},_.prototype.testNotNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNotNegative()?L.ONE:L.ZERO})},_.prototype.testPositiveInfinity=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isPositiveInfinity()?L.ONE:L.ZERO})},_.prototype.testNegativeInfinity=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNegativeInfinity()?L.ONE:L.ZERO})},_.prototype.testInfinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isInfinite()?L.ONE:L.ZERO})},_.prototype.testFinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isFinite()?L.ONE:L.ZERO})},_.prototype.isZero=function(t){return this.scalar.isZero(t)},_.prototype.isOne=function(t){return this.scalar.isOne(t)},_.prototype.isPositive=function(){return this.scalar.isPositive()},_.prototype.isNegative=function(){return this.scalar.isNegative()},_.prototype.isNotNegative=function(){return this.scalar.isNotNegative()},_.prototype.isNaN=function(){return this.scalar.isNaN()},_.prototype.isPositiveInfinity=function(){return this.scalar.isPositiveInfinity()},_.prototype.isNegativeInfinity=function(){return this.scalar.isNegativeInfinity()},_.prototype.isInfinite=function(){return this.scalar.isInfinite()},_.prototype.isFinite=function(){return this.scalar.isFinite()},_.prototype.isInteger=function(t){return this.scalar.isInteger(t)},_.prototype.isComplexInteger=function(t){return this.scalar.isComplexInteger(t)},_.prototype._rot90=function(t){var e=_._toInteger(t),n=1;if(1===arguments.length&&(n=(e%4+4)%4),0===n)return this;for(var r=new Array(this.row_length),i=0;i<this.row_length;i++){r[i]=new Array(this.column_length);for(var o=0;o<this.column_length;o++)r[i][o]=this.matrix_array[i][o]}var a=this.matrix_array;if(1===n){a.splice(this.column_length);for(var u=0;u<this.column_length;u++){u<this.row_length?a[u].splice(this.row_length):a[u]=new Array(this.row_length);for(var s=0;s<this.row_length;s++)a[u][s]=r[this.row_length-s-1][u]}}else if(2===n)for(var l=0;l<this.row_length;l++)for(var c=0;c<this.column_length;c++)a[l][c]=r[this.row_length-l-1][this.column_length-c-1];else if(3===n){a.splice(this.column_length);for(var h=0;h<this.column_length;h++){h<this.row_length?a[h].splice(this.row_length):a[h]=new Array(this.row_length);for(var f=0;f<this.row_length;f++)a[h][f]=r[f][this.column_length-h-1]}}return this.row_length=a.length,this.column_length=a[0].length,this._clearCash(),this},_.prototype.rot90=function(t){return this.clone()._rot90(t)},_.prototype._resize=function(t,e){var n=_._toInteger(t),r=_._toInteger(e);if(n===this.row_length&&r===this.column_length)return this;if(n<=0||r<=0)throw"_resize";for(var i=Math.max(this.row_length,n),o=Math.max(this.column_length,r),a=this.matrix_array,u=0;u<i;u++){u>=this.row_length&&(a[u]=new Array(o));for(var s=0;s<o;s++)(u>=this.row_length||s>=this.column_length)&&(a[u][s]=L.ZERO)}if(this.row_length>n&&a.splice(n),this.column_length>r)for(var l=0;l<a.length;l++)a[l].splice(r);return this.row_length=n,this.column_length=r,this._clearCash(),this},_.prototype.resize=function(t,e){return this.clone()._resize(t,e)},_.prototype._deleteRow=function(t){var e=_._toInteger(t);if(1===this.row_length||this.row_length<=e)throw"_deleteRow";return this.matrix_array.splice(e,1),this.row_length--,this._clearCash(),this},_.prototype._deleteColumn=function(t){var e=_._toInteger(t);if(1===this.column_length||this.column_length<=e)throw"_deleteColumn";for(var n=0;n<this.row_length;n++)this.matrix_array[n].splice(e,1);return this.column_length--,this._clearCash(),this},_.prototype.deleteRow=function(t){return this.clone()._deleteRow(t)},_.prototype.deleteColumn=function(t){return this.clone()._deleteColumn(t)},_.prototype._exchangeRow=function(t,e){var n=_._toInteger(t),r=_._toInteger(e);if(1===this.row_length||this.row_length<=n||this.row_length<=r)throw"_exchangeRow";if(n===r)return this;var i=this.matrix_array[n];return this.matrix_array[n]=this.matrix_array[r],this.matrix_array[r]=i,this._clearCash(),this},_.prototype._exchangeColumn=function(t,e){var n=_._toInteger(t),r=_._toInteger(e);if(1===this.column_length||this.column_length<=n||this.column_length<=r)throw"_exchangeColumn";if(n===r)return this;for(var i=0;i<this.row_length;i++){var o=this.matrix_array[i][n];this.matrix_array[i][n]=this.matrix_array[i][r],this.matrix_array[i][r]=o}return this._clearCash(),this},_.prototype.exchangeRow=function(t,e){return this.clone()._exchangeRow(t,e)},_.prototype.exchangeColumn=function(t,e){return this.clone()._exchangeColumn(t,e)},_.prototype._concatRight=function(t){var e=_._toMatrix(t);if(this.row_length!=e.row_length)throw"_concatRight";for(var n=0;n<this.row_length;n++)for(var r=0;r<e.column_length;r++)this.matrix_array[n].push(e.matrix_array[n][r]);return this.column_length+=e.column_length,this._clearCash(),this},_.prototype._concatBottom=function(t){var e=_._toMatrix(t);if(this.column_length!=e.column_length)throw"_concatBottom";for(var n=0;n<e.row_length;n++)this.matrix_array.push(e.matrix_array[n]);return this.row_length+=e.row_length,this._clearCash(),this},_.prototype.concatRight=function(t){return this.clone()._concatRight(t)},_.prototype.concatBottom=function(t){return this.clone()._concatBottom(t)},_.prototype.clip=function(t,e){var o=_._toMatrix(t),a=_._toMatrix(e),u=o.matrix_array,s=a.matrix_array;return this.cloneMatrixDoEachCalculation(function(t,e,n){var r=u[e%o.row_length][n%o.column_length],i=s[e%a.row_length][n%a.column_length];return t.clip(r,i)})},_.arange=function(t,e,n){var r=void 0!==e?_._toComplex(t):L.ZERO,i=_._toComplex(void 0!==e?e:t),o=void 0!==n?_._toComplex(n):L.ONE;return new _(A.InterpolationCalculation(r,o,i,!1))},_.prototype.circshift=function(t,e){var i=_._toInteger(t),n=e&&e.dimension?e.dimension:"auto";return this.eachVector(function(t){for(var e=new Array(t.length),n=(-i%t.length+t.length)%t.length,r=0;r<t.length;r++)e[r]=t[n++],n===t.length&&(n=0);return e},n)},_.prototype.roll=function(t,e){return this.circshift(t,e)},_.prototype.reshape=function(t,e){var n=_._toInteger(t),r=_._toInteger(e),i=this.row_length*this.column_length,o=n*r;if(i!=o)throw"reshape error. (this_size !== new_size)->("+i+" !== "+o+")";for(var a=this.matrix_array,u=0,s=0,l=new Array(n),c=0;c<n;c++){l[c]=new Array(r);for(var h=0;h<r;h++)l[c][h]=a[s][u],++u===this.column_length&&(u=0,s++)}return new _(l)},_.prototype.fliplr=function(){return this.flip({dimension:"row"})},_.prototype.flipud=function(){return this.flip({dimension:"column"})},_.prototype.flip=function(t){var e=t&&t.dimension?t.dimension:"auto";return this.eachVector(function(t){for(var e=new Array(t.length),n=0,r=t.length-1;n<t.length;n++,r--)e[n]=t[r];return e},e)},_.prototype.indexsort=function(t){var e=_._toMatrix(t);if(e.isMatrix())throw"argsort error. argsort is not vector. ("+e.toOneLineString+")";var n=!1,r=null,i=null;if(e.isRow()){if(this.column_length!==e.column_length)throw"argsort error. (this_size !== new_size)->("+this.column_length+" !== "+e.column_length+")";n=!0,r=this.transpose().matrix_array,i=e.matrix_array[0]}if(e.isColumn()){if(this.row_length!==e.row_length)throw"argsort error. (this_size !== new_size)->("+this.row_length+" !== "+e.row_length+")";r=this.matrix_array,i=e.transpose().matrix_array[0]}for(var o=new Array(i.length),a=0;a<i.length;a++)o[a]={index:i[a],data:r[a]};var l=[],c=function(t,e,n,r){if(e<n){var i=Math.floor((e+n)/2);c(t,e,i,r),c(t,i+1,n,r);var o,a,u,s=0;for(o=e;o<=i;o++)l[s++]=t[o];for(o=i+1,a=0,u=e;o<=n&&a<s;)0<=r(t[o],l[a])?t[u++]=l[a++]:t[u++]=t[o++];for(;a<s;)t[u++]=l[a++]}return!0};c(o,0,o.length-1,function(t,e){return t.index.compareTo(e.index)});for(var u=new Array(i.length),s=0;s<i.length;s++)u[s]=o[s].data;var h=new _(u);return n?h.transpose():h},_.prototype.transpose=function(){for(var t=new Array(this.column_length),e=0;e<this.column_length;e++){t[e]=new Array(this.row_length);for(var n=0;n<this.row_length;n++)t[e][n]=this.matrix_array[n][e]}return new _(t)},_.prototype.ctranspose=function(){return this.transpose().conj()},_.prototype.T=function(){return this.ctranspose()},_.prototype.inner=function(t,e){return void 0===e&&(e=1),I.inner(this,t,e)},_.prototype.lup=function(){return I.lup(this)},_.prototype.lu=function(){return I.lu(this)},_.prototype.linsolve=function(t){return I.linsolve(this,t)},_.prototype.qr=function(){return I.qr(this)},_.prototype.tridiagonalize=function(){return I.tridiagonalize(this)},_.prototype.eig=function(){return I.eig(this)},_.prototype.svd=function(){return I.svd(this)},_.prototype.pinv=function(){return I.pinv(this)},_.prototype.gammaln=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.gammaln()})},_.prototype.gamma=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.gamma()})},_.prototype.gammainc=function(t,e){var n=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.gammainc(n,e)})},_.prototype.gampdf=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.gampdf(n,r)})},_.prototype.gamcdf=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.gamcdf(n,r)})},_.prototype.gaminv=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.gaminv(n,r)})},_.prototype.beta=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.beta(e)})},_.prototype.betainc=function(t,e,n){var r=_._toDouble(t),i=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.betainc(r,i,n)})},_.prototype.betacdf=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.betacdf(n,r)})},_.prototype.betapdf=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.betapdf(n,r)})},_.prototype.betainv=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.betainv(n,r)})},_.prototype.factorial=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.factorial()})},_.prototype.nchoosek=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.nchoosek(e)})},_.prototype.erf=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erf()})},_.prototype.erfc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erfc()})},_.prototype.erfinv=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erfinv()})},_.prototype.erfcinv=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erfcinv()})},_.prototype.normpdf=function(t,e){var n=void 0!==t?_._toDouble(t):0,r=void 0!==e?_._toDouble(e):1;return this.cloneMatrixDoEachCalculation(function(t){return t.normpdf(n,r)})},_.prototype.normcdf=function(t,e){var n=void 0!==t?_._toDouble(t):0,r=void 0!==e?_._toDouble(e):1;return this.cloneMatrixDoEachCalculation(function(t){return t.normcdf(n,r)})},_.prototype.norminv=function(t,e){var n=void 0!==t?_._toDouble(t):0,r=void 0!==e?_._toDouble(e):1;return this.cloneMatrixDoEachCalculation(function(t){return t.norminv(n,r)})},_.prototype.binopdf=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.binopdf(n,r)})},_.prototype.binocdf=function(t,e,n){var r=_._toDouble(t),i=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.binocdf(r,i,n)})},_.prototype.binoinv=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.binoinv(n,r)})},_.prototype.poisspdf=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.poisspdf(e)})},_.prototype.poisscdf=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.poisscdf(e)})},_.prototype.poissinv=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.poissinv(e)})},_.prototype.tpdf=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tpdf(e)})},_.prototype.tcdf=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tcdf(e)})},_.prototype.tinv=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tinv(e)})},_.prototype.tdist=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.tdist(n,r)})},_.prototype.tinv2=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.tinv2(e)})},_.prototype.chi2pdf=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.chi2pdf(e)})},_.prototype.chi2cdf=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.chi2cdf(e)})},_.prototype.chi2inv=function(t){var e=_._toDouble(t);return this.cloneMatrixDoEachCalculation(function(t){return t.chi2inv(e)})},_.prototype.fpdf=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.fpdf(n,r)})},_.prototype.fcdf=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.fcdf(n,r)})},_.prototype.finv=function(t,e){var n=_._toDouble(t),r=_._toDouble(e);return this.cloneMatrixDoEachCalculation(function(t){return t.finv(n,r)})},_.prototype.and=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.and(_._toDouble(e))})},_.prototype.or=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.or(_._toDouble(e))})},_.prototype.xor=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.xor(_._toDouble(e))})},_.prototype.not=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.not()})},_.prototype.shift=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.shift(_._toDouble(e))})},_.prototype.factor=function(){for(var t=this.scalar.factor(),e=[],n=0;n<t.length;n++)e.push(new _(t[n]));return e},_.prototype.gcd=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.gcd(_._toDouble(e))})},_.prototype.extgcd=function(t){if(!this.isScalar())throw"IllegalArgumentException";var e=this.scalar,n=_._toDouble(t),r=e.extgcd(n);return[new _(r[0]),new _(r[1]),new _(r[2])]},_.prototype.lcm=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.lcm(_._toDouble(e))})},_.prototype.modPow=function(e,n){return this.cloneMatrixDoEachCalculation(function(t){return t.modPow(_._toDouble(e),_._toDouble(n))})},_.prototype.modInverse=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.modInverse(_._toDouble(e))})},_.prototype.scaleByPowerOfTen=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.scaleByPowerOfTen(_._toComplex(e))})},_.prototype.testPrime=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isPrime()?L.ONE:L.ZERO})},_.prototype.testProbablePrime=function(t){var e=void 0!==t?Math.round(_._toDouble(t)):void 0;return this.cloneMatrixDoEachCalculation(function(t){return t.isProbablePrime(e)?L.ONE:L.ZERO})},_.prototype.nextProbablePrime=function(t,e){var n=void 0!==t?Math.round(_._toDouble(t)):void 0,r=void 0!==e?Math.round(_._toDouble(e)):void 0;return this.cloneMatrixDoEachCalculation(function(t){return t.nextProbablePrime(n,r)})},_.prototype.isPrime=function(){return this.scalar.isPrime()},_.prototype.isProbablePrime=function(t){return this.scalar.isProbablePrime(t)},_.prototype.max=function(t){return E.max(this,t)},_.prototype.min=function(t){return E.min(this,t)},_.prototype.sum=function(t){return E.sum(this,t)},_.prototype.mean=function(t){return E.mean(this,t)},_.prototype.prod=function(t){return E.prod(this,t)},_.prototype.geomean=function(t){return E.geomean(this,t)},_.prototype.median=function(t){return E.median(this,t)},_.prototype.mode=function(t){return E.mode(this,t)},_.prototype.moment=function(t,e){return E.moment(this,t,e)},_.prototype.var=function(t){return E.var(this,t)},_.prototype.std=function(t){return E.std(this,t)},_.prototype.mad=function(t,e){return E.mad(this,t,e)},_.prototype.skewness=function(t){return E.skewness(this,t)},_.prototype.cov=function(t,e){return E.cov(this,t,e)},_.prototype.standardization=function(t){return E.standardization(this,t)},_.prototype.corrcoef=function(t,e){return E.corrcoef(this,t,e)},_.prototype.sort=function(t,e){return E.sort(this,t,e)},_.prototype.fft=function(t){return F.fft(this,t)},_.prototype.ifft=function(t){return F.ifft(this,t)},_.prototype.powerfft=function(t){return F.powerfft(this,t)},_.prototype.dct=function(t){return F.dct(this,t)},_.prototype.idct=function(t){return F.idct(this,t)},_.prototype.fft2=function(){return F.fft2(this)},_.prototype.ifft2=function(){return F.ifft2(this)},_.prototype.dct2=function(){return F.dct2(this)},_.prototype.idct2=function(){return F.idct2(this)},_.prototype.conv=function(t){return F.conv(this,t)},_.prototype.xcorr=function(t){return F.xcorr(this,t)},_.window=function(t,e,n){return F.window(t,e,n)},_.hann=function(t,e){return F.hann(t,e)},_.hamming=function(t,e){return F.hamming(t,e)},_.prototype.fftshift=function(t){return F.fftshift(this,t)},e.ONE.get=function(){return new _(1)},e.TWO.get=function(){return new _(2)},e.TEN.get=function(){return new _(10)},e.ZERO.get=function(){return new _(0)},e.MINUS_ONE.get=function(){return new _(-1)},e.I.get=function(){return new _(L.I)},e.PI.get=function(){return new _(Math.PI)},e.QUARTER_PI.get=function(){return new _(.25*Math.PI)},e.HALF_PI.get=function(){return new _(.5*Math.PI)},e.TWO_PI.get=function(){return new _(2*Math.PI)},e.E.get=function(){return new _(Math.E)},e.LN2.get=function(){return new _(Math.LN2)},e.LN10.get=function(){return new _(Math.LN10)},e.LOG2E.get=function(){return new _(Math.LOG2E)},e.LOG10E.get=function(){return new _(Math.LOG10E)},e.SQRT2.get=function(){return new _(Math.SQRT2)},e.SQRT1_2.get=function(){return new _(Math.SQRT1_2)},e.HALF.get=function(){return new _(.5)},e.POSITIVE_INFINITY.get=function(){return new _(Number.POSITIVE_INFINITY)},e.NEGATIVE_INFINITY.get=function(){return new _(Number.NEGATIVE_INFINITY)},e.NaN.get=function(){return new _(Number.NaN)},_.prototype.signum=function(){return this.sign()},_.prototype.subtract=function(t){return this.sub(t)},_.prototype.multiply=function(t){return this.mul(t)},_.prototype.divide=function(t){return this.div(t)},_.prototype.remainder=function(t){return this.rem(t)},_.prototype.trunc=function(){return this.fix()},Object.defineProperties(_.prototype,t),Object.defineProperties(_,e),_}(V),C=new v;R.ToComplexFromString=function(t){var e=t.replace(/\s/g,"").toLowerCase();if(e=e.replace(/infinity|inf/g,"1e100000"),!/[ij]/.test(e))return{real:parseFloat(e),imag:0};var n,r=0,i=0;return(n=e.match(/[+-]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))($|[+-])/))&&(r=parseFloat(n[0])),(n=e.match(/[+-]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij]/))&&(n=n[0].substring(0,n[0].length-1),i=/^[-+]$/.test(n)||0===n.length?"-"===n?-1:1:parseFloat(n)),{real:r,imag:i}};function Z(){}var L=function(i){function u(t){if(i.call(this),1!==arguments.length)throw"Complex Many arguments : "+arguments.length;var e=t;if(e instanceof u)this._re=e._re,this._im=e._im;else if("number"==typeof e)this._re=e,this._im=0;else if("string"==typeof e){var n=R.ToComplexFromString(e);this._re=n.real,this._im=n.imag}else if(e instanceof Array){if(2!==e.length)throw"Complex Unsupported argument "+arguments;this._re=e[0],this._im=e[1]}else if("boolean"==typeof e)this._re=e?1:0,this._im=0;else if("doubleValue"in e)this._re=e.doubleValue,this._im=0;else if("_re"in e&&"_im"in e)this._re=e._re,this._im=e._im;else{if(!(e instanceof Object))throw"Complex Unsupported argument "+arguments;var r=R.ToComplexFromString(e.toString());this._re=r.real,this._im=r.imag}}i&&(u.__proto__=i);var t={real:{configurable:!0},imag:{configurable:!0},norm:{configurable:!0},arg:{configurable:!0},booleanValue:{configurable:!0},intValue:{configurable:!0},doubleValue:{configurable:!0}},e={ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},ZERO:{configurable:!0},MINUS_ONE:{configurable:!0},I:{configurable:!0},MINUS_I:{configurable:!0},PI:{configurable:!0},QUARTER_PI:{configurable:!0},HALF_PI:{configurable:!0},TWO_PI:{configurable:!0},E:{configurable:!0},LN2:{configurable:!0},LN10:{configurable:!0},LOG2E:{configurable:!0},LOG10E:{configurable:!0},SQRT2:{configurable:!0},SQRT1_2:{configurable:!0},HALF:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};return((u.prototype=Object.create(i&&i.prototype)).constructor=u).create=function(t){return t instanceof u?t:new u(t)},u.valueOf=function(t){return u.create(t)},u._toComplex=function(t){return t instanceof u?t:t instanceof J?J._toComplex(t):new u(t)},u._toDouble=function(t){if("number"==typeof t)return t;var e=u._toComplex(t);if(e.isReal())return e.real;throw"not support complex numbers.["+t+"]"},u._toInteger=function(t){return Math.trunc(u._toDouble(t))},u.prototype.clone=function(){return this},u.prototype.toString=function(){function t(t){var e=t.toPrecision(6);if(-1!==e.indexOf("."))e=(e=e.replace(/\.?0+$/,"")).replace(/\.?0+e/,"e");else{if(/inf/i.test(e))return t===Number.POSITIVE_INFINITY?"Inf":"-Inf";if(/nan/i.test(e))return"NaN"}return e}return this.isReal()?t(this._re):0===this._re?t(this._im)+"i":0<=this._im||Number.isNaN(this._im)?t(this._re)+" + "+t(this._im)+"i":t(this._re)+" - "+t(-this._im)+"i"},u.prototype.toJSON=function(){return this.isReal()?this._re.toString():0===this._re?this._im.toString()+"i":0<=this._im||Number.isNaN(this._im)?this._re.toString()+"+"+this._im.toString()+"i":this._re.toString()+this._im.toString()+"i"},t.real.get=function(){return this._re},t.imag.get=function(){return this._im},t.norm.get=function(){return 0===this._im?Math.abs(this._re):0===this._re?Math.abs(this._im):Math.sqrt(this._re*this._re+this._im*this._im)},t.arg.get=function(){return 0===this._im?0<=this._re?0:Math.PI:0===this._re?Math.PI*(0<=this._im?.5:-.5):Math.atan2(this._im,this._re)},u.prototype.getDecimalPosition=function(){function t(t){if(!Number.isFinite(t))return 0;for(var e=t,n=0,r=0;r<20&&!(Math.abs(e-Math.round(e))<=Number.EPSILON);r++)e*=10,n++;return n}return Math.max(t(this.real),t(this.imag))},u.prototype.sign=function(){return this.isFinite()?0===this._im?0===this._re?u.ZERO:new u(0<this._re?1:-1):this.div(this.norm):this.isNaN()||this._im===1/0||this._im===-1/0?u.NaN:this._re===1/0?u.ONE:u.MINUS_ONE},u.prototype.add=function(t){var e=new u(t);return e._re=this._re+e._re,e._im=this._im+e._im,e},u.prototype.sub=function(t){var e=new u(t);return e._re=this._re-e._re,e._im=this._im-e._im,e},u.prototype.mul=function(t){var e=this,n=new u(t);if(0===e._im&&0===n._im)return n._re=e._re*n._re,n;if(0===e._re&&0===n._re)return n._re=-e._im*n._im,n._im=0,n;var r=e._re*n._re-e._im*n._im,i=e._im*n._re+e._re*n._im;return n._re=r,n._im=i,n},u.prototype.dot=function(t){var e=this,n=new u(t);if(0===e._im&&0===n._im)return n._re=e._re*n._re,n;if(0===e._re&&0===n._re)return n._re=e._im*n._im,n._im=0,n;var r=e._re*n._re+e._im*n._im,i=-e._im*n._re+e._re*n._im;return n._re=r,n._im=i,n},u.prototype.div=function(t){var e=this,n=new u(t);if(0===e._im&&0===n._im)return n._re=e._re/n._re,n;if(0===e._re&&0===n._re)return n._re=e._im/n._im,n._im=0,n;var r=e._re*n._re+e._im*n._im,i=e._im*n._re-e._re*n._im,o=1/(n._re*n._re+n._im*n._im);return n._re=r*o,n._im=i*o,n},u.prototype.rem=function(t){var e=new u(t);if(0!==this._im||0!==e._im)throw"calculation method is undefined.";return this.isFinite()&&e.isFinite()&&!e.isZero()?(e._re=this._re-e._re*Math.trunc(this._re/e._re),e):u.NaN},u.prototype.mod=function(t){var e=new u(t);if(0!==this._im||0!==e._im)throw"calculation method is undefined.";if(e.isZero())return this;var n=this.rem(e);return this.equalsState(e)?n:n.add(e)},u.prototype.inv=function(){return 0===this._im?new u(1/this._re):0===this._re?new u([0,-1/this._im]):u.ONE.div(this)},t.booleanValue.get=function(){return!this.isZero()&&!this.isNaN()},t.intValue.get=function(){if(!this.isFinite())return this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0;var t=this._re;return Math.abs(t-Math.trunc(t))<Number.EPSILON?Math.round(t):Math.trunc(t)},t.doubleValue.get=function(){if(!this.isFinite())return this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0;var t=this._re;return Math.abs(t-Math.trunc(t))<Number.EPSILON?Math.round(t):t},u.prototype.toBigInteger=function(){return new H(this.intValue)},u.prototype.toBigDecimal=function(t){return new $(t?[this.doubleValue,t]:this.doubleValue)},u.prototype.toFraction=function(){return new q(this.doubleValue)},u.prototype.toComplex=function(){return this},u.prototype.toMatrix=function(){return new J(this)},u.prototype.equals=function(t,e){var n=this,r=u._toComplex(t);if(n.isNaN()||r.isNaN())return!1;if(n._re===r._re&&n._im===r._im)return!0;var i=e?u._toDouble(e):Number.EPSILON;return Math.abs(n._re-r._re)<i&&Math.abs(n._im-r._im)<i},u.prototype.equalsState=function(t){function e(t){return t.isZero()?0:t.isFinite()?t.isPositive()?1:2:t.isPositiveInfinity()?4:t.isNegativeInfinity()?5:3}var n=u._toComplex(t);return e(this)===e(n)},u.prototype.compareTo=function(t,e){var n=this,r=u._toComplex(t);if(!n.isFinite()||!r.isFinite())return n.equals(r)?0:n.isNaN()||r.isNaN()||n.real===1/0&&n.imag===-1/0||n.real===-1/0&&n.imag===1/0||r.real===1/0&&r.imag===-1/0||r.real===-1/0&&r.imag===1/0?NaN:n.isFinite()?r.real+r.imag<0?1:-1:r.isFinite()?0<n.real+n.imag?1:-1:NaN;var i=e?u._toDouble(e):Number.EPSILON,o=n.real+n.imag,a=r.real+r.imag;return Math.abs(o-a)<=i?0:a<o?1:-1},u.prototype.max=function(t){var e=u._toComplex(t);return 0<=this.compareTo(e)?this:e},u.prototype.min=function(t){var e=u._toComplex(t);return this.compareTo(e)<=0?this:e},u.prototype.clip=function(t,e){var n=u._toComplex(t),r=u._toComplex(e),i=n.compareTo(r);if(1===i)throw"clip(min, max) error. (min > max)->("+n+" > "+r+")";return 0===i?n:1===this.compareTo(r)?r:-1===this.compareTo(n)?n:this},u.prototype.floor=function(){return new u([Math.floor(this._re),Math.floor(this._im)])},u.prototype.ceil=function(){return new u([Math.ceil(this._re),Math.ceil(this._im)])},u.prototype.round=function(){return new u([Math.round(this._re),Math.round(this._im)])},u.prototype.fix=function(){return new u([Math.trunc(this._re),Math.trunc(this._im)])},u.prototype.fract=function(){return new u([this._re-Math.floor(this._re),this._im-Math.floor(this._im)])},u.prototype.abs=function(){return new u(this.norm)},u.prototype.conj=function(){return 0===this._im?this:new u([this._re,-this._im])},u.prototype.negate=function(){return new u([-this._re,-this._im])},u.prototype.pow=function(t){var e=this,n=new u(t);if(n.isReal()){if(e.isReal()&&(e.isNotNegative()||n.isInteger()))return n._re=Math.pow(e._re,n._re),n;var r=Math.pow(e.norm,n._re),i=e.arg*n._re;return n._re=r*Math.cos(i),n._im=r*Math.sin(i),n}return n.mul(e.log()).exp()},u.prototype.square=function(){return 0===this._im?new u(this._re*this._re):this.mul(this)},u.prototype.sqrt=function(){if(this.isReal())return this.isNotNegative()?new u(Math.sqrt(this._re)):new u([0,Math.sqrt(-this._re)]);var t=Math.sqrt(this.norm),e=.5*this.arg;return new u([t*Math.cos(e),t*Math.sin(e)])},u.prototype.cbrt=function(t){var e=u._toInteger(void 0!==t?t:0),n=this.log().div(3).exp();return 0===e?n:1===e?n.mul([-.5,.5*Math.sqrt(3)]):n.mul([-.5,.5*-Math.sqrt(3)])},u.prototype.rsqrt=function(){return this.isReal()?this.isNotNegative()?new u(1/Math.sqrt(this._re)):new u([0,-1/Math.sqrt(-this._re)]):this.sqrt().inv()},u.prototype.log=function(){return this.isReal()&&this.isNotNegative()?new u(Math.log(this._re)):new u([Math.log(this.norm),this.arg])},u.prototype.exp=function(){if(this.isReal())return new u(Math.exp(this._re));var t=Math.exp(this._re);return new u([t*Math.cos(this._im),t*Math.sin(this._im)])},u.prototype.expm1=function(){return this.exp().sub(1)},u.prototype.log1p=function(){return this.add(1).log()},u.prototype.log2=function(){return this.log().div(u.LN2)},u.prototype.log10=function(){return this.log().div(u.LN10)},u.prototype.sin=function(){if(this.isReal())return new u(Math.sin(this._re));var t=this.mul(u.I).exp(),e=this.mul(u.I.negate()).exp();return t.sub(e).div([0,2])},u.prototype.cos=function(){if(this.isReal())return new u(Math.cos(this._re));var t=this.mul(u.I).exp(),e=this.mul(u.I.negate()).exp();return t.add(e).div(2)},u.prototype.tan=function(){return this.isReal()?new u(Math.tan(this._re)):this.sin().div(this.cos())},u.prototype.atan=function(){return this.isReal()?new u(Math.atan(this._re)):u.I.div(u.TWO).mul(u.I.add(this).div(u.I.sub(this)).log())},u.prototype.atan2=function(t){if(0===arguments.length)return new u(this.arg);var e=u._toComplex(t);if(this.isReal()&&e.isReal())return new u(Math.atan2(this._re,e._re));throw"calculation method is undefined."},u.prototype.asin=function(){return this.mul(u.I).add(u.ONE.sub(this.square()).sqrt()).log().mul(u.MINUS_I)},u.prototype.acos=function(){return this.add(u.I.mul(u.ONE.sub(this.square()).sqrt())).log().mul(u.MINUS_I)},u.prototype.sinh=function(){var t=this.exp();return t.sub(t.inv()).mul(.5)},u.prototype.asinh=function(){return this.isInfinite()?this:this.add(this.mul(this).add(1).sqrt()).log()},u.prototype.cosh=function(){return this.exp().add(this.negate().exp()).mul(.5)},u.prototype.acosh=function(){return this.isZero()?new u([0,.5*Math.PI]):1<=this.compareTo(u.ONE)?this.add(this.square().sub(1).sqrt()).log():this.sub(this.square().sub(1).sqrt()).log()},u.prototype.tanh=function(){if(this.isNaN())return u.NaN;var t=this.mul(2).exp();return t.isZero()?u.MINUS_ONE:t.isPositiveInfinity()?u.ONE:t.sub(1).div(t.add(1))},u.prototype.atanh=function(){return this.isInfinite()&&this.isReal()?new u([0,.5*Math.PI]):this.add(1).div(this.negate().add(1)).log().mul(.5)},u.prototype.sec=function(){return this.cos().inv()},u.prototype.asec=function(){return this.inv().acos()},u.prototype.sech=function(){return this.exp().add(this.negate().exp()).inv().mul(2)},u.prototype.asech=function(){return this.isInfinite()&&this.isReal()?new u([0,.5*Math.PI]):this.isPositive()||-1==this.compareTo(u.MINUS_ONE)?this.inv().add(this.square().inv().sub(1).sqrt()).log():this.inv().sub(this.square().inv().sub(1).sqrt()).log()},u.prototype.cot=function(){return this.tan().inv()},u.prototype.acot=function(){return this.inv().atan()},u.prototype.coth=function(){return this.isZero()?u.POSITIVE_INFINITY:this.tanh().inv()},u.prototype.acoth=function(){return this.isInfinite()?u.ZERO:this.add(1).div(this.sub(1)).log().mul(.5)},u.prototype.csc=function(){return this.sin().inv()},u.prototype.acsc=function(){return this.inv().asin()},u.prototype.csch=function(){return this.exp().sub(this.negate().exp()).inv().mul(2)},u.prototype.acsch=function(){return this.inv().add(this.square().inv().add(1).sqrt()).log()},u.prototype.logit=function(){return this.log().sub(u.ONE.sub(this).log())},u.prototype.sinc=function(){if(this.isReal()){if(0===this._re)return u.ONE;var t=Math.PI*this._re;return new u(Math.sin(t)/t)}var e=this.mul(u.PI);return new u(e.sin().div(e))},u.rand=function(t){var e=void 0!==t&&t instanceof v?t:C;return new u(e.nextDouble())},u.randn=function(t){return new u((void 0!==t&&t instanceof v?t:C).nextGaussian())},u.prototype.isInteger=function(t){var e=t?u._toDouble(t):Number.EPSILON;return this.isReal()&&Math.abs(this._re-Math.trunc(this._re))<e},u.prototype.isComplexInteger=function(t){var e=t?u._toDouble(t):Number.EPSILON;return Math.abs(this._re-Math.trunc(this._re))<e&&Math.abs(this._im-Math.trunc(this._im))<e},u.prototype.isZero=function(t){var e=t?u._toDouble(t):Number.EPSILON;return Math.abs(this._re)<e&&Math.abs(this._im)<e},u.prototype.isOne=function(t){var e=t?u._toDouble(t):Number.EPSILON;return Math.abs(this._re-1)<e&&Math.abs(this._im)<e},u.prototype.isComplex=function(t){var e=t?u._toDouble(t):Number.EPSILON;return Math.abs(this._im)>=e},u.prototype.isReal=function(t){var e=t?u._toDouble(t):Number.EPSILON;return Math.abs(this._im)<e},u.prototype.isNaN=function(){return isNaN(this._re)||isNaN(this._im)},u.prototype.isPositive=function(){return 0<this._re},u.prototype.isNegative=function(){return this._re<0},u.prototype.isNotNegative=function(){return 0<=this._re},u.prototype.isPositiveInfinity=function(){return this._re===Number.POSITIVE_INFINITY||this._im===Number.POSITIVE_INFINITY},u.prototype.isNegativeInfinity=function(){return this._re===Number.NEGATIVE_INFINITY||this._im===Number.NEGATIVE_INFINITY},u.prototype.isInfinite=function(){return this.isPositiveInfinity()||this.isNegativeInfinity()},u.prototype.isFinite=function(){return!this.isNaN()&&!this.isInfinite()},u.prototype.gammaln=function(){return new u(_.gammaln(this._re))},u.prototype.gamma=function(){return new u(_.gamma(this._re))},u.prototype.gammainc=function(t,e){var n=u._toDouble(t);return new u(_.gammainc(this._re,n,e))},u.prototype.gampdf=function(t,e){var n=u._toDouble(t),r=u._toDouble(e);return new u(_.gampdf(this._re,n,r))},u.prototype.gamcdf=function(t,e){var n=u._toDouble(t),r=u._toDouble(e);return new u(_.gamcdf(this._re,n,r))},u.prototype.gaminv=function(t,e){var n=u._toDouble(t),r=u._toDouble(e);return new u(_.gaminv(this._re,n,r))},u.prototype.beta=function(t){var e=u._toDouble(t);return new u(_.beta(this._re,e))},u.prototype.betainc=function(t,e,n){var r=u._toDouble(t),i=u._toDouble(e);return new u(_.betainc(this._re,r,i,n))},u.prototype.betapdf=function(t,e){var n=u._toDouble(t),r=u._toDouble(e);return new u(_.betapdf(this._re,n,r))},u.prototype.betacdf=function(t,e){var n=u._toDouble(t),r=u._toDouble(e);return new u(_.betacdf(this._re,n,r))},u.prototype.betainv=function(t,e){var n=u._toDouble(t),r=u._toDouble(e);return new u(_.betainv(this._re,n,r))},u.prototype.factorial=function(){return new u(_.factorial(this._re))},u.prototype.nchoosek=function(t){var e=u._toDouble(t);return new u(_.nchoosek(this._re,e))},u.prototype.erf=function(){return new u(_.erf(this._re))},u.prototype.erfc=function(){return new u(_.erfc(this._re))},u.prototype.erfinv=function(){return new u(_.erfinv(this._re))},u.prototype.erfcinv=function(){return new u(_.erfcinv(this._re))},u.prototype.normpdf=function(t,e){var n=void 0!==t?u._toDouble(t):0,r=void 0!==e?u._toDouble(e):1;return new u(_.normpdf(this._re,n,r))},u.prototype.normcdf=function(t,e){var n=void 0!==t?u._toDouble(t):0,r=void 0!==e?u._toDouble(e):1;return new u(_.normcdf(this._re,n,r))},u.prototype.norminv=function(t,e){var n=void 0!==t?u._toDouble(t):0,r=void 0!==e?u._toDouble(e):1;return new u(_.norminv(this._re,n,r))},u.prototype.binopdf=function(t,e){var n=u._toDouble(t),r=u._toDouble(e);return new u(_.binopdf(this._re,n,r))},u.prototype.binocdf=function(t,e,n){var r=u._toDouble(t),i=u._toDouble(e);return new u(_.binocdf(this._re,r,i,n))},u.prototype.binoinv=function(t,e){var n=u._toDouble(t),r=u._toDouble(e);return new u(_.binoinv(this._re,n,r))},u.prototype.poisspdf=function(t){var e=u._toDouble(t);return new u(_.poisspdf(this._re,e))},u.prototype.poisscdf=function(t){var e=u._toDouble(t);return new u(_.poisscdf(this._re,e))},u.prototype.poissinv=function(t){var e=u._toDouble(t);return new u(_.poissinv(this._re,e))},u.prototype.tpdf=function(t){var e=u._toDouble(t);return new u(_.tpdf(this._re,e))},u.prototype.tcdf=function(t){var e=u._toDouble(t);return new u(_.tcdf(this._re,e))},u.prototype.tinv=function(t){var e=u._toDouble(t);return new u(_.tinv(this._re,e))},u.prototype.tdist=function(t,e){var n=u._toDouble(t),r=u._toInteger(e);return new u(_.tdist(this._re,n,r))},u.prototype.tinv2=function(t){var e=u._toDouble(t);return new u(_.tinv2(this._re,e))},u.prototype.chi2pdf=function(t){var e=u._toDouble(t);return new u(_.chi2pdf(this._re,e))},u.prototype.chi2cdf=function(t){var e=u._toDouble(t);return new u(_.chi2cdf(this._re,e))},u.prototype.chi2inv=function(t){var e=u._toDouble(t);return new u(_.chi2inv(this._re,e))},u.prototype.fpdf=function(t,e){var n=u._toDouble(t),r=u._toDouble(e);return new u(_.fpdf(this._re,n,r))},u.prototype.fcdf=function(t,e){var n=u._toDouble(t),r=u._toDouble(e);return new u(_.fcdf(this._re,n,r))},u.prototype.finv=function(t,e){var n=u._toDouble(t),r=u._toDouble(e);return new u(_.finv(this._re,n,r))},u.prototype.and=function(t){return new u(Math.round(this.real)&Math.round(u._toDouble(t)))},u.prototype.or=function(t){return new u(Math.round(this.real)|Math.round(u._toDouble(t)))},u.prototype.xor=function(t){return new u(Math.round(this.real)^Math.round(u._toDouble(t)))},u.prototype.not=function(){return new u(!Math.round(this.real))},u.prototype.shift=function(t){return new u(Math.round(this.real)<<Math.round(u._toDouble(t)))},u.prototype.factor=function(){for(var t=this.round().toBigInteger().factor(),e=[],n=0;n<t.length;n++)e.push(new u(t[n]));return e},u.prototype.gcd=function(t){var e=Math.round(this.real),n=Math.round(u._toDouble(t));return new u(new H(e).gcd(n))},u.prototype.extgcd=function(t){var e=Math.round(this.real),n=Math.round(u._toDouble(t)),r=new H(e).extgcd(n);return[new u(r[0]),new u(r[1]),new u(r[2])]},u.prototype.lcm=function(t){var e=Math.round(this.real),n=Math.round(u._toDouble(t));return new u(new H(e).lcm(n))},u.prototype.modPow=function(t,e){var n=Math.round(this.real),r=Math.round(u._toDouble(t)),i=Math.round(u._toDouble(e));return new u(new H(n).modPow(r,i))},u.prototype.modInverse=function(t){var e=Math.round(this.real),n=Math.round(u._toDouble(t));return new u(new H(e).modInverse(n))},u.prototype.scaleByPowerOfTen=function(t){return this.mul(u.TEN.pow(t))},u.prototype.isPrime=function(){return new H(Math.round(this.real)).isPrime()},u.prototype.isProbablePrime=function(t){return new H(Math.round(this.real)).isProbablePrime(void 0!==t?Math.round(u._toDouble(t)):void 0)},u.prototype.nextProbablePrime=function(t,e){var n=new H(Math.round(this.real)),r=void 0!==t?Math.round(u._toDouble(t)):void 0,i=void 0!==e?Math.round(u._toDouble(e)):void 0;return new u(n.nextProbablePrime(r,i))},e.ONE.get=function(){return B.ONE},e.TWO.get=function(){return B.TWO},e.TEN.get=function(){return B.TEN},e.ZERO.get=function(){return B.ZERO},e.MINUS_ONE.get=function(){return B.MINUS_ONE},e.I.get=function(){return B.I},e.MINUS_I.get=function(){return B.MINUS_I},e.PI.get=function(){return B.PI},e.QUARTER_PI.get=function(){return B.QUARTER_PI},e.HALF_PI.get=function(){return B.HALF_PI},e.TWO_PI.get=function(){return B.TWO_PI},e.E.get=function(){return B.E},e.LN2.get=function(){return B.LN2},e.LN10.get=function(){return B.LN10},e.LOG2E.get=function(){return B.LOG2E},e.LOG10E.get=function(){return B.LOG10E},e.SQRT2.get=function(){return B.SQRT2},e.SQRT1_2.get=function(){return B.SQRT1_2},e.HALF.get=function(){return B.HALF},e.POSITIVE_INFINITY.get=function(){return B.POSITIVE_INFINITY},e.NEGATIVE_INFINITY.get=function(){return B.NEGATIVE_INFINITY},e.NaN.get=function(){return B.NaN},u.prototype.signum=function(){return this.sign()},u.prototype.subtract=function(t){return this.sub(t)},u.prototype.multiply=function(t){return this.mul(t)},u.prototype.divide=function(t){return this.div(t)},u.prototype.remainder=function(t){return this.rem(t)},u.prototype.trunc=function(){return this.fix()},Object.defineProperties(u.prototype,t),Object.defineProperties(u,e),u}(V),B={ZERO:new L(0),ONE:new L(1),TWO:new L(2),TEN:new L(10),MINUS_ONE:new L(-1),I:new L([0,1]),MINUS_I:new L([0,-1]),PI:new L(Math.PI),QUARTER_PI:new L(.25*Math.PI),HALF_PI:new L(.5*Math.PI),TWO_PI:new L(2*Math.PI),E:new L(Math.E),LN2:new L(Math.LN2),LN10:new L(Math.LN10),LOG2E:new L(Math.LOG2E),LOG10E:new L(Math.LOG10E),SQRT2:new L(Math.SQRT2),SQRT1_2:new L(Math.SQRT1_2),HALF:new L(.5),POSITIVE_INFINITY:new L(Number.POSITIVE_INFINITY),NEGATIVE_INFINITY:new L(Number.NEGATIVE_INFINITY),NaN:new L(Number.NaN)};Z.to_fraction_data_from_number_string=function(t){var e,n=0,r=!1,i=t.replace(/\s/g,"").toLowerCase(),o=[];if(null!==(e=i.match(/^[+-]+/))&&(e=e[0],i=i.substr(e.length),-1!==e.indexOf("-")&&(r=!0,o.push("-"))),null!==(e=i.match(/^[0-9]+/))&&(e=e[0],i=i.substr(e.length),o.push(e)),0===i.length)return new q([new H([o.join(""),10]),H.ONE]);var a=null;if(/[()'"[\]]/.test(i)){var u=i.match(/([^.]*)\.(\d*)[(['"](\d+)[)\]'"](.*)/);if(null===u)throw"Fraction Unsupported argument "+i;var s=u[2].length,l=u[3];i=0===s?u[1]+u[4]:u[1]+"."+u[2]+u[4];for(var c=new H([l,10]),h=[],f=0;f<l.length;f++)h.push("9");var g=new H([h.join(""),10]);a=(a=new q([c,g])).scaleByPowerOfTen(-s)}null!==(e=i.match(/^\.[0-9]+/))&&(e=e[0],i=i.substr(e.length),n+=(e=e.substr(1)).length,o.push(e)),null!==(e=i.match(/^e[+-]?[0-9]+/))&&(e=e[0].substr(1),n-=parseInt(e,10));var p=null,m=null,_=null;if(0===n&&(m=new H([o.join(""),10]),_=H.ONE),n<0){for(var N=0;N<-n;N++)o.push("0");m=new H([o.join(""),10]),_=H.ONE}else if(0<n){m=new H([o.join(""),10]);for(var v=["1"],I=0;I<n;I++)v.push("0");_=new H([v.join(""),10])}return p=new q([m,_]),a&&(p=r?p.sub(a):p.add(a)),p},Z.to_fraction_data_from_fraction_string=function(t){if(/nan|inf/i.test(t)){var e=new q;return e.denominator=H.ONE,/nan/i.test(t)?e.numerator=H.NaN:/-/.test(t)?e.numerator=H.NEGATIVE_INFINITY:e.numerator=H.POSITIVE_INFINITY,e}if(-1===t.indexOf("/"))return Z.to_fraction_data_from_number_string(t);var n=t.split("/"),r=Z.to_fraction_data_from_number_string(n[0]),i=Z.to_fraction_data_from_number_string(n[1]);return r.div(i)},Z.to_fraction_data_from_number=function(t){var e="boolean"!=typeof t?t:t?1:0,n=null,r=null;if(!isFinite(e)){var i=new q;return i.denominator=H.ONE,i.numerator=e===1/0?H.POSITIVE_INFINITY:e===-1/0?H.NEGATIVE_INFINITY:H.NaN,i}if(0===e){var o=new q;return o.denominator=H.ONE,o.numerator=H.ZERO,o}if(Math.abs(e-Math.round(e))<=Number.EPSILON)n=new H(Math.round(e)),r=H.ONE;else{var a=Math.trunc(Math.log(Math.abs(e))/Math.log(10)),u=e/Math.pow(10,a);a=-a;for(var s=0;s<14&&(u*=10,a+=1,!(Math.abs(u-Math.round(u))<=Number.EPSILON));s++);if(u=Math.round(1e14*u)/1e14,a<=0)n=new H(e),r=H.ONE;else{n=new H(u);for(var l=["1"],c=0;c<a;c++)l.push("0");r=new H([l.join(""),10])}}return new q([n,r])},Z.normalization=function(t){if(!t.denominator.equals(H.ONE)){if(t.denominator.equals(H.MINUS_ONE))return t.numerator=t.numerator.negate(),void(t.denominator=H.ONE);if(t.numerator.equals(H.ZERO))t.denominator=H.ONE;else{var e=t.numerator.gcd(t.denominator),n=t.numerator.div(e),r=t.denominator.div(e);r.sign()<0&&(n=n.negate(),r=r.negate()),t.numerator=n,t.denominator=r}}};function Y(){}var q=function(s){function p(t){if(s.call(this),this.numerator=null,this.denominator=null,0===arguments.length)this.numerator=H.ZERO,this.denominator=H.ONE;else{if(1!==arguments.length)throw"Fraction Unsupported argument "+t;var e=!1;if("number"==typeof t||"boolean"==typeof t){var n=Z.to_fraction_data_from_number(t);this.numerator=n.numerator,this.denominator=n.denominator}else if("string"==typeof t){var r=Z.to_fraction_data_from_fraction_string(t);this.numerator=r.numerator,this.denominator=r.denominator}else if(t instanceof H)this.numerator=t,this.denominator=H.ONE;else if(t instanceof p)this.numerator=t.numerator,this.denominator=t.denominator;else if(t instanceof Array&&2===t.length)this.numerator=t[0]instanceof H?t[0]:new H(t[0]),this.denominator=t[1]instanceof H?t[1]:new H(t[1]),e=!0;else if(t instanceof $){var i=t.unscaledValue();if(i.isFinite()){var o=new p(t.unscaledValue()).scaleByPowerOfTen(-t.scale());this.numerator=o.numerator,this.denominator=o.denominator}else this.numerator=i,this.denominator=H.ONE}else{if("object"!=typeof t)throw"Fraction Unsupported argument "+t;if("doubleValue"in t){var a=Z.to_fraction_data_from_number(t.doubleValue);this.numerator=a.numerator,this.denominator=a.denominator}else if("numerator"in t&&"denominator"in t)this.numerator=t.numerator instanceof H?t.numerator:new H(t.numerator),this.denominator=t.denominator instanceof H?t.denominator:new H(t.denominator),e=!0;else{var u=Z.to_fraction_data_from_fraction_string(t.toString());this.numerator=u.numerator,this.denominator=u.denominator}}e&&Z.normalization(this)}}s&&(p.__proto__=s);var t={booleanValue:{configurable:!0},intValue:{configurable:!0},doubleValue:{configurable:!0}},e={MINUS_ONE:{configurable:!0},ZERO:{configurable:!0},HALF:{configurable:!0},ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};return((p.prototype=Object.create(s&&s.prototype)).constructor=p).create=function(t){return t instanceof p?t:new p(t)},p.valueOf=function(t){return p.create(t)},p._toFraction=function(t){return t instanceof p?t:new p(t)},p._toFloat=function(t){return"number"==typeof t?t:t instanceof p?t.doubleValue:new p(t).doubleValue},p._toInteger=function(t){return"number"==typeof t?Math.trunc(t):t instanceof p?t.intValue:new p(t).intValue},p.prototype.clone=function(){return new p(this)},p.prototype.abs=function(){return this.isFinite()?0<=this.sign()?this:this.negate():this.isNegativeInfinity()?p.POSITIVE_INFINITY:this},p.prototype.negate=function(){return this.isFinite()?new p([this.numerator.negate(),this.denominator]):this.isPositiveInfinity()?p.NEGATIVE_INFINITY:this.isNegativeInfinity()?p.POSITIVE_INFINITY:this},p.prototype.sign=function(){return this.isFinite()?this.numerator.sign():this.isNaN()?NaN:this.isPositiveInfinity()?1:-1},p.prototype.toString=function(){return this.isFinite()?this.isInteger()?this.numerator.toString():this.toFractionString():this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity"},p.prototype.toJSON=function(){return this.toString()},p.prototype.toFractionString=function(){return this.isFinite()?this.numerator.toString()+"/"+this.denominator.toString():this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity"},p.prototype.toPlainString=function(t){if(!this.isFinite())return this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity";if(this.isInteger())return this.numerator.toString();var e,n=this.numerator.sign(),r=this.numerator.abs(),i=this.denominator,o=null,a=[],u={};e=void 0!==t?p._toInteger(t):10*(r.toString().length+i.toString().length);for(var s=0;s<e;s++){var l=r.divideAndRemainder(i),c=l[0],h=l[1],f=h.toString();if(a.push(c.toString()),void 0!==u[f]){var g=(o=a.join("")).indexOf(".")+u[f]+1;o=o.substr(0,g)+"("+o.substr(g,o.length-g)+")";break}if(u[f]=s,h.isZero())break;0===s&&a.push("."),r=h.scaleByPowerOfTen(1)}return null===o&&(o=o=a.join("")),(n<0?"-":"")+o},p.prototype.add=function(t){var e=this,n=p._toFraction(t);return e.isFinite()&&n.isFinite()?e.isInteger()&&n.isInteger()?new p([e.numerator.add(n.numerator),H.ONE]):new p([e.numerator.mul(n.denominator).add(n.numerator.mul(e.denominator)),e.denominator.mul(n.denominator)]):e.isNaN()||n.isNaN()||e.isInfinite()&&n.isInfinite()&&!e.equalsState(n)?p.NaN:e.isPositiveInfinity()||n.isPositiveInfinity()?p.POSITIVE_INFINITY:p.NEGATIVE_INFINITY},p.prototype.sub=function(t){var e=this,n=p._toFraction(t);return e.isFinite()&&n.isFinite()?e.isInteger()&&n.isInteger()?new p([e.numerator.sub(n.numerator),H.ONE]):new p([e.numerator.mul(n.denominator).sub(n.numerator.mul(e.denominator)),e.denominator.mul(n.denominator)]):e.isNaN()||n.isNaN()||e.equalsState(n)?p.NaN:e.isNegativeInfinity()||n.isPositiveInfinity()?p.NEGATIVE_INFINITY:p.POSITIVE_INFINITY},p.prototype.mul=function(t){var e=this,n=p._toFraction(t);return e.isFinite()&&n.isFinite()?e.isInteger()&&n.isInteger()?new p([e.numerator.mul(n.numerator),H.ONE]):new p([e.numerator.mul(n.numerator),e.denominator.mul(n.denominator)]):e.isNaN()||n.isNaN()||e.isZero()||n.isZero()?p.NaN:0<e.sign()*n.sign()?p.POSITIVE_INFINITY:p.NEGATIVE_INFINITY},p.prototype.div=function(t){var e=this,n=p._toFraction(t);return e.isFinite()&&n.isFinite()?n.isZero()?e.isZero()?p.NaN:0<=e.sign()?p.POSITIVE_INFINITY:p.NEGATIVE_INFINITY:e.isInteger()&&n.isInteger()?new p([e.numerator,n.numerator]):new p([e.numerator.mul(n.denominator),n.numerator.mul(e.denominator)]):e.isNaN()||n.isNaN()||e.isInfinite()&&n.isInfinite()?p.NaN:e.isInfinite()?0<=e.sign()*n.sign()?p.POSITIVE_INFINITY:p.NEGATIVE_INFINITY:p.ZERO},p.prototype.inv=function(){return this.isFinite()?this.isZero()?p.NaN:new p([this.denominator,this.numerator]):this.isNaN()?p.NaN:p.ZERO},p.prototype.rem=function(t){var e=p._toFraction(t);return this.isFinite()&&e.isFinite()&&!e.isZero()?this.sub(e.mul(this.div(e).fix())):p.NaN},p.prototype.mod=function(t){var e=p._toFraction(t);if(e.isZero())return this;var n=this.rem(e);return this.equalsState(e)?n:n.add(e)},p.prototype.pow=function(t){var e=this,n=p._toFraction(t);if(e.isNaN()||n.isNaN())return p.NaN;if(n.isZero())return p.ONE;if(e.isZero())return p.ZERO;if(e.isOne())return p.ONE;if(e.isInfinite())return e.isPositiveInfinity()?p.POSITIVE_INFINITY:n.isPositiveInfinity()?p.NaN:new p(1/0*Math.pow(-1,Math.round(n.doubleValue)));if(n.isInfinite()){if(e.isNegative())return p.NaN;if(e.compareTo(p.ONE)<0){if(n.isPositiveInfinity())return p.ZERO;if(n.isNegativeInfinity())return p.POSITIVE_INFINITY}else{if(n.isPositiveInfinity())return p.POSITIVE_INFINITY;if(n.isNegativeInfinity())return p.ZERO}}return new p([e.numerator.pow(n.intValue),e.denominator.pow(n.intValue)])},p.prototype.square=function(){return this.mul(this)},p.prototype.factorial=function(){return this.isFinite()?new p([this.toBigInteger().factorial(),p.ONE]):this},p.prototype.scaleByPowerOfTen=function(t){if(!this.isFinite())return this;var e,n=p._toInteger(t);return 0===n?this:(0<n?e=new p([this.numerator.scaleByPowerOfTen(n),this.denominator]):n<0&&(e=new p([this.numerator,this.denominator.scaleByPowerOfTen(-n)])),e)},t.booleanValue.get=function(){return this.numerator.booleanValue},t.intValue.get=function(){return this.isFinite()?this.isInteger()?Math.trunc(this.numerator.doubleValue):Math.trunc(this.doubleValue):this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0},t.doubleValue.get=function(){if(!this.isFinite())return this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0;if(this.isInteger())return this.numerator.doubleValue;var t=new $([this.numerator,y.UNLIMITED]),e=new $([this.denominator,y.UNLIMITED]);return t.div(e,{context:y.DECIMAL64}).doubleValue},p.prototype.toBigInteger=function(){return new H(this.fix().numerator)},p.prototype.toBigDecimal=function(t){if(!this.isFinite())return new $(this.doubleValue);if(this.isInteger())return new $(this.numerator);var e=new $([this.numerator,y.UNLIMITED]),n=new $([this.denominator,y.UNLIMITED]);return t?e.div(n,{context:t}):e.div(n,{context:$.getDefaultContext()})},p.prototype.toFraction=function(){return this},p.prototype.toComplex=function(){return new L(this)},p.prototype.toMatrix=function(){return new J(this)},p.prototype.equals=function(t){var e=this,n=p._toFraction(t);return e.isFinite()&&n.isFinite()?e.numerator.equals(n.numerator)&&e.denominator.equals(n.denominator):!e.isNaN()&&!n.isNaN()&&!!e.equalsState(n)},p.prototype.equalsState=function(t){var e=p._toFraction(t);return this.numerator.equalsState(e.numerator)},p.prototype.compareTo=function(t){var e=p._toFraction(t);return this.isFinite()&&e.isFinite()?this.sub(e).sign():this.numerator.compareTo(e.numerator)},p.prototype.max=function(t){var e=p._toFraction(t);return this.isNaN()||e.isNaN()?p.NaN:0<=this.compareTo(e)?this:e},p.prototype.min=function(t){var e=p._toFraction(t);return this.isNaN()||e.isNaN()?p.NaN:0<=this.compareTo(e)?e:this},p.prototype.clip=function(t,e){var n=p._toFraction(t),r=p._toFraction(e);if(this.isNaN()||n.isNaN()||r.isNaN())return p.NaN;var i=n.compareTo(r);if(1===i)throw"clip(min, max) error. (min > max)->("+n+" > "+r+")";return 0===i?n:1===this.compareTo(r)?r:-1===this.compareTo(n)?n:this},p.prototype.floor=function(){if(this.isInteger()||!this.isFinite())return this;var t=this.fix();return 0<this.sign()?t:new p([t.numerator.sub(H.ONE),p.ONE])},p.prototype.ceil=function(){if(this.isInteger()||!this.isFinite())return this;var t=this.fix();return 0<this.sign()?new p([t.numerator.add(H.ONE),p.ONE]):t},p.prototype.round=function(){if(this.isInteger()||!this.isFinite())return this;var t=this.floor();return 0<=this.sub(t).compareTo(p.HALF)?new p([t.numerator.add(H.ONE),p.ONE]):t},p.prototype.fix=function(){return this.isInteger()||!this.isFinite()?this:new p([this.numerator.div(this.denominator),p.ONE])},p.prototype.fract=function(){return this.isFinite()?this.isInteger()?p.ZERO:this.sub(this.floor()):p.NaN},p.prototype.isInteger=function(){return!!this.isFinite()&&this.denominator.equals(H.ONE)},p.prototype.isZero=function(){return!!this.isFinite()&&this.numerator.isZero()},p.prototype.isOne=function(){return!!this.isFinite()&&(this.numerator.equals(H.ONE)&&this.denominator.equals(H.ONE))},p.prototype.isPositive=function(){return this.numerator.isPositive()},p.prototype.isNegative=function(){return this.numerator.isNegative()},p.prototype.isNotNegative=function(){return this.numerator.isNotNegative()},p.prototype.isNaN=function(){return this.numerator.isNaN()},p.prototype.isPositiveInfinity=function(){return this.numerator.isPositiveInfinity()},p.prototype.isNegativeInfinity=function(){return this.numerator.isNegativeInfinity()},p.prototype.isInfinite=function(){return this.numerator.isInfinite()},p.prototype.isFinite=function(){return this.numerator.isFinite()},p.prototype.isRepeatingDecimal=function(){return!!this.isFinite()&&(!this.isInteger()&&!(this.denominator.rem(2).isZero()||this.denominator.rem(5).isZero()))},p.prototype.and=function(t){var e=p._toFraction(t),n=this.round().toBigInteger(),r=e.round().toBigInteger();return new p(n.and(r))},p.prototype.or=function(t){var e=p._toFraction(t),n=this.round().toBigInteger(),r=e.round().toBigInteger();return new p(n.or(r))},p.prototype.xor=function(t){var e=p._toFraction(t),n=this.round().toBigInteger(),r=e.round().toBigInteger();return new p(n.xor(r))},p.prototype.not=function(){return new p(this.round().toBigInteger().not())},p.prototype.shift=function(t){var e=this.round().toBigInteger(),n=p._toInteger(t);return new p(e.shift(n))},p.prototype.factor=function(){for(var t=this.round().toBigInteger().factor(),e=[],n=0;n<t.length;n++)e.push(new p(t[n]));return e},p.prototype.gcd=function(t){var e=this.round().toBigInteger(),n=p._toFraction(t).toBigInteger();return new p(e.gcd(n))},p.prototype.extgcd=function(t){var e=this.round().toBigInteger(),n=p._toFraction(t).toBigInteger(),r=e.extgcd(n);return[new p(r[0]),new p(r[1]),new p(r[2])]},p.prototype.lcm=function(t){var e=this.round().toBigInteger(),n=p._toFraction(t).toBigInteger();return new p(e.lcm(n))},p.prototype.modPow=function(t,e){var n=this.round().toBigInteger(),r=p._toFraction(t).toBigInteger(),i=p._toFraction(e).toBigInteger();return new p(n.modPow(r,i))},p.prototype.modInverse=function(t){var e=this.round().toBigInteger(),n=p._toFraction(t).toBigInteger();return new p(e.modInverse(n))},p.prototype.isPrime=function(){return this.round().toBigInteger().isPrime()},p.prototype.isProbablePrime=function(t){return this.round().toBigInteger().isProbablePrime(void 0!==t?p._toInteger(t):void 0)},p.prototype.nextProbablePrime=function(t,e){var n=this.round().toBigInteger(),r=void 0!==t?p._toInteger(t):void 0,i=void 0!==e?p._toInteger(e):void 0;return new p(n.nextProbablePrime(r,i))},e.MINUS_ONE.get=function(){return null===U.MINUS_ONE&&(U.MINUS_ONE=new p([H.MINUS_ONE,H.ONE])),U.MINUS_ONE},e.ZERO.get=function(){return null===U.ZERO&&(U.ZERO=new p([H.ZERO,H.ONE])),U.ZERO},e.HALF.get=function(){return null===U.HALF&&(U.HALF=new p([H.ONE,H.TWO])),U.HALF},e.ONE.get=function(){return null===U.ONE&&(U.ONE=new p([H.ONE,H.ONE])),U.ONE},e.TWO.get=function(){return null===U.TWO&&(U.TWO=new p([H.TWO,H.ONE])),U.TWO},e.TEN.get=function(){return null===U.TEN&&(U.TEN=new p([H.TEN,H.ONE])),U.TEN},e.POSITIVE_INFINITY.get=function(){return null===U.POSITIVE_INFINITY&&(U.POSITIVE_INFINITY=new p(Number.POSITIVE_INFINITY)),U.POSITIVE_INFINITY},e.NEGATIVE_INFINITY.get=function(){return null===U.NEGATIVE_INFINITY&&(U.NEGATIVE_INFINITY=new p(Number.NEGATIVE_INFINITY)),U.NEGATIVE_INFINITY},e.NaN.get=function(){return null===U.NaN&&(U.NaN=new p(Number.NaN)),U.NaN},p.prototype.signum=function(){return this.sign()},p.prototype.subtract=function(t){return this.sub(t)},p.prototype.multiply=function(t){return this.mul(t)},p.prototype.divide=function(t){return this.div(t)},p.prototype.remainder=function(t){return this.rem(t)},Object.defineProperties(p.prototype,t),Object.defineProperties(p,e),p}(P),U={MINUS_ONE:null,ZERO:null,ONE:null,HALF:null,TWO:null,TEN:null,POSITIVE_INFINITY:null,NEGATIVE_INFINITY:null,NaN:null},G=new v;Y.toHexadecimalArrayFromPlainString=function(t,e){for(var n=Math.floor(Math.log(1073741823)/Math.log(e)),r=[],i=[],o=Math.ceil(t.length/n),a=t.length,u=0;u<o;u++)a-=n,r[u]=0<=a?parseInt(t.substring(a,a+n),e):parseInt(t.substring(0,a+n),e);for(var s=Math.round(Math.pow(e,n));0!==r.length;){for(var l=0,c=r.length-1;0<=c;c--){var h=r[c]+l*s;r[c]=h>>>1,l=1&h}i[i.length]=l,0===r[r.length-1]&&r.pop()}r=[];for(var f=0;f<i.length;f++)r[f>>>4]|=i[f]<<(15&f);return r},Y.toPlainStringFromString=function(t){var e,n,r=0,i=t.replace(/\s/g,"").toLowerCase(),o=[];if(null!==(e=i.match(/^[0-9]+/))&&(e=e[0],i=i.substr(e.length),o.push(e)),null!==(e=i.match(/^\.[0-9]+/))&&(e=e[0],i=i.substr(e.length),r+=(e=e.substr(1)).length,o.push(e)),null!==(e=i.match(/^e[+-]?[0-9]+/))&&(e=e[0].substr(1),r-=parseInt(e,10)),0===r&&(n=o.join("")),r<0){for(var a=0;a<-r;a++)o.push("0");n=o.join("")}else 0<r&&(n=0!==(n=(n=o.join("")).substring(0,n.length-r)).length?n:"0");return n},Y.toBigIntegerFromNumber=function(t){var e,n,r="boolean"!=typeof t?t:t?1:0;if(!isFinite(r))return r===Number.POSITIVE_INFINITY?{state:j.POSITIVE_INFINITY,element:[]}:r===Number.NEGATIVE_INFINITY?{state:j.NEGATIVE_INFINITY,element:[]}:{state:j.NOT_A_NUMBER,element:[]};if(Math.abs(r)<1-Number.EPSILON)return{element:[],state:j.ZERO};if(4294967295<(e=0<r?(n=j.POSITIVE_NUMBER,r):(n=j.NEGATIVE_NUMBER,-r)))return{element:Y.toHexadecimalArrayFromPlainString(Y.toPlainStringFromString(e.toFixed()),10),state:n};e=Math.abs(r-Math.round(r))<=Number.EPSILON?Math.round(e):Math.trunc(e);for(var i=[];0!==e;)i[i.length]=1&e,e>>>=1;for(var o=[],a=0;a<i.length;a++)o[a>>>4]|=i[a]<<(15&a);return{element:o,state:n}},Y.toPlainStringFromHexadecimalArray=function(t,a){for(var e=function(t,e,n){for(var r=t.length,i=0,o=0;o<r;o++)n[o]=t[o]+(e.length>=o+1?e[o]:0)+i,n[o]>=a?(i=1,n[o]-=a):i=0;1===i&&(n[r]=1)},n=[0],r=[1],i=0;i<t.length;i++)for(var o=0;o<16;o++)t[i]>>>o&1&&e(r,n,n),e(r,r,r);return n},Y.isZeroElement=function(t){return 0===t.length||1===t.length&&0===t[0]},Y.toBigIntegerFromString=function(t,e){var n=t.replace(/\s/g,"").toLowerCase();if(/nan/.test(t))return{state:j.NOT_A_NUMBER,element:[]};if(/inf/.test(t))return/-/.test(t)?{state:j.NEGATIVE_INFINITY,element:[]}:{state:j.POSITIVE_INFINITY,element:[]};var r=n.match(/^[-+]+/),i=[],o=j.POSITIVE_NUMBER;if(null!==r){var a=r[0];n=n.substring(a.length,n.length),-1!==a.indexOf("-")&&(o=j.NEGATIVE_NUMBER)}return i=e?Y.toHexadecimalArrayFromPlainString(n,e):/^0x/.test(n)?Y.toHexadecimalArrayFromPlainString(n.substring(2,n.length),16):/^0b/.test(n)?Y.toHexadecimalArrayFromPlainString(n.substring(2,n.length),2):/^0o/.test(n)?Y.toHexadecimalArrayFromPlainString(n.substring(2,n.length),8):(n=Y.toPlainStringFromString(n),Y.toHexadecimalArrayFromPlainString(n,10)),Y.isZeroElement(i)&&(i=[],o=j.ZERO),{element:i,state:o}};var j={ZERO:0,POSITIVE_NUMBER:1,NEGATIVE_NUMBER:2,NOT_A_NUMBER:3,POSITIVE_INFINITY:4,NEGATIVE_INFINITY:5},H=function(s){function N(t){if(s.call(this),this.state=j.ZERO,0===arguments.length)this.element=[];else{if(1!==arguments.length)throw"BigInteger Unsupported argument "+t;if(t instanceof N)this.element=t.element.slice(0),this.state=t.state;else if("number"==typeof t){var e=Y.toBigIntegerFromNumber(t);this.element=e.element,this.state=e.state}else if("string"==typeof t){var n=Y.toBigIntegerFromString(t);this.element=n.element,this.state=n.state}else if(t instanceof Array){if(2!==t.length||"string"!=typeof t[0]||"number"!=typeof t[1])throw"BigInteger Unsupported argument "+arguments;var r=Y.toBigIntegerFromString(t[0],t[1]);this.element=r.element,this.state=r.state}else if("object"==typeof t)if("toBigInteger"in t){var i=t.toBigInteger();this.element=i.element,this.state=i.state}else if("intValue"in t){var o=Y.toBigIntegerFromNumber(t.intValue);this.element=o.element,this.state=o.state}else{var a=Y.toBigIntegerFromString(t.toString());this.element=a.element,this.state=a.state}else{if("boolean"!=typeof t)throw"BigInteger Unsupported argument "+t;var u=Y.toBigIntegerFromNumber(t);this.element=u.element,this.state=u.state}}}s&&(N.__proto__=s);var t={booleanValue:{configurable:!0},intValue:{configurable:!0},doubleValue:{configurable:!0}},e={MINUS_ONE:{configurable:!0},ZERO:{configurable:!0},ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};return((N.prototype=Object.create(s&&s.prototype)).constructor=N).create=function(t){return t instanceof N?t:new N(t)},N.valueOf=function(t){return N.create(t)},N._toBigInteger=function(t){return t instanceof N?t:new N(t)},N._toFloat=function(t){return"number"==typeof t?t:t instanceof N?t.doubleValue:new N(t).doubleValue},N._toInteger=function(t){return"number"==typeof t?Math.trunc(t):t instanceof N?t.intValue:new N(t).intValue},N.createRandomBigInteger=function(t,e){var n,r=void 0!==e&&e instanceof v?e:G,i=new N,o=N._toInteger(t),a=1+(o-1>>4);if(0===o)return N.ZERO;for(var u=0,s=0;u<a;u++)s=0===s?(n=r.nextInt(),i.element[u]=65535&n,1):(i.element[u]=n>>>16&65535,0);return o%16!=0&&(i.element[i.element.length-1]&=(1<<o%16)-1),i.state=j.POSITIVE_NUMBER,i._memory_reduction(),i},N.prototype.toString=function(t){if(!this.isFinite())return this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity";for(var e=t?N._toInteger(t):10,n=Math.floor(Math.log(1073741823)/Math.log(e)),r=Math.round(Math.pow(e,n)),i=[],o=0;o<n;o++)i[o]="0";var a=i.join(""),u=Y.toPlainStringFromHexadecimalArray(this.element,r),s=[],l="";this.sign()<0&&(s[s.length]="-");for(var c=u.length-1;0<=c;c--)l=u[c].toString(e),c<u.length-1&&(s[s.length]=a.substring(0,n-l.length)),s[s.length]=l;return s.join("")},N.prototype.toJSON=function(){return this.toString(10)},N.prototype.clone=function(){return new N(this)},N.prototype.getTwosComplement=function(t){var e=this.clone();if(!this.isFinite())return e;if(e.isNotNegative())return e;e.state=j.POSITIVE_NUMBER;for(var n=void 0!==t?t:e.bitLength(),r=e.element,i=0;i<r.length;i++)r[i]^=65535;return n%16!=0&&(r[r.length-1]&=(1<<n%16)-1),e._add(new N(1)),e},N.prototype._memory_allocation=function(t){if(this.isFinite()){var e=N._toInteger(t),n=this.element.length<<4;if(n<e)for(var r=1+((e-n-1&4294967280)>>>4),i=0;i<r;i++)this.element[this.element.length]=0}},N.prototype._memory_reduction=function(){if(this.isFinite()){for(var t=this.element.length-1;0<=t;t--)if(0!==this.element[t])return void(t<this.element.length-1&&this.element.splice(t+1,this.element.length-t-1));this.state=j.ZERO,this.element=[]}},N.prototype._abs=function(){return this.state===j.NEGATIVE_NUMBER?this.state=j.POSITIVE_NUMBER:this.state===j.NEGATIVE_INFINITY&&(this.state=j.POSITIVE_INFINITY),this},N.prototype.abs=function(){return this.clone()._abs()},N.prototype._negate=function(){return this.state===j.POSITIVE_NUMBER?this.state=j.NEGATIVE_NUMBER:this.state===j.NEGATIVE_NUMBER?this.state=j.POSITIVE_NUMBER:this.state===j.POSITIVE_INFINITY?this.state=j.NEGATIVE_INFINITY:this.state===j.NEGATIVE_INFINITY&&(this.state=j.POSITIVE_INFINITY),this},N.prototype.negate=function(){return this.clone()._negate()},N.prototype.sign=function(){return this.isNaN()?NaN:this.isZero()?0:this.isPositive()?1:-1},N.prototype._add=function(t){var e,n=this,r=N._toBigInteger(t);if(!n.isFinite()||!r.isFinite())return e=n.isNaN()||r.isNaN()||n.isInfinite()&&r.isInfinite()&&!n.equalsState(r)?N.NaN.clone():n.isPositiveInfinity()||r.isPositiveInfinity()?N.POSITIVE_INFINITY.clone():N.NEGATIVE_INFINITY.clone(),this.element=e.element,this.state=e.state,this;var i=n.element,o=r.element;if(n.sign()===r.sign()){this._memory_allocation(o.length<<4);for(var a=0,u=0;u<i.length;u++)i[u]+=(o.length>=u+1?o[u]:0)+a,65535<i[u]?(a=1,i[u]&=65535):a=0;0!==a&&(i[i.length]=a)}else{var s=n.compareToAbs(r);if(0===s)return this.element=[],this.state=j.ZERO,this;if(-1===s){this.state=r.state;var l=i;i=o.slice(0),o=l}for(var c=0,h=0;h<i.length;h++)i[h]-=(o.length>=h+1?o[h]:0)+c,c=i[h]<0?(i[h]+=65536,1):0;this.element=i,this._memory_reduction()}return this},N.prototype.add=function(t){return this.clone()._add(t)},N.prototype._sub=function(t){var e=N._toBigInteger(t),n=e.state,r=this._add(e._negate());return e.state=n,r},N.prototype.sub=function(t){return this.clone()._sub(t)},N.prototype._mul=function(t){var e=this.mul(t);return this.element=e.element,this.state=e.state,this},N.prototype.mul=function(t){var e=N._toBigInteger(t),n=this,r=e;if(!n.isFinite()||!r.isFinite())return n.isNaN()||r.isNaN()||n.isZero()||r.isZero()?N.NaN.clone():0<n.sign()*r.sign()?N.POSITIVE_INFINITY.clone():N.NEGATIVE_INFINITY.clone();for(var i=n.element,o=r.element,a=new N,u=new N,s=a.element,l=0;l<i.length;l++){u.element=[];for(var c=u.element,h=0,f=0;f<o.length;f++)c[f]=i[l]*o[f]+h,65535<c[f]?(h=c[f]>>>16,c[f]&=65535):h=0;0!==h&&(c[c.length]=h);for(var g=c.length-1;0<=g;g--)c[g+l]=c[g];for(var p=l-1;0<=p;p--)c[p]=0;h=0,a._memory_allocation(c.length<<4);for(var m=l;m<s.length;m++)s[m]+=(c.length>=m+1?c[m]:0)+h,65535<s[m]?(h=1,s[m]&=65535):h=0;0!==h&&(s[s.length]=h)}var _=this.sign()*e.sign();return a.state=0==_?j.ZERO:1==_?j.POSITIVE_NUMBER:j.NEGATIVE_NUMBER,a},N.prototype._divideAndRemainder=function(t){var e=this,n=N._toBigInteger(t);if(!e.isFinite()||!n.isFinite())return e.isNaN()||n.isNaN()||e.isInfinite()&&n.isInfinite()?[N.NaN,N.NaN]:e.isInfinite()?0<=e.sign()*n.sign()?[N.POSITIVE_INFINITY,N.NaN]:[N.NEGATIVE_INFINITY,N.NaN]:[N.ZERO,N.NaN];if(n.isZero())return e.isZero()?[N.NaN,N.NaN]:[0<=e.sign()?N.POSITIVE_INFINITY:N.NEGATIVE_INFINITY,N.NaN];var r=[],i=e.compareToAbs(n),o=e.sign()*n.sign();if(i<0)return r[0]=new N(0),r[1]=e.clone(),r;if(0===i)return r[0]=new N(1),r[0].state=1==o?j.POSITIVE_NUMBER:j.NEGATIVE_NUMBER,r[1]=new N(0),r;for(var a=new N(1),u=e.bitLength()-n.bitLength(),s=e.clone()._abs(),l=n.shift(u)._abs(),c=new N,h=0;h<=u&&(0<=s.compareToAbs(l)&&(s._sub(l),c._add(a)),h!==u);h++)l._shift(-1),c._shift(1);return r[0]=c,r[0].state=1==o?j.POSITIVE_NUMBER:j.NEGATIVE_NUMBER,r[1]=s,r[1].state=s.state!==j.ZERO?e.state:s.state,r},N.prototype.divideAndRemainder=function(t){return this.clone()._divideAndRemainder(t)},N.prototype._div=function(t){return this._divideAndRemainder(t)[0]},N.prototype.div=function(t){return this.clone()._div(t)},N.prototype.inv=function(){return this.isFinite()?this.isZero()?N.NaN:N.ZERO:this.isNaN()?N.NaN:N.ZERO},N.prototype._rem=function(t){var e=this._divideAndRemainder(t)[1];return this.element=e.element,this.state=e.state,this},N.prototype.rem=function(t){return this.clone()._rem(t)},N.prototype._mod=function(t){var e=N._toBigInteger(t);if(e.isZero())return this;var n=this._divideAndRemainder(e)[1];return this.state!==e.state&&n._add(e),this.element=n.element,this.state=n.state,this},N.prototype.mod=function(t){return this.clone()._mod(t)},N.prototype.modPow=function(t,e){var n=N._toBigInteger(e),r=new N(this),i=new N(1),o=new N(t);if(!r.isFinite()||!o.isFinite())return N.NaN;for(;0!==o.element.length;)0!=(1&o.element[0])&&(i=i.multiply(r).mod(n)),r=r.multiply(r).mod(n),o._shift(-1);return i},N.prototype.modInverse=function(t){var e=N._toBigInteger(t);if(!this.isFinite()||!e.isFinite())return N.NaN;var n=this.extgcd(t),r=new N(1);return 0!==n[2].compareTo(r)?N.NaN:n[0]._add(e).rem(e)},N.prototype.factorial=function(){if(!this.isFinite())return this;if(this.isNegative())return N.NaN;for(var t=N._toInteger(this),e=N.ONE,n=2;n<=t;n++)e=e.multiply(n);return e},N.prototype.scaleByPowerOfTen=function(t){var e=N._toInteger(t);return 0===e?this:0<e?this.mul(N.TEN.pow(e)):this.div(N.TEN.pow(e))},N.prototype.pow=function(t){var e=new N(t);if(this.isNaN()||e.isNaN())return N.NaN;if(e.isZero())return N.ONE;if(this.isZero())return e.isNegativeInfinity()?N.POSITIVE_INFINITY:N.ZERO;if(this.isOne())return this;if(this.isInfinite())return this.isPositiveInfinity()?N.POSITIVE_INFINITY:e.isPositiveInfinity()?N.NaN:N.create(1/0*Math.pow(-1,Math.round(e.doubleValue)));if(e.isInfinite()){if(this.isNegative())return N.NaN;if(this.compareTo(N.ONE)<0){if(e.isPositiveInfinity())return N.ZERO;if(e.isNegativeInfinity())return N.POSITIVE_INFINITY}else{if(e.isPositiveInfinity())return N.POSITIVE_INFINITY;if(e.isNegativeInfinity())return N.ZERO}}for(var n=N._toBigInteger(this),r=N._toBigInteger(1);0!==e.element.length;)0!=(1&e.element[0])&&(r=r.multiply(n)),n=n.multiply(n),e._shift(-1);return r},N.prototype.square=function(){return this.mul(this)},N.prototype.sqrt=function(){if(this.isZero())return N.ZERO;if(this.isNaN())return N.NaN;if(this.isNegative())return N.NaN;if(this.isInfinite())return N.POSITIVE_INFINITY;for(var t=N.ONE,e=this;-1===t.compareToAbs(e);)t=t.shiftLeft(1),e=e.shiftRight(1);for(var n=e,r=0;r<300;r++){var i=n.add(this.div(n)).shiftRight(1);if(i.sub(n).isZero())break;n=i}return n},N.prototype.cbrt=function(){if(this.isZero())return N.ZERO;if(this.isNaN())return N.NaN;if(this.isInfinite())return this;for(var t=N.ONE,e=this;-1===t.compareToAbs(e);)t=t.shiftLeft(1),e=e.shiftRight(2);for(var n=e,r=0;r<300;r++){var i=n.mul(n),o=n.shiftLeft(1).add(this.div(i)).div(3);if(o.sub(n).isZero())break;n=o}return n},N.prototype.log2=function(){return this.isZero()?N.ZERO:this.isNaN()?N.NaN:this.isNegative()?N.NaN:this.isInfinite()?N.POSITIVE_INFINITY:N.create(this.bitLength()-1)},N.prototype.log10=function(){return this.isZero()?N.ZERO:this.isNaN()?N.NaN:this.isNegative()?N.NaN:this.isInfinite()?N.POSITIVE_INFINITY:N.create(this.toString(10).length-1)},N.setDefaultRandom=function(t){G=t},N.getDefaultRandom=function(){return G},N.prototype.getShort=function(t){if(this.isZero())return 0;var e=N._toInteger(t);return 0<=e&&e<=this.element.length?this.element[e]:NaN},t.booleanValue.get=function(){return!this.isZero()&&!this.isNaN()},t.intValue.get=function(){if(!this.isFinite())return this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0;for(var t=0,e=Math.min(3,this.element.length-1);0<=e;e--)t*=65536,t+=this.element[e];return this.isNegative()&&(t=-t),t},t.doubleValue.get=function(){return this.isFinite()?parseFloat(this.toString()):this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0},N.prototype.toBigInteger=function(){return this},N.prototype.toBigDecimal=function(t){return new $(t?[this,t]:this)},N.prototype.toFraction=function(){return new q(this)},N.prototype.toComplex=function(){return new L(this)},N.prototype.toMatrix=function(){return new J(this)},N.prototype.equals=function(t){var e=N._toBigInteger(t);if(!this.isFinite()||!e.isFinite())return!this.isNaN()&&!e.isNaN()&&this.state===e.state;if(this.state!==e.state)return!1;if(this.element.length!==e.element.length)return!1;for(var n=0;n<e.element.length;n++)if(this.element[n]!==e.element[n])return!1;return!0},N.prototype.compareToAbs=function(t){var e=N._toBigInteger(t);if(!this.isFinite()||!e.isFinite())return this.isNaN()||e.isNaN()?NaN:this.isInfinite()||e.isInfinite()?0:e.isInfinite()?-1:1;if(this.element.length<e.element.length)return-1;if(this.element.length>e.element.length)return 1;for(var n=this.element.length-1;0<=n;n--)if(this.element[n]!==e.element[n]){var r=this.element[n]-e.element[n];return 0==r?0:0<r?1:-1}return 0},N.prototype.compareTo=function(t){var e=N._toBigInteger(t);if(!this.isFinite()||!e.isFinite())return this.isNaN()||e.isNaN()?NaN:this.state===e.state?0:this.isPositiveInfinity()||e.isNegativeInfinity()?1:-1;var n=this.sign(),r=e.sign();return n!==r?r<n?1:-1:0===n?0:this.compareToAbs(e)*n},N.prototype.equalsState=function(t){var e=N._toBigInteger(t);return this.state===e.state},N.prototype.max=function(t){var e=N._toBigInteger(t);return 0<=this.compareTo(e)?this.clone():e.clone()},N.prototype.min=function(t){var e=N._toBigInteger(t);return 0<=this.compareTo(e)?e.clone():this.clone()},N.prototype.clip=function(t,e){var n=N._toBigInteger(t),r=N._toBigInteger(e);if(this.isNaN()||n.isNaN()||r.isNaN())return N.NaN;var i=n.compareTo(r);if(1===i)throw"clip(min, max) error. (min > max)->("+n+" > "+r+")";return 0===i?n:1===this.compareTo(r)?r:-1===this.compareTo(n)?n:this},N.prototype.floor=function(){return this},N.prototype.ceil=function(){return this},N.prototype.round=function(){return this},N.prototype.fix=function(){return this},N.prototype.fract=function(){return N.ZERO},N.prototype.factor=function(){if(!this.isFinite())return[N.NaN];if(this.isZero())return[N.ZERO];if(this.isNegative())return[this];var t=[],e=this.intValue;if(e>Number.MAX_SAFE_INTEGER)return[];for(;4<=e&&e%2==0;)t.push(N.TWO),e=Math.floor(e/2);for(var n=3,r=Math.floor(e/n);n<=r;)e%n==0?(t.push(N.create(n)),e=r):n+=2,r=Math.floor(e/n);return t.push(N.create(e)),t},N.prototype.gcd=function(t){var e=N._toBigInteger(t);if(!this.isFinite()||!e.isFinite())return N.NaN;for(var n,r=this,i=e;0!==i.sign();)n=r.rem(i),r=i,i=n;return r},N.prototype.extgcd=function(t){var e=N._toBigInteger(t);if(!this.isFinite()||!e.isFinite())return[N.NaN,N.NaN,N.NaN];for(var n,r,i,o,a=new N(1),u=new N(0),s=this,l=e,c=a,h=u,f=u,g=a;0!==l.sign();){var p=s.divideAndRemainder(l);r=p[0],n=p[1],i=c.subtract(r.multiply(h)),o=f.subtract(r.multiply(g)),c=h,h=i,f=g,g=o,s=l,l=n}return[c,f,s]},N.prototype.lcm=function(t){var e=N._toBigInteger(t);return this.isFinite()&&e.isFinite()?this.mul(e).div(this.gcd(e)):N.NaN},N.probablePrime=function(t,e,n,r){for(var i=n?N._toInteger(n):100,o=r?N._toInteger(r):500,a=0;a<o;a++){var u=N.createRandomBigInteger(t,e);if(u.isProbablePrime(i))return u}return console.log("probablePrime "+r),N.NaN},N.prototype.isPrime=function(){if(!this.isFinite())return!1;if(this.sign()<=0)return!1;var t=Math.sqrt(Number.MAX_SAFE_INTEGER),e=this.doubleValue,n=Math.ceil(Math.sqrt(e));if(e<=2)return!0;if(t<=n)return null;for(var r=2;r<=n;r++)if(e%r==0)return!1;return!0},N.prototype.isProbablePrime=function(t){if(!this.isFinite())return!1;var e=this.element;if(this.sign()<=0)return!1;if(1===e.length&&e[0]<=2)return!0;if(0==(1&e[0]))return!1;var n=void 0!==t?N._toInteger(t):100,r=N.ZERO,i=N.ONE,o=this.bitLength(),a=this.subtract(i),u=a.getLowestSetBit(),s=a.shift(-u);if(n<=0)return!1;for(var l=0;l<n;l++){for(var c=void 0;0===(c=N.createRandomBigInteger(o)).compareTo(r)||-1!==c.compareTo(this););for(var h=s,f=c.modPow(h,this);!(h.equals(a)||f.equals(i)||f.equals(a));)f=f.mul(f)._mod(this),h=h.shiftLeft(1);if(!f.equals(a)&&0==(1&h.element[0]))return!1}return!0},N.prototype.nextProbablePrime=function(t,e){if(!this.isFinite())return N.NaN;for(var n=void 0!==t?N._toInteger(t)>>1:50,r=void 0!==e?N._toInteger(e):1e5,i=this.clone(),o=0;o<r;o++)if(i._add(N.ONE),i.isProbablePrime(n))return i;throw"nextProbablePrime ["+r+"]"},N.prototype._shift=function(t){if(!this.isFinite())return this;var e=N._toInteger(t);if(0===e)return this;var n=this.element;if(1===e){var r=n.length-1;for(0!=(32768&n[r])&&(n[n.length]=1);0<=r;r--)n[r]<<=1,n[r]&=65535,0<r&&0!=(32768&n[r-1])&&(n[r]+=1)}else if(-1===e){for(var i=0;i<n.length;i++)n[i]>>>=1,i<n.length-1&&0!=(1&n[i+1])&&(n[i]|=32768);0===n[n.length-1]&&n.pop()}else{if(16<=e){for(var o=e>>>4,a=n.length-1;0<=a;a--)n[a+o]=n[a];for(var u=o-1;0<=u;u--)n[u]=0;e&=15}else if(e<=-16){var s=-e>>>4;n.splice(0,s),e+=s<<4}if(0!==e)if(0<e){for(var l=0,c=0;c<n.length;c++)n[c]=(n[c]<<e)+l,65535<n[c]?(l=n[c]>>>16,n[c]&=65535):l=0;0!==l&&(n[n.length]=l)}else{e=-e;for(var h=0;h<n.length;h++)h!==n.length-1?(n[h]+=n[h+1]<<16,n[h]>>>=e,n[h]&=65535):n[h]>>>=e;0===n[n.length-1]&&n.pop()}}return 0===n.length&&(this.state=j.ZERO),this},N.prototype.shift=function(t){return this.clone()._shift(t)},N.prototype.shiftLeft=function(t){return this.shift(t)},N.prototype.shiftRight=function(t){return this.shift(-t)},N.prototype.getLowestSetBit=function(){if(!this.isFinite())return NaN;for(var t=0;t<this.element.length;t++)if(0!==this.element[t])for(var e=this.element[t],n=0;n<16;n++)if(0!=(e>>>n&1))return 16*t+n;return-1},N.prototype.bitLength=function(){if(!this.isFinite())return NaN;for(var t=this.element.length-1;0<=t;t--)if(0!==this.element[t])for(var e=this.element[t],n=15;0<=n;n--)if(0!=(e>>>n&1))return 16*t+n+1;return 0},N.prototype.bitCount=function(){if(!this.isFinite())return NaN;for(var t,e=(t=0<=this.sign()?this:this.add(new N(1))).bitLength(),n=0,r=0,i=0;n<e;i++)for(var o=t.element[i],a=0;a<16&&n<e;a++,n++)0!=(o>>>a&1)&&(r+=1);return r},N.prototype._and=function(t){var e,n=N._toBigInteger(t);if(!this.isFinite()||!n.isFinite())return e=(e=this.isNaN()||n.isNaN()?N.NaN:N.ZERO).clone(),this.element=e.element,this.state=e.state,this;var r=this.sign(),i=n.sign(),o=Math.max(this.bitLength(),n.bitLength()),a=this.getTwosComplement(o).element,u=n.getTwosComplement(o).element,s=Math.max(a.length,u.length);this.element=[];for(var l=0;l<s;l++){var c=l>=a.length?0:a[l],h=l>=u.length?0:u[l];this.element[l]=c&h}return this._memory_reduction(),this.state===j.ZERO||1!==r&&1!==i?this.state===j.NEGATIVE_NUMBER&&(this.element=this.getTwosComplement(o).element,this._memory_reduction()):this.state=j.POSITIVE_NUMBER,this},N.prototype.and=function(t){return this.clone()._and(t)},N.prototype._or=function(t){var e,n=N._toBigInteger(t);if(!this.isFinite()||!n.isFinite())return e=(e=this.isNaN()||n.isNaN()?N.NaN.clone():this.isInfinite()||n.isInfinite()?N.ZERO:this.isInfinite()?n:this).clone(),this.element=e.element,this.state=e.state,this;var r=this.sign(),i=n.sign(),o=Math.max(this.bitLength(),n.bitLength()),a=this.getTwosComplement(o).element,u=n.getTwosComplement(o).element,s=Math.max(a.length,u.length);this.element=[];for(var l=0;l<s;l++){var c=l>=a.length?0:a[l],h=l>=u.length?0:u[l];this.element[l]=c|h}return this.state=-1===r||-1===i?j.NEGATIVE_NUMBER:0===Math.max(r,i)?j.ZERO:j.POSITIVE_NUMBER,this.state===j.NEGATIVE_NUMBER&&(this.element=this.getTwosComplement(o).element,this._memory_reduction()),this},N.prototype.or=function(t){return this.clone()._or(t)},N.prototype._xor=function(t){var e,n=N._toBigInteger(t);if(!this.isFinite()||!n.isFinite())return e=(e=this.isNaN()||n.isNaN()?N.NaN:this.isInfinite()||n.isInfinite()?N.ZERO:this.isInfinite()?n:this).clone(),this.element=e.element,this.state=e.state,this;var r=this.sign(),i=n.sign(),o=Math.max(this.bitLength(),n.bitLength()),a=this.getTwosComplement(o).element,u=n.getTwosComplement(o).element,s=Math.max(a.length,u.length);this.element=[];for(var l=0;l<s;l++){var c=l>=a.length?0:a[l],h=l>=u.length?0:u[l];this.element[l]=c^h}return this._memory_reduction(),this.state=0!==r&&r!==i?j.NEGATIVE_NUMBER:j.POSITIVE_NUMBER,this.state===j.NEGATIVE_NUMBER&&(this.element=this.getTwosComplement(o).element,this._memory_reduction()),this},N.prototype.xor=function(t){return this.clone()._xor(t)},N.prototype._not=function(){return this._add(new N(1))._negate()},N.prototype.not=function(){return this.clone()._not()},N.prototype._setBit=function(t){var e=N._toInteger(t);return this._memory_allocation(e+1),this.element[e>>>4]|=1<<(15&e),this.state=j.POSITIVE_NUMBER,this},N.prototype.setBit=function(t){var e=N._toInteger(t);return this.clone()._setBit(e)},N.prototype._flipBit=function(t){var e=N._toInteger(t);return this._memory_allocation(e+1),this.element[e>>>4]^=1<<(15&e),this._memory_reduction(),this},N.prototype.flipBit=function(t){var e=N._toInteger(t);return this.clone()._flipBit(e)},N.prototype.clearBit=function(t){var e=N._toInteger(t),n=this.clone();return n.element[e>>>4]&=~(1<<(15&e)),n._memory_reduction(),n},N.prototype.testBit=function(t){var e=N._toInteger(t);return 0!=(this.element[e>>>4]>>>(15&e)&1)},N.prototype.isZero=function(){return this.state===j.ZERO},N.prototype.isOne=function(){return this.state===j.POSITIVE_NUMBER&&1===this.element.length&&1===this.element[0]},N.prototype.isPositive=function(){return this.state===j.POSITIVE_NUMBER||this.state===j.POSITIVE_INFINITY},N.prototype.isNegative=function(){return this.state===j.NEGATIVE_NUMBER||this.state===j.NEGATIVE_INFINITY},N.prototype.isNotNegative=function(){return this.state===j.ZERO||this.state===j.POSITIVE_NUMBER||this.state===j.POSITIVE_INFINITY},N.prototype.isNaN=function(){return this.state===j.NOT_A_NUMBER},N.prototype.isPositiveInfinity=function(){return this.state===j.POSITIVE_INFINITY},N.prototype.isNegativeInfinity=function(){return this.state===j.NEGATIVE_INFINITY},N.prototype.isInfinite=function(){return this.isPositiveInfinity()||this.isNegativeInfinity()},N.prototype.isFinite=function(){return!this.isNaN()&&!this.isInfinite()},e.MINUS_ONE.get=function(){return k.MINUS_ONE},e.ZERO.get=function(){return k.ZERO},e.ONE.get=function(){return k.ONE},e.TWO.get=function(){return k.TWO},e.TEN.get=function(){return k.TEN},e.POSITIVE_INFINITY.get=function(){return k.POSITIVE_INFINITY},e.NEGATIVE_INFINITY.get=function(){return k.NEGATIVE_INFINITY},e.NaN.get=function(){return k.NaN},N.prototype.signum=function(){return this.sign()},N.prototype.subtract=function(t){return this.sub(t)},N.prototype.multiply=function(t){return this.mul(t)},N.prototype.divide=function(t){return this.div(t)},N.prototype.remainder=function(t){return this.rem(t)},Object.defineProperties(N.prototype,t),Object.defineProperties(N,e),N}(P),k={MINUS_ONE:new H(-1),ZERO:new H(0),ONE:new H(1),TWO:new H(2),TEN:new H(10),POSITIVE_INFINITY:new H(Number.POSITIVE_INFINITY),NEGATIVE_INFINITY:new H(Number.NEGATIVE_INFINITY),NaN:new H(Number.NaN)},W=[];W[0]=y.DECIMAL128;function Q(){}Q.ToBigDecimalFromString=function(t){var e,n=0,r=t.replace(/\s/g,"").toLowerCase();if(/nan/.test(r))return{scale:0,integer:H.NaN};if(/inf/.test(r))return/-/.test(r)?{scale:0,integer:H.NEGATIVE_INFINITY}:{scale:0,integer:H.POSITIVE_INFINITY};var i="";return null!==(e=r.match(/^[+-]+/))&&(e=e[0],r=r.substr(e.length),-1!==e.indexOf("-")&&(i+="-")),null!==(e=r.match(/^[0-9]+/))&&(e=e[0],r=r.substr(e.length),i+=e),null!==(e=r.match(/^\.[0-9]+/))&&(e=e[0],r=r.substr(e.length),n+=(e=e.substr(1)).length,i+=e),null!==(e=r.match(/^e[+-]?[0-9]+/))&&(e=e[0].substr(1),n-=parseInt(e,10)),{scale:n,integer:new H([i,10])}},Q.ToBigDecimalFromNumber=function(t){var e="boolean"!=typeof t?t:t?1:0;if(isFinite(e)){if(0===e)return{scale:0,integer:H.ZERO};if(Math.abs(e)>=1-Number.EPSILON&&Math.abs(e-Math.round(e))<=Number.EPSILON)return{scale:0,integer:new H(Math.round(e))};var n=Math.trunc(Math.log(Math.abs(e))/Math.log(10)),r=e/Math.pow(10,n);n=-n;for(var i=0;i<14&&(r*=10,n+=1,!(Math.abs(r-Math.round(r))<=Number.EPSILON));i++);return r=Math.round(1e14*r)/1e14,{scale:n,integer:new H(r)}}return e===1/0?{scale:0,integer:H.POSITIVE_INFINITY}:e===-1/0?{scale:0,integer:H.NEGATIVE_INFINITY}:{scale:0,integer:H.NaN}};var $=function(p){function I(t){p.call(this),this._scale=0,this.context=I.getDefaultContext();var e=!1;if(1<arguments.length)throw"BigDecimal Unsupported argument["+arguments.length+"]";if(t instanceof I)this.integer=t.integer.clone(),this.int_string=t.int_string,this._scale=t._scale,this.context=t.context;else if("number"==typeof t||"boolean"==typeof t){var n=Q.ToBigDecimalFromNumber(t);this.integer=n.integer,this._scale=n.scale}else if("string"==typeof t){var r=Q.ToBigDecimalFromString(t);this.integer=r.integer,this._scale=r.scale}else if(t instanceof Array){if(1<=t.length){var i=t[0];if("number"==typeof i||"boolean"==typeof i){var o=Q.ToBigDecimalFromNumber(i);this.integer=o.integer,this._scale=o.scale}else if("string"==typeof i){var a=Q.ToBigDecimalFromString(i);this.integer=a.integer,this._scale=a.scale}else if(i instanceof I)this.integer=i.integer.clone(),this._scale=i._scale;else if(i instanceof H)this.integer=i.clone();else{if("object"!=typeof i)throw"BigDecimal Unsupported argument "+i+"("+typeof i+")";if("toBigDecimal"in i){var u=i.toBigDecimal();this.integer=u.integer,this._scale=u._scale}else if("doubleValue"in i){var s=Q.ToBigDecimalFromNumber(i.doubleValue);this.integer=s.integer,this._scale=s.scale}else{var l=Q.ToBigDecimalFromString(i.toString());this.integer=l.integer,this._scale=l.scale}}}2<=t.length&&("number"==typeof t[1]?(this._scale=t[1],3<=t.length&&(this.context=void 0!==t[2]&&t[2]instanceof y?t[2]:I.getDefaultContext(),e=!0)):2<=t.length&&(this.context=void 0!==t[1]&&t[1]instanceof y?t[1]:I.getDefaultContext(),e=!0))}else if(t instanceof H)this.integer=t.clone();else{if("object"!=typeof t)throw"BigDecimal Unsupported argument "+arguments;if("toBigDecimal"in t){var c=t.toBigDecimal();this.integer=c.integer,this._scale=c._scale,this.context=c.context}else if("doubleValue"in t){var h=Q.ToBigDecimalFromNumber(t.doubleValue);this.integer=h.integer,this._scale=h.scale}else if("integer"in t&&"scale"in t&&"context"in t)this.integer=new H(t.integer),t.scale&&(this._scale=t.scale),t.context&&(this.context=t.context,e=!0);else if(t instanceof Object){var f=Q.ToBigDecimalFromString(t.toString());this.integer=f.integer,this._scale=f.scale}}if(e){var g=this.round(this.context);this.integer=g.integer,this._scale=g._scale,delete this.int_string}if(!(this.integer instanceof H&&this.context instanceof y))throw"BigDecimal Unsupported argument "+arguments}p&&(I.__proto__=p);var t={booleanValue:{configurable:!0},intValue:{configurable:!0},intValueExact:{configurable:!0},floatValue:{configurable:!0},doubleValue:{configurable:!0}},e={MINUS_ONE:{configurable:!0},ZERO:{configurable:!0},HALF:{configurable:!0},ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},PI:{configurable:!0},QUARTER_PI:{configurable:!0},HALF_PI:{configurable:!0},TWO_PI:{configurable:!0},E:{configurable:!0},LN2:{configurable:!0},LN10:{configurable:!0},LOG2E:{configurable:!0},LOG10E:{configurable:!0},SQRT2:{configurable:!0},SQRT1_2:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};return((I.prototype=Object.create(p&&p.prototype)).constructor=I).create=function(t){return t instanceof I?t:new I(t)},I.valueOf=function(t,e){return new I(1===arguments.length?t:[t,e])},I._toBigDecimal=function(t){return t instanceof I?t:new I(t)},I._toBigInteger=function(t){return t instanceof H?t:t instanceof I?t.toBigInteger():new H(t)},I._toFloat=function(t){return"number"==typeof t?t:t instanceof I?t.doubleValue:new I(t).doubleValue},I._toInteger=function(t){return"number"==typeof t?Math.trunc(t):t instanceof H?t.intValue:new H(t).intValue},I.prototype._getUnsignedIntegerString=function(){return void 0===this.int_string&&(this.int_string=this.integer.toString(10).replace(/^-/,"")),this.int_string},I.prototype.clone=function(){return new I(this)},I.prototype.scale=function(){return this._scale},I.prototype.sign=function(){return this.isFinite()?this.integer.sign():this.isNaN()?NaN:this.isPositiveInfinity()?1:-1},I.prototype.precision=function(){return this._getUnsignedIntegerString().length},I.prototype.unscaledValue=function(){return new H(this.integer)},I.prototype.ulp=function(){return new I([H.ONE,this.scale()])},I.prototype.abs=function(){var t=this.clone();return t.integer=t.integer.abs(),t},I.prototype.plus=function(){return this},I.prototype.negate=function(){var t=this.clone();return t.integer=t.integer.negate(),t},I.prototype.movePointLeft=function(t){if(!this.isFinite())return this;var e=I._toInteger(t),n=this.scaleByPowerOfTen(-e);return n=n.setScale(Math.max(this.scale()+e,0))},I.prototype.movePointRight=function(t){return this.movePointLeft(-t)},I.prototype.stripTrailingZeros=function(){if(!this.isFinite())return this;var t=0<=this.sign()?"":"-",e=this.integer.toString(10).replace(/^-/,""),n=e.match(/0+$/),r=null!==n?n[0].length:0;r===e.length&&(r=e.length-1);var i=this.scale()-r;return new I([new H(t+e.substring(0,e.length-r)),i])},I.setDefaultContext=function(t){W[W.length-1]=t||y.DECIMAL128},I.getDefaultContext=function(){return W[W.length-1]},I.pushDefaultContext=function(t){W.push(t)},I.popDefaultContext=function(){W.pop()},t.booleanValue.get=function(){return this.integer.booleanValue},t.intValue.get=function(){return this.isFinite()?4294967295&this.toBigInteger().intValue:this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0},t.intValueExact.get=function(){if(!this.isFinite())throw"ArithmeticException";var t=this.toBigInteger().intValue;if(t<-2147483648||2147483647<t)throw"ArithmeticException";return t},t.floatValue.get=function(){if(!this.isFinite())return this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0;var t=this.precision();return y.DECIMAL32.getPrecision()<t?0<=this.sign()?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:parseFloat(this.toEngineeringString())},t.doubleValue.get=function(){return this.isFinite()?parseFloat(this.toEngineeringString()):this.isNaN()?NaN:this.isPositiveInfinity()?1/0:-1/0},I.prototype.toBigInteger=function(){return this.integer.scaleByPowerOfTen(-this.scale())},I.prototype.toBigDecimal=function(t){return t?this.round(t):this},I.prototype.toFraction=function(){return new q(this)},I.prototype.toComplex=function(){return new L(this)},I.prototype.toMatrix=function(){return new J(this)},I.prototype.toString=function(){if(!this.isFinite())return this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity";var t=-this.scale()+(this.precision()-1);return 0<=this.scale()&&-6<=t?this.toPlainString():this.toScientificNotation(t)},I.prototype.toJSON=function(){return this.toString()},I.prototype.toScientificNotation=function(t){if(!this.isFinite())return this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity";var e,n,r=I._toInteger(t),i=this._getUnsignedIntegerString(),o=this.scale(),a=[];if(-1===this.sign()&&(a[a.length]="-"),0<=(o=-r-o))for(a[a.length]=i,e=0;e<o;e++)a[a.length]="0";else if(0<(n=this.precision()+o))a[a.length]=i.substring(0,n),a[a.length]=".",a[a.length]=i.substring(n,i.length);else{for(n=-n,a[a.length]="0.",e=0;e<n;e++)a[a.length]="0";a[a.length]=i}return a[a.length]="E",0<=r&&(a[a.length]="+"),a[a.length]=r,a.join("")},I.prototype.toEngineeringString=function(){if(!this.isFinite())return this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity";var t=-this.scale()+(this.precision()-1);return 0<=this.scale()&&-6<=t?this.toPlainString():this.toScientificNotation(3*Math.floor(t/3))},I.prototype.toPlainString=function(){return this.isFinite()?0===this.scale()?this.sign()<0?"-"+this._getUnsignedIntegerString():this._getUnsignedIntegerString():this.toScientificNotation(0).match(/^[^E]*/)[0]:this.isNaN()?"NaN":this.isPositiveInfinity()?"Infinity":"-Infinity"},I.prototype.equals=function(t,e){if(e)return 0===this.compareTo(t,e);if(t instanceof I||"string"==typeof t){var n=t instanceof I?t:I._toBigDecimal(t);return!this.isNaN()&&!n.isNaN()&&(this.equalsState(n)&&this._scale===n._scale&&this.integer.equals(n.integer))}return 0===this.compareTo(t)},I.prototype.equalsState=function(t){var e=I._toBigDecimal(t);return this.integer.equalsState(e.integer)},I.prototype.compareTo=function(t,e){var n=this,r=I._toBigDecimal(t);if(!n.isFinite()||!r.isFinite())return n.integer.compareTo(r.integer);if(e){var i=I._toBigDecimal(e);I.pushDefaultContext(y.UNLIMITED);var o=n.sub(r);return I.popDefaultContext(),o.abs().compareTo(i)<=0?0:o.sign()}var a=n.sign(),u=r.sign();if(0===a&&a===u)return 0;if(0===a)return-u;if(0===u)return a;if(n._scale===r._scale)return n.integer.compareTo(r.integer);if(n._scale>r._scale){var s=r.setScale(n._scale);return n.integer.compareTo(s.integer)}return n.setScale(r._scale).integer.compareTo(r.integer)},I.prototype.max=function(t){var e=I._toBigDecimal(t);return this.isNaN()||e.isNaN()?I.NaN:0<=this.compareTo(e)?this.clone():e.clone()},I.prototype.min=function(t){var e=I._toBigDecimal(t);return this.isNaN()||e.isNaN()?I.NaN:this.compareTo(e)<=0?this.clone():e.clone()},I.prototype.clip=function(t,e){var n=I._toBigDecimal(t),r=I._toBigDecimal(e);if(this.isNaN()||n.isNaN()||r.isNaN())return I.NaN;var i=n.compareTo(r);if(1===i)throw"clip(min, max) error. (min > max)->("+n+" > "+r+")";return 0===i?n:1===this.compareTo(r)?r:-1===this.compareTo(n)?n:this},I.prototype.setScale=function(t,e){if(!this.isFinite())return this;var n=I._toInteger(t);if(this.scale()===n)return this.clone();var r=void 0!==e?d.valueOf(e):d.UNNECESSARY,i=this._getUnsignedIntegerString(),o=this.sign(),a=0<=o?"":"-",u=n-this.scale();if(0<=u){var s;for(s=0;s<u;s++)i+="0";return new I([new H(a+i),n])}var l=i.length+u,c=l+1;if(l<=0){var h=(o+r.getAddNumber(o))/10;return new I([new H(h),n])}var f=i.match(/0+$/);if(0<=(null!==f?f[0].length:0)+u||r===d.DOWN)return new I([new H(a+i.substring(0,l)),n]);var g=1<(i=i.substring(0,c)).length?2:1,p=parseInt(i.substring(i.length-g,i.length))*o,m=new H(a+i),_=new H(r.getAddNumber(p));return i=m.add(_).toString(),new I([new H(i.substring(0,i.length-1)),n])},I.prototype.round=function(t){if(!this.isFinite())return this;if(1!==arguments.length)return this.setScale(0,d.HALF_UP);if(void 0===t)return this;if(!(t instanceof y))throw"not MathContext";var e=t.getPrecision(),n=e-this.precision();if(0==n||0===e)return this.clone();var r=this.setScale(this.scale()+n,t.getRoundingMode());if(0<n)return r;if(r.precision()===t.getPrecision())return r;var i=0<=r.integer.sign()?"":"-",o=r._getUnsignedIntegerString(),a=i+o.substring(0,o.length-1);return new I([new H(a),r.scale()-1])},I.prototype.floor=function(){return this.isFinite()?this.setScale(0,d.FLOOR):this},I.prototype.ceil=function(){return this.isFinite()?this.setScale(0,d.CEILING):this},I.prototype.fix=function(){return this.isFinite()?this.setScale(0,d.DOWN):this},I.prototype.fract=function(){return this.isFinite()?this.sub(this.floor()):I.NaN},I.prototype.add=function(t){var e=this,n=I._toBigDecimal(t);if(!e.isFinite()||!n.isFinite())return e.isNaN()||n.isNaN()||e.isInfinite()&&n.isInfinite()&&!e.equalsState(n)?I.NaN:e.isPositiveInfinity()||n.isPositiveInfinity()?I.POSITIVE_INFINITY:I.NEGATIVE_INFINITY;var r=I.getDefaultContext(),i=Math.max(e._scale,n._scale);if(e._scale===n._scale)return new I([e.integer.add(n.integer),i,r]);if(e._scale>n._scale){var o=n.setScale(e._scale);return new I([e.integer.add(o.integer),i,r])}return new I([e.setScale(n._scale).integer.add(n.integer),i,r])},I.prototype.sub=function(t){var e=I._toBigDecimal(t);return this.add(e.negate())},I.prototype.mul=function(t){var e=I._toBigDecimal(t);if(!this.isFinite()||!e.isFinite())return this.isNaN()||e.isNaN()||this.isZero()||e.isZero()?I.NaN:0<this.sign()*e.sign()?I.POSITIVE_INFINITY:I.NEGATIVE_INFINITY;var n=I.getDefaultContext();return new I([this.integer.mul(e.integer),this._scale+e._scale,n])},I.prototype.divideToIntegralValue=function(t){var e=this,n=I._toBigDecimal(t);if(!e.isFinite()||!n.isFinite())return e.isNaN()||n.isNaN()||e.isInfinite()&&n.isInfinite()?I.NaN:e.isInfinite()?0<=e.sign()*n.sign()?I.POSITIVE_INFINITY:I.NEGATIVE_INFINITY:I.ZERO;if(n.isZero())return e.isZero()?I.NaN:0<=e.sign()?I.POSITIVE_INFINITY:I.NEGATIVE_INFINITY;function r(t){var e,n="1";for(e=0;e<t;e++)n+="0";return new H(n)}var i=I.getDefaultContext();if(0===n.compareTo(I.ZERO))throw"ArithmeticException";var o=e.integer,a=n.integer,u=e._scale-n._scale;e._scale>n._scale?a=a.mul(r(u)):e._scale<n._scale&&(o=o.mul(r(-u)));var s=o.div(a),l=s.sign();if(0!==l){var c=s.toString(10).replace(/^-/,"");if(0!==i.getPrecision()&&c.length>i.getPrecision())throw"ArithmeticException";if(c.length<=-u){var h=c.match(/0+$/),f=null!==h?h[0].length:0;return new I([new H((0<=l?"":"-")+c.substring(0,c.length-f)),-f,i])}}var g=new I(s);return(g=(g=g.setScale(u,d.UP)).round(i)).context=i,g},I.prototype.divideAndRemainder=function(t){var e=I._toBigDecimal(t);if(!this.isFinite()||!e.isFinite())return this.isNaN()||e.isNaN()||this.isInfinite()&&e.isInfinite()?[I.NaN,I.NaN]:this.isInfinite()?0<=this.sign()*e.sign()?[I.POSITIVE_INFINITY,I.NaN]:[I.NEGATIVE_INFINITY,I.NaN]:[I.ZERO,I.NaN];if(e.isZero())return this.isZero()?[I.NaN,I.NaN]:[0<=this.sign()?I.POSITIVE_INFINITY:I.NEGATIVE_INFINITY,I.NaN];var n=this.divideToIntegralValue(e),r=this.sub(n.mul(e));return[n,r]},I.prototype.rem=function(t){return this.divideAndRemainder(t)[1]},I.prototype.mod=function(t){var e=I._toBigDecimal(t);if(e.isZero())return this;var n=this.rem(e);return this.equalsState(e)?n:n.add(e)},I.prototype.div=function(t,e){var n=this,r=I._toBigDecimal(t);if(!n.isFinite()||!r.isFinite())return n.isNaN()||r.isNaN()||n.isInfinite()&&r.isInfinite()?I.NaN:n.isInfinite()?0<=n.sign()*r.sign()?I.POSITIVE_INFINITY:I.NEGATIVE_INFINITY:I.ZERO;if(r.isZero())return n.isZero()?I.NaN:0<=n.sign()?I.POSITIVE_INFINITY:I.NEGATIVE_INFINITY;var i=null,o=null,a=0,u=!1;if(e?e instanceof y?(i=(o=e).getRoundingMode(),a=o.getPrecision()):(a=e&&e.scale?e.scale:(u=!0,e&&(e.roundingMode||e.context)?n.scale():n.scale()-r.scale()),e&&e.context?(i=(o=e.context).getRoundingMode(),a=o.getPrecision()):o=this.context,i=e&&e.roundingMode?e.roundingMode:o.getRoundingMode()):(i=(o=I.getDefaultContext()).getRoundingMode(),a=o.getPrecision()),0===r.compareTo(I.ZERO))throw"ArithmeticException";var s,l=o.getPrecision();if(0===l||l<=100){var c,h,f,g,p={};s=I.ZERO;var m=0!==l?l+8:262143;c=n,I.pushDefaultContext(y.UNLIMITED);for(var _,N=!1,v=0;v<m&&(f=(h=c.divideAndRemainder(r))[0],g=h[1],s=s.add(f.scaleByPowerOfTen(-v)),!g.isZero());v++){if(0===l){if(p[g._getUnsignedIntegerString()]){N=!0,_="ArithmeticException "+s+"["+g._getUnsignedIntegerString()+"]";break}p[g._getUnsignedIntegerString()]=!0}c=g.scaleByPowerOfTen(1)}if(I.popDefaultContext(),N)throw _}else I.pushDefaultContext(new y(l+4,d.HALF_UP)),s=this.mul(r.inv()),I.popDefaultContext();if(s.context=o,u)try{s=s.setScale(a,i)}catch(t){}else s=s.setScale(a,i);return s=s.round(I.getDefaultContext())},I.prototype.inv=function(){if(I.getDefaultContext().equals(y.UNLIMITED))return I.ONE.div(this);if(!this.isFinite())return this.isNaN()?I.NaN:I.ZERO;if(this.isZero())return I.NaN;var t=this.isNegative(),e=t?this.negate():this,n=I.create(1),r=new I([1,1+(-e.scale()+(e.precision()-1))]);if(r.isZero())return null;for(var i=r,o=0;o<20;o++){var a=n.sub(e.mul(i));if(a.isZero())break;i=i.mul(n.add(a).add(a.square()))}return t?i.negate():i},I.prototype.factorial=function(){return this.isFinite()?new I(new H(this).factorial()):this},I.prototype.scaleByPowerOfTen=function(t){if(!this.isFinite())return this;var e=I._toInteger(t),n=this.clone();return n._scale=this.scale()-e,n},I.prototype.pow=function(t){var e=I._toBigDecimal(t);if(this.isNaN()||e.isNaN())return I.NaN;if(e.isZero())return I.ONE;if(this.isZero())return I.ZERO;if(this.isOne())return this;if(this.isInfinite())return this.isPositiveInfinity()?I.POSITIVE_INFINITY:e.isPositiveInfinity()?I.NaN:I.create(1/0*Math.pow(-1,Math.round(e.doubleValue)));if(e.isInfinite()){if(this.isNegative())return I.NaN;if(this.compareTo(I.ONE)<0){if(e.isPositiveInfinity())return I.ZERO;if(e.isNegativeInfinity())return I.POSITIVE_INFINITY}else{if(e.isPositiveInfinity())return I.POSITIVE_INFINITY;if(e.isNegativeInfinity())return I.ZERO}}var n=I.getDefaultContext(),r=e.intValue;if(1e3<Math.abs(r))throw I.POSITIVE_INFINITY;if(0===n.getPrecision()&&e.isNegative())return I.NaN;if(e.isInteger()){var i,o,a=e.isNegative(),u=Math.round(Math.abs(r));for(i=this.clone(),o=I.ONE,I.pushDefaultContext(y.UNLIMITED);0!==u;)0!=(1&u)&&(o=o.mul(i)),i=i.square(),u>>>=1;return I.popDefaultContext(),o.context=n,a&&(o=o.inv()),o=o.round(n)}var s=I.getDefaultContext();I.pushDefaultContext(I.getDefaultContext().increasePrecision());var l=this.log().mul(t).exp().round(s);return I.popDefaultContext(),l},I.prototype.square=function(){return this.mul(this)},I.prototype.sqrt=function(){if(this.isZero())return I.ZERO;if(this.isNaN())return I.NaN;if(this.isNegative())return I.NaN;if(this.isInfinite())return I.POSITIVE_INFINITY;if(this.isZero())return I.ZERO;var t=I.getDefaultContext();I.pushDefaultContext(I.getDefaultContext().increasePrecision());var e=this.rsqrt().inv().round(t);return I.popDefaultContext(),e},I.prototype.cbrt=function(){if(this.isZero())return I.ZERO;if(this.isNaN())return I.NaN;if(this.isInfinite())return this;var t,e=-this.scale()+(this.precision()-1)+1,n=this.sign(),r=this.abs();if(e<30){var i=I.getDefaultContext();I.pushDefaultContext(I.getDefaultContext().increasePrecision()),t=r.log().div(3).exp().round(i),I.popDefaultContext()}else{for(var o=1===r.compareTo(I.ONE)?r:I.ONE,a=0;a<1e3;a++){var u=o.mul(o),s=o.mul(2).add(r.div(u)).div(3);if(s.sub(o).isZero())break;o=s}t=o}return 1===n?t:t.negate()},I.prototype.rsqrt=function(){if(this.isZero())return I.POSITIVE_INFINITY;if(this.isNaN())return I.NaN;if(this.isInfinite())return I.ZERO;if(this.isNegative())return I.NaN;var t=I.create(1),e=I.create(5),n=I.create(6),r=I.create(8),i=I.create(16).inv(),o=this.inv();if(o.isZero())throw"ArithmeticException";for(var a=o,u=0;u<50;u++){var s=t.sub(this.mul(a.square()));if(s.isZero())break;a=a.mul(t.add(s.mul(r.add(s.mul(n.add(e.mul(s))))).mul(i)))}return a},I.prototype.log=function(){if(this.isZero())return I.NEGATIVE_INFINITY;if(this.isNaN())return I.NaN;if(this.isNegative())return I.NaN;if(this.isInfinite())return I.POSITIVE_INFINITY;if(this.isOne())return I.ZERO;var t=I.getDefaultContext(),e=-this.scale()+(this.precision()-1)+1;I.pushDefaultContext(new y(t.getPrecision()+e,d.HALF_UP));var n=this,r=0,i=I.E,o=n.compareTo(i);if(0===o)return I.popDefaultContext(),I.ONE;if(0<o)for(;r<300&&!(n.compareTo(i)<=0);r++)n=n.div(i);else{var a=new I(1);if(n.compareTo(a)<0)for(;-300<r&&!(0<n.compareTo(a));r--)n=n.mul(i)}I.popDefaultContext();for(var u=(n=n.round(I.getDefaultContext())).sub(I.ONE).div(n.add(I.ONE)),s=u.mul(u),l=u,c=u,h=I.ONE,f=0;f<300;f++){h=h.add(I.TWO),l=l.mul(s);var g=c.add(l.div(h)),p=g.sub(c);if(c=g,p.isZero())break}return(n=c.mul(I.TWO)).add(r)},I.prototype.exp=function(){if(this.isZero())return I.ONE;if(this.isNaN())return I.NaN;if(this.isNegativeInfinity())return I.ZERO;if(this.isPositiveInfinity())return I.POSITIVE_INFINITY;var t=this.isNegative(),e=this;t&&(e=e.negate());var n=-e.scale()+(e.precision()-1)+1,r=I.getDefaultContext();I.pushDefaultContext(new y(r.getPrecision()+n,d.HALF_UP));var i=0,o=1,a=e.doubleValue;10<=a&&(i=Math.floor(Math.log(Math.floor(a))/Math.log(10)),o=Math.pow(10,i));for(var u,s=e.div(o,r),l=s,c=I.ONE.add(s),h=I.ONE,f=2;f<300;f++){h=h.mul(f),l=l.mul(s);var g=c.add(l.div(h)),p=g.sub(c);if(c=g,p.isZero())break}return u=(u=c).pow(o),I.popDefaultContext(),u=u.round(I.getDefaultContext()),t?u.inv():u},I.prototype.expm1=function(){return this.exp().sub(1)},I.prototype.log1p=function(){return this.add(1).log()},I.prototype.log2=function(){return this.log().div(I.LN2)},I.prototype.log10=function(){return this.log().div(I.LN10)},I.prototype.sin=function(){if(!this.isFinite())return I.NaN;var t=-this.scale()+(this.precision()-1)+1,e=new y(I.getDefaultContext().getPrecision()+t,d.HALF_UP);I.pushDefaultContext(e);var n=this.mod(I.TWO_PI);I.popDefaultContext();for(var r=n,i=n.mul(n),o=n,a=I.ONE,u=-1,s=2;s<300;s++)if(a=a.mul(s),s%2==1){o=o.mul(i);var l=void 0;u=u<0?(l=r.sub(o.div(a)),1):(l=r.add(o.div(a)),-1);var c=l.sub(r);if(r=l,c.isZero())break}return r},I.prototype.cos=function(){if(!this.isFinite())return I.NaN;var t=-this.scale()+(this.precision()-1)+1,e=new y(I.getDefaultContext().getPrecision()+t,d.HALF_UP);I.pushDefaultContext(e);var n=this.mod(I.TWO_PI);I.popDefaultContext();for(var r=I.ONE,i=I.ONE,o=n.mul(n),a=I.ONE,u=-1,s=2;s<300;s++)if(a=a.mul(s),s%2==0){i=i.mul(o);var l=void 0;u=u<0?(l=r.sub(i.div(a)),1):(l=r.add(i.div(a)),-1);var c=l.sub(r);if(r=l,c.isZero())break}return r},I.prototype.tan=function(){return this.isFinite()?this.sin().div(this.cos()):I.NaN},I.prototype.atan=function(){if(!this.isFinite())return this.isNaN()?I.NaN:this.isPositiveInfinity()?I.HALF_PI:I.HALF_PI.negate();if(this.isZero())return I.ZERO;if(0===this.compareTo(I.ONE))return I.QUARTER_PI;if(0===this.compareTo(I.MINUS_ONE))return I.QUARTER_PI.negate();var t,e=this.sign(),n=this.abs();1===n.compareTo(I.TWO)?(t=1,n=n.inv()):1===n.compareTo(I.HALF)?(t=2,n=I.ONE.sub(n).div(I.ONE.add(n))):t=3;for(var r=n,i=n.mul(n),o=n,a=I.ONE,u=-1,s=0;s<300;s++){o=o.mul(i),a=a.add(I.TWO);var l=void 0;u=u<0?(l=r.sub(o.div(a)),1):(l=r.add(o.div(a)),-1);var c=l.sub(r);if(r=l,c.isZero())break}return 1===t?r=I.HALF_PI.sub(r):2===t&&(r=I.QUARTER_PI.sub(r)),e<0&&(r=r.negate()),r},I.prototype.atan2=function(t,e){var n,r=I.getDefaultContext(),i=this.round(e),o=new I([t,e]);if(o.isNaN()||i.isNaN())return I.NaN;if(o.isPositive())n=i.div(o).atan();else if(i.isNotNegative()&&o.isNegative())n=i.div(o).atan().add(I.PI);else if(i.isNegative()&&o.isNegative())n=i.div(o).atan().sub(I.PI);else if(i.isPositive())n=I.HALF_PI;else{if(!i.isNegative())throw"ArithmeticException";n=I.HALF_PI.negate()}return I.setDefaultContext(r),n},I.prototype.asin=function(){var t=this.square().negate().add(1).sqrt(),e=t.square().add(this.square()).sqrt(),n=this.atan2(t);return e.log().add(n)},I.prototype.acos=function(){var t=this.square().negate().add(1).sqrt(),e=this.square().add(t.square()).sqrt(),n=t.atan2(this);return e.log().add(n)},I.prototype.sinh=function(){if(this.isInfinite())return this;var t=this.exp();return t.sub(t.inv()).mul(.5)},I.prototype.asinh=function(){return this.isInfinite()?this:this.add(this.mul(this).add(1).sqrt()).log()},I.prototype.cosh=function(){return this.isInfinite()?I.POSITIVE_INFINITY:this.exp().add(this.negate().exp()).mul(.5)},I.prototype.acosh=function(){return this.isInfinite()?I.NaN:this.add(this.mul(this).sub(1).sqrt()).log()},I.prototype.tanh=function(){if(this.isInfinite())return I.create(this.sign());var t=this.mul(2).exp();return t.sub(1).div(t.add(1))},I.prototype.atanh=function(){return this.add(1).div(this.negate().add(1)).log().mul(.5)},I.prototype.sec=function(){return this.cos().inv()},I.prototype.asec=function(){return this.inv().acos()},I.prototype.sech=function(){return this.isNegativeInfinity()?I.ZERO:this.exp().add(this.negate().exp()).inv().mul(2)},I.prototype.asech=function(){return this.inv().add(this.square().inv().sub(1).sqrt()).log()},I.prototype.cot=function(){return this.isZero()?I.POSITIVE_INFINITY:this.tan().inv()},I.prototype.acot=function(){return this.isZero()?I.HALF_PI:this.inv().atan()},I.prototype.coth=function(){if(this.isInfinite())return I.create(this.sign());var t=this.mul(2).exp();return t.add(1).div(t.sub(1))},I.prototype.acoth=function(){return this.isInfinite()?I.ZERO:this.add(1).div(this.sub(1)).log().mul(.5)},I.prototype.csc=function(){return this.isZero()?I.POSITIVE_INFINITY:this.sin().inv()},I.prototype.acsc=function(){return this.inv().asin()},I.prototype.csch=function(){return this.isInfinite()?I.ZERO:this.isZero()?I.POSITIVE_INFINITY:this.exp().sub(this.negate().exp()).inv().mul(2)},I.prototype.acsch=function(){return this.isZero()?I.POSITIVE_INFINITY:this.inv().add(this.square().inv().add(1).sqrt()).log()},I.prototype.logit=function(){return this.log().sub(I.ONE.sub(this).log())},I.prototype.sinc=function(){if(this.isZero())return I.ONE;var t=I.PI.mul(this);return t.sin().div(t)},I.rand=function(t){var e=I.getDefaultContext().getPrecision();e<=0&&(e=100);var n=Math.ceil(e*Math.log(10)/Math.log(2)),r=H.ONE.shiftLeft(n);return new I(H.createRandomBigInteger(n,t)).div(r)},I.randn=function(t){var e=I.rand(t).log().mul(-2).sqrt(),n=I.rand(t).mul(2).mul(I.PI);return e.mul(n.sin())},I.prototype.isInteger=function(t){return!!this.isFinite()&&this.sub(this.fix()).isZero(t)},I.prototype.isZero=function(t){return!!this.isFinite()&&(t?this.equals(I.ZERO,t):this.integer.isZero())},I.prototype.isOne=function(t){return!!this.isFinite()&&0===this.compareTo(I.ONE,t)},I.prototype.isPositive=function(){return this.integer.isPositive()},I.prototype.isNegative=function(){return this.integer.isNegative()},I.prototype.isNotNegative=function(){return this.integer.isNotNegative()},I.prototype.isNaN=function(){return this.integer.isNaN()},I.prototype.isPositiveInfinity=function(){return this.integer.isPositiveInfinity()},I.prototype.isNegativeInfinity=function(){return this.integer.isNegativeInfinity()},I.prototype.isInfinite=function(){return this.integer.isInfinite()},I.prototype.isFinite=function(){return this.integer.isFinite()},I.prototype.and=function(t){var e=I._toBigDecimal(t),n=this.round().toBigInteger(),r=e.round().toBigInteger();return new I(n.and(r))},I.prototype.or=function(t){var e=I._toBigDecimal(t),n=this.round().toBigInteger(),r=e.round().toBigInteger();return new I(n.or(r))},I.prototype.xor=function(t){var e=I._toBigDecimal(t),n=this.round().toBigInteger(),r=e.round().toBigInteger();return new I(n.xor(r))},I.prototype.not=function(){return new I(this.round().toBigInteger().not())},I.prototype.shift=function(t){var e=this.round().toBigInteger(),n=I._toInteger(t);return new I(e.shift(n))},I.prototype.factor=function(){for(var t=this.round().toBigInteger().factor(),e=[],n=0;n<t.length;n++)e.push(new I(t[n]));return e},I.prototype.gcd=function(t){var e=this.round().toBigInteger(),n=I._toBigDecimal(t).toBigInteger();return new I(e.gcd(n))},I.prototype.extgcd=function(t){var e=this.round().toBigInteger(),n=I._toBigDecimal(t).toBigInteger(),r=e.extgcd(n);return[new I(r[0]),new I(r[1]),new I(r[2])]},I.prototype.lcm=function(t){var e=this.round().toBigInteger(),n=I._toBigDecimal(t).toBigInteger();return new I(e.lcm(n))},I.prototype.modPow=function(t,e){var n=this.round().toBigInteger(),r=I._toBigDecimal(t).toBigInteger(),i=I._toBigDecimal(e).toBigInteger();return new I(n.modPow(r,i))},I.prototype.modInverse=function(t){var e=this.round().toBigInteger(),n=I._toBigDecimal(t).toBigInteger();return new I(e.modInverse(n))},I.prototype.isPrime=function(){return this.round().toBigInteger().isPrime()},I.prototype.isProbablePrime=function(t){return this.round().toBigInteger().isProbablePrime(void 0!==t?I._toInteger(t):void 0)},I.prototype.nextProbablePrime=function(t,e){var n=this.round().toBigInteger(),r=void 0!==t?I._toInteger(t):void 0,i=void 0!==e?I._toInteger(e):void 0;return I.create(n.nextProbablePrime(r,i))},e.MINUS_ONE.get=function(){return et.MINUS_ONE.get()},e.ZERO.get=function(){return et.ZERO.get()},e.HALF.get=function(){return et.HALF.get()},e.ONE.get=function(){return et.ONE.get()},e.TWO.get=function(){return et.TWO.get()},e.TEN.get=function(){return et.TEN.get()},e.PI.get=function(){return et.PI.get()},e.QUARTER_PI.get=function(){return et.QUARTER_PI.get()},e.HALF_PI.get=function(){return et.HALF_PI.get()},e.TWO_PI.get=function(){return et.TWO_PI.get()},e.E.get=function(){return et.E.get()},e.LN2.get=function(){return et.LN2.get()},e.LN10.get=function(){return et.LN10.get()},e.LOG2E.get=function(){return et.LOG2E.get()},e.LOG10E.get=function(){return et.LOG10E.get()},e.SQRT2.get=function(){return et.SQRT2.get()},e.SQRT1_2.get=function(){return et.SQRT1_2.get()},e.POSITIVE_INFINITY.get=function(){return null===K.POSITIVE_INFINITY&&(K.POSITIVE_INFINITY=new I(Number.POSITIVE_INFINITY)),K.POSITIVE_INFINITY},e.NEGATIVE_INFINITY.get=function(){return null===K.NEGATIVE_INFINITY&&(K.NEGATIVE_INFINITY=new I(Number.NEGATIVE_INFINITY)),K.NEGATIVE_INFINITY},e.NaN.get=function(){return null===K.NaN&&(K.NaN=new I(Number.NaN)),K.NaN},I.prototype.signum=function(){return this.sign()},I.prototype.subtract=function(t){return this.sub(t)},I.prototype.multiply=function(t){return this.mul(t)},I.prototype.divide=function(t,e){return this.div(t,e)},I.prototype.remainder=function(t){return this.rem(t)},I.prototype.trunc=function(){return this.fix()},Object.defineProperties(I.prototype,t),Object.defineProperties(I,e),I}(V);$.RoundingMode=d,$.MathContext=y;function X(t,e){this.method_name=t,this.table=[],this.table_max=e}var K={MINUS_ONE:function(){return new $(-1)},ZERO:function(){return new $(0)},HALF:function(){return new $(.5)},ONE:function(){return new $(1)},TWO:function(){return new $(2)},TEN:function(){return new $(10)},PI:function(){var t=$.getDefaultContext();if(t.getPrecision()<=78)return new $("3.1415926535897932384626433832795028841971693993751058209749445923078164062862").round(t);for(var e=$.create(1),n=$.create(2),r=$.create(4),i=e,o=n.sqrt().inv(),a=r.inv(),u=e,s=e,l=0;l<10;l++){var c=i.add(o).div(n),h=i.mul(o).sqrt(),f=a.sub(u.mul(i.sub(c).square())),g=u.mul(n),p=c.add(h).square().div(f.mul(r)),m=p.sub(s);if(s=p,m.isZero())break;i=c,o=h,a=f,u=g}return s},QUARTER_PI:function(){return K.PI().div(4)},HALF_PI:function(){return K.PI().div(2)},TWO_PI:function(){return K.PI().mul(2)},E:function(){var t=$.getDefaultContext();if(t.getPrecision()<=83)return new $("2.71828182845904523536028747135266249775724709369995957496696762772407663035354759").round(t);for(var e=$.create(2),n=$.create(1),r=2;r<300;r++){n=n.mul(r);var i=e.add(n.inv()),o=i.sub(e);if(e=i,o.isZero())break}return e},LN2:function(){return new $(2).log()},LN10:function(){return new $(10).log()},LOG2E:function(){return new $(2).log().inv()},LOG10E:function(){return new $(10).log().inv()},SQRT2:function(){return new $(2).sqrt()},SQRT1_2:function(){return new $(.5).sqrt()},POSITIVE_INFINITY:null,NEGATIVE_INFINITY:null,NaN:null};X.prototype.get=function(){for(var t=$.getDefaultContext().toString(),e=0;e<this.table.length;e++)if(this.table[e].name===t){var n=this.table.splice(e,1)[0];return this.table.unshift(n),n.number}var r=K[this.method_name]();return this.table.length===this.table_max&&this.table.pop(),this.table.unshift({name:t,number:r}),r};function tt(){}var et=new function(){this.MINUS_ONE=new X("MINUS_ONE",10),this.ZERO=new X("ZERO",10),this.HALF=new X("HALF",10),this.ONE=new X("ONE",10),this.TWO=new X("TWO",10),this.TEN=new X("TEN",10),this.PI=new X("PI",10),this.QUARTER_PI=new X("QUARTER_PI",10),this.HALF_PI=new X("HALF_PI",10),this.TWO_PI=new X("TWO_PI",10),this.E=new X("E",10),this.LN2=new X("LN2",10),this.LN10=new X("LN10",10),this.LOG2E=new X("LOG2E",10),this.LOG10E=new X("LOG10E",10),this.SQRT2=new X("SQRT2",10),this.SQRT1_2=new X("SQRT1_2",10)};tt.runPrincipalComponentAnalysis=function(t){var n=J.create(t.samples),e={correction:void 0!==t.is_unbiased&&t.is_unbiased?1:0};t.is_standardised&&(n=n.standardization(e));var r=n.cov(e).svd(),i=r.S.diag(),o=r.U.T().negate(),a=o.dotpow(2),u=i.sum(),s=i.dotdiv(u),l=L.ZERO,c=J.createMatrixDoEachCalculation(function(t,e){return l=l.add(s.getComplex(t+e))},s.column_length,s.row_length);n=n.sub(n.mean({dimension:"column"}));for(var h=J.createMatrixDoEachCalculation(function(t,e){return n.getMatrix(e,":").dotmul(o.getMatrix(t,":")).sum()},i.length,n.size(1)),f=i.T().getNumberMatrixArray()[0],g=o.getNumberMatrixArray(),p=a.getNumberMatrixArray(),m=c.getNumberMatrixArray()[0],_=s.T().getNumberMatrixArray()[0],N=h.getNumberMatrixArray(),v=[],I=0;I<i.length;I++)v.push({eigen_value:f[I],factor_loading:g[I],factor_loading_contribution_rate:p[I],cumulative_contribution_ratio:m[I],contribution_ratio:_[I],score:N[I]});return{principal_component:v}};function nt(){}nt.runMultipleRegressionAnalysis=function(t){var e=J.create(t.samples),n=J.create(t.target),r={correction:1};t.is_standardised&&(e=e.standardization(),n=n.standardization());var i=J.create(e.width),o=J.create(e.height),a=e.cov(r),u=a.rcond();if(u<=1e-10)return console.log("Analysis failed due to highly correlated explanatory variables.(rcond : "+u+")"),null;for(var s=[],l=i.intValue,c=0;c<l;c++)s[c]=[e.getMatrix(":",c).cov(n,r)];for(var h=J.create(s),f=a.inv().mul(h),g=n.mean().sub(e.mean().mul(f)),p=e.mul(f).add(g),m=p.var(r),_=n.var(r),N=p.corrcoef(n,r),v=m.div(_),I=i,d=p.sub(n.mean()).dotpow(2).sum(),y=d.div(I),b=o.sub(i).sub(1),w=p.sub(n).dotpow(2).sum(),E=w.div(b),x=o.sub(1),M=n.sub(n.mean()).dotpow(2).sum(),O=M.div(x),T=E,F=T.sqrt(),P=y.div(E),S=J.ONE.sub(P.fcdf(I,b)),D=J.ONE.sub(E.div(O)),A=o.mul(w.div(o).mul(2*Math.PI).log().add(1)).add(i.add(2).mul(2)),V=a.dotmul(o).inv(),R={coefficient:J.ZERO,standard_error:J.ZERO,t_stat:J.ZERO,p_value:J.ZERO,lower_95:J.ZERO,upper_95:J.ZERO},C=[],Z=0;Z<l;Z++)C[Z]={coefficient:J.ZERO,standard_error:J.ZERO,t_stat:J.ZERO,p_value:J.ZERO,lower_95:J.ZERO,upper_95:J.ZERO};R.coefficient=g;for(var L=0;L<l;L++)C[L].coefficient=new J(f.getComplex(L));for(var B=i.intValue,Y=o.inv(),q=0;q<B;q++)for(var U=0;U<B;U++)Y=Y.add(e.getMatrix(":",q).mean().mul(e.getMatrix(":",U).mean()).mul(V.getMatrix(q,U)));R.standard_error=Y.mul(T).sqrt();for(var G=0;G<l;G++)C[G].standard_error=V.getMatrix(G,G).mul(T).sqrt();function z(t){t.t_stat=t.coefficient.div(t.standard_error),t.p_value=t.t_stat.tdist(b,2);var e=new J(1-.95);t.lower_95=t.coefficient.sub(e.tinv2(b).mul(t.standard_error)),t.upper_95=t.coefficient.add(e.tinv2(b).mul(t.standard_error))}z(R);for(var j=0;j<l;j++)z(C[j]);for(var H,k={coefficient:R.coefficient.doubleValue,standard_error:R.standard_error.doubleValue,t_stat:R.t_stat.doubleValue,p_value:R.p_value.doubleValue,lower_95:R.lower_95.doubleValue,upper_95:R.upper_95.doubleValue},W=[],Q=0;Q<l;Q++)W.push({coefficient:C[Q].coefficient.doubleValue,standard_error:C[Q].standard_error.doubleValue,t_stat:C[Q].t_stat.doubleValue,p_value:C[Q].p_value.doubleValue,lower_95:C[Q].lower_95.doubleValue,upper_95:C[Q].upper_95.doubleValue});return H={intercept:k,parameters:W},{q:i.doubleValue,n:o.doubleValue,predicted_values:p.getNumberMatrixArray(),sY:m.doubleValue,sy:_.doubleValue,multiple_R:N.doubleValue,R_square:v.doubleValue,adjusted_R_square:D.doubleValue,ANOVA:{regression:{df:I.doubleValue,SS:d.doubleValue,MS:y.doubleValue},residual:{df:b.doubleValue,SS:w.doubleValue,MS:E.doubleValue},total:{df:x.doubleValue,SS:M.doubleValue,MS:O.doubleValue},F:P.doubleValue,significance_F:S.doubleValue},Ve:T.doubleValue,standard_error:F.doubleValue,AIC:A.doubleValue,regression_table:H}};function rt(){}rt.runPrincipalComponentAnalysis=function(t){return tt.runPrincipalComponentAnalysis(t)},rt.runMultipleRegressionAnalysis=function(t){return nt.runMultipleRegressionAnalysis(t)};function it(){}var ot={BigInteger:{configurable:!0},BigDecimal:{configurable:!0},RoundingMode:{configurable:!0},MathContext:{configurable:!0},Fraction:{configurable:!0},Complex:{configurable:!0},Matrix:{configurable:!0},Random:{configurable:!0},DataAnalysis:{configurable:!0},Probability:{configurable:!0}};return ot.BigInteger.get=function(){return H},ot.BigDecimal.get=function(){return $},ot.RoundingMode.get=function(){return d},ot.MathContext.get=function(){return y},ot.Fraction.get=function(){return q},ot.Complex.get=function(){return L},ot.Matrix.get=function(){return J},ot.Random.get=function(){return v},ot.DataAnalysis.get=function(){return rt},ot.Probability.get=function(){return _},Object.defineProperties(it,ot),it});
