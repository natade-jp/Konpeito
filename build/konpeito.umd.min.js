/*!
 * konpeito.js (version 2.1.0, 2020/1/26)
 * https://github.com/natade-jp/konpeito
 * Copyright 2013-2020 natade < https://github.com/natade-jp >
 *
 * The MIT license.
 * https://opensource.org/licenses/MIT
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t=t||self).konpeito=r()}(this,function(){"use strict";function n(t){this.x=[];for(var r=0;r<521;r++)this.x[r]=0;if(void 0!==t)this.setSeed(t);else{var e=(new Date).getTime()+n.seedUniquifier&4294967295;n.seedUniquifier=n.seedUniquifier+1&4294967295,this.setSeed(e)}}n.prototype._rnd521=function(){for(var t=this.x,r=0;r<32;r++)t[r]^=t[r+489];for(var e=32;e<521;e++)t[e]^=t[e-32]},n.prototype.setSeed=function(t){for(var r,e,n,i=0,o=this.x,a=t,u=0;u<=16;u++){for(var s=0;s<32;s++)n=void 0,n=(n=(65535&(r=a))*(65535&(e=1566083941))>>>0)+((65535&(65535&r)*(e>>>16))<<16)>>>0,i=(i>>>1)+((a=1+(4294967295&(n+=(65535&(r>>>16)*(65535&e))<<16)))<0?2147483648:0);o[u]=i}for(var l=16;l<521;l++)i=16===l?l:l-17,o[l]=o[i]<<23&4294967295^o[l-16]>>>9^o[l-1];for(var h=0;h<4;h++)this._rnd521();this.xi=0,this.haveNextNextGaussian=!1,this.nextNextGaussian=0},n.prototype.genrand_int32=function(){521===this.xi&&(this._rnd521(),this.xi=0);var t=this.x[this.xi]>>>0;return this.xi=this.xi+1,t},n.seedUniquifier=2271560481;function e(t,r){var e=(65535&t)*(65535&r)>>>0,n=(65535&t)*(r>>>16);return e=e+((65535&n)<<16)>>>0,4294967295&(e+=(65535&(n=(t>>>16)*(65535&r)))<<16)}function i(t){if(this.x=123456789,this.y=362436069,this.z=521288629,this.w=88675123,void 0!==t)this.setSeed(t);else{var r=(new Date).getTime()+i.seedUniquifier&4294967295;i.seedUniquifier=i.seedUniquifier+1&4294967295,this.setSeed(r)}}i.prototype.setSeed=function(t){var r=t;r=e(r,214013)+2531011>>>0,this.z=r,r=e(r,214013)+2531011>>>0,this.w=r,this.haveNextNextGaussian=!1,this.nextNextGaussian=0},i.prototype.genrand_int32=function(){var t=this.x^this.x<<11;return this.x=this.y,this.y=this.z,this.z=this.w,this.w=this.w^this.w>>>19^t^t>>>8,this.w},i.seedUniquifier=2271560481;function v(t){var r=void 0,e="fast";this.rand=null,"number"==typeof t?r=t:"object"==typeof t&&(void 0!==t.seed&&(r=t.seed),void 0!==t.algorithm&&(e=t.algorithm)),/fast|xorshift/i.test(e)?this.rand=new i(r):this.rand=new n(r)}v.prototype.setSeed=function(t){this.rand.setSeed(t)},v.prototype.genrand_int32=function(){return this.rand.genrand_int32()},v.prototype.next=function(t){return 0===t?0:32===t?this.genrand_int32():t<32?this.genrand_int32()>>>32-t:63===t?2147483648*this.genrand_int32()+this.genrand_int32():64===t?4294967296*this.genrand_int32()+this.genrand_int32():t<63?this.genrand_int32()*(1<<t-32)+(this.genrand_int32()>>>64-t):void 0},v.prototype.nextBytes=function(t){for(var r=new Array(t),e=0;e<r.length;e++)r[e]=this.next(8);return r},v.prototype.nextShort=function(){return this.next(16)},v.prototype.nextInt=function(t){if(void 0===t||"number"!=typeof t)return 4294967295&this.next(32);for(var r,e;e=(r=this.genrand_int32()>>>0)%t,4294967296<r-e+t;);return e},v.prototype.nextLong=function(){return this.next(64)},v.prototype.nextBoolean=function(){return 0!==this.next(1)},v.prototype.nextFloat=function(){return this.next(24)/16777216},v.prototype.nextDouble=function(){return(134217728*this.next(26)+this.next(27))/9007199254740992},v.prototype.nextGaussian=function(){if(this.haveNextNextGaussian)return this.haveNextNextGaussian=!1,this.nextNextGaussian;var t=Math.sqrt(-2*Math.log(this.nextDouble())),r=2*Math.PI*this.nextDouble(),e=t*Math.sin(r);return this.nextNextGaussian=t*Math.cos(r),this.haveNextNextGaussian=!0,e};function t(){}t.toString=function(){return"NONE"},t.getAddNumber=function(t){return 0};function w(){}var o=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),((r.prototype=Object.create(t&&t.prototype)).constructor=r).toString=function(){return"UP"},r.getAddNumber=function(t){var r=t%10;return 0==r?0:0<r?10-r:-(10+r)},r}(t),a=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),((r.prototype=Object.create(t&&t.prototype)).constructor=r).toString=function(){return"DOWN"},r.getAddNumber=function(t){return-t%10},r}(t),u=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),((r.prototype=Object.create(t&&t.prototype)).constructor=r).toString=function(){return"CEILING"},r.getAddNumber=function(t){var r=t%10;return 0==r?0:0<r?10-r:-r},r}(t),s=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),((r.prototype=Object.create(t&&t.prototype)).constructor=r).toString=function(){return"FLOOR"},r.getAddNumber=function(t){var r=t%10;return 0==r?0:0<r?-r:-(10+r)},r}(t),l=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),((r.prototype=Object.create(t&&t.prototype)).constructor=r).toString=function(){return"HALF_UP"},r.getAddNumber=function(t){var r=t%10,e=0<=r?1:-1;return Math.abs(r)<5?-1*r:e*(10-Math.abs(r))},r}(t),h=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),((r.prototype=Object.create(t&&t.prototype)).constructor=r).toString=function(){return"HALF_DOWN"},r.getAddNumber=function(t){var r=t%10,e=0<=r?1:-1;return Math.abs(r)<6?-1*r:e*(10-Math.abs(r))},r}(t),c=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),((r.prototype=Object.create(t&&t.prototype)).constructor=r).toString=function(){return"HALF_EVEN"},r.getAddNumber=function(t){var r,e,n=t%100;return e=1===(n<0?(r=-1,1&Math.ceil(n/10)):(r=1)&Math.floor(n/10))?5:6,n%=10,Math.abs(n)<e?-1*n:r*(10-Math.abs(n))},r}(t),f=function(t){function r(){t.apply(this,arguments)}return t&&(r.__proto__=t),((r.prototype=Object.create(t&&t.prototype)).constructor=r).toString=function(){return"UNNECESSARY"},r.getAddNumber=function(t){if(0==t%10)return 0;throw"ArithmeticException"},r}(t),r={UP:{configurable:!0},DOWN:{configurable:!0},CEILING:{configurable:!0},FLOOR:{configurable:!0},HALF_UP:{configurable:!0},HALF_DOWN:{configurable:!0},HALF_EVEN:{configurable:!0},UNNECESSARY:{configurable:!0}};w.valueOf=function(t){var r;if("string"==typeof t)r=t;else{if(!(t instanceof Object))throw"Unsupported argument "+t;r=t.toString()}for(var e=[o,a,s,u,l,h,c,f],n=r.toUpperCase(),i=0;i<e.length;i++)if(e[i].toString()===n)return e[i];throw"IllegalArgumentException : "+r},r.UP.get=function(){return o},r.DOWN.get=function(){return a},r.CEILING.get=function(){return u},r.FLOOR.get=function(){return s},r.HALF_UP.get=function(){return l},r.HALF_DOWN.get=function(){return h},r.HALF_EVEN.get=function(){return c},r.UNNECESSARY.get=function(){return f},Object.defineProperties(w,r);function y(t,r){var e;if(this.precision=0,this.roundingMode=void 0===r?w.HALF_UP:r,"number"==typeof t&&(this.precision=t),"string"==typeof t&&(null!==(e=t.match(/precision=\d+/))&&(e=e[0].substring("precision=".length,e[0].length),this.precision=parseInt(e,10)),null!==(e=t.match(/roundingMode=\w+/))&&(e=e[0].substring("roundingMode=".length,e[0].length),this.roundingMode=w.valueOf(e))),this.precision<0)throw"IllegalArgumentException"}var g={UNLIMITED:{configurable:!0},DECIMAL32:{configurable:!0},DECIMAL64:{configurable:!0},DECIMAL128:{configurable:!0},DECIMAL256:{configurable:!0}};y.prototype.getPrecision=function(){return this.precision},y.prototype.getRoundingMode=function(){return this.roundingMode},y.prototype.equals=function(t){return t instanceof y&&t.toString()===this.toString()},y.prototype.toString=function(){return"precision="+this.precision+" roundingMode="+this.roundingMode.toString()},g.UNLIMITED.get=function(){return _.UNLIMITED},g.DECIMAL32.get=function(){return _.DECIMAL32},g.DECIMAL64.get=function(){return _.DECIMAL64},g.DECIMAL128.get=function(){return _.DECIMAL128},g.DECIMAL256.get=function(){return _.DECIMAL256},Object.defineProperties(y,g);function m(){}var _={UNLIMITED:new y(0,w.HALF_UP),DECIMAL32:new y(7,w.HALF_EVEN),DECIMAL64:new y(16,w.HALF_EVEN),DECIMAL128:new y(34,w.HALF_EVEN),DECIMAL256:new y(72,w.HALF_EVEN)},p=new v;m.toHexadecimalArrayFromPlainString=function(t,r){for(var e=Math.floor(Math.log(1073741823)/Math.log(r)),n=[],i=[],o=Math.ceil(t.length/e),a=t.length,u=0;u<o;u++)a-=e,n[u]=0<=a?parseInt(t.substring(a,a+e),r):parseInt(t.substring(0,a+e),r);for(var s=Math.round(Math.pow(r,e));0!==n.length;){for(var l=0,h=n.length-1;0<=h;h--){var c=n[h]+l*s;n[h]=c>>>1,l=1&c}i[i.length]=l,0===n[n.length-1]&&n.pop()}n=[];for(var f=0;f<i.length;f++)n[f>>>4]|=i[f]<<(15&f);return n},m.toPlainStringFromString=function(t){var r,e,n=0,i=t.replace(/\s/g,"").toLowerCase(),o=[];if(null!==(r=i.match(/^[0-9]+/))&&(r=r[0],i=i.substr(r.length),o.push(r)),null!==(r=i.match(/^\.[0-9]+/))&&(r=r[0],i=i.substr(r.length),n+=(r=r.substr(1)).length,o.push(r)),null!==(r=i.match(/^e[+-]?[0-9]+/))&&(r=r[0].substr(1),n-=parseInt(r,10)),0===n&&(e=o.join("")),n<0){for(var a=0;a<-n;a++)o.push("0");e=o.join("")}else 0<n&&(e=0!==(e=(e=o.join("")).substring(0,e.length-n)).length?e:"0");return e},m.toBigIntegerFromNumber=function(t){var r,e;if(4294967295<(r=0===t?e=0:0<t?(e=1,t):(e=-1,-t)))return{element:m.toHexadecimalArrayFromPlainString(m.toPlainStringFromString(r.toFixed()),10),_sign:e};for(var n=[];0!==r;)n[n.length]=1&r,r>>>=1;for(var i=[],o=0;o<n.length;o++)i[o>>>4]|=n[o]<<(15&o);return{element:i,_sign:e}},m.toPlainStringFromHexadecimalArray=function(t,a){for(var r=function(t,r,e){for(var n=t.length,i=0,o=0;o<n;o++)e[o]=t[o]+(r.length>=o+1?r[o]:0)+i,e[o]>=a?(i=1,e[o]-=a):i=0;1===i&&(e[n]=1)},e=[0],n=[1],i=0;i<t.length;i++)for(var o=0;o<16;o++)t[i]>>>o&1&&r(n,e,e),r(n,n,n);return e},m.toBigIntegerFromString=function(t,r){var e=t.replace(/\s/g,"").toLowerCase(),n=e.match(/^[-+]+/),i=[],o=1;if(null!==n){var a=n[0];e=e.substring(a.length,e.length),-1!==a.indexOf("-")&&(o=-1)}return 1===(i=r?m.toHexadecimalArrayFromPlainString(e,r):/^0x/.test(e)?m.toHexadecimalArrayFromPlainString(e.substring(2,e.length),16):/^0b/.test(e)?m.toHexadecimalArrayFromPlainString(e.substring(2,e.length),2):/^0o/.test(e)?m.toHexadecimalArrayFromPlainString(e.substring(2,e.length),8):(e=m.toPlainStringFromString(e),m.toHexadecimalArrayFromPlainString(e,10))).length&&0===i[0]&&(i=[],o=0),{element:i,_sign:o}};function b(t){if(0===arguments.length)this.element=[],this._sign=0;else{if(1!==arguments.length)throw"BigInteger Unsupported argument "+t;if(this._sign=1,t instanceof b)this.element=t.element.slice(0),this._sign=t._sign;else if("number"==typeof t){var r=m.toBigIntegerFromNumber(t);this.element=r.element,this._sign=r._sign}else if("string"==typeof t){var e=m.toBigIntegerFromString(t);this.element=e.element,this._sign=e._sign}else if(t instanceof Array){if(2!==t.length||"string"!=typeof t[0]||"number"!=typeof t[1])throw"BigInteger Unsupported argument "+arguments;var n=m.toBigIntegerFromString(t[0],t[1]);this.element=n.element,this._sign=n._sign}else{if("object"!=typeof t)throw"BigInteger Unsupported argument "+t;if("toBigInteger"in t){var i=t.toBigInteger();this.element=i.element,this._sign=i._sign}else if("intValue"in t){var o=m.toBigIntegerFromNumber(t.intValue);this.element=o.element,this._sign=o._sign}else{var a=m.toBigIntegerFromString(t.toString());this.element=a.element,this._sign=a._sign}}}}var d={intValue:{configurable:!0},longValue:{configurable:!0},doubleValue:{configurable:!0}},x={MINUS_ONE:{configurable:!0},ZERO:{configurable:!0},ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0}};b.create=function(t){return t instanceof b?t:new b(t)},b.valueOf=function(t){return b.create(t)},b._toBigInteger=function(t){return t instanceof b?t:new b(t)},b._toFloat=function(t){return"number"==typeof t?t:t instanceof b?t.doubleValue:new b(t).doubleValue},b._toInteger=function(t){return"number"==typeof t?Math.trunc(t):t instanceof b?t.intValue:new b(t).intValue},b.createRandomBigInteger=function(t,r){var e=r&&r instanceof v?r:p,n=new b;n._sign=1;var i,o=b._toInteger(t),a=1+(o-1>>4);if(0===o)return b.ZERO;for(var u=0,s=0;u<a;u++)s=0===s?(i=e.nextInt(),n.element[u]=65535&i,1):(n.element[u]=i>>>16&65535,0);return o%16!=0&&(n.element[n.element.length-1]&=(1<<o%16)-1),n._memory_reduction(),n},b.prototype.toString=function(t){for(var r=t?b._toInteger(t):10,e=Math.floor(Math.log(1073741823)/Math.log(r)),n=Math.round(Math.pow(r,e)),i=[],o=0;o<e;o++)i[o]="0";var a=i.join(""),u=m.toPlainStringFromHexadecimalArray(this.element,n),s=[],l="";this.signum()<0&&(s[s.length]="-");for(var h=u.length-1;0<=h;h--)l=u[h].toString(r),h<u.length-1&&(s[s.length]=a.substring(0,e-l.length)),s[s.length]=l;return s.join("")},b.prototype.clone=function(){return new b(this)},b.prototype.getTwosComplement=function(t){var r=this.clone();if(0<=r._sign)return r;r._sign=1;for(var e=void 0!==t?t:r.bitLength(),n=r.element,i=0;i<n.length;i++)n[i]^=65535;return e%16!=0&&(n[n.length-1]&=(1<<e%16)-1),r._add(new b(1)),r},b.prototype._memory_allocation=function(t){var r=b._toInteger(t),e=this.element.length<<4;if(e<r)for(var n=1+((r-e-1&4294967280)>>>4),i=0;i<n;i++)this.element[this.element.length]=0},b.prototype._memory_reduction=function(){for(var t=this.element.length-1;0<=t;t--)if(0!==this.element[t])return void(t<this.element.length-1&&this.element.splice(t+1,this.element.length-t-1));this._sign=0,this.element=[]},b.prototype._abs=function(){return this._sign*=this._sign,this},b.prototype.abs=function(){return this.clone()._abs()},b.prototype._negate=function(){return this._sign*=-1,this},b.prototype.negate=function(){return this.clone()._negate()},b.prototype.signum=function(){return 0===this.element.length?0:this._sign},b.prototype.sign=function(){return this.signum()},b.prototype._add=function(t){var r=b._toBigInteger(t),e=this.element,n=r.element;if(this._sign===r._sign){this._memory_allocation(n.length<<4);for(var i=0,o=0;o<e.length;o++)e[o]+=(n.length>=o+1?n[o]:0)+i,65535<e[o]?(i=1,e[o]&=65535):i=0;0!==i&&(e[e.length]=i)}else{var a=this.compareToAbs(r);if(0===a)return this.element=[],this._sign=1,this;if(-1===a){this._sign=r._sign;var u=e;e=n.slice(0),n=u}for(var s=0,l=0;l<e.length;l++)e[l]-=(n.length>=l+1?n[l]:0)+s,s=e[l]<0?(e[l]+=65536,1):0;this.element=e,this._memory_reduction()}return this},b.prototype.add=function(t){return this.clone()._add(t)},b.prototype._subtract=function(t){var r=b._toBigInteger(t),e=r._sign,n=this._add(r._negate());return r._sign=e,n},b.prototype.subtract=function(t){return this.clone()._subtract(t)},b.prototype.sub=function(t){return this.subtract(t)},b.prototype._multiply=function(t){var r=this.multiply(t);return this.element=r.element,this._sign=r._sign,this},b.prototype.multiply=function(t){for(var r=b._toBigInteger(t),e=new b,n=new b,i=r,o=this.element,a=i.element,u=e.element,s=0;s<o.length;s++){n.element=[];for(var l=n.element,h=0,c=0;c<a.length;c++)l[c]=o[s]*a[c]+h,65535<l[c]?(h=l[c]>>>16,l[c]&=65535):h=0;0!==h&&(l[l.length]=h);for(var f=l.length-1;0<=f;f--)l[f+s]=l[f];for(var g=s-1;0<=g;g--)l[g]=0;h=0,e._memory_allocation(l.length<<4);for(var m=s;m<u.length;m++)u[m]+=(l.length>=m+1?l[m]:0)+h,65535<u[m]?(h=1,u[m]&=65535):h=0;0!==h&&(u[u.length]=h)}return e._sign=this._sign*r._sign,e},b.prototype.mul=function(t){return this.multiply(t)},b.prototype._divideAndRemainder=function(t){var r=b._toBigInteger(t),e=[];if(0===r.signum())throw"BigInteger divideAndRemainder ["+r.toString()+"]";var n=this.compareToAbs(r);if(n<0)return e[0]=new b(0),e[1]=this.clone(),e;if(0===n)return e[0]=new b(1),e[0]._sign=this._sign*r._sign,e[1]=new b(0),e;for(var i=new b(1),o=this.bitLength()-r.bitLength(),a=this.clone()._abs(),u=r.shift(o)._abs(),s=new b,l=0;l<=o&&(0<=a.compareToAbs(u)&&(a._subtract(u),s._add(i)),l!==o);l++)u._shift(-1),s._shift(1);return e[0]=s,e[0]._sign=this._sign*r._sign,e[1]=a,e[1]._sign=this._sign,e},b.prototype.divideAndRemainder=function(t){return this.clone()._divideAndRemainder(t)},b.prototype._divide=function(t){return this._divideAndRemainder(t)[0]},b.prototype.divide=function(t){return this.clone()._divide(t)},b.prototype.div=function(t){return this.divide(t)},b.prototype._remainder=function(t){return this._divideAndRemainder(t)[1]},b.prototype.remainder=function(t){return this.clone()._remainder(t)},b.prototype.rem=function(t){return this.remainder(t)},b.prototype._mod=function(t){var r=b._toBigInteger(t);if(r.signum()<0)return null;var e=this._divideAndRemainder(r);return e[1]instanceof b?0<=e[1].signum()?e[1]:e[1]._add(r):null},b.prototype.mod=function(t){return this.clone()._mod(t)},b.prototype.modPow=function(t,r){for(var e=b._toBigInteger(r),n=new b(this),i=new b(1),o=new b(t);0!==o.element.length;)0!=(1&o.element[0])&&(i=i.multiply(n).mod(e)),n=n.multiply(n).mod(e),o._shift(-1);return i},b.prototype.modInverse=function(t){var r=b._toBigInteger(t),e=this.extgcd(t),n=new b(1);return 0!==e[2].compareTo(n)?null:e[0]._add(r)._mod(r)},b.prototype.factorial=function(){for(var t=b._toInteger(this),r=b.ONE,e=2;e<=t;e++)r=r.multiply(e);return r},b.prototype.scaleByPowerOfTen=function(t){var r=b._toInteger(t);return 0===r?this:0<r?this.mul(b.TEN.pow(r)):this.div(b.TEN.pow(r))},b.prototype.pow=function(t){for(var r=new b(t),e=b._toBigInteger(this),n=b._toBigInteger(1);0!==r.element.length;)0!=(1&r.element[0])&&(n=n.multiply(e)),e=e.multiply(e),r._shift(-1);return n},b.prototype.square=function(){return this.mul(this)},b.prototype.sqrt=function(){if(this.sign()<=0)throw"ArithmeticException";for(var t=this.toString(10).replace(/^-/,"").length,r=b.ONE.scaleByPowerOfTen(t),e=0;e<300;e++){var n=r.add(this.div(r)).shiftRight(1);if(n.sub(r).isZero())break;r=n}return r},b.setDefaultRandom=function(t){p=t},b.getDefaultRandom=function(){return p},b.prototype.getShort=function(t){var r=b._toInteger(t);return r<0||this.element.length<=r?0:this.element[r]},d.intValue.get=function(){var t=this.getShort(0)+(this.getShort(1)<<16);return 0<(t&=4294967295)&&this._sign<0&&(t=-t),t},d.longValue.get=function(){for(var t=0,r=3;0<=r;r--)t*=65536,t+=this.getShort(r);return this._sign<0&&(t=-t),t},d.doubleValue.get=function(){return parseFloat(this.toString())},b.prototype.gcd=function(t){for(var r,e=this,n=b._toBigInteger(t);0!==n.signum();)r=e.remainder(n),e=n,n=r;return e},b.prototype.extgcd=function(t){for(var r,e,n,i,o=b._toBigInteger(t),a=new b(1),u=new b(0),s=this,l=o,h=a,c=u,f=u,g=a;0!==l.signum();){var m=s.divideAndRemainder(l);e=m[0],r=m[1],n=h.subtract(e.multiply(c)),i=f.subtract(e.multiply(g)),h=c,c=n,f=g,g=i,s=l,l=r}return[h,f,s]},b.prototype.lcm=function(t){var r=b._toBigInteger(t);return this.mul(r).div(this.gcd(r))},b.prototype.equals=function(t){var r=b._toBigInteger(t);if(this.signum()!==r.signum())return!1;if(this.element.length!==r.element.length)return!1;for(var e=0;e<r.element.length;e++)if(this.element[e]!==r.element[e])return!1;return!0},b.prototype.compareToAbs=function(t){var r=b._toBigInteger(t);if(this.element.length<r.element.length)return-1;if(this.element.length>r.element.length)return 1;for(var e=this.element.length-1;0<=e;e--)if(this.element[e]!==r.element[e]){var n=this.element[e]-r.element[e];return 0==n?0:0<n?1:-1}return 0},b.prototype.compareTo=function(t){var r=b._toBigInteger(t);return this.signum()!==r.signum()?this._sign>r._sign?1:-1:0===this.signum()?0:this.compareToAbs(r)*this._sign},b.prototype.max=function(t){var r=b._toBigInteger(t);return 0<=this.compareTo(r)?this.clone():r.clone()},b.prototype.min=function(t){var r=b._toBigInteger(t);return 0<=this.compareTo(r)?r.clone():this.clone()},b.prototype.clip=function(t,r){var e=b._toBigInteger(t),n=b._toBigInteger(r),i=e.compareTo(n);if(1===i)throw"clip(min, max) error. (min > max)->("+e+" > "+n+")";return 0===i?e:1===this.compareTo(n)?n:-1===this.compareTo(e)?e:this},b.probablePrime=function(t,r,e,n){for(var i=e?b._toInteger(e):100,o=n?b._toInteger(n):500,a=0;a<o;a++){var u=b.createRandomBigInteger(t,r);if(u.isProbablePrime(i))return u}throw"probablePrime "+n},b.prototype.isProbablePrime=function(t){var r=this.element;if(0===r.length||1===r.length&&r[0]<=2)return!0;if(0==(1&r[0]))return!1;var e=void 0!==t?b._toInteger(t):100,n=new b(0),i=new b(1),o=this,a=o.bitLength(),u=o.subtract(i),s=u.getLowestSetBit(),l=u.shift(-s);if(e<=0)return!1;for(var h=0;h<e;h++){for(var c=void 0;0===(c=b.createRandomBigInteger(a)).compareTo(n)||-1!==c.compareTo(o););for(var f=l,g=c.modPow(f,o);!(f.equals(u)||g.equals(i)||g.equals(u));)g=g.mul(g)._mod(o),f=f.shiftLeft(1);if(!g.equals(u)&&0==(1&f.element[0]))return!1}return!0},b.prototype.nextProbablePrime=function(t,r){for(var e=void 0!==t?b._toInteger(t)>>1:50,n=void 0!==r?b._toInteger(r):1e5,i=this.clone(),o=0;o<n;o++)if(i._add(b.ONE),i.isProbablePrime(e))return i;throw"nextProbablePrime ["+n+"]"},b.prototype._shift=function(t){var r=b._toInteger(t);if(0===r)return this;var e=this.element;if(1===r){var n=e.length-1;for(0!=(32768&e[n])&&(e[e.length]=1);0<=n;n--)e[n]<<=1,e[n]&=65535,0<n&&0!=(32768&e[n-1])&&(e[n]+=1)}else if(-1===r){for(var i=0;i<e.length;i++)e[i]>>>=1,i<e.length-1&&0!=(1&e[i+1])&&(e[i]|=32768);0===e[e.length-1]&&e.pop()}else{if(16<=r){for(var o=r>>>4,a=e.length-1;0<=a;a--)e[a+o]=e[a];for(var u=o-1;0<=u;u--)e[u]=0;r&=15}else if(r<=-16){var s=-r>>>4;e.splice(0,s),r+=s<<4}if(0!==r)if(0<r){for(var l=0,h=0;h<e.length;h++)e[h]=(e[h]<<r)+l,65535<e[h]?(l=e[h]>>>16,e[h]&=65535):l=0;0!==l&&(e[e.length]=l)}else{r=-r;for(var c=0;c<e.length;c++)c!==e.length-1?(e[c]+=e[c+1]<<16,e[c]>>>=r,e[c]&=65535):e[c]>>>=r;0===e[e.length-1]&&e.pop()}}return this},b.prototype.shift=function(t){return this.clone()._shift(t)},b.prototype.shiftLeft=function(t){return this.shift(t)},b.prototype.shiftRight=function(t){return this.shift(-t)},b.prototype.getLowestSetBit=function(){for(var t=0;t<this.element.length;t++)if(0!==this.element[t])for(var r=this.element[t],e=0;e<16;e++)if(0!=(r>>>e&1))return 16*t+e;return-1},b.prototype.bitLength=function(){for(var t=this.element.length-1;0<=t;t--)if(0!==this.element[t])for(var r=this.element[t],e=15;0<=e;e--)if(0!=(r>>>e&1))return 16*t+e+1;return 0},b.prototype.bitCount=function(){for(var t,r=(t=0<=this._sign?this:this.add(new b(1))).bitLength(),e=0,n=0,i=0;e<r;i++)for(var o=t.element[i],a=0;a<16&&e<r;a++,e++)0!=(o>>>a&1)&&(n+=1);return n},b.prototype._and=function(t){var r=b._toBigInteger(t),e=this.signum(),n=r.signum(),i=Math.max(this.bitLength(),r.bitLength()),o=this.getTwosComplement(i).element,a=r.getTwosComplement(i).element,u=Math.max(o.length,a.length);this.element=[];for(var s=0;s<u;s++){var l=s>=o.length?0:o[s],h=s>=a.length?0:a[s];this.element[s]=l&h}return this._memory_reduction(),1===e||1===n?this._sign=1:-1===this._sign&&(this.element=this.getTwosComplement(i).element,this._memory_reduction()),this},b.prototype.and=function(t){return this.clone()._and(t)},b.prototype._or=function(t){var r=b._toBigInteger(t),e=this.signum(),n=r.signum(),i=Math.max(this.bitLength(),r.bitLength()),o=this.getTwosComplement(i).element,a=r.getTwosComplement(i).element,u=Math.max(o.length,a.length);this.element=[];for(var s=0;s<u;s++){var l=s>=o.length?0:o[s],h=s>=a.length?0:a[s];this.element[s]=l|h}return this._sign=-1===e||-1===n?-1:Math.max(e,n),-1===this._sign&&(this.element=this.getTwosComplement(i).element,this._memory_reduction()),this},b.prototype.or=function(t){return this.clone()._or(t)},b.prototype._xor=function(t){var r=b._toBigInteger(t),e=this.signum(),n=r.signum(),i=Math.max(this.bitLength(),r.bitLength()),o=this.getTwosComplement(i).element,a=r.getTwosComplement(i).element,u=Math.max(o.length,a.length);this.element=[];for(var s=0;s<u;s++){var l=s>=o.length?0:o[s],h=s>=a.length?0:a[s];this.element[s]=l^h}return this._memory_reduction(),this._sign=0!==e&&e!==n?-1:1,-1===this._sign&&(this.element=this.getTwosComplement(i).element,this._memory_reduction()),this},b.prototype.xor=function(t){return this.clone()._xor(t)},b.prototype._not=function(){return this._add(new b(1))._negate()},b.prototype.not=function(){return this.clone()._not()},b.prototype._andNot=function(t){var r=b._toBigInteger(t);return this._and(r.not())},b.prototype.andNot=function(t){return this.clone()._andNot(t)},b.prototype._nand=function(t){return this._andNot(t)},b.prototype.nand=function(t){return this.andNot(t)},b.prototype._orNot=function(t){var r=b._toBigInteger(t);return this._or(r)._not()},b.prototype.orNot=function(t){return this.clone()._orNot(t)},b.prototype._nor=function(t){return this._orNot(t)},b.prototype.nor=function(t){return this.orNot(t)},b.prototype._setBit=function(t){var r=b._toInteger(t);return this._memory_allocation(r+1),this.element[r>>>4]|=1<<(15&r),this},b.prototype.setBit=function(t){var r=b._toInteger(t);return this.clone()._setBit(r)},b.prototype._flipBit=function(t){var r=b._toInteger(t);return this._memory_allocation(r+1),this.element[r>>>4]^=1<<(15&r),this._memory_reduction(),this},b.prototype.flipBit=function(t){var r=b._toInteger(t);return this.clone()._flipBit(r)},b.prototype.clearBit=function(t){var r=b._toInteger(t),e=this.clone();return e.element[r>>>4]&=~(1<<(15&r)),e._memory_reduction(),e},b.prototype.testBit=function(t){var r=b._toInteger(t);return 0!=(this.element[r>>>4]>>>(15&r)&1)},b.prototype.isZero=function(){return this._memory_reduction(),0===this._sign},b.prototype.isOne=function(){return 1===this._sign&&1===this.element.length&&1===this.element[0]},b.prototype.isPositive=function(){return this._memory_reduction(),0<this._sign},b.prototype.isNegative=function(){return this._sign<0},b.prototype.isNotNegative=function(){return 0<=this._sign},x.MINUS_ONE.get=function(){return N.MINUS_ONE},x.ZERO.get=function(){return N.ZERO},x.ONE.get=function(){return N.ONE},x.TWO.get=function(){return N.TWO},x.TEN.get=function(){return N.TEN},Object.defineProperties(b.prototype,d),Object.defineProperties(b,x);function M(){}var N={MINUS_ONE:new b(-1),ZERO:new b(0),ONE:new b(1),TWO:new b(2),TEN:new b(10)},I=y.DECIMAL128;M.ToBigDecimalFromString=function(t){var r,e=0,n=t.replace(/\s/g,"").toLowerCase(),i="";return null!==(r=n.match(/^[+-]+/))&&(r=r[0],n=n.substr(r.length),-1!==r.indexOf("-")&&(i+="-")),null!==(r=n.match(/^[0-9]+/))&&(r=r[0],n=n.substr(r.length),i+=r),null!==(r=n.match(/^\.[0-9]+/))&&(r=r[0],n=n.substr(r.length),e+=(r=r.substr(1)).length,i+=r),null!==(r=n.match(/^e[+-]?[0-9]+/))&&(r=r[0].substr(1),e-=parseInt(r,10)),{scale:e,integer:new b([i,10])}},M.ToBigDecimalFromNumber=function(t){if(t===Math.floor(t))return{scale:0,integer:new b(Math.round(t))};var r=Math.trunc(Math.log(Math.abs(t))/Math.log(10)),e=t/Math.pow(10,r);r=-r;for(var n=0;n<14&&(e*=10,r+=1,!(Math.abs(e-Math.round(e))<=Number.EPSILON));n++);return e=Math.round(1e14*e)/1e14,{scale:r,integer:new b(e)}};function E(t){this._scale=0,this.default_context=I;var r=!1;if(1<arguments.length)throw"BigDecimal Unsupported argument["+arguments.length+"]";if(t instanceof E)this.integer=t.integer.clone(),this._scale=t._scale,this.int_string=t.int_string,this.default_context=t.default_context;else if("number"==typeof t){var e=M.ToBigDecimalFromNumber(t);this.integer=e.integer,this._scale=e.scale}else if("string"==typeof t){var n=M.ToBigDecimalFromString(t);this.integer=n.integer,this._scale=n.scale}else if(t instanceof Array){if(1<=t.length){var i=t[0];if("number"==typeof i){var o=M.ToBigDecimalFromNumber(i);this.integer=o.integer,this._scale=o.scale}else if("string"==typeof i){var a=M.ToBigDecimalFromString(i);this.integer=a.integer,this._scale=a.scale}else if(i instanceof E)this.integer=i.integer.clone(),this._scale=i._scale;else if(i instanceof b)this.integer=i.clone();else{if("object"!=typeof i)throw"BigDecimal Unsupported argument "+i+"("+typeof i+")";if("toBigDecimal"in i){var u=i.toBigDecimal();this.integer=u.integer,this._scale=u._scale}else if("doubleValue"in i){var s=M.ToBigDecimalFromNumber(i.doubleValue);this.integer=s.integer,this._scale=s.scale}else{var l=M.ToBigDecimalFromString(i.toString());this.integer=l.integer,this._scale=l.scale}}}2<=t.length&&("number"==typeof t[1]?(this._scale=t[1],3<=t.length&&(this.default_context=void 0!==t[2]&&t[2]instanceof y?t[2]:I,r=!0)):2<=t.length&&(this.default_context=void 0!==t[1]&&t[1]instanceof y?t[1]:I,r=!0))}else if(t instanceof b)this.integer=t.clone();else{if("object"!=typeof t)throw"BigDecimal Unsupported argument "+arguments;if("toBigDecimal"in t){var h=t.toBigDecimal();this.integer=h.integer,this._scale=h._scale,this.default_context=h.default_context}else if("doubleValue"in t){var c=M.ToBigDecimalFromNumber(t.doubleValue);this.integer=c.integer,this._scale=c.scale}else if("integer"in t&&"scale"in t&&"context"in t)this.integer=new b(t.integer),t.scale&&(this._scale=t.scale),t.context&&(this.default_context=t.context,r=!0);else if(t instanceof Object){var f=M.ToBigDecimalFromString(t.toString());this.integer=f.integer,this._scale=f.scale}}if(r){var g=this.round(this.default_context);this.integer=g.integer,this._scale=g._scale,delete this.int_string}if(!(this.integer instanceof b&&this.default_context instanceof y))throw"BigDecimal Unsupported argument "+arguments}var O={intValue:{configurable:!0},intValueExact:{configurable:!0},floatValue:{configurable:!0},doubleValue:{configurable:!0}},D={MINUS_ONE:{configurable:!0},ZERO:{configurable:!0},HALF:{configurable:!0},ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},PI:{configurable:!0},QUARTER_PI:{configurable:!0},HALF_PI:{configurable:!0},TWO_PI:{configurable:!0},E:{configurable:!0},LN2:{configurable:!0},LN10:{configurable:!0},LOG2E:{configurable:!0},LOG10E:{configurable:!0},SQRT2:{configurable:!0},SQRT1_2:{configurable:!0}};E.create=function(t){return t instanceof E?t:new E(t)},E.prototype.createUsingThisSettings=function(t,r){return new E(r?[t,r]:[t,this.default_context])},E.valueOf=function(t,r){return new E(1===arguments.length?t:[t,r])},E._toBigDecimal=function(t){return t instanceof E?t:new E(t)},E._toBigInteger=function(t){return t instanceof b?t:t instanceof E?t.toBigInteger():new b(t)},E._toFloat=function(t){return"number"==typeof t?t:t instanceof E?t.doubleValue:new E(t).doubleValue},E._toInteger=function(t){return"number"==typeof t?Math.trunc(t):t instanceof b?t.intValue:new b(t).intValue},E.prototype._getUnsignedIntegerString=function(){return void 0===this.int_string&&(this.int_string=this.integer.toString(10).replace(/^-/,"")),this.int_string},E.prototype.clone=function(){return new E(this)},E.prototype.scale=function(){return this._scale},E.prototype.signum=function(){return this.integer.signum()},E.prototype.sign=function(){return this.signum()},E.prototype.precision=function(){return this._getUnsignedIntegerString().length},E.prototype.unscaledValue=function(){return new b(this.integer)},E.prototype.ulp=function(){return new E([b.ONE,this.scale()])},E.prototype.abs=function(t){var r=this.clone();return r.integer=r.integer.abs(),void 0===t?r:r.round(t)},E.prototype.plus=function(t){var r=this.clone();return void 0===t?r:r.round(t)},E.prototype.negate=function(t){var r=this.clone();return r.integer=r.integer.negate(),void 0===t?r:r.round(t)},E.prototype.movePointLeft=function(t){var r=E._toInteger(t),e=this.scaleByPowerOfTen(-r);return e=e.setScale(Math.max(this.scale()+r,0))},E.prototype.movePointRight=function(t){var r=E._toInteger(t),e=this.scaleByPowerOfTen(r);return e=e.setScale(Math.max(this.scale()-r,0))},E.prototype.stripTrailingZeros=function(){var t=0<=this.signum()?"":"-",r=this.integer.toString(10).replace(/^-/,""),e=r.match(/0+$/),n=null!==e?e[0].length:0;n===r.length&&(n=r.length-1);var i=this.scale()-n;return new E([new b(t+r.substring(0,r.length-n)),i])},E.prototype.add=function(t,r){var e=E._toBigDecimal(t),n=r||e.default_context,i=this,o=e,a=Math.max(i._scale,o._scale);if(i._scale===o._scale)return new E([i.integer.add(o.integer),a,n]);if(i._scale>o._scale){var u=o.setScale(i._scale);return new E([i.integer.add(u.integer),a,n])}var s=i.setScale(o._scale);return new E([s.integer.add(o.integer),a,n])},E.prototype.subtract=function(t,r){var e=E._toBigDecimal(t),n=r||e.default_context,i=this,o=e,a=Math.max(i._scale,o._scale);if(i._scale===o._scale)return new E([i.integer.subtract(o.integer),a,n]);if(i._scale>o._scale){var u=o.setScale(i._scale);return new E([i.integer.subtract(u.integer),a,n])}var s=i.setScale(o._scale);return new E([s.integer.subtract(o.integer),a,n])},E.prototype.sub=function(t,r){return this.subtract(t,r)},E.prototype.multiply=function(t,r){var e=E._toBigDecimal(t),n=r||e.default_context,i=e,o=this.integer.multiply(i.integer),a=this._scale+i._scale;return new E([o,a,n])},E.prototype.mul=function(t,r){return this.multiply(t,r)},E.prototype.divideToIntegralValue=function(t,r){function e(t){var r,e="1";for(r=0;r<t;r++)e+="0";return new b(e)}var n=E._toBigDecimal(t),i=r||n.default_context;if(0===n.compareTo(E.ZERO))throw"ArithmeticException";var o=n,a=this.integer,u=o.integer,s=this._scale-o._scale;this._scale>o._scale?u=u.multiply(e(s)):this._scale<o._scale&&(a=a.multiply(e(-s)));var l=a.divide(u),h=l.signum();if(0!==h){var c=l.toString(10).replace(/^-/,"");if(0!==i.getPrecision()&&c.length>i.getPrecision())throw"ArithmeticException";if(c.length<=-s){var f=c.match(/0+$/),g=null!==f?f[0].length:0;return new E([new b((0<=h?"":"-")+c.substring(0,c.length-g)),-g,i])}}var m=new E(l);return(m=(m=m.setScale(s,w.UP)).round(i)).default_context=i,m},E.prototype.divideAndRemainder=function(t,r){var e=E._toBigDecimal(t),n=r||e.default_context,i=this.divideToIntegralValue(e,n),o=this.subtract(i.multiply(e,n),n);return[i,o]},E.prototype.rem=function(t,r){return this.divideAndRemainder(t,r)[1]},E.prototype.mod=function(t,r){var e=this.rem(t,r);return e.compareTo(E.ZERO)<0?e.add(t,r):e},E.prototype.divide=function(t,r){var e=E._toBigDecimal(t),n=null,i=null,o=0,a=!1;if(r?r instanceof y?(n=(i=r).getRoundingMode(),o=i.getPrecision()):(o=r&&r.scale?r.scale:(a=!0,r&&(r.roundingMode||r.context)?this.scale():this.scale()-e.scale()),r&&r.context?(n=(i=r.context).getRoundingMode(),o=i.getPrecision()):i=this.default_context,n=r&&r.roundingMode?r.roundingMode:i.getRoundingMode()):(n=(i=e.default_context).getRoundingMode(),o=i.getPrecision()),0===e.compareTo(E.ZERO))throw"ArithmeticException";var u,s=i.getPrecision();if(0===s||s<=100){var l,h,c,f,g={};u=E.ZERO;var m=0!==s?s+8:262143;l=this;for(var _=0;_<m&&(c=(h=l.divideAndRemainder(e,y.UNLIMITED))[0],f=h[1],u=u.add(c.scaleByPowerOfTen(-_),y.UNLIMITED),0!==f.compareTo(E.ZERO));_++){if(0===s){if(g[f._getUnsignedIntegerString()])throw"ArithmeticException "+u+"["+f._getUnsignedIntegerString()+"]";g[f._getUnsignedIntegerString()]=!0}l=f.scaleByPowerOfTen(1)}}else{var p=new y(s+4,w.HALF_UP);u=this.mul(e.inv(p),p)}if(u.default_context=i,a)try{u=u.setScale(o,n)}catch(t){}else u=u.setScale(o,n);return u=u.round(i)},E.prototype.div=function(t,r){return this.divide(t,r)},E.prototype.inv=function(t){var r=t||this.default_context,e=E.getDefaultContext(),n=this.isNegative(),i=n?this.negate():this;E.setDefaultContext(r);var o=E.create(1),a=-i.scale()+(i.precision()-1),u=new E([1,1+a]);if(u.isZero())return E.setDefaultContext(e),null;i=i.round(r);for(var s=u,l=0;l<20;l++){var h=o.sub(i.mul(s));if(h.isZero())break;s=s.mul(o.add(h).add(h.square()))}return E.setDefaultContext(e),n?s.negate():s},E.prototype.factorial=function(t){var r=t||this.default_context;return new E(new b(this).factorial()).round(r)},E.prototype.scaleByPowerOfTen=function(t){var r=E._toInteger(t),e=this.clone();return e._scale=this.scale()-r,e},E.setDefaultContext=function(t){I=t||y.DECIMAL128},E.getDefaultContext=function(){return I},O.intValue.get=function(){return 4294967295&this.toBigInteger().intValue},O.intValueExact.get=function(){var t=this.toBigInteger().intValue;if(t<-2147483648||2147483647<t)throw"ArithmeticException";return t},O.floatValue.get=function(){var t=this.precision();return y.DECIMAL32.getPrecision()<t?0<=this.signum()?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:parseFloat(this.toEngineeringString())},O.doubleValue.get=function(){return parseFloat(this.toEngineeringString())},E.prototype.toBigInteger=function(){return this.integer.scaleByPowerOfTen(-this.scale())},E.prototype.equals=function(t,r){if(r)return 0===this.compareTo(t,r);if(t instanceof E)return this._scale===t._scale&&this.integer.equals(t.integer);if("string"==typeof t||t instanceof String){var e=E._toBigDecimal(t);return this._scale===e._scale&&this.integer.equals(e.integer)}return 0===this.compareTo(t)},E.prototype.compareTo=function(t,r){var e=this,n=E._toBigDecimal(t);if(r){var i=E._toBigDecimal(r),o=e.sub(n,y.UNLIMITED);return o.abs().compareTo(i)<=0?0:o.sign()}var a=e.signum(),u=n.signum();if(0===a&&a===u)return 0;if(0===a)return-u;if(0===u)return a;if(e._scale===n._scale)return e.integer.compareTo(n.integer);if(e._scale>n._scale){var s=n.setScale(e._scale);return e.integer.compareTo(s.integer)}return e.setScale(n._scale).integer.compareTo(n.integer)},E.prototype.max=function(t){var r=E._toBigDecimal(t);return 0<=this.compareTo(r)?this.clone():r.clone()},E.prototype.min=function(t){var r=E._toBigDecimal(t);return this.compareTo(r)<=0?this.clone():r.clone()},E.prototype.clip=function(t,r){var e=E._toBigDecimal(t),n=E._toBigDecimal(r),i=e.compareTo(n);if(1===i)throw"clip(min, max) error. (min > max)->("+e+" > "+n+")";return 0===i?e:1===this.compareTo(n)?n:-1===this.compareTo(e)?e:this},E.prototype.toString=function(){var t=-this.scale()+(this.precision()-1);return 0<=this.scale()&&-6<=t?this.toPlainString():this.toScientificNotation(t)},E.prototype.toScientificNotation=function(t){var r,e,n=E._toInteger(t),i=this._getUnsignedIntegerString(),o=this.scale(),a=[];if(-1===this.signum()&&(a[a.length]="-"),0<=(o=-n-o))for(a[a.length]=i,r=0;r<o;r++)a[a.length]="0";else if(0<(e=this.precision()+o))a[a.length]=i.substring(0,e),a[a.length]=".",a[a.length]=i.substring(e,i.length);else{for(e=-e,a[a.length]="0.",r=0;r<e;r++)a[a.length]="0";a[a.length]=i}return a[a.length]="E",0<=n&&(a[a.length]="+"),a[a.length]=n,a.join("")},E.prototype.toEngineeringString=function(){var t=-this.scale()+(this.precision()-1);return 0<=this.scale()&&-6<=t?this.toPlainString():this.toScientificNotation(3*Math.floor(t/3))},E.prototype.toPlainString=function(){return 0===this.scale()?this.signum()<0?"-"+this._getUnsignedIntegerString():this._getUnsignedIntegerString():this.toScientificNotation(0).match(/^[^E]*/)[0]},E.prototype.setScale=function(t,r){var e=E._toInteger(t);if(this.scale()===e)return this.clone();var n=void 0!==r?w.valueOf(r):w.UNNECESSARY,i=this._getUnsignedIntegerString(),o=this.signum(),a=0<=o?"":"-",u=e-this.scale();if(0<=u){var s;for(s=0;s<u;s++)i+="0";return new E([new b(a+i),e])}var l=i.length+u,h=l+1;if(l<=0){var c=(o+n.getAddNumber(o))/10;return new E([new b(c),e])}var f=i.match(/0+$/);if(0<=(null!==f?f[0].length:0)+u||n===w.DOWN)return new E([new b(a+i.substring(0,l)),e]);var g=1<(i=i.substring(0,h)).length?2:1,m=parseInt(i.substring(i.length-g,i.length))*o,_=new b(a+i),p=new b(n.getAddNumber(m));return i=_.add(p).toString(),new E([new b(i.substring(0,i.length-1)),e])},E.prototype.round=function(t){if(t){if(!(t instanceof y))throw"not MathContext";var r=t.getPrecision(),e=r-this.precision();if(0==e||0===r)return this.clone();var n=this.setScale(this.scale()+e,t.getRoundingMode());if(0<e)return n;if(n.precision()===t.getPrecision())return n;var i=0<=n.integer.signum()?"":"-",o=n._getUnsignedIntegerString(),a=i+o.substring(0,o.length-1);return new E([new b(a),n.scale()-1])}return this.setScale(0,w.HALF_UP)},E.prototype.floor=function(){return this.setScale(0,w.FLOOR)},E.prototype.ceil=function(){return this.setScale(0,w.CEILING)},E.prototype.fix=function(){return this.setScale(0,w.DOWN)},E.prototype.fract=function(){return this.sub(this.floor())},E.prototype.pow=function(t,r){var e=E._toBigDecimal(t),n=e.intValue,i=r||this.default_context;if(1e3<Math.abs(n))throw"ArithmeticException";if(this.isZero())return r?E.ONE.round(r):E.ONE;if(this.isOne())return r?this.round(r):this;if(0===i.getPrecision()&&e.isNegative())throw"ArithmeticException";if(e.isInteger()){var o,a,u=e.isNegative(),s=Math.round(Math.abs(n));for(o=this.clone(),a=E.ONE;0!==s;)0!=(1&s)&&(a=a.multiply(o,y.UNLIMITED)),o=o.multiply(o.clone(),y.UNLIMITED),s>>>=1;return a=u?a.inv(i):a.round(i)}return this.log(i).mul(t,i).exp(i)},E.prototype.square=function(t){return this.mul(this,t)},E.prototype.sqrt=function(t){return this.rsqrt(t).inv(t)},E.prototype.rsqrt=function(t){var r=t||this.default_context,e=E.getDefaultContext(),n=this.round(r);E.setDefaultContext(r);var i=E.create(1),o=E.create(5),a=E.create(6),u=E.create(8),s=E.create(16).inv(),l=n.inv();if(l.isZero())return E.setDefaultContext(e),null;for(var h=l,c=0;c<50;c++){var f=i.sub(n.mul(h.square())).round(r);if(f.isZero())break;h=h.mul(i.add(f.mul(u.add(f.mul(a.add(o.mul(f))))).mul(s)))}return E.setDefaultContext(e),h},E.prototype.log=function(t){if(this.isZero()||this.isNegative())throw"ArithmeticException";var r=t||this.default_context;if(this.isOne())return new E([0,r]);var e=E.getDefaultContext(),n=-this.scale()+(this.precision()-1)+1,i=new y(r.getPrecision()+n,w.HALF_UP);E.setDefaultContext(i);var o=this.round(i),a=0,u=E.E,s=o.compareTo(u);if(0===s)return E.setDefaultContext(r),new E([1,r]);if(0<s)for(;a<300&&!(o.compareTo(u)<=0);a++)o=o.divide(u,r);else{var l=new E(1);if(o.compareTo(l)<0)for(;-300<a&&!(0<o.compareTo(l));a--)o=o.mul(u,r)}E.setDefaultContext(r);for(var h=(o=o.round(r)).sub(E.ONE).div(o.add(E.ONE)),c=h.mul(h),f=h,g=h,m=E.ONE,_=0;_<300;_++){m=m.add(E.TWO),f=f.mul(c);var p=g.add(f.div(m)),v=p.sub(g);if(g=p,v.isZero())break}var d=(o=g.mul(E.TWO)).add(a);return E.setDefaultContext(e),d},E.prototype.exp=function(t){if(this.isZero())return new E([1,t]);var r=this.isNegative(),e=t||this.default_context,n=E.getDefaultContext(),i=this;r&&(i=i.negate());var o=-i.scale()+(i.precision()-1)+1,a=new y(e.getPrecision()+o,w.HALF_UP);E.setDefaultContext(a);var u=0,s=1,l=i.doubleValue;10<=l&&(u=Math.floor(Math.log(Math.floor(l))/Math.log(10)),s=Math.pow(10,u));for(var h,c=i.div(s,e),f=c,g=E.ONE.add(c),m=E.ONE,_=2;_<300;_++){m=m.mul(_),f=f.mul(c);var p=g.add(f.div(m)),v=p.sub(g);if(g=p,v.isZero())break}return h=(h=g).pow(s),E.setDefaultContext(n),r?h.round(e).inv():h.round(e)},E.prototype.sin=function(t){var r=t||this.default_context,e=E.getDefaultContext(),n=-this.scale()+(this.precision()-1)+1,i=new y(r.getPrecision()+n,w.HALF_UP);E.setDefaultContext(i);var o=this.mod(E.TWO_PI,r);E.setDefaultContext(r);for(var a=o=o.round(r),u=o.mul(o),s=o,l=E.ONE,h=-1,c=2;c<300;c++)if(l=l.mul(c),c%2==1){s=s.mul(u);var f=void 0;h=h<0?(f=a.sub(s.div(l)),1):(f=a.add(s.div(l)),-1);var g=f.sub(a);if(a=f,g.isZero())break}return E.setDefaultContext(e),a},E.prototype.cos=function(t){var r=t||this.default_context,e=E.getDefaultContext(),n=-this.scale()+(this.precision()-1)+1,i=new y(r.getPrecision()+n,w.HALF_UP);E.setDefaultContext(i);var o=this.mod(E.TWO_PI,r);E.setDefaultContext(r),o=o.round(r);for(var a=E.ONE,u=E.ONE,s=o.mul(o),l=E.ONE,h=-1,c=2;c<300;c++)if(l=l.mul(c),c%2==0){u=u.mul(s);var f=void 0;h=h<0?(f=a.sub(u.div(l)),1):(f=a.add(u.div(l)),-1);var g=f.sub(a);if(a=f,g.isZero())break}return E.setDefaultContext(e),a},E.prototype.tan=function(t){var r=t||this.default_context;return this.sin(r).div(this.cos(r))},E.prototype.atan=function(t){var r=t||this.default_context,e=E.getDefaultContext();if(E.setDefaultContext(r),this.isZero()){var n=E.ZERO;return E.setDefaultContext(e),n}if(0===this.compareTo(E.ONE)){var i=E.QUARTER_PI;return E.setDefaultContext(e),i}if(0===this.compareTo(E.MINUS_ONE)){var o=E.QUARTER_PI.negate();return E.setDefaultContext(e),o}var a,u=this.sign(),s=this.abs(r);1===s.compareTo(E.TWO)?(a=1,s=s.inv()):1===s.compareTo(E.HALF)?(a=2,s=E.ONE.sub(s).div(E.ONE.add(s))):a=3;for(var l=s,h=s.mul(s),c=s,f=E.ONE,g=-1,m=0;m<300;m++){c=c.mul(h),f=f.add(E.TWO);var _=void 0;g=g<0?(_=l.sub(c.div(f)),1):(_=l.add(c.div(f)),-1);var p=_.sub(l);if(l=_,p.isZero())break}return 1===a?l=E.HALF_PI.sub(l):2===a&&(l=E.QUARTER_PI.sub(l)),u<0&&(l=l.negate()),E.setDefaultContext(e),l},E.prototype.atan2=function(t,r){var e,n=E.getDefaultContext(),i=this.round(r),o=new E([t,r]);if(o.isPositive())e=i.div(o).atan();else if(i.isNotNegative()&&o.isNegative())e=i.div(o).atan().add(E.PI);else if(i.isNegative()&&o.isNegative())e=i.div(o).atan().sub(E.PI);else if(i.isPositive())e=E.HALF_PI;else{if(!i.isNegative())throw"ArithmeticException";e=E.HALF_PI.negate()}return E.setDefaultContext(n),e},E.prototype.isInteger=function(t){return this.sub(this.fix()).isZero(t)},E.prototype.isZero=function(t){return t?this.equals(E.ZERO,t):this.integer.isZero()},E.prototype.isOne=function(t){return 0===this.compareTo(E.ONE,t)},E.prototype.isPositive=function(){return this.integer.isPositive()},E.prototype.isNegative=function(){return this.integer.isNegative()},E.prototype.isNotNegative=function(){return this.integer.isNotNegative()},D.MINUS_ONE.get=function(){return C.MINUS_ONE.get()},D.ZERO.get=function(){return C.ZERO.get()},D.HALF.get=function(){return C.HALF.get()},D.ONE.get=function(){return C.ONE.get()},D.TWO.get=function(){return C.TWO.get()},D.TEN.get=function(){return C.TEN.get()},D.PI.get=function(){return C.PI.get()},D.QUARTER_PI.get=function(){return C.QUARTER_PI.get()},D.HALF_PI.get=function(){return C.HALF_PI.get()},D.TWO_PI.get=function(){return C.TWO_PI.get()},D.E.get=function(){return C.E.get()},D.LN2.get=function(){return C.LN2.get()},D.LN10.get=function(){return C.LN10.get()},D.LOG2E.get=function(){return C.LOG2E.get()},D.LOG10E.get=function(){return C.LOG10E.get()},D.SQRT2.get=function(){return C.SQRT2.get()},D.SQRT1_2.get=function(){return C.SQRT1_2.get()},Object.defineProperties(E.prototype,O),Object.defineProperties(E,D),E.RoundingMode=w,E.MathContext=y;function A(t,r){this.method_name=t,this.table=[],this.table_max=r}var T={MINUS_ONE:function(){return new E(-1)},ZERO:function(){return new E(0)},HALF:function(){return new E(.5)},ONE:function(){return new E(1)},TWO:function(){return new E(2)},TEN:function(){return new E(10)},PI:function(){for(var t=E.create(1),r=E.create(2),e=E.create(4),n=t,i=r.sqrt().inv(),o=e.inv(),a=t,u=t,s=0;s<300;s++){var l=n.add(i).div(r),h=n.mul(i).sqrt(),c=o.sub(a.mul(n.sub(l).square())),f=a.mul(r),g=l.add(h).square().div(c.mul(e)),m=g.sub(u);if(u=g,m.isZero())break;n=l,i=h,o=c,a=f}return u},QUARTER_PI:function(){return T.PI().div(4)},HALF_PI:function(){return T.PI().div(2)},TWO_PI:function(){return T.PI().mul(2)},E:function(){for(var t=E.create(2),r=E.create(1),e=2;e<300;e++){r=r.mul(e);var n=t.add(r.inv()),i=n.sub(t);if(t=n,i.isZero())break}return t},LN2:function(){return new E(2).log()},LN10:function(){return new E(10).log()},LOG2E:function(){return new E(2).log().inv()},LOG10E:function(){return new E(10).log().inv()},SQRT2:function(){return new E(2).sqrt()},SQRT1_2:function(){return new E(.5).sqrt()}};A.prototype.get=function(){for(var t=E.getDefaultContext().toString(),r=0;r<this.table.length;r++)if(this.table[r].name===t){var e=this.table.splice(r,1)[0];return this.table.unshift(e),e.number}var n=T[this.method_name]();return this.table.length===this.table_max&&this.table.pop(),this.table.unshift({name:t,number:n}),n};function S(){}var C=new function(){this.MINUS_ONE=new A("MINUS_ONE",10),this.ZERO=new A("ZERO",10),this.HALF=new A("HALF",10),this.ONE=new A("ONE",10),this.TWO=new A("TWO",10),this.TEN=new A("TEN",10),this.PI=new A("PI",10),this.QUARTER_PI=new A("QUARTER_PI",10),this.HALF_PI=new A("HALF_PI",10),this.TWO_PI=new A("TWO_PI",10),this.E=new A("E",10),this.LN2=new A("LN2",10),this.LN10=new A("LN10",10),this.LOG2E=new A("LOG2E",10),this.LOG10E=new A("LOG10E",10),this.SQRT2=new A("SQRT2",10),this.SQRT1_2=new A("SQRT1_2",10)};S.to_fraction_data_from_number_string=function(t){var r,e=0,n=!1,i=t.replace(/\s/g,"").toLowerCase(),o=[];if(null!==(r=i.match(/^[+-]+/))&&(r=r[0],i=i.substr(r.length),-1!==r.indexOf("-")&&(n=!0,o.push("-"))),null!==(r=i.match(/^[0-9]+/))&&(r=r[0],i=i.substr(r.length),o.push(r)),0===i.length)return new R([new b([o.join(""),10]),b.ONE]);var a=null;if(/[()'"[\]]/.test(i)){var u=i.match(/([^.]*)\.(\d*)[(['"](\d+)[)\]'"](.*)/);if(null===u)throw"Fraction Unsupported argument "+i;var s=u[2].length,l=u[3];i=0===s?u[1]+u[4]:u[1]+"."+u[2]+u[4];for(var h=new b([l,10]),c=[],f=0;f<l.length;f++)c.push("9");var g=new b([c.join(""),10]);a=(a=new R([h,g])).scaleByPowerOfTen(-s)}null!==(r=i.match(/^\.[0-9]+/))&&(r=r[0],i=i.substr(r.length),e+=(r=r.substr(1)).length,o.push(r)),null!==(r=i.match(/^e[+-]?[0-9]+/))&&(r=r[0].substr(1),e-=parseInt(r,10));var m=null,_=null,p=null;if(0===e&&(_=new b([o.join(""),10]),p=b.ONE),e<0){for(var v=0;v<-e;v++)o.push("0");_=new b([o.join(""),10]),p=b.ONE}else if(0<e){_=new b([o.join(""),10]);for(var d=["1"],w=0;w<e;w++)d.push("0");p=new b([d.join(""),10])}return m=new R([_,p]),a&&(m=n?m.sub(a):m.add(a)),m},S.to_fraction_data_from_fraction_string=function(t){if(-1===t.indexOf("/"))return S.to_fraction_data_from_number_string(t);var r=t.split("/"),e=S.to_fraction_data_from_number_string(r[0]),n=S.to_fraction_data_from_number_string(r[1]);return e.div(n)},S.to_fraction_data_from_number=function(t){var r=null,e=null;if(t===Math.floor(t))r=new b(t),e=b.ONE;else{var n=Math.trunc(Math.log(Math.abs(t))/Math.log(10)),i=t/Math.pow(10,n);n=-n;for(var o=0;o<14&&(i*=10,n+=1,!(Math.abs(i-Math.round(i))<=Number.EPSILON));o++);if(i=Math.round(1e14*i)/1e14,n<=0)r=new b(t),e=b.ONE;else{r=new b(i);for(var a=["1"],u=0;u<n;u++)a.push("0");e=new b([a.join(""),10])}}return new R([r,e])},S.normalization=function(t){if(!t.denominator.equals(b.ONE)){if(t.denominator.equals(b.MINUS_ONE))return t.numerator=t.numerator.negate(),void(t.denominator=b.ONE);if(t.numerator.equals(b.ZERO))t.denominator=b.ONE;else{var r=t.numerator.gcd(t.denominator),e=t.numerator.div(r),n=t.denominator.div(r);n.sign()<0&&(e=e.negate(),n=n.negate()),t.numerator=e,t.denominator=n}}};var R=function t(r){if(this.numerator=null,this.denominator=null,0===arguments.length)this.numerator=b.ZERO,this.denominator=b.ONE;else{if(1!==arguments.length)throw"Fraction Unsupported argument "+r;var e=!1;if("number"==typeof r){var n=S.to_fraction_data_from_number(r);this.numerator=n.numerator,this.denominator=n.denominator}else if("string"==typeof r){var i=S.to_fraction_data_from_fraction_string(r);this.numerator=i.numerator,this.denominator=i.denominator}else if(r instanceof b)this.numerator=r,this.denominator=b.ONE;else if(r instanceof t)this.numerator=r.numerator,this.denominator=r.denominator;else if(r instanceof Array&&2===r.length)this.numerator=r[0]instanceof b?r[0]:new b(r[0]),this.denominator=r[1]instanceof b?r[1]:new b(r[1]),e=!0;else if(r instanceof E){var o=new t(r.unscaledValue()).scaleByPowerOfTen(-r.scale());this.numerator=o.numerator,this.denominator=o.denominator}else{if("object"!=typeof r)throw"Fraction Unsupported argument "+r;if("doubleValue"in r){var a=S.to_fraction_data_from_number(r.doubleValue);this.numerator=a.numerator,this.denominator=a.denominator}else if("numerator"in r&&"denominator"in r)this.numerator=r.numerator instanceof b?r.numerator:new b(r.numerator),this.denominator=r.denominator instanceof b?r.denominator:new b(r.denominator),e=!0;else{var u=S.to_fraction_data_from_fraction_string(r.toString());this.numerator=u.numerator,this.denominator=u.denominator}}e&&S.normalization(this)}},P={intValue:{configurable:!0},doubleValue:{configurable:!0}},L={MINUS_ONE:{configurable:!0},ZERO:{configurable:!0},HALF:{configurable:!0},ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0}};R.create=function(t){return t instanceof R?t:new R(t)},R.valueOf=function(t){return R.create(t)},R._toFraction=function(t){return t instanceof R?t:new R(t)},R._toFloat=function(t){return"number"==typeof t?t:t instanceof R?t.doubleValue:new R(t).doubleValue},R._toInteger=function(t){return"number"==typeof t?Math.trunc(t):t instanceof R?t.intValue:new R(t).intValue},R.prototype.clone=function(){return new R(this)},R.prototype.abs=function(){return 0<=this.sign()?this:this.negate()},R.prototype.negate=function(){return new R([this.numerator.negate(),this.denominator])},R.prototype.sign=function(){return this.numerator.sign()},R.prototype.toString=function(){return this.numerator.toString()+" / "+this.denominator.toString()},R.prototype.add=function(t){var r=this,e=R._toFraction(t);return r.isInteger()&&e.isInteger()?new R([r.numerator.add(e.numerator),b.ONE]):new R([r.numerator.mul(e.denominator).add(e.numerator.mul(r.denominator)),r.denominator.mul(e.denominator)])},R.prototype.sub=function(t){var r=this,e=R._toFraction(t);return r.isInteger()&&e.isInteger()?new R([r.numerator.sub(e.numerator),b.ONE]):new R([r.numerator.mul(e.denominator).sub(e.numerator.mul(r.denominator)),r.denominator.mul(e.denominator)])},R.prototype.mul=function(t){var r=R._toFraction(t);return this.isInteger()&&r.isInteger()?new R([this.numerator.mul(r.numerator),b.ONE]):new R([this.numerator.mul(r.numerator),this.denominator.mul(r.denominator)])},R.prototype.div=function(t){var r=R._toFraction(t);return this.isInteger()&&r.isInteger()?new R([this.numerator,r.numerator]):new R([this.numerator.mul(r.denominator),r.numerator.mul(this.denominator)])},R.prototype.inv=function(){return new R([this.denominator,this.numerator])},R.prototype.mod=function(t){var r=R._toFraction(t);return this.sub(r.mul(this.div(r).floor()))},R.prototype.pow=function(t){var r=R._toInteger(t),e=this.numerator.pow(r),n=this.denominator.pow(r);return new R([e,n])},R.prototype.factorial=function(){return new R([this.toBigInteger().factorial(),R.ONE])},R.prototype.scaleByPowerOfTen=function(t){var r,e=R._toInteger(t);return 0===e?this:(0<e?r=new R([this.numerator.scaleByPowerOfTen(e),this.denominator]):e<0&&(r=new R([this.numerator,this.denominator.scaleByPowerOfTen(-e)])),r)},P.intValue.get=function(){return this.isInteger()?Math.trunc(this.numerator.doubleValue):Math.trunc(this.doubleValue)},P.doubleValue.get=function(){if(this.isInteger())return this.numerator.doubleValue;var t=new E([this.numerator,y.UNLIMITED]),r=new E([this.denominator,y.UNLIMITED]);return t.div(r,{context:y.DECIMAL64}).doubleValue},R.prototype.toBigInteger=function(){return new b(this.fix().numerator)},R.prototype.toBigDecimal=function(t){if(this.isInteger())return new E(this.numerator);var r=new E([this.numerator,y.UNLIMITED]),e=new E([this.denominator,y.UNLIMITED]);return t?r.div(e,{context:t}):r.div(e,{context:E.getDefaultContext()})},R.prototype.equals=function(t){var r=R._toFraction(t);return this.numerator.equals(r.numerator)&&this.denominator.equals(r.denominator)},R.prototype.compareTo=function(t){return this.sub(t).sign()},R.prototype.max=function(t){var r=R._toFraction(t);return 0<=this.compareTo(r)?this:r},R.prototype.min=function(t){var r=R._toFraction(t);return 0<=this.compareTo(r)?r:this},R.prototype.clip=function(t,r){var e=R._toFraction(t),n=R._toFraction(r),i=e.compareTo(n);if(1===i)throw"clip(min, max) error. (min > max)->("+e+" > "+n+")";return 0===i?e:1===this.compareTo(n)?n:-1===this.compareTo(e)?e:this},R.prototype.floor=function(){if(this.isInteger())return this;var t=this.fix();return 0<this.sign()?t:new R([t.numerator.sub(b.ONE),R.ONE])},R.prototype.ceil=function(){if(this.isInteger())return this;var t=this.fix();return 0<this.sign()?new R([t.numerator.add(b.ONE),R.ONE]):t},R.prototype.round=function(){if(this.isInteger())return this;var t=this.floor();return 0<=this.sub(t).compareTo(R.HALF)?new R([t.numerator.add(b.ONE),R.ONE]):t},R.prototype.fix=function(){return this.isInteger()?this:new R([this.numerator.div(this.denominator),R.ONE])},R.prototype.fract=function(){return this.isInteger()?R.ZERO:this.sub(this.floor())},R.prototype.isInteger=function(){return this.denominator.equals(b.ONE)},R.prototype.isZero=function(){return this.numerator.equals(b.ZERO)&&this.denominator.equals(b.ONE)},R.prototype.isOne=function(){return this.numerator.equals(b.ONE)&&this.denominator.equals(b.ONE)},R.prototype.isPositive=function(){return this.numerator.isPositive()},R.prototype.isNegative=function(){return this.numerator.isNegative()},R.prototype.isNotNegative=function(){return this.numerator.isNotNegative()},L.MINUS_ONE.get=function(){return V.MINUS_ONE},L.ZERO.get=function(){return V.ZERO},L.HALF.get=function(){return V.HALF},L.ONE.get=function(){return V.ONE},L.TWO.get=function(){return V.TWO},L.TEN.get=function(){return V.TEN},Object.defineProperties(R.prototype,P),Object.defineProperties(R,L);function F(){}var V={MINUS_ONE:new R([b.MINUS_ONE,b.ONE]),ZERO:new R([b.ZERO,b.ONE]),ONE:new R([b.ONE,b.ONE]),HALF:new R([b.ONE,b.TWO]),TWO:new R([b.TWO,b.ONE]),TEN:new R([b.TEN,b.ONE])};F.tridiagonalize=function(t){for(var r=K._toMatrix(t).getNumberMatrixArray(),h=function(t,r,e,n){for(var i=0,o=e||0,a=n||t.length,u=o;u<a;u++)i+=t[u]*r[u];return i},e=function(t,r,e){var n=r||0,i=e||t.length,o=Math.sqrt(h(t,t,n,i)),a=[];if(1e-10<=Math.abs(o)){var u;t[n]<0&&(o=-o);for(var s=n,l=0;s<i;s++,l++)s===n?(a[l]=t[s]+o,u=1/Math.sqrt(a[l]*o),a[l]=a[l]*u):a[l]=t[s]*u}return{y1:-o,v:a}},n=r.length,i=[],o=[],a=0;a<n-2;a++){var u=r[a];i[a]=u[a];var s=e(u,a+1,n);o[a]=s.y1;for(var l=0;l<s.v.length;l++)u[a+1+l]=s.v[l];if(!(Math.abs(o[a])<1e-10)){for(var c=a+1;c<n;c++){for(var f=0,g=a+1;g<c;g++)f+=r[g][c]*u[g];for(var m=c;m<n;m++)f+=r[c][m]*u[m];i[c]=f}for(var _=h(u,i,a+1,n)/2,p=n-1;a<p;p--){var v=u[p],d=i[p]-_*v;i[p]=d;for(var w=p;w<n;w++){var y=v*i[w]+d*u[w];r[p][w]=r[p][w]-y}}}}2<=n&&(i[n-2]=r[n-2][n-2],o[n-2]=r[n-2][n-1]),1<=n&&(i[n-1]=r[n-1][n-1]);for(var b=n-1;0<=b;b--){var x=r[b];if(b<n-2)for(var M=b+1;M<n;M++)for(var N=r[M],I=h(x,N,b+1,n),E=b+1;E<n;E++)N[E]-=I*x[E];for(var O=0;O<n;O++)x[O]=0;x[b]=1}var D=K.createMatrixDoEachCalculation(function(t,r){return t===r?new et(i[t]):1===Math.abs(t-r)?new et(o[Math.trunc(.5*(t+r))]):et.ZERO},n,n);return{P:new K(r).T(),H:D}},F.eig=function(t){for(var r=K._toMatrix(t),e=!1,n=F.tridiagonalize(r),i=n.P.getNumberMatrixArray(),o=n.H.getNumberMatrixArray(),a=r.row_length,u=[],s=[],l=0;l<a;l++)u[l]=o[l][l],s[l]=0===l?0:o[l][l-1];for(var h=a-1;0<h;h--){var c=h;for(c=h;1<=c&&!(Math.abs(s[c])<=1e-10*(Math.abs(u[c-1])+Math.abs(u[c])));c--);if(c!=h){for(var f=0;;){if(100<++f){e=!0;break}var g=(u[h-1]-u[h])/2,m=s[h]*s[h],_=Math.sqrt(g*g+m);g<0&&(_=-_);for(var p=u[c]-u[h]+m/(g+_),v=s[c+1],d=c;d<h;d++){var w=void 0,y=void 0;Math.abs(p)>=Math.abs(v)?y=(m=-v/p)*(w=1/Math.sqrt(m*m+1)):w=(m=-p/v)*(y=1/Math.sqrt(m*m+1)),m=((g=u[d]-u[d+1])*y+2*w*s[d+1])*y,u[d]-=m,u[d+1]+=m,c<d&&(s[d]=w*s[d]-y*v),s[d+1]+=y*(w*g-2*y*s[d+1]);for(var b=0;b<a;b++)p=i[b][d],v=i[b][d+1],i[b][d]=w*p-y*v,i[b][d+1]=y*p+w*v;d<h-1&&(p=s[d+1],v=-y*s[d+2],s[d+2]*=w)}if(Math.abs(s[h])<=1e-10*(Math.abs(u[h-1])+Math.abs(u[h])))break}if(e)break}}return function(t,r){for(var e=r.length,n=[],i=0;i<e;i++)n[i]={sigma:r[i],index:i};n.sort(function(t,r){return t.sigma===r.sigma?0:t.sigma<r.sigma?1:-1});for(var o=K.zeros(e),a=K.zeros(e),u=0;u<e;u++)a.matrix_array[u][u]=new et(n[u].sigma),o.matrix_array[u][n[u].index]=et.ONE;return{V:t.mul(o),D:a}}(new K(i),u)},F.doGramSchmidtOrthonormalization=function(t){for(var r=K._toMatrix(t),e=r.column_length,n=r.matrix_array,i=K.zeros(e),o=K.zeros(e),a=i.matrix_array,u=o.matrix_array,s=[],l=new Array(e),h=0;h<e;h++){for(var c=0;c<e;c++)l[c]=n[c][h];if(0<h){for(var f=0;f<h;f++)for(var g=0;g<e;g++)u[f][h]=u[f][h].add(n[g][h].dot(a[g][f]));for(var m=0;m<h;m++)for(var _=0;_<e;_++)l[_]=l[_].sub(u[m][h].mul(a[_][m]))}for(var p=0;p<e;p++)u[h][h]=u[h][h].add(l[p].square());if(u[h][h]=u[h][h].sqrt(),u[h][h].isZero(1e-10)){s.push(h);for(var v=0;v<e;v++)a[v][h]=et.ZERO}else for(var d=0;d<e;d++)a[d][h]=l[d].div(u[h][h])}return{Q:i,R:o,non_orthogonalized:s}},F.createOrthogonalVector=function(t,r){for(var e=new K(t),n=e.column_length,i=e.matrix_array,o=F.getLinearDependenceVector(e,r||1e-10),a=o.length-1;0<=a;a--)i.splice(o[a],1),e.row_length--;var u=n-i.length;if(u<=0)return null;for(var s=new v(0),l=null,h=0;h<100;h++){var c=e.T(),f=K.createMatrixDoEachCalculation(function(){return new et(s.nextGaussian())},c.row_length,u);if(c._concatRight(f),0===(l=F.doGramSchmidtOrthonormalization(c)).non_orthogonalized.length)break}if(0!==l.non_orthogonalized.length)return console.log("miss"),null;for(var g=new Array(u),m=l.Q.matrix_array,_=0;_<u;_++){g[_]=new Array(n);for(var p=0;p<n;p++)g[_][p]=m[p][n-u+_]}return new K(g)},F.getMaxRowNumber=function(t,r,e,n){for(var i=K._toMatrix(t),o=0,a=0,u=e||0,s=n||i.row_length;u<s;u++){var l=i.matrix_array[u][r].norm;a<l&&(a=l,o=u)}return{index:o,max:a}},F.getLinearDependenceVector=function(t,r){for(var e=new K(t),n=e.matrix_array,i=r?K._toDouble(r):1e-10,o=new Array(e.row_length),a=0;a<e.row_length;a++)o[a]=a;for(var u=0;u<e.column_length;u++){var s=0,l=0,h=0;for(var c in o){var f=o[c],g=n[f][u].norm;l<g&&(l=g,h=parseInt(c,10),s=f)}if(!(l<=i)){if(o.splice(h,1),u===e.column_length-1)break;for(var m in o)for(var _=o[m],p=n[_][u].div(n[s][u]),v=u;v<e.column_length;v++)n[_][v]=n[_][v].sub(n[s][v].mul(p))}}return o};function z(){}z.inner=function(t,r,e){var n=K._toMatrix(t),i=K._toMatrix(r),o=n.matrix_array,a=i.matrix_array,u=e?K._toInteger(e):1;if(n.isScalar()&&i.isScalar())return new K(n.scalar.dot(i.scalar));if(n.isVector()&&i.isVector()){for(var s=et.ZERO,l=0;l<n.length;l++)s=s.add(n.getComplex(l).dot(i.getComplex(l)));return new K(s)}if(n.row_length!==i.row_length||n.column_length!==i.column_length)throw"Matrix size does not match";if(1===u){var h=new Array(1);h[0]=new Array(n.column_length);for(var c=0;c<n.column_length;c++){for(var f=et.ZERO,g=0;g<n.row_length;g++)f=f.add(o[g][c].dot(a[g][c]));h[0][c]=f}return new K(h)}if(2!==u)throw"dim";for(var m=new Array(n.row_length),_=0;_<n.row_length;_++){for(var p=et.ZERO,v=0;v<n.column_length;v++)p=p.add(o[_][v].dot(a[_][v]));m[_]=[p]}return new K(m)},z.norm=function(t,r){var e=K._toMatrix(t),n=void 0===r?2:K._toDouble(r);if(1===n){var i=e.matrix_array;if(e.isRow()){for(var o=0,a=0;a<e.column_length;a++)o+=i[0][a].norm;return o}if(e.isColumn()){for(var u=0,s=0;s<e.row_length;s++)u+=i[s][0].norm;return u}for(var l=0,h=0;h<e.column_length;h++){for(var c=0,f=0;f<e.row_length;f++)c+=i[f][h].norm;l<c&&(l=c)}return l}if(2===n){var g=e.matrix_array;if(e.isRow()){for(var m=0,_=0;_<e.column_length;_++)m+=g[0][_].square().real;return Math.sqrt(m)}if(e.isColumn()){for(var p=0,v=0;v<e.row_length;v++)p+=g[v][0].square().real;return Math.sqrt(p)}return e.svd().S.diag().max().scalar.real}if(n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY){var d=e.matrix_array,w=n===Number.POSITIVE_INFINITY?0:Number.POSITIVE_INFINITY,y=n===Number.POSITIVE_INFINITY?Math.max:Math.min;if(e.isRow()){for(var b=0;b<e.column_length;b++)w=y(w,d[0][b].norm);return w}if(e.isColumn()){for(var x=0;x<e.row_length;x++)w=y(w,d[x][0].norm);return w}for(var M=w=0;M<e.row_length;M++){for(var N=0,I=0;I<e.column_length;I++)N+=d[M][I].norm;w=Math.max(w,N)}return w}if(e.isVector()){for(var E=0,O=0;O<e.length;O++)E+=Math.pow(e.getComplex(O).norm,n);return Math.pow(E,1/n)}throw"norm"},z.cond=function(t,r){var e=K._toMatrix(t);if(2!==(void 0===r?2:K._toInteger(r)))return e.norm(r)*e.pinv().norm(r);if(e.isZeros())return Number.POSITIVE_INFINITY;if(e.isVector())return 1;if(e.isUnitary())return 1;var n=e.svd().S.diag();return n.max().scalar.real/n.min().scalar.real},z.rcond=function(t){return 1/z.cond(K._toMatrix(t),1)},z.rank=function(t,r){var e=K._toMatrix(t),n=void 0!==r?K._toDouble(r):void 0;return e.row_length<=e.column_length?Math.min(e.row_length,e.column_length)-F.getLinearDependenceVector(e,n).length:e.row_length-F.getLinearDependenceVector(e,n).length},z.trace=function(t){for(var r=K._toMatrix(t),e=Math.min(r.row_length,r.column_length),n=et.ZERO,i=0;i<e;i++)n=n.add(r.matrix_array[i][i]);return n},z.det=function(t){var r=K._toMatrix(t);if(!r.isSquare())throw"not square";var e=r.length;if(e<5){var l=function(t){if(2===t.length)return t[0][0].mul(t[1][1]).sub(t[0][1].mul(t[1][0]));for(var r=et.ZERO,e=0;e<t.length;e++){for(var n=[],i=t[e][0],o=0,a=0;o<t.length;o++)if(e!==o){n[a]=[];for(var u=1,s=0;u<t.length;u++,s++)n[a][s]=t[o][u];a++}r=e%2==0?r.add(i.mul(l(n))):r.sub(i.mul(l(n)))}return r};return new K(l(r.matrix_array))}var n=z.lup(r),i=(e-n.P.diag().sum().scalar.real)/2,o=n.U.diag().prod();return i%2==1&&(o=o.negate()),new K(o)},z.lup=function(t){for(var r=new K(t),e=K.zeros(r.row_length),n=r,i=K.eye(r.row_length),o=e.matrix_array,a=n.matrix_array,u=0;u<r.column_length;u++){var s,l=F.getMaxRowNumber(n,u,u);if(s=l.index,0!==l.max){u!==s&&(e._exchangeRow(u,s),n._exchangeRow(u,s),i._exchangeRow(u,s));for(var h=u+1;h<r.row_length;h++){var c=a[h][u].div(a[u][u]);o[h][u]=c;for(var f=u;f<r.column_length;f++)a[h][f]=a[h][f].sub(a[u][f].mul(c))}}}return e._resize(r.row_length,Math.min(r.row_length,r.column_length)),n._resize(Math.min(r.row_length,r.column_length),r.column_length),e._each(function(t,r,e){return r===e?et.ONE:t}),{L:e,U:n,P:i}},z.lu=function(t){var r=z.lup(t);return{L:r.P.T().mul(r.L),U:r.U}},z.linsolve=function(t,r){var e=K._toMatrix(t),n=K._toMatrix(r);if(!e.isSquare())throw"Matrix size does not match";var i=n;if(n.row_length!==e.row_length||1<n.column_length)throw"Matrix size does not match";var o=new K(e);o._concatRight(i);for(var a=o.matrix_array,u=o.column_length,s=e.column_length,l=0;l<s-1;l++){var h=F.getMaxRowNumber(o,l,l).index;o._exchangeRow(l,h);for(var c=a[l][l].inv(),f=l,g=l;g<u;g++)a[f][g]=a[f][g].mul(c);for(var m=l+1;m<s;m++)for(var _=a[m][l],p=l;p<u;p++)a[m][p]=a[m][p].sub(a[l][p].mul(_))}var v=new Array(s);v[s-1]=a[s-1][s].div(a[s-1][s-1]);for(var d=s-2;0<=d;d--){v[d]=a[d][u-1];for(var w=d+1;w<s;w++)v[d]=v[d].sub(a[d][w].mul(v[w]));v[d]=v[d].div(a[d][d])}for(var y=new Array(e.row_length),b=0;b<e.row_length;b++)y[b]=[v[b]];return new K(y)},z.qr=function(t){var r=new K(t),e=r.row_length,n=r.row_length,i=r.row_length,o=r.column_length,a=Math.max(r.row_length,r.column_length);r._resize(a,a);var u=F.doGramSchmidtOrthonormalization(r),s=u.Q,l=u.R,h=u.non_orthogonalized;if(h.length===r.row_length)s=K.eye(r.row_length);else if(0!==h.length){for(var c={},f=0;f<h.length;f++)c[h[f]]=1;for(var g=[],m=0;m<a;m++)if(!c[m]){for(var _=[],p=0;p<a;p++)_[p]=s.matrix_array[p][m];g.push(_)}for(var v=F.createOrthogonalVector(g),d=0;d<h.length;d++)for(var w=h[d],y=0;y<a;y++)s.matrix_array[y][w]=v.matrix_array[d][y]}return s._resize(e,n),l._resize(i,o),{Q:s,R:l}},z.tridiagonalize=function(t){var r=new K(t);if(!r.isSquare())throw"not square matrix";if(!r.isSymmetric())throw"not Symmetric";if(r.isComplex())throw"not Real Matrix";return F.tridiagonalize(r)},z.eig=function(t){var r=new K(t);if(!r.isSquare())throw"not square matrix";if(!r.isSymmetric())throw"not Symmetric";if(r.isComplex())throw"not Real Matrix";return F.eig(r)},z.svd=function(t){var r=new K(t);if(r.isComplex())throw"Unimplemented";var n=z.rank(r),i=z.eig(r.T().mul(r)),o=K.zeros(r.row_length,r.column_length);o._each(function(t,r,e){if(r===e&&r<n)return i.D.getComplex(r,r).sqrt()});var e=Math.min(r.row_length,r.column_length),a=K.createMatrixDoEachCalculation(function(t,r){if(t!==r)return et.ZERO;var e=o.matrix_array[t][t];return e.isZero()?et.ZERO:e.inv()},e),u=i.V.resize(i.V.row_length,e),s=r.mul(u).mul(a);return{U:z.qr(s).Q,S:o,V:i.V}},z.inv=function(t){var r=new K(t);if(r.isScalar())return new K(et.ONE.div(r.scalar));if(!r.isSquare())throw"not square";if(r.isDiagonal()){for(var e=r.T(),n=Math.min(e.row_length,e.column_length),i=0;i<n;i++)e.matrix_array[i][i]=e.matrix_array[i][i].inv();return e}var o=r.column_length,a=new K(r);a._concatRight(K.eye(o));for(var u=a.matrix_array,s=a.column_length,l=0;l<o;l++){var h=F.getMaxRowNumber(a,l,l).index;a._exchangeRow(l,h);for(var c=u[l][l].inv(),f=l,g=l;g<s;g++)u[f][g]=u[f][g].mul(c);for(var m=0;m<o;m++)if(m!==l)for(var _=u[m][l],p=l;p<s;p++)u[m][p]=u[m][p].sub(u[l][p].mul(_))}for(var v=new Array(o),d=0;d<o;d++){v[d]=new Array(o);for(var w=0;w<o;w++)v[d][w]=u[d][o+w]}return new K(v)},z.pinv=function(t){var r=new K(t),e=z.svd(r),n=e.U,i=e.S,o=e.V,a=K.createMatrixDoEachCalculation(function(t,r){if(t!==r)return et.ZERO;var e=i.matrix_array[t][t];return e.isZero()?et.ZERO:e.inv()},r.column_length,r.row_length);return o.mul(a).mul(n.T())};function B(){}B.max=function(t,r){var e=K._toMatrix(t),n=r&&r.dimension?r.dimension:"auto";return e.eachVector(function(t){for(var r=t[0],e=1;e<t.length;e++)r.compareTo(t[e])<0&&(r=t[e]);return[r]},n)},B.min=function(t,r){var e=K._toMatrix(t),n=r&&r.dimension?r.dimension:"auto";return e.eachVector(function(t){for(var r=t[0],e=1;e<t.length;e++)0<r.compareTo(t[e])&&(r=t[e]);return[r]},n)},B.sum=function(t,r){var e=K._toMatrix(t),n=r&&r.dimension?r.dimension:"auto";return e.eachVector(function(t){for(var r=et.ZERO,e=et.ZERO,n=0;n<t.length;n++){var i=t[n].add(e),o=r.add(i);e=o.sub(r).sub(i),r=o}return[r]},n)},B.mean=function(t,r){var e=K._toMatrix(t),n=r&&r.dimension?r.dimension:"auto";return e.eachVector(function(t){for(var r=et.ZERO,e=et.ZERO,n=0;n<t.length;n++){var i=t[n].add(e),o=r.add(i);e=o.sub(r).sub(i),r=o}return[r.div(t.length)]},n)},B.prod=function(t,r){var e=K._toMatrix(t),n=r&&r.dimension?r.dimension:"auto";return e.eachVector(function(t){for(var r=et.ONE,e=0;e<t.length;e++)r=r.mul(t[e]);return[r]},n)},B.geomean=function(t,r){var e=K._toMatrix(t),n=r&&r.dimension?r.dimension:"auto";return e.eachVector(function(t){for(var r=et.ONE,e=0;e<t.length;e++)r=r.mul(t[e]);return[r.pow(et.create(t.length).inv())]},n)},B.median=function(t,r){function i(t,r){return t.compareTo(r)}var e=K._toMatrix(t),n=r&&r.dimension?r.dimension:"auto";return e.eachVector(function(t){var r;if(t.sort(i),t.length%2==1)r=t[Math.floor(t.length/2)];else{var e=t[Math.floor(t.length/2)-1],n=t[Math.floor(t.length/2)];r=e.add(n).div(et.TWO)}return[r]},n)},B.mode=function(t,r){function s(t,r){return t.compareTo(r)}var e=K._toMatrix(t),n=r&&r.dimension?r.dimension:"auto";return e.eachVector(function(t){t.sort(s);for(var r={},e=0;e<t.length;e++){var n=t[e].real+" "+t[e].imag;r[n]?r[n].value++:r[n]={complex:t[e],value:1}}var i=et.ZERO,o=Number.NEGATIVE_INFINITY;for(var a in r){var u=r[a];u.value>o&&(o=u.value,i=u.complex)}return[i]},n)},B.moment=function(t,r,e){var n=K._toMatrix(t),o=B.mean(n),a=e&&"number"==typeof e.correction?K._toDouble(e.correction):1,i=e&&e.dimension?e.dimension:"auto",u=K._toComplex(r),s=0;return n.eachVector(function(t){var r;r=o.isScalar()?o.scalar:o.getComplex(s++);for(var e=et.ZERO,n=0;n<t.length;n++){var i=t[n].sub(r);e=e.add(i.pow(u))}return 1===t.length?[e.div(t.length)]:[e.div(t.length-1+a)]},i)},B.var=function(t,r){var e=K._toMatrix(t),o=B.mean(e),a=r&&"number"==typeof r.correction?K._toDouble(r.correction):0,n=r&&r.dimension?r.dimension:"auto",u=0;return e.eachVector(function(t){if(1===t.length)return[et.ZERO];for(var r=o.getComplex(u++),e=0,n=0;n<t.length;n++){var i=t[n].sub(r).norm;e+=i*i}return[et.create(e/(t.length-1+a))]},n)},B.std=function(t,r){var e=K._toMatrix(t),n=r&&"number"==typeof r.correction?K._toDouble(r.correction):0,i=r&&r.dimension?r.dimension:"auto",o=B.var(e,{correction:n,dimension:i});return o._each(function(t){return t.sqrt()}),o},B.mad=function(t,r,e){var n=K._toMatrix(t),i=r?"string"==typeof r?r:K._toInteger(r):"mean",o=e&&e.dimension?e.dimension:"auto";if("mean"===i||0===i)return B.mean(n.sub(B.mean(n,{dimension:o})).abs(),{dimension:o});if("median"===i||1===i)return B.median(n.sub(B.median(n,{dimension:o})).abs(),{dimension:o});throw"mad unsupported argument "+i},B.skewness=function(t,r){var e=K._toMatrix(t),n=r&&"number"==typeof r.correction?K._toDouble(r.correction):1,i=r&&r.dimension?r.dimension:"auto",o=B.moment(e,3,{correction:n,dimension:i}),a=B.std(e,{correction:n,dimension:i});return 1===n?o.dotdiv(a.dotpow(3)):o.dotdiv(a.dotpow(3)).dotmul(2)},B.cov=function(t,r){var e=K._toMatrix(t),n=r&&"number"==typeof r.correction?K._toDouble(r.correction):0;if(e.isVector())return B.var(e,r);for(var i=1===e.row_length?1:n,o=e.matrix_array,a=B.mean(e).matrix_array[0],u=new Array(e.column_length),s=0;s<e.column_length;s++){var l=a[s];u[s]=new Array(e.column_length);for(var h=s;h<e.column_length;h++){for(var c=a[h],f=et.ZERO,g=0;g<e.row_length;g++)f=f.add(o[g][s].sub(l).dot(o[g][h].sub(c)));u[s][h]=f.div(e.row_length-1+i)}}for(var m=1;m<u[0].length;m++)for(var _=0;_<m;_++)u[m][_]=u[_][m];return new K(u)},B.normalize=function(t,r){var e=K._toMatrix(t),n=e.sub(B.mean(e,r));return n.dotdiv(B.std(n,r))},B.corrcoef=function(t,r){var e=K._toMatrix(t);return B.cov(B.normalize(e,r),r)},B.sort=function(t,r,e){var n,i=K._toMatrix(t),o=e&&e.dimension?e.dimension:"auto";n="ascend"===(r||"ascend")?function(t,r){return t.compareTo(r)}:function(t,r){return r.compareTo(t)};return i.eachVector(function(t){return t.sort(n),t},o)};function Z(){}Z.gammaln=function(t){for(var r=Math.log(2*Math.PI),e=[-15238221.539407417,691472.268851313,-36108.77125372499,8553103/6/650,-156.84828462600203,854513/138/462,-174611/330/380,43867/798/306,-3617/510/240,7/6/182,-691/2730/132,5/66/90,-1/30/56,1/42/30,-1/30/12,1/6/2],n=1,i=t;i<e.length;)n*=i,i++;for(var o=1/(i*i),a=e[0],u=1;u<e.length;u++)a*=o,a+=e[u];return a/=i,a+=.5*r,a+=-Math.log(n)-i+(i-.5)*Math.log(i)},Z.q_gamma=function(t,r,e){var n,i,o,a,u,s=1,l=1+t-r;if(t<1+r)return 1-Z.p_gamma(t,r,e);for(i=(o=Math.exp(r*Math.log(t)-t-e))/l,n=2;n<1e3;n++)if(a=((n-1-r)*(l-s)+(n+t)*l)/n,u=i,(i+=a=(o*=(n-1-r)/n)/((s=l)*(l=a)))==u)return i;return Number.NaN},Z.p_gamma=function(t,r,e){var n,i,o,a;if(1+r<=t)return 1-Z.q_gamma(t,r,e);if(0===t)return 0;for(i=o=Math.exp(r*Math.log(t)-t-e)/r,n=1;n<1e3;n++)if(a=i,(i+=o*=t/(r+n))==a)return i;return Number.NaN},Z.gamma=function(t){return t<0?Math.PI/(Math.sin(Math.PI*t)*Math.exp(Z.gammaln(1-t))):Math.exp(Z.gammaln(t))},Z.gammainc=function(t,r,e){if("lower"===e)return Z.p_gamma(t,r,Z.gammaln(r));if("upper"===e)return Z.q_gamma(t,r,Z.gammaln(r));if(2===arguments.length)return Z.gammainc(t,r,"lower");throw"gammainc unsupported argument ["+e+"]"},Z.gampdf=function(t,r,e){var n=1/(Z.gamma(r)*Math.pow(e,r));return n*=Math.pow(t,r-1),n*=Math.exp(-t/e)},Z.gamcdf=function(t,r,e){return Z.gammainc(t/e,r)},Z.gaminv=function(t,r,e){if(t<0||1<t)return Number.NaN;if(0==t)return 0;if(1==t)return Number.POSITIVE_INFINITY;for(var n,i,o=r*e,a=0;a<100&&(n=(i=o-(Z.gamcdf(o,r,e)-t)/Z.gampdf(o,r,e))-o,!(Math.abs(n)<=1e-12));a++)(o=i)<0&&(o=1e-12);return o},Z.beta=function(t,r){return Math.exp(Z.gammaln(t)+Z.gammaln(r)-Z.gammaln(t+r))},Z.p_beta=function(t,r,e){var n,i,o,a;if(r<=0)return Number.POSITIVE_INFINITY;if(e<=0)return t<1?0:1===t?1:Number.POSITIVE_INFINITY;if((r+1)/(r+e+2)<t)return 1-Z.p_beta(1-t,e,r);if(t<=0)return 0;for(o=r*Math.log(t),o+=e*Math.log(1-t),o+=Z.gammaln(r+e),o-=Z.gammaln(r)+Z.gammaln(e),o=Math.exp(o),i=o/=r,n=1;n<1e3;n++)if(o*=r+e+n-1,o*=t,a=i,(i+=o/=r+n)===a)return i;return Number.NaN},Z.q_beta=function(t,r,e){return 1-Z.p_beta(t,r,e)},Z.betainc=function(t,r,e,n){if("lower"===n)return Z.p_beta(t,r,e);if("upper"===n)return Z.q_beta(t,r,e);if(3===arguments.length)return Z.betainc(t,r,e,"lower");throw"betainc unsupported argument ["+n+"]"},Z.isInteger=function(t){return t-Math.trunc(t)!=0},Z.betapdf=function(t,r,e){return t<0&&Z.isInteger(e-1)||1-t<0&&Z.isInteger(e-1)?0:Math.pow(t,r-1)*Math.pow(1-t,e-1)/Z.beta(r,e)},Z.betacdf=function(t,r,e){return Z.betainc(t,r,e)},Z.betainv=function(t,r,e){if(t<0||1<t)return Number.NaN;if(0==t&&0<r&&0<e)return 0;if(1==t&&0<r&&0<e)return 1;var n,i,o,a=1e-14;n=0==e?1-a:0==r?a:r/(r+e);for(var u=0;u<100&&(i=(o=n-(Z.betacdf(n,r,e)-t)/Z.betapdf(n,r,e))-n,!(Math.abs(i)<=a));u++)1<(n=o)?n=1-a:n<0&&(n=a);return n},Z.factorial=function(t){var r=Z.gamma(t+1);return Math.trunc(t)===t?Math.round(r):r},Z.nchoosek=function(t,r){return Math.round(Z.factorial(t)/(Z.factorial(t-r)*Z.factorial(r)))},Z.erf=function(t){return Z.p_gamma(t*t,.5,.5*Math.log(Math.PI))*(0<=t?1:-1)},Z.erfc=function(t){return 1-Z.erf(t)},Z.erfinv=function(t){return Z.erfcinv(1-t)},Z.erfcinv=function(t){return-Z.norminv(.5*t)/Math.sqrt(2)},Z.normpdf=function(t,r,e){var n="number"==typeof r?r:0,i="number"==typeof e?e:1,o=1/Math.sqrt(2*Math.PI*i*i);return o*=Math.exp(-(t-n)*(t-n)/(2*i*i))},Z.normcdf=function(t,r,e){return(1+Z.erf((t-("number"==typeof r?r:0))/(("number"==typeof e?e:1)*Math.sqrt(2))))/2},Z.norminv=function(t,r,e){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;for(var n,i,o="number"==typeof r?r:0,a="number"==typeof e?e:1,u=o,s=0;s<200&&(n=(i=u-(Z.normcdf(u,o,a)-t)/Z.normpdf(u,o,a))-u,!(Math.abs(n)<=1e-12));s++)u=i;return u},Z.tpdf=function(t,r){var e=1/(Math.sqrt(r)*Z.beta(.5,.5*r));return e*=Math.pow(1+t*t/r,.5*-(r+1))},Z.tcdf=function(t,r){return.5*(1+Z.betainc(t*t/(r+t*t),.5,.5*r)*(t<0?-1:1))},Z.tinv=function(t,r){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;if(t<.5){var e=Z.betainv(2*t,.5*r,.5);return-Math.sqrt(r/e-r)}var n=Z.betainv(2*(1-t),.5*r,.5);return Math.sqrt(r/n-r)},Z.tdist=function(t,r,e){return(1-Z.tcdf(t,r))*e},Z.tinv2=function(t,r){return-Z.tinv(.5*t,r)},Z.chi2pdf=function(t,r){if(t<0)return 0;if(0===t)return.5;var e=Math.pow(t,r/2-1)*Math.exp(-t/2);return e/=Math.pow(2,r/2)*Z.gamma(r/2)},Z.chi2cdf=function(t,r){return Z.gammainc(t/2,r/2)},Z.chi2inv=function(t,r){return Z.gaminv(t,r/2,2)},Z.fpdf=function(t,r,e){if(r<0||e<0)return Number.NaN;if(t<=0)return 0;var n=1;return n*=Math.pow(r*t/(r*t+e),r/2),n*=Math.pow(1-r*t/(r*t+e),e/2),n/=t*Z.beta(r/2,e/2)},Z.fcdf=function(t,r,e){return Z.betacdf(r*t/(r*t+e),r/2,e/2)},Z.finv=function(t,r,e){return(1/Z.betainv(1-t,e/2,r/2)-1)*e/r};function q(t){return t&&("string"==typeof t||t instanceof String)}function U(){}U.gammaln=function(t){return new et(Z.gammaln(et._toDouble(t)))},U.gamma=function(t){return new et(Z.gamma(et._toDouble(t)))},U.gammainc=function(t,r,e){var n=et._toDouble(t),i=et._toDouble(r),o=q(e)?e:"lower";return new et(Z.gammainc(n,i,o))},U.gampdf=function(t,r,e){var n=et._toDouble(t),i=et._toDouble(r),o=et._toDouble(e);return new et(Z.gampdf(n,i,o))},U.gamcdf=function(t,r,e){var n=et._toDouble(t),i=et._toDouble(r),o=et._toDouble(e);return new et(Z.gamcdf(n,i,o))},U.gaminv=function(t,r,e){var n=et._toDouble(t),i=et._toDouble(r),o=et._toDouble(e);return new et(Z.gaminv(n,i,o))},U.beta=function(t,r){var e=et._toDouble(t),n=et._toDouble(r);return new et(Z.beta(e,n))},U.betainc=function(t,r,e,n){var i=et._toDouble(t),o=et._toDouble(r),a=et._toDouble(e),u=q(n)?n:"lower";return new et(Z.betainc(i,o,a,u))},U.betapdf=function(t,r,e){var n=et._toDouble(t),i=et._toDouble(r),o=et._toDouble(e);return new et(Z.betapdf(n,i,o))},U.betacdf=function(t,r,e){var n=et._toDouble(t),i=et._toDouble(r),o=et._toDouble(e);return new et(Z.betacdf(n,i,o))},U.betainv=function(t,r,e){var n=et._toDouble(t),i=et._toDouble(r),o=et._toDouble(e);return new et(Z.betainv(n,i,o))},U.factorial=function(t){return new et(Z.factorial(et._toDouble(t)))},U.nchoosek=function(t,r){var e=et._toDouble(t),n=et._toDouble(r);return new et(Z.nchoosek(e,n))},U.erf=function(t){var r=et._toDouble(t);return new et(Z.erf(r))},U.erfc=function(t){var r=et._toDouble(t);return new et(Z.erfc(r))},U.erfinv=function(t){var r=et._toDouble(t);return new et(Z.erfinv(r))},U.erfcinv=function(t){var r=et._toDouble(t);return new et(Z.erfcinv(r))},U.normpdf=function(t,r,e){var n=et._toDouble(t),i=void 0!==r?et._toDouble(r):0,o=void 0!==e?et._toDouble(e):1;return new et(Z.normpdf(n,i,o))},U.normcdf=function(t,r,e){var n=et._toDouble(t),i=void 0!==r?et._toDouble(r):0,o=void 0!==e?et._toDouble(e):1;return new et(Z.normcdf(n,i,o))},U.norminv=function(t,r,e){var n=et._toDouble(t),i=void 0!==r?et._toDouble(r):0,o=void 0!==e?et._toDouble(e):1;return new et(Z.norminv(n,i,o))},U.tpdf=function(t,r){var e=et._toDouble(t),n=et._toDouble(r);return new et(Z.tpdf(e,n))},U.tcdf=function(t,r){var e=et._toDouble(t),n=et._toDouble(r);return new et(Z.tcdf(e,n))},U.tinv=function(t,r){var e=et._toDouble(t),n=et._toDouble(r);return new et(Z.tinv(e,n))},U.tdist=function(t,r,e){var n=et._toDouble(t),i=et._toDouble(r),o=et._toInteger(e);return new et(Z.tdist(n,i,o))},U.tinv2=function(t,r){var e=et._toDouble(t),n=et._toDouble(r);return new et(Z.tinv2(e,n))},U.chi2pdf=function(t,r){var e=et._toDouble(t),n=et._toDouble(r);return new et(Z.chi2pdf(e,n))},U.chi2cdf=function(t,r){var e=et._toDouble(t),n=et._toDouble(r);return new et(Z.chi2cdf(e,n))},U.chi2inv=function(t,r){var e=et._toDouble(t),n=et._toDouble(r);return new et(Z.chi2inv(e,n))},U.fpdf=function(t,r,e){var n=et._toDouble(t),i=et._toDouble(r),o=et._toDouble(e);return new et(Z.fpdf(n,i,o))},U.fcdf=function(t,r,e){var n=et._toDouble(t),i=et._toDouble(r),o=et._toDouble(e);return new et(Z.fcdf(n,i,o))},U.finv=function(t,r,e){var n=et._toDouble(t),i=et._toDouble(r),o=et._toDouble(e);return new et(Z.finv(n,i,o))};function H(){}H.gammaln=function(t){return K._toMatrix(t).cloneMatrixDoEachCalculation(function(t){return U.gammaln(t)})},H.gamma=function(t){return K._toMatrix(t).cloneMatrixDoEachCalculation(function(t){return U.gamma(t)})},H.gammainc=function(t,r,e){var n=K._toMatrix(t),i=K._toDouble(r),o=q(e)?e:"lower";return n.cloneMatrixDoEachCalculation(function(t){return U.gammainc(t,i,o)})},H.gampdf=function(t,r,e){var n=K._toMatrix(t),i=K._toDouble(r),o=K._toDouble(e);return n.cloneMatrixDoEachCalculation(function(t){return U.gampdf(t,i,o)})},H.gamcdf=function(t,r,e){var n=K._toMatrix(t),i=K._toDouble(r),o=K._toDouble(e);return n.cloneMatrixDoEachCalculation(function(t){return U.gamcdf(t,i,o)})},H.gaminv=function(t,r,e){var n=K._toMatrix(t),i=K._toDouble(r),o=K._toDouble(e);return n.cloneMatrixDoEachCalculation(function(t){return U.gaminv(t,i,o)})},H.beta=function(t,r){var e=K._toMatrix(t),n=K._toDouble(r);return e.cloneMatrixDoEachCalculation(function(t){return U.beta(t,n)})},H.betainc=function(t,r,e,n){var i=K._toMatrix(t),o=K._toDouble(r),a=K._toDouble(e),u=q(n)?n:"lower";return i.cloneMatrixDoEachCalculation(function(t){return U.betainc(t,o,a,u)})},H.betacdf=function(t,r,e){var n=K._toMatrix(t),i=K._toDouble(r),o=K._toDouble(e);return n.cloneMatrixDoEachCalculation(function(t){return U.betacdf(t,i,o)})},H.betapdf=function(t,r,e){var n=K._toMatrix(t),i=K._toDouble(r),o=K._toDouble(e);return n.cloneMatrixDoEachCalculation(function(t){return U.betapdf(t,i,o)})},H.betainv=function(t,r,e){var n=K._toMatrix(t),i=K._toDouble(r),o=K._toDouble(e);return n.cloneMatrixDoEachCalculation(function(t){return U.betainv(t,i,o)})},H.factorial=function(t){return K._toMatrix(t).cloneMatrixDoEachCalculation(function(t){return U.factorial(t)})},H.nchoosek=function(t,r){var e=K._toMatrix(t),n=K._toDouble(r);return e.cloneMatrixDoEachCalculation(function(t){return U.nchoosek(t,n)})},H.erf=function(t){return K._toMatrix(t).cloneMatrixDoEachCalculation(function(t){return U.erf(t)})},H.erfc=function(t){return K._toMatrix(t).cloneMatrixDoEachCalculation(function(t){return U.erfc(t)})},H.erfinv=function(t){return K._toMatrix(t).cloneMatrixDoEachCalculation(function(t){return U.erfinv(t)})},H.erfcinv=function(t){return K._toMatrix(t).cloneMatrixDoEachCalculation(function(t){return U.erfcinv(t)})},H.normpdf=function(t,r,e){var n=K._toMatrix(t),i=void 0!==r?K._toDouble(r):0,o=void 0!==e?K._toDouble(e):1;return n.cloneMatrixDoEachCalculation(function(t){return U.normpdf(t,i,o)})},H.normcdf=function(t,r,e){var n=K._toMatrix(t),i=void 0!==r?K._toDouble(r):0,o=void 0!==e?K._toDouble(e):1;return n.cloneMatrixDoEachCalculation(function(t){return U.normcdf(t,i,o)})},H.norminv=function(t,r,e){var n=K._toMatrix(t),i=void 0!==r?K._toDouble(r):0,o=void 0!==e?K._toDouble(e):1;return n.cloneMatrixDoEachCalculation(function(t){return U.norminv(t,i,o)})},H.tpdf=function(t,r){var e=K._toMatrix(t),n=K._toDouble(r);return e.cloneMatrixDoEachCalculation(function(t){return U.tpdf(t,n)})},H.tcdf=function(t,r){var e=K._toMatrix(t),n=K._toDouble(r);return e.cloneMatrixDoEachCalculation(function(t){return U.tcdf(t,n)})},H.tinv=function(t,r){var e=K._toMatrix(t),n=K._toDouble(r);return e.cloneMatrixDoEachCalculation(function(t){return U.tinv(t,n)})},H.tdist=function(t,r,e){var n=K._toMatrix(t),i=K._toDouble(r),o=K._toDouble(e);return n.cloneMatrixDoEachCalculation(function(t){return U.tdist(t,i,o)})},H.tinv2=function(t,r){var e=K._toMatrix(t),n=K._toDouble(r);return e.cloneMatrixDoEachCalculation(function(t){return U.tinv2(t,n)})},H.chi2pdf=function(t,r){var e=K._toMatrix(t),n=K._toDouble(r);return e.cloneMatrixDoEachCalculation(function(t){return U.chi2pdf(t,n)})},H.chi2cdf=function(t,r){var e=K._toMatrix(t),n=K._toDouble(r);return e.cloneMatrixDoEachCalculation(function(t){return U.chi2cdf(t,n)})},H.chi2inv=function(t,r){var e=K._toMatrix(t),n=K._toDouble(r);return e.cloneMatrixDoEachCalculation(function(t){return U.chi2inv(t,n)})},H.fpdf=function(t,r,e){var n=K._toMatrix(t),i=K._toDouble(r),o=K._toDouble(e);return n.cloneMatrixDoEachCalculation(function(t){return U.fpdf(t,i,o)})},H.fcdf=function(t,r,e){var n=K._toMatrix(t),i=K._toDouble(r),o=K._toDouble(e);return n.cloneMatrixDoEachCalculation(function(t){return U.fcdf(t,i,o)})},H.finv=function(t,r,e){var n=K._toMatrix(t),i=K._toDouble(r),o=K._toDouble(e);return n.cloneMatrixDoEachCalculation(function(t){return U.finv(t,i,o)})};function j(t){this.size=t,this.inv_size=1/this.size,this.bit_size=Math.round(Math.log(this.size)/Math.log(2)),this.is_fast=1<<this.bit_size===this.size,this.bitrv=null,this.fft_re=new Array(this.size),this.fft_im=new Array(this.size);for(var r=-2*Math.PI/this.size,e=0,n=0,i=0;n<this.size;n++){this.fft_re[n]=Math.cos(i),this.fft_im[n]=Math.sin(i);var o=r+e,a=i+o;e=a-i-o,i=a}this.is_fast&&(this.bitrv=j.create_bit_reverse_table(this.bit_size))}j.bit_reverse_32=function(t){var r=4294967295&t;return r=(65535&(r=(16711935&(r=(252645135&(r=(858993459&(r=(1431655765&r)<<1|r>>1&1431655765))<<2|r>>2&858993459))<<4|r>>4&252645135))<<8|r>>8&16711935))<<16|r>>16&65535},j.create_bit_reverse_table=function(t){for(var r=1<<t,e=[],n=0;n<r;n++)e[n]=j.bit_reverse_32(n)>>>32-t;return e},j.prototype.delete=function(){delete this.size,delete this.inv_size,delete this.bit_size,delete this.is_fast,delete this.bitrv,delete this.fft_re,delete this.fft_im},j.prototype.fft=function(t,r){var e=new Array(this.size),n=new Array(this.size);if(this.is_fast){for(var i=0;i<this.size;i++)e[i]=t[this.bitrv[i]],n[i]=r[this.bitrv[i]];for(var o=1,a=this.size/2,u=2,s=1<<this.bit_size-1;0<s;s>>=1){for(var l=0;l<a;l++)for(var h=l*u,c=0,f=0;c<o;c++,h++,f+=s){var g=e[h+o]*this.fft_re[f]-n[h+o]*this.fft_im[f],m=n[h+o]*this.fft_re[f]+e[h+o]*this.fft_im[f];e[h+o]=e[h]-g,n[h+o]=n[h]-m,e[h]+=g,n[h]+=m}a/=2,u*=2,o*=2}}else if(Y.isContainsZero(r))for(var _=0;_<this.size;_++){e[_]=0;for(var p=n[_]=0,v=0;p<this.size;v=++p*_%this.size)e[_]+=t[p]*this.fft_re[v]-r[p]*this.fft_im[v],n[_]+=t[p]*this.fft_im[v]+r[p]*this.fft_re[v]}else for(var d=0;d<this.size;d++){e[d]=0;for(var w=n[d]=0,y=0;w<this.size;y=++w*d%this.size)e[d]+=t[w]*this.fft_re[y],n[d]+=t[w]*this.fft_im[y]}return{real:e,imag:n}},j.prototype.ifft=function(t,r){var e=new Array(this.size),n=new Array(this.size);if(this.is_fast){for(var i=0;i<this.size;i++)e[i]=t[this.bitrv[i]],n[i]=r[this.bitrv[i]];for(var o,a,u=1,s=this.size/2,l=2,h=1<<this.bit_size-1;0<h;h>>=1){for(var c=0;c<s;c++)for(var f=c*l,g=0,m=0;g<u;g++,f++,m+=h)o=e[f+u]*this.fft_re[m]+n[f+u]*this.fft_im[m],a=n[f+u]*this.fft_re[m]-e[f+u]*this.fft_im[m],e[f+u]=e[f]-o,n[f+u]=n[f]-a,e[f]+=o,n[f]+=a;s/=2,l*=2,u*=2}}else if(Y.isContainsZero(r))for(var _=0;_<this.size;_++){e[_]=0;for(var p=n[_]=0,v=0;p<this.size;v=_*++p%this.size)e[_]+=t[p]*this.fft_re[v]+r[p]*this.fft_im[v],n[_]+=-t[p]*this.fft_im[v]+r[p]*this.fft_re[v]}else for(var d=0;d<this.size;d++){e[d]=0;for(var w=n[d]=0,y=0;w<this.size;y=d*++w%this.size)e[d]+=t[w]*this.fft_re[y],n[d]+=-t[w]*this.fft_im[y]}for(var b=0;b<this.size;b++)e[b]*=this.inv_size,n[b]*=this.inv_size;return{real:e,imag:n}};function G(t,r){this.object=t,this.table=[],this.table_max=r}G.prototype.get=function(t){for(var r=0;r<this.table.length;r++)if(this.table[r].size===t){var e=this.table.splice(r,1)[0];return this.table.unshift(e),e}var n=new this.object(t);this.table.length===this.table_max&&this.table.pop().delete();return this.table.unshift(n),n};function k(t){this.size=t,this.dct_size=2*t,this.dct_re=new Array(this.size),this.dct_im=new Array(this.size);for(var r=1/Math.sqrt(this.size),e=r*Math.sqrt(2),n=0;n<this.size;n++){var i=-Math.PI*n/this.dct_size;this.dct_re[n]=Math.cos(i)*(0===n?r:e),this.dct_im[n]=Math.sin(i)*(0===n?r:e)}}var W=new G(j,4);k.prototype.delete=function(){delete this.size,delete this.dct_size,delete this.dct_re,delete this.dct_im},k.prototype.dct=function(t){for(var r=new Array(this.dct_size),e=new Array(this.dct_size),n=0;n<this.dct_size;n++)r[n]=n<this.size?t[n]:0,e[n]=0;for(var i=W.get(this.dct_size).fft(r,e),o=0;o<this.size;o++)r[o]=i.real[o]*this.dct_re[o]-i.imag[o]*this.dct_im[o];return r.splice(this.size),r},k.prototype.idct=function(t){for(var r=new Array(this.dct_size),e=new Array(this.dct_size),n=2*this.size,i=0;i<this.dct_size;i++)r[i]=i<this.size?n*t[i]*this.dct_re[i]:0,e[i]=i<this.size?n*t[i]*-this.dct_im[i]:0;var o=W.get(this.dct_size).ifft(r,e);return o.real.splice(this.size),o.real};var Q=new G(k,4),Y=function(){};Y.isContainsZero=function(t){for(var r=0;r<t.length;r++)if(0!==t[r])return!0;return!1},Y.fft=function(t,r){return W.get(t.length).fft(t,r)},Y.ifft=function(t,r){return W.get(t.length).ifft(t,r)},Y.dct=function(t){return Q.get(t.length).dct(t)},Y.idct=function(t){return Q.get(t.length).idct(t)},Y.powerfft=function(t,r){for(var e=t.length,n=Y.fft(t,r),i=new Array(e),o=0;o<e;o++)i[o]=n.real[o]*n.real[o]+n.imag[o]*n.imag[o];return i},Y.conv=function(t,r,e,n){var i=!1;if(t.length===e.length){i=!0;for(var o=0;o<t.length;o++)if(t[o]!==e[o]||r[o]!==n[o]){i=!1;break}}var a=t.length,u=2*a;if(1<<Math.round(Math.log(a)/Math.log(2))===a){if(i){for(var s=t.length,l=new Array(u),h=new Array(u),c=0;c<u;c++)l[c]=c<s?t[c]:0,h[c]=c<s?r[c]:0;for(var f=Y.fft(l,h),g=0;g<u;g++)l[g]=f.real[g]*f.real[g]-f.imag[g]*f.imag[g],h[g]=f.real[g]*f.imag[g]+f.imag[g]*f.real[g];var m=Y.ifft(l,h);return m.real.splice(u-1),m.imag.splice(u-1),m}if(t.length===e.length){for(var _=t.length,p=new Array(u),v=new Array(u),d=new Array(u),w=new Array(u),y=0;y<u;y++)p[y]=y<_?t[y]:0,v[y]=y<_?r[y]:0,d[y]=y<_?e[y]:0,w[y]=y<_?n[y]:0;for(var b=Y.fft(p,v),x=Y.fft(d,w),M=new Array(u),N=new Array(u),I=0;I<u;I++)M[I]=b.real[I]*x.real[I]-b.imag[I]*x.imag[I],N[I]=b.real[I]*x.imag[I]+b.imag[I]*x.real[I];var E=Y.ifft(M,N);return E.real.splice(u-1),E.imag.splice(u-1),E}}var O=!Y.isContainsZero(r);O=O&&!Y.isContainsZero(n);for(var D=new Array(t.length+e.length-1),A=new Array(t.length+e.length-1),T=0;T<D.length;T++)D[T]=0,A[T]=0;if(O)for(var S=0;S<e.length;S++)for(var C=0;C<t.length;C++)D[S+C]+=t[C]*e[S];else for(var R=0;R<e.length;R++)for(var P=0;P<t.length;P++)D[R+P]+=t[P]*e[R]-r[P]*n[R],A[R+P]+=t[P]*n[R]+r[P]*e[R];return{real:D,imag:A}},Y.xcorr=function(t,r,e,n){var i=!1;if(t.length===e.length){i=!0;for(var o=0;o<t.length;o++)if(t[o]!==e[o]||r[o]!==n[o]){i=!1;break}}if(t.length===e.length){var a=t.length,u=2*a;if(1<<Math.round(Math.log(a)/Math.log(2))===a){var s=null;if(i){for(var l=new Array(u),h=new Array(u),c=0;c<u;c++)l[c]=c<a?t[c]:0,h[c]=c<a?r[c]:0;var f=Y.powerfft(l,h);s=Y.ifft(f,h),l.pop(),h.pop();for(var g=0,m=a+1;g<l.length;g++,m++)u<=m&&(m=0),l[g]=s.real[m],h[g]=s.imag[m];return{real:l,imag:h}}for(var _=new Array(u),p=new Array(u),v=new Array(u),d=new Array(u),w=0;w<u;w++)_[w]=w<a?t[w]:0,p[w]=w<a?r[w]:0,v[w]=w<a?e[a-w-1]:0,d[w]=w<a?-n[a-w-1]:0;for(var y=Y.fft(_,p),b=Y.fft(v,d),x=new Array(u),M=new Array(u),N=0;N<u;N++)x[N]=y.real[N]*b.real[N]-y.imag[N]*b.imag[N],M[N]=y.real[N]*b.imag[N]+y.imag[N]*b.real[N];return(s=Y.ifft(x,M)).real.splice(u-1),s.imag.splice(u-1),s}}var I=!Y.isContainsZero(r);if(I=I&&!Y.isContainsZero(n),i){var E=t.length,O=2*E;if(I){for(var D=new Array(E),A=0;A<E;A++)for(var T=E-A,S=D[A]=0;S<T;S++)D[A]+=t[S]*e[S+A];for(var C=new Array(O-1),R=new Array(O-1),P=0,L=E-1;P<E;P++,L--)C[P]=D[L],C[E+P-1]=D[P];for(var F=0;F<R.length;F++)R[F]=0;return{real:C,imag:R}}}for(var V=new Array(e.length),z=new Array(e.length),B=0;B<e.length;B++)V[B]=e[e.length-B-1],z[B]=-n[e.length-B-1];var Z=Y.conv(t,r,V,z);if(t.length===e.length)return Z;for(var q=Math.abs(t.length-e.length),U=new Array(q),H=0;H<q;H++)U[H]=0;return t.length>e.length?{real:U.concat(Z.real),imag:U.concat(Z.imag)}:{real:Z.real.concat(U),imag:Z.imag.concat(U)}},Y.window=function(t,r,e){var a,n=void 0!==e?e:"symmetric",i=t.toLocaleLowerCase(),u=r,s=new Array(u);"symmetric"===n||0===n?a=function(t){return t/(u-1)*(2*Math.PI)}:"periodic"!==n&&0===n||(a=function(t){return t/u*(2*Math.PI)});function o(t,r,e,n,i){for(var o=0;o<u;o++)s[o]=t,s[o]-=r*Math.cos(1*a(o)),s[o]+=e*Math.cos(2*a(o)),s[o]-=n*Math.cos(3*a(o)),s[o]+=i*Math.cos(4*a(o))}switch(i){case"rectangle":o(1,0,0,0,0);break;case"hann":o(.5,.5,0,0,0);break;case"hamming":o(.54,.46,0,0,0);break;case"blackman":o(.42,.5,.08,0,0);break;case"blackmanharris":o(.35875,.48829,.14128,.01168,0);break;case"blackmannuttall":o(.3635819,.4891775,.1365995,.0106411,0);break;case"flattop":o(1,1.93,1.29,.388,.032);break;case"sin":for(var l=0;l<u;l++)s[l]=Math.sin(.5*a(l));break;case"vorbis":for(var h=0;h<u;h++){var c=Math.sin(.5*a(h));s[h]=Math.sin(.5*Math.PI*c*c)}}return s},Y.hann=function(t,r){return Y.window("hann",t,r)},Y.hamming=function(t,r){return Y.window("hamming",t,r)};function $(){}$.fft=function(t,r){var e=r&&r.dimension?r.dimension:"auto";return K._toMatrix(t).eachVector(function(t){for(var r=new Array(t.length),e=new Array(t.length),n=0;n<t.length;n++)r[n]=t[n].real,e[n]=t[n].imag;for(var i=Y.fft(r,e),o=new Array(t.length),a=0;a<t.length;a++)o[a]=new et([i.real[a],i.imag[a]]);return o},e)},$.ifft=function(t,r){var e=r&&r.dimension?r.dimension:"auto";return K._toMatrix(t).eachVector(function(t){for(var r=new Array(t.length),e=new Array(t.length),n=0;n<t.length;n++)r[n]=t[n].real,e[n]=t[n].imag;for(var i=Y.ifft(r,e),o=new Array(t.length),a=0;a<t.length;a++)o[a]=new et([i.real[a],i.imag[a]]);return o},e)},$.powerfft=function(t,r){var e=r&&r.dimension?r.dimension:"auto";return K._toMatrix(t).eachVector(function(t){for(var r=new Array(t.length),e=new Array(t.length),n=0;n<t.length;n++)r[n]=t[n].real,e[n]=t[n].imag;for(var i=Y.powerfft(r,e),o=new Array(t.length),a=0;a<t.length;a++)o[a]=new et(i[a]);return o},e)},$.dct=function(t,r){var e=r&&r.dimension?r.dimension:"auto",n=K._toMatrix(t);if(n.isComplex())throw"dct don't support complex numbers.";return n.eachVector(function(t){for(var r=new Array(t.length),e=0;e<t.length;e++)r[e]=t[e].real;for(var n=Y.dct(r),i=new Array(t.length),o=0;o<t.length;o++)i[o]=new et(n[o]);return i},e)},$.idct=function(t,r){var e=r&&r.dimension?r.dimension:"auto",n=K._toMatrix(t);if(n.isComplex())throw"idct don't support complex numbers.";return n.eachVector(function(t){for(var r=new Array(t.length),e=0;e<t.length;e++)r[e]=t[e].real;for(var n=Y.idct(r),i=new Array(t.length),o=0;o<t.length;o++)i[o]=new et(n[o]);return i},e)},$.fft2=function(t){return $.fft(t,{dimension:"both"})},$.ifft2=function(t){return $.ifft(t,{dimension:"both"})},$.dct2=function(t){return $.dct(t,{dimension:"both"})},$.idct2=function(t){return $.idct(t,{dimension:"both"})},$.conv=function(t,r){var e=K._toMatrix(t),n=K._toMatrix(r);if(e.isMatrix()||n.isMatrix())throw"conv don't support matrix numbers.";var i=new Array(e.length),o=new Array(e.length),a=new Array(n.length),u=new Array(n.length);if(e.isRow())for(var s=0;s<e.column_length;s++)i[s]=e.matrix_array[0][s].real,o[s]=e.matrix_array[0][s].imag;else for(var l=0;l<e.row_length;l++)i[l]=e.matrix_array[l][0].real,o[l]=e.matrix_array[l][0].imag;if(n.isRow())for(var h=0;h<n.column_length;h++)a[h]=n.matrix_array[0][h].real,u[h]=n.matrix_array[0][h].imag;else for(var c=0;c<n.row_length;c++)a[c]=n.matrix_array[c][0].real,u[c]=n.matrix_array[c][0].imag;for(var f=Y.conv(i,o,a,u),g=new Array(f.real.length),m=0;m<f.real.length;m++)g[m]=new et([f.real[m],f.imag[m]]);var _=new K([g]);return n.isRow()?_:_.transpose()},$.xcorr=function(t,r){var e=K._toMatrix(t);if(!r)return e.xcorr(e);var n=K._toMatrix(r);if(e.isMatrix()||n.isMatrix())throw"conv don't support matrix numbers.";var i=new Array(e.length),o=new Array(e.length),a=new Array(n.length),u=new Array(n.length);if(e.isRow())for(var s=0;s<e.column_length;s++)i[s]=e.matrix_array[0][s].real,o[s]=e.matrix_array[0][s].imag;else for(var l=0;l<e.row_length;l++)i[l]=e.matrix_array[l][0].real,o[l]=e.matrix_array[l][0].imag;if(n.isRow())for(var h=0;h<n.column_length;h++)a[h]=n.matrix_array[0][h].real,u[h]=n.matrix_array[0][h].imag;else for(var c=0;c<n.row_length;c++)a[c]=n.matrix_array[c][0].real,u[c]=n.matrix_array[c][0].imag;for(var f=Y.xcorr(i,o,a,u),g=new Array(f.real.length),m=0;m<f.real.length;m++)g[m]=new et([f.real[m],f.imag[m]]);var _=new K([g]);return e.isRow()?_:_.transpose()},$.window=function(t,r,e){var n=K._toInteger(r),i=Y.window(t,n,e);return new K(i).transpose()},$.hann=function(t,r){return $.window("hann",t,r)},$.hamming=function(t,r){return $.window("hamming",t,r)},$.fftshift=function(t,r){var e=K._toMatrix(t);if(e.isVector()){var n=Math.floor(e.length/2);return e.circshift(n,r)}var i=Math.floor(e.column_length/2),o=Math.floor(e.row_length/2);if(void 0!==r){var a=r.dimension;if("row"===a||1===a)return e.circshift(i,r);if("column"===a||2===a)return e.circshift(o,r)}return e.circshift(i,{dimension:"row"}).circshift(o,{dimension:"column"})};function J(){}J.toPositionArrayFromObject=function(t,r,e){if("string"==typeof t){var n=J.toArrayFromString(t);if(":"===n){for(var i=new Array(r),o=0;o<r;o++)i[o]=o+e;return i}if(n instanceof Array){for(var a=n,u=new Array(a.length),s=0;s<a.length;s++)u[s]=Math.trunc(a[s].real);return u}throw"toArrayFromString["+t+"]["+n+"]"}var l=t;if(l instanceof K||l instanceof et||"number"==typeof l||(l=K._toMatrix(l)),l instanceof K){if(!l.isVector())throw"getMatrix argument "+l;var h=l.length,c=new Array(l.length);if(l.isRow())for(var f=0;f<h;f++)c[f]=Math.trunc(l.matrix_array[0][f].real);else if(l.isColumn())for(var g=0;g<h;g++)c[g]=Math.trunc(l.matrix_array[g][0].real);return c}return[K._toInteger(l)]},J.match2=function(t,r){for(var e=[],n=t,i=0;i<1e3;i++){var o=n.match(r);if(null===o){n.length&&e.push([!1,n]);break}0<o.index&&e.push([!1,n.substr(0,o.index)]),e.push([!0,o[0]]),n=n.substr(o.index+o[0].length)}return e},J.trimBracket=function(t){return/^\[/.test(t)&&/\]$/.test(t)?t.substring(1,t.length-1):null},J.toMatrixArrayFromStringForArrayJSON=function(t){var r=[],e=t.match(/\[[^\]]+\]/g);null===e&&(e=[t]);for(var n=0;n<e.length;n++){for(var i=e[n],o=i.substring(1,i.length-1).split(","),a=[],u=0;u<o.length;u++){var s=o[u];a[u]=new et(s)}r[n]=a}return r},J.InterpolationCalculation=function(t,r,e,n){var i=t.compareTo(e),o=void 0===n||n;if(0===i)return[t];if(r.isZero())throw"IllegalArgumentException";if(r.isNegative()&&-1===i)throw"IllegalArgumentException";var a=[],u=t;a[0]=u;for(var s=1;s<65536;s++){if(u=u.add(r),o){if(e.compareTo(u)===i)break}else if(0<=e.compareTo(u)*i)break;a[s]=u}return a},J.toArrayFromMatch2String=function(t){for(var r=t,e=[],n=0;n<r.length;n++){var i=r[n];if(i[0])if(n<r.length-2&&!r[n+1][0]&&/:/.test(r[n+1][1])){var o=void 0,a=void 0,u=void 0;n<r.length-4&&!r[n+3][0]&&/:/.test(r[n+3][1])?(o=new et(i[1]),a=new et(r[n+2][1]),u=new et(r[n+4][1]),n+=4):(o=new et(i[1]),a=et.ONE,u=new et(r[n+2][1]),n+=2);for(var s=J.InterpolationCalculation(o,a,u,!0),l=0;l<s.length;l++)e.push(s[l])}else e.push(new et(i[1]))}return e},J.toArrayFromString=function(t){if(":"===t.trim())return":";var r=t.toLowerCase().replace(/infinity|inf/g,"1e100000"),e=new RegExp("("+/[+-]? *(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij]( *[+] *[- ]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan)))?/.source+")|("+/[+-]? *(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))( *[+-] *[- ]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij])?/.source+")","i");return J.toArrayFromMatch2String(J.match2(r,e))},J.toMatrixArrayFromStringForArraySPACE=function(t){for(var r=t.split(";"),e=new Array(r.length),n=0;n<r.length;n++)e[n]=J.toArrayFromString(r[n]);return e},J.toMatrixArrayFromStringInBracket=function(t){return/[[\]]/.test(t)?J.toMatrixArrayFromStringForArrayJSON(t):J.toMatrixArrayFromStringForArraySPACE(t)},J.toMatrixArrayFromString=function(t){var r=t.replace(/^\s*|\s*$/g,""),e=J.trimBracket(r);return e?J.toMatrixArrayFromStringInBracket(e):[[new et(t)]]},J.isCorrectMatrixArray=function(t){if(0===t.length)return!1;var r=t[0].length;if(0===r)return!1;for(var e=1;e<t.length;e++)if(t[e].length!==r)return!1;return!0};var K=function t(r){var e=null,n=!1;if(1!==arguments.length)throw"Matrix : Many arguments ["+arguments.length+"]";var i=r;if(i instanceof t){e=new Array(i.row_length);for(var o=0;o<i.row_length;o++){e[o]=new Array(i.column_length);for(var a=0;a<i.column_length;a++)e[o][a]=i.matrix_array[o][a]}}else if(i instanceof et)e=[[i]];else if(i instanceof Array){e=[];for(var u=0;u<i.length;u++){var s=i[u];if(s instanceof Array){for(var l=new Array(s.length),h=0;h<s.length;h++){var c=s[h];if(c instanceof et)l[h]=c;else if(c instanceof t){if(!c.isScalar())throw"Matrix in matrix";l[h]=c.scalar}else l[h]=new et(c)}e[u]=l}else if(0===u&&(e[0]=new Array(i.length)),s instanceof et)e[0][u]=s;else if(s instanceof t){if(!s.isScalar())throw"Matrix in matrix";e[0][u]=s.scalar}else e[0][u]=new et(s)}}else e="string"==typeof i?(n=!0,J.toMatrixArrayFromString(i)):i instanceof Object&&"doubleValue"in i?[[new et(i.doubleValue)]]:i instanceof Object?(n=!0,J.toMatrixArrayFromString(i.toString())):[[new et(i)]];if(n)for(var f=0;f<e.length;f++)":"===e[f]&&e.splice(f--,1);if(!J.isCorrectMatrixArray(e))throw console.log(e),"new Matrix IllegalArgumentException";this.matrix_array=e,this.row_length=this.matrix_array.length,this.column_length=this.matrix_array[0].length,this.string_cash=null},X={intValue:{configurable:!0},doubleValue:{configurable:!0},scalar:{configurable:!0},length:{configurable:!0},norm1:{configurable:!0},norm2:{configurable:!0}};K.create=function(t){return 1===arguments.length&&t instanceof K?t:new K(t)},K.valueOf=function(t){return K.create(t)},K._toMatrix=function(t){return t instanceof K?t:new K(t)},K._toComplex=function(t){if(t instanceof et)return t;var r=K._toMatrix(t);if(r.isScalar())return r.scalar;throw"not scalar. ["+t+"]"},K._toDouble=function(t){if("number"==typeof t)return t;var r=K._toComplex(t);if(r.isReal())return r.real;throw"not support complex numbers."},K._toInteger=function(t){return Math.trunc(K._toDouble(t))},K.prototype._clearCash=function(){this.string_cash&&delete this.string_cash},K.prototype.clone=function(){return new K(this.matrix_array)},K.prototype.toString=function(){if(this.string_cash)return this.string_cash;var n=Math.pow(10,9),o=!1,i=!1,a=0;this._each(function(t,r,e){t.isReal()||(o=!0),Number.isFinite(t.real)&&Math.abs(t.real)>=n&&(i=!0),Number.isFinite(t.imag)&&Math.abs(t.imag)>=n&&(i=!0),a=Math.max(a,t.getDecimalPosition())}),0<a&&(a=4);function u(t){var r=i?t.toExponential(4):t.toFixed(a);if(/inf/i.test(r))return t===Number.POSITIVE_INFINITY?"Inf":"-Inf";if(/nan/i.test(r))return"NaN";if(!i)return r;var e=r.split("e"),n=e[1];return 2===n.length?n=n.substr(0,1)+"00"+n.substr(1):3===n.length&&(n=n.substr(0,1)+"0"+n.substr(1)),e[0]+"e"+n}var s=0,l=[];this._each(function(t){var r={},e=t.real;if(r.re_sign=e<0?"-":" ",e=Math.abs(e),r.re_str=u(e),s=Math.max(s,r.re_str.length+1),o){var n=t.imag;r.im_sign=n<0?"-":"+",n=Math.abs(n),r.im_str=u(n),s=Math.max(s,r.im_str.length+1)}l.push(r)});function h(t,r){return"                                        ".substr(0,r-t.length)+t}var c=[],f=this;return this._each(function(t,r,e){var n=l.shift(),i=h(n.re_sign+n.re_str,s);o&&(i+=" "+n.im_sign+h(n.im_str,s)+"i"),c.push(i),c.push(e<f.column_length-1?" ":"\n")}),this.string_cash=c.join(""),this.string_cash},K.prototype.toOneLineString=function(){if(this.isScalar())return this.scalar.toString();for(var t="[ ",r=0;r<this.row_length;r++)for(var e=0;e<this.column_length;e++)t+=this.matrix_array[r][e].toString(),e<this.column_length-1?t+=", ":r<this.row_length-1&&(t+="; ");return t+=" ]"},K.prototype.equals=function(t,r){var e=this,n=K._toMatrix(t);if(e.row_length!==n.row_length||e.column_length!==n.column_length)return!1;if(1===e.row_length&&1===e.column_length)return e.scalar.equals(n.scalar,r);for(var i=e.matrix_array,o=n.matrix_array,a=0;a<this.row_length;a++)for(var u=0;u<this.column_length;u++)if(!i[a][u].equals(o[a][u],r))return!1;return!0},K.prototype.getNumberMatrixArray=function(){for(var t=new Array(this.row_length),r=0;r<this.row_length;r++){t[r]=new Array(this.column_length);for(var e=0;e<this.column_length;e++)t[r][e]=this.matrix_array[r][e].real}return t},K.prototype.getComplexMatrixArray=function(){for(var t=new Array(this.row_length),r=0;r<this.row_length;r++){t[r]=new Array(this.column_length);for(var e=0;e<this.column_length;e++)t[r][e]=this.matrix_array[r][e]}return t},K.prototype._each=function(t){for(var r=!1,e=0;e<this.row_length;e++)for(var n=0;n<this.column_length;n++){var i=t(this.matrix_array[e][n],e,n);void 0!==i&&(this.matrix_array[e][n]=i instanceof et?i:i instanceof K?i.scalar:new et(i),r=!0)}return r&&this._clearCash(),this},K.prototype.cloneMatrixDoEachCalculation=function(t){return this.clone()._each(t)},K.createMatrixDoEachCalculation=function(t,r,e){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";for(var n=K._toInteger(r),i=e?K._toInteger(e):n,o=new Array(n),a=0;a<n;a++){o[a]=new Array(i);for(var u=0;u<i;u++){var s=t(a,u);o[a][u]=void 0===s?et.ZERO:K._toComplex(s)}}return new K(o)},K.prototype.eachVectorAuto=function(t){if(this.isRow()){for(var r=new Array(this.row_length),e=0;e<this.column_length;e++)r[e]=this.matrix_array[0][e];return new K(t(r))}var n=new K(0);n._resize(1,this.column_length);for(var i=0;i<this.column_length;i++){for(var o=new Array(this.row_length),a=0;a<this.row_length;a++)o[a]=this.matrix_array[a][i];var u=t(o);n._resize(Math.max(n.row_length,u.length),n.column_length);for(var s=0;s<u.length;s++)n.matrix_array[s][i]=u[s]}return n},K.prototype.eachVectorBoth=function(t){var r=new K(0);r._resize(this.row_length,1);for(var e=0;e<this.row_length;e++){for(var n=new Array(this.column_length),i=0;i<this.column_length;i++)n[i]=this.matrix_array[e][i];var o=t(n);r._resize(r.row_length,Math.max(r.column_length,o.length));for(var a=0;a<o.length;a++)r.matrix_array[e][a]=o[a]}var u=new K(0);u._resize(1,r.column_length);for(var s=0;s<r.column_length;s++){for(var l=new Array(r.row_length),h=0;h<r.row_length;h++)l[h]=r.matrix_array[h][s];var c=t(l);u._resize(Math.max(u.row_length,c.length),u.column_length);for(var f=0;f<c.length;f++)u.matrix_array[f][s]=c[f]}return u},K.prototype.eachVectorRow=function(t){var r=new K(0);r._resize(this.row_length,1);for(var e=0;e<this.row_length;e++){for(var n=new Array(this.column_length),i=0;i<this.column_length;i++)n[i]=this.matrix_array[e][i];var o=t(n);r._resize(r.row_length,Math.max(r.column_length,o.length));for(var a=0;a<o.length;a++)r.matrix_array[e][a]=o[a]}return r},K.prototype.eachVectorColumn=function(t){var r=new K(0);r._resize(1,this.column_length);for(var e=0;e<this.column_length;e++){for(var n=new Array(this.row_length),i=0;i<this.row_length;i++)n[i]=this.matrix_array[i][e];var o=t(n);r._resize(Math.max(r.row_length,o.length),r.column_length);for(var a=0;a<o.length;a++)r.matrix_array[a][e]=o[a]}return r},K.prototype.eachVector=function(t,r){var e=void 0!==r?r:"auto";if("string"==typeof e?e=e.toLocaleLowerCase():"number"!=typeof e&&(e=K._toInteger(e)),"auto"===e||0===e)return this.eachVectorAuto(t);if("row"===e||1===e)return this.eachVectorRow(t);if("column"===e||2===e)return this.eachVectorColumn(t);if("both"===e||3===e)return this.eachVectorBoth(t);throw"eachVector argument "+r},K.prototype.getMatrix=function(t,r,e){void 0===e&&(e=!1);for(var n=e?1:0,i=J.toPositionArrayFromObject(t,this.row_length,n),o=J.toPositionArrayFromObject(r,this.column_length,n),a=this.matrix_array,u=new Array(i.length),s=0;s<i.length;s++){for(var l=new Array(o.length),h=0;h<o.length;h++)l[h]=a[i[s]-n][o[h]-n];u[s]=l}return new K(u)},K.prototype.setMatrix=function(t,r,e,n){void 0===n&&(n=!1);for(var i=n?1:0,o=J.toPositionArrayFromObject(t,this.row_length,i),a=J.toPositionArrayFromObject(r,this.column_length,i),u=new K(this).matrix_array,s=K._toMatrix(e),l=s.matrix_array,h=0;h<o.length;h++)for(var c=0;c<a.length;c++)u[o[h]-i][a[c]-i]=l[h%s.row_length][c%s.column_length];return new K(u)},K.prototype.getComplex=function(t,r){var e=null,n=null;return 1===arguments.length?e=K._toInteger(t):2===arguments.length&&(e=K._toInteger(t),n=K._toInteger(r)),this.isRow()?this.matrix_array[0][e]:this.isColumn()?this.matrix_array[e][0]:this.matrix_array[e][n]},X.intValue.get=function(){return Math.trunc(this.matrix_array[0][0].real)},X.doubleValue.get=function(){return this.matrix_array[0][0].real},X.scalar.get=function(){return this.matrix_array[0][0]},X.length.get=function(){return this.row_length>this.column_length?this.row_length:this.column_length},X.norm1.get=function(){return z.norm(this,1)},X.norm2.get=function(){return z.norm(this,2)},K.prototype.norm=function(t){return z.norm(this,t)},K.prototype.cond=function(t){return z.cond(this,t)},K.prototype.rcond=function(){return z.rcond(this)},K.prototype.rank=function(t){return z.rank(this,t)},K.prototype.trace=function(){return z.trace(this)},K.prototype.det=function(){return z.det(this)},K.memset=function(t,r,e){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";var n=K._toMatrix(t);if(n.isScalar()){var i=n.scalar;return K.createMatrixDoEachCalculation(function(){return i},r,e)}var o=n.matrix_array,a=n.row_length,u=n.column_length;return K.createMatrixDoEachCalculation(function(t,r){return o[t%a][r%u]},r,e)},K.eye=function(t,r){return K.createMatrixDoEachCalculation(function(t,r){return t===r?et.ONE:et.ZERO},t,r)},K.zeros=function(t,r){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return K.memset(et.ZERO,t,r)},K.ones=function(t,r){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return K.memset(et.ONE,t,r)},K.rand=function(t,r){return K.createMatrixDoEachCalculation(function(){return et.rand()},t,r)},K.randn=function(t,r){return K.createMatrixDoEachCalculation(function(){return et.randn()},t,r)},K.prototype.diag=function(){if(this.isVector()){var e=this;return K.createMatrixDoEachCalculation(function(t,r){return t===r?e.getComplex(t):et.ZERO},this.length)}for(var t=Math.min(this.row_length,this.column_length),r=new Array(t),n=0;n<t;n++)r[n]=new Array(1),r[n][0]=this.matrix_array[n][n];return new K(r)},K.prototype.isScalar=function(){return 1===this.row_length&&1==this.column_length},K.prototype.isRow=function(){return 1===this.row_length},K.prototype.isColumn=function(){return 1===this.column_length},K.prototype.isVector=function(){return 1===this.row_length||1===this.column_length},K.prototype.isMatrix=function(){return 1!==this.row_length&&1!==this.column_length},K.prototype.isSquare=function(){return this.row_length===this.column_length},K.prototype.isReal=function(r){var e=!0;return this._each(function(t){e&&t.isComplex(r)&&(e=!1)}),e},K.prototype.isComplex=function(t){return!this.isReal(t)},K.prototype.isZeros=function(t){var r=!0,e=t||1e-10;return this._each(function(t){r&&!t.isZero(e)&&(r=!1)}),r},K.prototype.isIdentity=function(t){var n=!0,i=t||1e-10;return this._each(function(t,r,e){n&&(r===e?t.isOne(i)||(n=!1):t.isZero(i)||(n=!1))}),n},K.prototype.isDiagonal=function(t){var n=!0,i=t||1e-10;return this._each(function(t,r,e){n&&r!==e&&!t.isZero(i)&&(n=!1)}),n},K.prototype.isTridiagonal=function(t){var n=!0,i=t||1e-10;return this._each(function(t,r,e){n&&1<Math.abs(r-e)&&!t.isZero(i)&&(n=!1)}),n},K.prototype.isRegular=function(t){if(!this.isSquare())return!1;var r=t||1e-10;return this.rank(r)===this.row_length},K.prototype.isOrthogonal=function(t){if(!this.isSquare())return!1;var r=t||1e-10;return this.mul(this.transpose()).isIdentity(r)},K.prototype.isUnitary=function(t){if(!this.isSquare())return!1;var r=t||1e-10;return this.mul(this.ctranspose()).isIdentity(r)},K.prototype.isSymmetric=function(t){if(!this.isSquare())return!1;for(var r=t||1e-10,e=0;e<this.row_length;e++)for(var n=e+1;n<this.column_length;n++)if(!this.matrix_array[e][n].equals(this.matrix_array[n][e],r))return!1;return!0},K.prototype.isHermitian=function(t){if(!this.isSquare())return!1;for(var r=t||1e-10,e=0;e<this.row_length;e++)for(var n=e;n<this.column_length;n++)if(e===n){if(!this.matrix_array[e][n].isReal(r))return!1}else if(!this.matrix_array[e][n].equals(this.matrix_array[n][e].conj(),r))return!1;return!0},K.prototype.isTriangleUpper=function(t){var n=!0,i=t||1e-10;return this._each(function(t,r,e){n&&e<r&&!t.isZero(i)&&(n=!1)}),n},K.prototype.isTriangleLower=function(t){var n=!0,i=t||1e-10;return this._each(function(t,r,e){n&&r<e&&!t.isZero(i)&&(n=!1)}),n},K.prototype.isPermutation=function(t){if(!this.isSquare())return!1;for(var r=t||1e-10,e=new Array(this.row_length),n=new Array(this.column_length),i=0;i<this.row_length;i++)for(var o=0;o<this.column_length;o++){var a=this.matrix_array[i][o];if(a.isOne(r)){if(e[i]||n[o])return!1;e[i]=1,n[o]=1}else if(!a.isZero(r))return!1}for(var u=0;u<this.row_length;u++)if(void 0===e[u]||void 0===n[u])return!1;return!0},K.prototype.size=function(){return new K([[this.row_length,this.column_length]])},K.prototype.compareTo=function(t,r){var e=this,n=K._toMatrix(t);if(e.isScalar()&&n.isScalar())return e.scalar.compareTo(n.scalar,r);var i=e.matrix_array,o=n.matrix_array,a=Math.max(e.row_length,n.row_length),u=Math.max(e.column_length,n.column_length);return K.createMatrixDoEachCalculation(function(t,r){return i[t%e.row_length][r%e.column_length].compareTo(o[t%n.row_length][r%n.column_length])},a,u)},K.prototype.add=function(t){var e=this,n=K._toMatrix(t);if(e.row_length!==n.row_length&&e.column_length!==n.column_length)throw"Matrix size does not match";var i=e.matrix_array,o=n.matrix_array,r=Math.max(e.row_length,n.row_length),a=Math.max(e.column_length,n.column_length);return K.createMatrixDoEachCalculation(function(t,r){return i[t%e.row_length][r%e.column_length].add(o[t%n.row_length][r%n.column_length])},r,a)},K.prototype.sub=function(t){var e=this,n=K._toMatrix(t);if(e.row_length!==n.row_length&&e.column_length!==n.column_length)throw"Matrix size does not match";var i=e.matrix_array,o=n.matrix_array,r=Math.max(e.row_length,n.row_length),a=Math.max(e.column_length,n.column_length);return K.createMatrixDoEachCalculation(function(t,r){return i[t%e.row_length][r%e.column_length].sub(o[t%n.row_length][r%n.column_length])},r,a)},K.prototype.mul=function(t){var r=this,e=K._toMatrix(t),n=r.matrix_array,i=e.matrix_array;if(r.isScalar()&&e.isScalar())return new K(r.scalar.mul(e.scalar));if(r.isScalar()){for(var o=new Array(e.row_length),a=0;a<e.row_length;a++){o[a]=new Array(e.column_length);for(var u=0;u<e.column_length;u++)o[a][u]=r.scalar.mul(i[a][u])}return new K(o)}if(e.isScalar()){for(var s=new Array(r.row_length),l=0;l<r.row_length;l++){s[l]=new Array(r.column_length);for(var h=0;h<r.column_length;h++)s[l][h]=n[l][h].mul(e.scalar)}return new K(s)}if(r.column_length!==e.row_length)throw"Matrix size does not match";for(var c=new Array(r.row_length),f=0;f<r.row_length;f++){c[f]=new Array(e.column_length);for(var g=0;g<e.column_length;g++){for(var m=et.ZERO,_=0;_<r.column_length;_++)m=m.add(n[f][_].mul(i[_][g]));c[f][g]=m}}return new K(c)},K.prototype.div=function(t){var r=this,e=K._toMatrix(t),n=r.matrix_array;if(r.isScalar()&&e.isScalar())return new K(r.scalar.div(e.scalar));if(e.isScalar()){for(var i=new Array(r.row_length),o=0;o<r.row_length;o++){i[o]=new Array(r.column_length);for(var a=0;a<r.column_length;a++)i[o][a]=n[o][a].div(e.scalar)}return new K(i)}if(e.row_length===e.column_length){return 1e-10<e.det().scalar.norm?this.mul(e.inv()):this.mul(e.pinv())}if(r.column_length!==e.column_length)throw"Matrix size does not match";throw"warning"},K.prototype.pow=function(t){if(!this.isSquare())throw"not square "+this;var r,e,n=K._toInteger(t);if(n<0)throw"error negative number "+n;for(r=this.clone(),e=K.eye(this.length);0!==n;)0!=(1&n)&&(e=e.mul(r)),r=r.mul(r),n>>>=1;return e},K.prototype.dotmul=function(t){var e=this,n=K._toMatrix(t);if(!e.isScalar()&&!n.isScalar()&&e.row_length!==n.row_length&&e.column_length!==n.column_length)throw"Matrix size does not match";var i=e.matrix_array,o=n.matrix_array,r=Math.max(e.row_length,n.row_length),a=Math.max(e.column_length,n.column_length);return K.createMatrixDoEachCalculation(function(t,r){return i[t%e.row_length][r%e.column_length].mul(o[t%n.row_length][r%n.column_length])},r,a)},K.prototype.dotdiv=function(t){var e=this,n=K._toMatrix(t);if(!e.isScalar()&&!n.isScalar()&&e.row_length!==n.row_length&&e.column_length!==n.column_length)throw"Matrix size does not match";var i=e.matrix_array,o=n.matrix_array,r=Math.max(e.row_length,n.row_length),a=Math.max(e.column_length,n.column_length);return K.createMatrixDoEachCalculation(function(t,r){return i[t%e.row_length][r%e.column_length].div(o[t%n.row_length][r%n.column_length])},r,a)},K.prototype.dotinv=function(){var e=this.matrix_array;return K.createMatrixDoEachCalculation(function(t,r){return e[t][r].inv()},this.row_length,this.column_length)},K.prototype.dotpow=function(t){var e=this,n=K._toMatrix(t);if(!e.isScalar()&&!n.isScalar()&&e.row_length!==n.row_length&&e.column_length!==n.column_length)throw"Matrix size does not match";var i=e.matrix_array,o=n.matrix_array,r=Math.max(e.row_length,n.row_length),a=Math.max(e.column_length,n.column_length);return K.createMatrixDoEachCalculation(function(t,r){return i[t%e.row_length][r%e.column_length].pow(o[t%n.row_length][r%n.column_length])},r,a)},K.prototype.nmul=function(t){return this.dotmul(t)},K.prototype.ndiv=function(t){return this.dotdiv(t)},K.prototype.ninv=function(){return this.dotinv()},K.prototype.npow=function(t){return this.dotpow(t)},K.prototype.real=function(){return this.cloneMatrixDoEachCalculation(function(t){return new et(t.real)})},K.prototype.imag=function(){return this.cloneMatrixDoEachCalculation(function(t){return new et(t.imag)})},K.prototype.arg=function(){return this.cloneMatrixDoEachCalculation(function(t){return new et(t.arg)})},K.prototype.sign=function(){return this.cloneMatrixDoEachCalculation(function(t){return new et(t.sign())})},K.prototype.testInteger=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isInteger(r)?et.ONE:et.ZERO})},K.prototype.testComplexInteger=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplexInteger(r)?et.ONE:et.ZERO})},K.prototype.testZero=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isZero(r)?et.ONE:et.ZERO})},K.prototype.testOne=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isOne(r)?et.ONE:et.ZERO})},K.prototype.testComplex=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplex(r)?et.ONE:et.ZERO})},K.prototype.testReal=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isReal(r)?et.ONE:et.ZERO})},K.prototype.testNaN=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNaN()?et.ONE:et.ZERO})},K.prototype.testPositive=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isPositive()?et.ONE:et.ZERO})},K.prototype.testNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNegative()?et.ONE:et.ZERO})},K.prototype.testNotNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNotNegative()?et.ONE:et.ZERO})},K.prototype.testInfinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isInfinite()?et.ONE:et.ZERO})},K.prototype.testFinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isFinite()?et.ONE:et.ZERO})},K.prototype.abs=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.abs()})},K.prototype.conj=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.conj()})},K.prototype.negate=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.negate()})},K.prototype.sqrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sqrt()})},K.prototype.log=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log()})},K.prototype.exp=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.exp()})},K.prototype.sin=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sin()})},K.prototype.cos=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cos()})},K.prototype.tan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.tan()})},K.prototype.atan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.atan()})},K.prototype.atan2=function(t){var r=K._toComplex(t);return this.cloneMatrixDoEachCalculation(function(t){return t.atan2(r)})},K.prototype.floor=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.floor()})},K.prototype.ceil=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.ceil()})},K.prototype.round=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.round()})},K.prototype.fix=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fix()})},K.prototype.fract=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fract()})},K.prototype.sinc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sinc()})},K.prototype._rot90=function(t){var r=K._toInteger(t),e=1;if(1===arguments.length&&(e=(r%4+4)%4),0===e)return this;for(var n=new Array(this.row_length),i=0;i<this.row_length;i++){n[i]=new Array(this.column_length);for(var o=0;o<this.column_length;o++)n[i][o]=this.matrix_array[i][o]}var a=this.matrix_array;if(1===e){a.splice(this.column_length);for(var u=0;u<this.column_length;u++){u<this.row_length?a[u].splice(this.row_length):a[u]=new Array(this.row_length);for(var s=0;s<this.row_length;s++)a[u][s]=n[this.row_length-s-1][u]}}else if(2===e)for(var l=0;l<this.row_length;l++)for(var h=0;h<this.column_length;h++)a[l][h]=n[this.row_length-l-1][this.column_length-h-1];else if(3===e){a.splice(this.column_length);for(var c=0;c<this.column_length;c++){c<this.row_length?a[c].splice(this.row_length):a[c]=new Array(this.row_length);for(var f=0;f<this.row_length;f++)a[c][f]=n[f][this.column_length-c-1]}}return this.row_length=a.length,this.column_length=a[0].length,this._clearCash(),this},K.prototype.rot90=function(t){return this.clone()._rot90(t)},K.prototype._resize=function(t,r){var e=K._toInteger(t),n=K._toInteger(r);if(e===this.row_length&&n===this.column_length)return this;if(e<=0||n<=0)throw"_resize";for(var i=Math.max(this.row_length,e),o=Math.max(this.column_length,n),a=this.matrix_array,u=0;u<i;u++){u>=this.row_length&&(a[u]=new Array(o));for(var s=0;s<o;s++)(u>=this.row_length||s>=this.column_length)&&(a[u][s]=et.ZERO)}if(this.row_length>e&&a.splice(e),this.column_length>n)for(var l=0;l<a.length;l++)a[l].splice(n);return this.row_length=e,this.column_length=n,this._clearCash(),this},K.prototype.resize=function(t,r){return this.clone()._resize(t,r)},K.prototype._deleteRow=function(t){var r=K._toInteger(t);if(1===this.row_length||this.row_length<=r)throw"_deleteRow";return this.matrix_array.splice(r,1),this.row_length--,this._clearCash(),this},K.prototype._deleteColumn=function(t){var r=K._toInteger(t);if(1===this.column_length||this.column_length<=r)throw"_deleteColumn";for(var e=0;e<this.row_length;e++)this.matrix_array[e].splice(r,1);return this.column_length--,this._clearCash(),this},K.prototype.deleteRow=function(t){return this.clone()._deleteRow(t)},K.prototype.deleteColumn=function(t){return this.clone()._deleteColumn(t)},K.prototype._exchangeRow=function(t,r){var e=K._toInteger(t),n=K._toInteger(r);if(1===this.row_length||this.row_length<=e||this.row_length<=n)throw"_exchangeRow";if(e===n)return this;var i=this.matrix_array[e];return this.matrix_array[e]=this.matrix_array[n],this.matrix_array[n]=i,this._clearCash(),this},K.prototype._exchangeColumn=function(t,r){var e=K._toInteger(t),n=K._toInteger(r);if(1===this.column_length||this.column_length<=e||this.column_length<=n)throw"_exchangeColumn";if(e===n)return this;for(var i=0;i<this.row_length;i++){var o=this.matrix_array[i][e];this.matrix_array[i][e]=this.matrix_array[i][n],this.matrix_array[i][n]=o}return this._clearCash(),this},K.prototype.exchangeRow=function(t,r){return this.clone()._exchangeRow(t,r)},K.prototype.exchangeColumn=function(t,r){return this.clone()._exchangeColumn(t,r)},K.prototype._concatRight=function(t){var r=K._toMatrix(t);if(this.row_length!=r.row_length)throw"_concatRight";for(var e=0;e<this.row_length;e++)for(var n=0;n<r.column_length;n++)this.matrix_array[e].push(r.matrix_array[e][n]);return this.column_length+=r.column_length,this._clearCash(),this},K.prototype._concatBottom=function(t){var r=K._toMatrix(t);if(this.column_length!=r.column_length)throw"_concatBottom";for(var e=0;e<r.row_length;e++)this.matrix_array.push(r.matrix_array[e]);return this.row_length+=r.row_length,this._clearCash(),this},K.prototype.concatRight=function(t){return this.clone()._concatRight(t)},K.prototype.concatBottom=function(t){return this.clone()._concatBottom(t)},K.prototype.clip=function(t,r){var o=K._toMatrix(t),a=K._toMatrix(r),u=o.matrix_array,s=a.matrix_array;return this.cloneMatrixDoEachCalculation(function(t,r,e){var n=u[r%o.row_length][e%o.column_length],i=s[r%a.row_length][e%a.column_length];return t.clip(n,i)})},K.arange=function(t,r,e){var n=void 0!==r?K._toComplex(t):et.ZERO,i=void 0!==r?K._toComplex(r):K._toComplex(t),o=void 0!==e?K._toComplex(e):et.ONE;return new K(J.InterpolationCalculation(n,o,i,!1))},K.prototype.circshift=function(t,r){var i=K._toInteger(t),e=r&&r.dimension?r.dimension:"auto";return this.eachVector(function(t){for(var r=new Array(t.length),e=(-i%t.length+t.length)%t.length,n=0;n<t.length;n++)r[n]=t[e++],e===t.length&&(e=0);return r},e)},K.prototype.roll=function(t,r){return this.circshift(t,r)},K.prototype.reshape=function(t,r){var e=K._toInteger(t),n=K._toInteger(r),i=this.row_length*this.column_length,o=e*n;if(i!=o)throw"reshape error. (this_size !== new_size)->("+i+" !== "+o+")";for(var a=this.matrix_array,u=0,s=0,l=new Array(e),h=0;h<e;h++){l[h]=new Array(n);for(var c=0;c<n;c++)l[h][c]=a[s][u],++u===this.column_length&&(u=0,s++)}return new K(l)},K.prototype.fliplr=function(){return this.flip({dimension:"row"})},K.prototype.flipud=function(){return this.flip({dimension:"column"})},K.prototype.flip=function(t){var r=t&&t.dimension?t.dimension:"auto";return this.eachVector(function(t){for(var r=new Array(t.length),e=0,n=t.length-1;e<t.length;e++,n--)r[e]=t[n];return r},r)},K.prototype.indexsort=function(t){var r=K._toMatrix(t);if(r.isMatrix())throw"argsort error. argsort is not vector. ("+r.toOneLineString+")";var e=!1,n=null,i=null;if(r.isRow()){if(this.column_length!==r.column_length)throw"argsort error. (this_size !== new_size)->("+this.column_length+" !== "+r.column_length+")";e=!0,n=this.transpose().matrix_array,i=r.matrix_array[0]}if(r.isColumn()){if(this.row_length!==r.row_length)throw"argsort error. (this_size !== new_size)->("+this.row_length+" !== "+r.row_length+")";n=this.matrix_array,i=r.transpose().matrix_array[0]}for(var o=new Array(i.length),a=0;a<i.length;a++)o[a]={index:i[a],data:n[a]};var l=[],h=function(t,r,e,n){if(r<e){var i=Math.floor((r+e)/2);h(t,r,i,n),h(t,i+1,e,n);var o,a,u,s=0;for(o=r;o<=i;o++)l[s++]=t[o];for(o=i+1,a=0,u=r;o<=e&&a<s;)0<=n(t[o],l[a])?t[u++]=l[a++]:t[u++]=t[o++];for(;a<s;)t[u++]=l[a++]}return!0};h(o,0,o.length-1,function(t,r){return t.index.compareTo(r.index)});for(var u=new Array(i.length),s=0;s<i.length;s++)u[s]=o[s].data;var c=new K(u);return e?c.transpose():c},K.prototype.transpose=function(){for(var t=new Array(this.column_length),r=0;r<this.column_length;r++){t[r]=new Array(this.row_length);for(var e=0;e<this.row_length;e++)t[r][e]=this.matrix_array[e][r]}return new K(t)},K.prototype.ctranspose=function(){return this.transpose().conj()},K.prototype.T=function(){return this.ctranspose()},K.prototype.inner=function(t,r){return void 0===r&&(r=1),z.inner(this,t,r)},K.prototype.lup=function(){return z.lup(this)},K.prototype.lu=function(){return z.lu(this)},K.prototype.linsolve=function(t){return z.linsolve(this,t)},K.prototype.qr=function(){return z.qr(this)},K.prototype.tridiagonalize=function(){return z.tridiagonalize(this)},K.prototype.eig=function(){return z.eig(this)},K.prototype.svd=function(){return z.svd(this)},K.prototype.inv=function(){return z.inv(this)},K.prototype.pinv=function(){return z.pinv(this)},K.prototype.gammaln=function(){return H.gammaln(this)},K.prototype.gamma=function(){return H.gamma(this)},K.prototype.gammainc=function(t,r){return H.gammainc(this,t,r)},K.prototype.gampdf=function(t,r){return H.gampdf(this,t,r)},K.prototype.gamcdf=function(t,r){return H.gampdf(this,t,r)},K.prototype.gaminv=function(t,r){return H.gaminv(this,t,r)},K.prototype.beta=function(t){return H.beta(this,t)},K.prototype.betainc=function(t,r,e){return H.betainc(this,t,r,e)},K.prototype.betacdf=function(t,r){return H.betacdf(this,t,r)},K.prototype.betapdf=function(t,r){return H.betapdf(this,t,r)},K.prototype.betainv=function(t,r){return H.betainv(this,t,r)},K.prototype.factorial=function(){return H.factorial(this)},K.prototype.nchoosek=function(t){return H.nchoosek(this,t)},K.prototype.erf=function(){return H.erf(this)},K.prototype.erfc=function(){return H.erfc(this)},K.prototype.erfinv=function(){return H.erfinv(this)},K.prototype.erfcinv=function(){return H.erfcinv(this)},K.prototype.normpdf=function(t,r){return void 0===t&&(t=0),void 0===r&&(r=1),H.normpdf(this,t,r)},K.prototype.normcdf=function(t,r){return void 0===t&&(t=0),void 0===r&&(r=1),H.normcdf(this,t,r)},K.prototype.norminv=function(t,r){return void 0===t&&(t=0),void 0===r&&(r=1),H.norminv(this,t,r)},K.prototype.tpdf=function(t){return H.tpdf(this,t)},K.prototype.tcdf=function(t){return H.tcdf(this,t)},K.prototype.tinv=function(t){return H.tinv(this,t)},K.prototype.tdist=function(t,r){return H.tdist(this,t,r)},K.prototype.tinv2=function(t){return H.tinv2(this,t)},K.prototype.chi2pdf=function(t){return H.chi2pdf(this,t)},K.prototype.chi2cdf=function(t){return H.chi2cdf(this,t)},K.prototype.chi2inv=function(t){return H.chi2inv(this,t)},K.prototype.fpdf=function(t,r){return H.fpdf(this,t,r)},K.prototype.fcdf=function(t,r){return H.fcdf(this,t,r)},K.prototype.finv=function(t,r){return H.finv(this,t,r)},K.prototype.max=function(t){return B.max(this,t)},K.prototype.min=function(t){return B.min(this,t)},K.prototype.sum=function(t){return B.sum(this,t)},K.prototype.mean=function(t){return B.mean(this,t)},K.prototype.prod=function(t){return B.prod(this,t)},K.prototype.geomean=function(t){return B.geomean(this,t)},K.prototype.median=function(t){return B.median(this,t)},K.prototype.mode=function(t){return B.mode(this,t)},K.prototype.moment=function(t,r){return B.moment(this,t,r)},K.prototype.var=function(t){return B.var(this,t)},K.prototype.std=function(t){return B.std(this,t)},K.prototype.mad=function(t,r){return B.mad(this,t,r)},K.prototype.skewness=function(t){return B.skewness(this,t)},K.prototype.cov=function(t){return B.cov(this,t)},K.prototype.normalize=function(t){return B.normalize(this,t)},K.prototype.corrcoef=function(t){return B.corrcoef(this,t)},K.prototype.sort=function(t,r){return B.sort(this,t,r)},K.prototype.fft=function(t){return $.fft(this,t)},K.prototype.ifft=function(t){return $.ifft(this,t)},K.prototype.powerfft=function(t){return $.powerfft(this,t)},K.prototype.dct=function(t){return $.dct(this,t)},K.prototype.idct=function(t){return $.idct(this,t)},K.prototype.fft2=function(){return $.fft2(this)},K.prototype.ifft2=function(){return $.ifft2(this)},K.prototype.dct2=function(){return $.dct2(this)},K.prototype.idct2=function(){return $.idct2(this)},K.prototype.conv=function(t){return $.conv(this,t)},K.prototype.xcorr=function(t){return $.xcorr(this,t)},K.window=function(t,r,e){return $.window(t,r,e)},K.hann=function(t,r){return $.hann(t,r)},K.hamming=function(t,r){return $.hamming(t,r)},K.prototype.fftshift=function(t){return $.fftshift(this,t)},Object.defineProperties(K.prototype,X);function tt(){}var rt=new v;tt.ToComplexFromString=function(t){var r=t.replace(/\s/g,"").toLowerCase();if(r=r.replace(/infinity|inf/g,"1e100000"),!/[ij]/.test(r))return{real:parseFloat(r),imag:0};var e,n=0,i=0;return(e=r.match(/[+-]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))($|[+-])/))&&(n=parseFloat(e[0])),(e=r.match(/[+-]?(([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)|(nan))?[ij]/))&&(e=e[0].substring(0,e[0].length-1),i=/^[-+]$/.test(e)||0===e.length?"-"===e?-1:1:parseFloat(e)),{real:n,imag:i}};var et=function t(r){if(1!==arguments.length)throw"Complex Many arguments : "+arguments.length;var e=r;if(e instanceof t)this._re=e._re,this._im=e._im;else if("number"==typeof e)this._re=e,this._im=0;else if("string"==typeof e){var n=tt.ToComplexFromString(e);this._re=n.real,this._im=n.imag}else if(e instanceof Array){if(2!==e.length)throw"Complex Unsupported argument "+arguments;this._re=e[0],this._im=e[1]}else if("doubleValue"in e)this._re=e.doubleValue,this._im=0;else if("_re"in e&&"_im"in e)this._re=e._re,this._im=e._im;else{if(!(e instanceof Object))throw"Complex Unsupported argument "+arguments;var i=tt.ToComplexFromString(e.toString());this._re=i.real,this._im=i.imag}},nt={intValue:{configurable:!0},doubleValue:{configurable:!0},real:{configurable:!0},imag:{configurable:!0},norm:{configurable:!0},arg:{configurable:!0}},it={ONE:{configurable:!0},TWO:{configurable:!0},TEN:{configurable:!0},ZERO:{configurable:!0},MINUS_ONE:{configurable:!0},I:{configurable:!0},PI:{configurable:!0},QUARTER_PI:{configurable:!0},HALF_PI:{configurable:!0},TWO_PI:{configurable:!0},E:{configurable:!0},LN2:{configurable:!0},LN10:{configurable:!0},LOG2E:{configurable:!0},LOG10E:{configurable:!0},SQRT2:{configurable:!0},SQRT1_2:{configurable:!0},HALF:{configurable:!0},POSITIVE_INFINITY:{configurable:!0},NEGATIVE_INFINITY:{configurable:!0},NaN:{configurable:!0}};et.create=function(t){return t instanceof et?t:new et(t)},et.valueOf=function(t){return et.create(t)},et._toComplex=function(t){return t instanceof et?t:t instanceof K?K._toComplex(t):new et(t)},et._toDouble=function(t){if("number"==typeof t)return t;var r=et._toComplex(t);if(r.isReal())return r.real;throw"not support complex numbers.["+t+"]"},et._toInteger=function(t){return Math.trunc(et._toDouble(t))},nt.intValue.get=function(){return Math.trunc(this.real)},nt.doubleValue.get=function(){return this.real},et.prototype.clone=function(){return this},et.prototype.toString=function(){function t(t){var r=t.toPrecision(6);if(-1!==r.indexOf("."))r=(r=r.replace(/\.?0+$/,"")).replace(/\.?0+e/,"e");else{if(/inf/i.test(r))return t===Number.POSITIVE_INFINITY?"Inf":"-Inf";if(/nan/i.test(r))return"NaN"}return r}return this.isReal()?t(this._re):0===this._re?t(this._im)+"i":0<=this._im||Number.isNaN(this._im)?t(this._re)+" + "+t(this._im)+"i":t(this._re)+" - "+t(-this._im)+"i"},et.rand=function(){return new et(rt.nextDouble())},et.randn=function(){return new et(rt.nextGaussian())},nt.real.get=function(){return this._re},nt.imag.get=function(){return this._im},nt.norm.get=function(){return 0===this._im?Math.abs(this._re):0===this._re?Math.abs(this._im):Math.sqrt(this._re*this._re+this._im*this._im)},nt.arg.get=function(){return 0===this._im?0<=this._re?0:Math.PI:0===this._re?Math.PI*(0<=this._im?.5:-.5):Math.atan2(this._im,this._re)},et.prototype.getDecimalPosition=function(){function t(t){if(!Number.isFinite(t))return 0;for(var r=t,e=0,n=0;n<20&&!(Math.abs(r-Math.round(r))<=Number.EPSILON);n++)r*=10,e++;return e}return Math.max(t(this.real),t(this.imag))},et.prototype.sign=function(){return 0===this._im?0===this._re?new et(0):new et(0<this._re?1:-1):this.div(this.norm)},et.prototype.add=function(t){var r=new et(t);return r._re=this._re+r._re,r._im=this._im+r._im,r},et.prototype.sub=function(t){var r=new et(t);return r._re=this._re-r._re,r._im=this._im-r._im,r},et.prototype.mul=function(t){var r=new et(t);if(0===this._im&&0===r._im)return r._re=this._re*r._re,r;if(0===this._re&&0===r._re)return r._re=-this._im*r._im,r._im=0,r;var e=this._re*r._re-this._im*r._im,n=this._im*r._re+this._re*r._im;return r._re=e,r._im=n,r},et.prototype.dot=function(t){var r=new et(t);if(0===this._im&&0===r._im)return r._re=this._re*r._re,r;if(0===this._re&&0===r._re)return r._re=this._im*r._im,r._im=0,r;var e=this._re*r._re+this._im*r._im,n=-this._im*r._re+this._re*r._im;return r._re=e,r._im=n,r},et.prototype.div=function(t){var r=new et(t);if(0===this._im&&0===r._im)return r._re=this._re/r._re,r;if(0===this._re&&0===r._re)return r._re=this._im/r._im,r._im=0,r;var e=this._re*r._re+this._im*r._im,n=this._im*r._re-this._re*r._im,i=1/(r._re*r._re+r._im*r._im);return r._re=e*i,r._im=n*i,r},et.prototype.mod=function(t){var r=new et(t);if(0!==this._im||0!==r._im)throw"calculation method is undefined.";var e=this._re-r._re*(0|this._re/r._re);return e<0&&(e+=r._re),r._re=e,r},et.prototype.inv=function(){return 0===this._im?new et(1/this._re):0===this._re?new et([0,-1/this._im]):et.ONE.div(this)},et.prototype.equals=function(t,r){var e=et._toComplex(t),n=r?et._toDouble(r):Number.EPSILON;return this._re===e._re&&this._im===e._im||Math.abs(this._re-e._re)<n&&Math.abs(this._im-e._im)<n},et.prototype.compareTo=function(t,r){var e=et._toComplex(t),n=r?et._toDouble(r):Number.EPSILON,i=this.real+this.imag,o=e.real+e.imag;return Math.abs(i-o)<=n?0:o<i?1:-1},et.prototype.max=function(t){var r=et._toComplex(t);return 0<=this.compareTo(r)?this:r},et.prototype.min=function(t){var r=et._toComplex(t);return this.compareTo(r)<=0?this:r},et.prototype.clip=function(t,r){var e=et._toComplex(t),n=et._toComplex(r),i=e.compareTo(n);if(1===i)throw"clip(min, max) error. (min > max)->("+e+" > "+n+")";return 0===i?e:1===this.compareTo(n)?n:-1===this.compareTo(e)?e:this},et.prototype.isInteger=function(t){var r=t?et._toDouble(t):Number.EPSILON;return this.isReal()&&Math.abs(this._re-Math.trunc(this._re))<r},et.prototype.isComplexInteger=function(t){var r=t?et._toDouble(t):Number.EPSILON;return Math.abs(this._re-Math.trunc(this._re))<r&&Math.abs(this._im-Math.trunc(this._im))<r},et.prototype.isZero=function(t){var r=t?et._toDouble(t):Number.EPSILON;return Math.abs(this._re)<r&&Math.abs(this._im)<r},et.prototype.isOne=function(t){var r=t?et._toDouble(t):Number.EPSILON;return Math.abs(this._re-1)<r&&Math.abs(this._im)<r},et.prototype.isComplex=function(t){var r=t?et._toDouble(t):Number.EPSILON;return Math.abs(this._im)>=r},et.prototype.isReal=function(t){var r=t?et._toDouble(t):Number.EPSILON;return Math.abs(this._im)<r},et.prototype.isNaN=function(){return isNaN(this._re)||isNaN(this._im)},et.prototype.isPositive=function(){return 0<this._re},et.prototype.isNegative=function(){return this._re<0},et.prototype.isNotNegative=function(){return 0<=this._re},et.prototype.isInfinite=function(){return this._re===Number.POSITIVE_INFINITY||this._im===Number.POSITIVE_INFINITY||this._re===Number.NEGATIVE_INFINITY||this._im===Number.NEGATIVE_INFINITY},et.prototype.isFinite=function(){return!this.isNaN()&&!this.isInfinite()},et.prototype.abs=function(){return new et(this.norm)},et.prototype.conj=function(){return 0===this._im?this:new et([this._re,-this._im])},et.prototype.negate=function(){return new et([-this._re,-this._im])},et.prototype.pow=function(t){var r=new et(t);if(r.isReal()){if(this.isReal()&&(this.isNotNegative()||r.isInteger()))return r._re=Math.pow(this._re,r._re),r;var e=Math.pow(this.norm,r._re),n=this.arg*r._re;return r._re=e*Math.cos(n),r._im=e*Math.sin(n),r}return r.mul(this.log()).exp()},et.prototype.square=function(){return 0===this._im?new et(this._re*this._re):this.mul(this)},et.prototype.sqrt=function(){if(this.isReal())return this.isNotNegative()?new et(Math.sqrt(this._re)):new et([0,Math.sqrt(-this._re)]);var t=Math.sqrt(this.norm),r=.5*this.arg;return new et([t*Math.cos(r),t*Math.sin(r)])},et.prototype.rsqrt=function(){return this.isReal()?this.isNotNegative()?new et(1/Math.sqrt(this._re)):new et([0,-1/Math.sqrt(-this._re)]):this.sqrt().inv()},et.prototype.log=function(){return this.isReal()&&this.isNotNegative()?new et(Math.log(this._re)):new et([Math.log(this.norm),this.arg])},et.prototype.exp=function(){if(this.isReal())return new et(Math.exp(this._re));var t=Math.exp(this._re);return new et([t*Math.cos(this._im),t*Math.sin(this._im)])},et.prototype.sin=function(){if(this.isReal())return new et(Math.sin(this._re));var t=this.mul(et.I).exp(),r=this.mul(et.I.negate()).exp();return t.sub(r).div([0,2])},et.prototype.cos=function(){if(this.isReal())return new et(Math.cos(this._re));var t=this.mul(et.I).exp(),r=this.mul(et.I.negate()).exp();return t.add(r).div(2)},et.prototype.tan=function(){return this.isReal()?new et(Math.tan(this._re)):this.sin().div(this.cos())},et.prototype.atan=function(){return this.isReal()?new et(Math.atan(this._re)):et.I.div(et.TWO).mul(et.I.add(this).div(et.I.sub(this)).log())},et.prototype.atan2=function(t){if(0===arguments.length)return new et(this.arg);var r=et._toComplex(t);if(this.isReal()&&r.isReal())return new et(Math.atan2(this._re,r._re));throw"calculation method is undefined."},et.prototype.sinc=function(){if(this.isReal()){if(0===this._re)return et.ONE;var t=Math.PI*this._re;return new et(Math.sin(t)/t)}var r=this.mul(et.PI);return new et(r.sin().div(r))},et.prototype.floor=function(){return new et([Math.floor(this._re),Math.floor(this._im)])},et.prototype.ceil=function(){return new et([Math.ceil(this._re),Math.ceil(this._im)])},et.prototype.round=function(){return new et([Math.round(this._re),Math.round(this._im)])},et.prototype.fix=function(){return new et([Math.trunc(this._re),Math.trunc(this._im)])},et.prototype.fract=function(){return new et([this._re-Math.floor(this._re),this._im-Math.floor(this._im)])},it.ONE.get=function(){return at.ONE},it.TWO.get=function(){return at.TWO},it.TEN.get=function(){return at.TEN},it.ZERO.get=function(){return at.ZERO},it.MINUS_ONE.get=function(){return at.MINUS_ONE},it.I.get=function(){return at.I},it.PI.get=function(){return at.PI},it.QUARTER_PI.get=function(){return at.QUARTER_PI},it.HALF_PI.get=function(){return at.HALF_PI},it.TWO_PI.get=function(){return at.TWO_PI},it.E.get=function(){return at.E},it.LN2.get=function(){return at.LN2},it.LN10.get=function(){return at.LN10},it.LOG2E.get=function(){return at.LOG2E},it.LOG10E.get=function(){return at.LOG10E},it.SQRT2.get=function(){return at.SQRT2},it.SQRT1_2.get=function(){return at.SQRT1_2},it.HALF.get=function(){return at.HALF},it.POSITIVE_INFINITY.get=function(){return at.POSITIVE_INFINITY},it.NEGATIVE_INFINITY.get=function(){return at.NEGATIVE_INFINITY},it.NaN.get=function(){return at.NaN},Object.defineProperties(et.prototype,nt),Object.defineProperties(et,it);function ot(){}var at={ZERO:new et(0),ONE:new et(1),TWO:new et(2),TEN:new et(10),MINUS_ONE:new et(-1),I:new et([0,1]),PI:new et(Math.PI),QUARTER_PI:new et(.25*Math.PI),HALF_PI:new et(.5*Math.PI),TWO_PI:new et(2*Math.PI),E:new et(Math.E),LN2:new et(Math.LN2),LN10:new et(Math.LN10),LOG2E:new et(Math.LOG2E),LOG10E:new et(Math.LOG10E),SQRT2:new et(Math.SQRT2),SQRT1_2:new et(Math.SQRT1_2),HALF:new et(.5),POSITIVE_INFINITY:new et(Number.POSITIVE_INFINITY),NEGATIVE_INFINITY:new et(Number.NEGATIVE_INFINITY),NaN:new et(Number.NaN)},ut={BigInteger:{configurable:!0},BigDecimal:{configurable:!0},RoundingMode:{configurable:!0},MathContext:{configurable:!0},Fraction:{configurable:!0},Complex:{configurable:!0},Matrix:{configurable:!0},Random:{configurable:!0}};return ut.BigInteger.get=function(){return b},ut.BigDecimal.get=function(){return E},ut.RoundingMode.get=function(){return w},ut.MathContext.get=function(){return y},ut.Fraction.get=function(){return R},ut.Complex.get=function(){return et},ut.Matrix.get=function(){return K},ut.Random.get=function(){return v},Object.defineProperties(ot,ut),ot});
