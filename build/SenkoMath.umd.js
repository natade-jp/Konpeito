/*!
 * SenkoJS
 * https://github.com/natade-jp/SenkoJS
 * Copyright 2013-2019 natade
 *
 * The MIT license.
 * https://opensource.org/licenses/MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.SenkoMath=e()}(this,function(){"use strict";var _=function t(){this.x=[];for(var e=0;e<521;e++)this.x[e]=0;if(1<=arguments.length)this.setSeed(arguments[0]);else{var r=(new Date).getTime()+t.seedUniquifier&4294967295;t.seedUniquifier=t.seedUniquifier+1&4294967295,this.setSeed(r)}};_._unsigned32=function(t){return t<0?2147483648+(2147483647&t):t},_.prototype._multiplication32=function(t,e){var r=(65535&t)*(65535&e),n=_._unsigned32(r);return n=_._unsigned32(n+((65535&(r=(65535&t)*(e>>>16)))<<16)),4294967295&(n=_._unsigned32(n+((65535&(r=(t>>>16)*(65535&e)))<<16)))},_.prototype._rnd521=function(){for(var t=this.x,e=0;e<32;e++)t[e]^=t[e+489];for(var r=32;r<521;r++)t[r]^=t[r-32]},_.prototype.setSeed=function(t){for(var e=0,r=this.x,n=0;n<=16;n++){for(var i=0;i<32;i++)e=(e>>>1)+((t=this._multiplication32(t,1566083941)+1)<0?2147483648:0);r[n]=e}for(var o=16;o<521;o++)e=16===o?o:o-17,r[o]=r[e]<<23&4294967295^r[o-16]>>>9^r[o-1];for(var a=0;a<4;a++)this._rnd521();this.xi=0,this.haveNextNextGaussian=!1,this.nextNextGaussian=0},_.prototype.genrand_int32=function(){521===this.xi&&(this._rnd521(),this.xi=0);var t=_._unsigned32(this.x[this.xi]);return this.xi=this.xi+1,t},_.prototype.next=function(t){return 0===t?0:32===t?this.genrand_int32():t<32?this.genrand_int32()>>>32-t:63===t?2147483648*this.next(32)+this.next(32):64===t?4294967296*this.next(32)+this.next(32):t<64?this.genrand_int32()*(1<<t-32)+(this.genrand_int32()>>>64-t):void 0},_.prototype.nextBytes=function(t){for(var e=0;e<t.length;e++)t[e]=this.next(8)},_.prototype.nextInt=function(){if(1!==arguments.length)return 4294967295&this.next(32);for(var t,e,r=arguments[0];e=(t=_._unsigned32(this.genrand_int32()))%r,4294967296<t-e+r;);return e},_.prototype.nextLong=function(){return this.next(64)},_.prototype.nextBoolean=function(){return 0!==this.next(1)},_.prototype.nextFloat=function(){return this.next(24)/16777216},_.prototype.nextDouble=function(){return(134217728*this.next(26)+this.next(27))/9007199254740992},_.prototype.nextGaussian=function(){if(this.haveNextNextGaussian)return this.haveNextNextGaussian=!1,this.nextNextGaussian;var t=Math.sqrt(-2*Math.log(this.nextDouble())),e=2*Math.PI*this.nextDouble(),r=t*Math.sin(e);return this.nextNextGaussian=t*Math.cos(e),this.haveNextNextGaussian=!0,r},_.seedUniquifier=2271560481;var g=function t(){var e=arguments;if(this.element=[],this.sign=0,2===arguments.length&&void 0!==_&&arguments[1]instanceof _){this.sign=1;var r,n=arguments[0],i=arguments[1],o=1+(n-1>>4);if(0===n)return;for(var a=0,s=0;a<o;a++)s=0===s?(r=i.nextInt(),this.element[a]=65535&r,1):(this.element[a]=r>>>16&65535,0);n%16!=0&&(this.element[this.element.length-1]&=(1<<n%16)-1),this._memory_reduction()}else if(3===arguments.length){if(void 0===_)return;for(;;){var h=new t(e[0],e[2]);if(h.isProbablePrime(e[1])){this.element=h.element,this.sign=h.sign;break}}}else if(1<=arguments.length){this.sign=1;var u=arguments[0];if(u instanceof t){for(var l=0;l<arguments[0].element.length;l++)this.element[l]=e[0].element[l];this.sign=arguments[0].sign}else if("number"==typeof u||u instanceof Number){var c=arguments[0];c<0&&(this.sign=-1,c=-c),this.element=this._number_to_binary_number(c)}else if("string"==typeof u||u instanceof String){var f=arguments[0].replace(/\s/g,"").toLowerCase(),m=f.match(/^[-+]+/);null!==m&&(m=m[0],f=f.substring(m.length,f.length),-1!==m.indexOf("-")&&(this.sign=-1)),2===arguments.length?this.element=this._string_to_binary_number(f,arguments[1]):/^0x/.test(f)?this.element=this._string_to_binary_number(f.substring(2,f.length),16):/^0b/.test(f)?this.element=this._string_to_binary_number(f.substring(2,f.length),2):/^0/.test(f)?this.element=this._string_to_binary_number(f.substring(1,f.length),8):this.element=this._string_to_binary_number(f,10),1===this.element.length&&0===this.element[0]&&(this.element=[])}}};g.prototype.equals=function(t){if(t instanceof g||(t=new g(t)),this.signum()!==t.signum())return!1;if(this.element.length!==t.element.length)return!1;for(var e=0;e<t.element.length;e++)if(this.element[e]!==t.element[e])return!1;return!0},g.prototype.toString=function(t){0===arguments.length&&(t=10);var e,r=Math.floor(Math.log(1073741823)/Math.log(t)),n=Math.round(Math.pow(t,r)),i=[];for(e=0;e<r;e++)i[e]="0";i=i.join("");var o=this._binary_number_to_string(this.element,n),a=[],s="";for(this.signum()<0&&(a[a.length]="-"),e=o.length-1;0<=e;e--)s=o[e].toString(t),e<o.length-1&&(a[a.length]=i.substring(0,r-s.length)),a[a.length]=s;return a.join("")},g.prototype.getShort=function(t){return t<0||this.element.length<=t?0:this.element[t]},g.prototype.byteValue=function(){var t=this.getShort(0);return 0<(t&=255)&&this.sign<0&&(t=-t),t},g.prototype.shortValue=function(){var t=this.getShort(0);return 0<(t&=65535)&&this.sign<0&&(t=-t),t},g.prototype.intValue=function(){var t=this.getShort(0)+(this.getShort(1)<<16);return 0<(t&=4294967295)&&this.sign<0&&(t=-t),t},g.prototype.longValue=function(){for(var t=0,e=3;0<=e;e--)t*=65536,t+=this.getShort(e);return this.sign<0&&(t=-t),t},g.prototype.floatValue=function(){return parseFloat(this.toString())},g.prototype.doubleValue=function(){return parseFloat(this.toString())},g.prototype.clone=function(){var t=new g;return t.element=this.element.slice(0),t.sign=this.sign,t},g.prototype.getLowestSetBit=function(){for(var t=0;t<this.element.length;t++)if(0!==this.element[t])for(var e=this.element[t],r=0;r<16;r++)if(0!=(e>>>r&1))return 16*t+r;return-1},g.prototype.bitLength=function(){for(var t=this.element.length-1;0<=t;t--)if(0!==this.element[t])for(var e=this.element[t],r=15;0<=r;r--)if(0!=(e>>>r&1))return 16*t+r+1;return 0},g.prototype.bitCount=function(){for(var t,e=(t=0<=this.sign?this:this.add(new g(1))).bitLength(),r=0,n=0,i=0;r<e;i++)for(var o=t.element[i],a=0;a<16&&r<e;a++,r++)0!=(o>>>a&1)&&(n+=1);return n},g.prototype.getTwosComplement=function(t){var e=this.clone();if(0<=e.sign)return e;e.sign=1,0===arguments.length&&(t=e.bitLength());for(var r=e.element,n=0;n<r.length;n++)r[n]^=65535;return t%16!=0&&(r[r.length-1]&=(1<<t%16)-1),e._add(new g(1)),e},g.prototype._and=function(t){t instanceof g||(t=new g(t));var e=this,r=t,n=e.signum(),i=r.signum(),o=Math.max(e.bitLength(),r.bitLength());e=e.getTwosComplement(o).element,r=r.getTwosComplement(o).element;var a=Math.max(e.length,r.length);this.element=[];for(var s=0;s<a;s++){var h=s>=e.length?0:e[s],u=s>=r.length?0:r[s];this.element[s]=h&u}return 0===this.bitLength()&&(this.element=[],this.sign=0),1===n||1===i?this.sign=1:-1===this.sign&&(this.element=this.getTwosComplement(o).element),this},g.prototype.and=function(t){return this.clone()._and(t)},g.prototype._or=function(t){t instanceof g||(t=new g(t));var e=this,r=t,n=e.signum(),i=r.signum(),o=Math.max(e.bitLength(),r.bitLength());e=e.getTwosComplement(o).element,r=r.getTwosComplement(o).element;var a=Math.max(e.length,r.length);this.element=[];for(var s=0;s<a;s++){var h=s>=e.length?0:e[s],u=s>=r.length?0:r[s];this.element[s]=h|u}return this.sign=-1===n||-1===i?-1:Math.max(n,i),-1===this.sign&&(this.element=this.getTwosComplement(o).element),this},g.prototype.or=function(t){return this.clone()._or(t)},g.prototype._xor=function(t){t instanceof g||(t=new g(t));var e=this,r=t,n=e.signum(),i=r.signum(),o=Math.max(e.bitLength(),r.bitLength());e=e.getTwosComplement(o).element,r=r.getTwosComplement(o).element;var a=Math.max(e.length,r.length);this.element=[];for(var s=0;s<a;s++){var h=s>=e.length?0:e[s],u=s>=r.length?0:r[s];this.element[s]=h^u}return this.sign=0!==n&&n!==i?-1:1,-1===this.sign&&(this.element=this.getTwosComplement(o).element),this},g.prototype.xor=function(t){return this.clone()._xor(t)},g.prototype._not=function(){return this._add(new g(1))._negate()},g.prototype.not=function(){return this.clone()._not()},g.prototype._andNot=function(t){return t instanceof g||(t=new g(t)),this._and(t.not())},g.prototype.andNot=function(t){return this.clone()._andNot(t)},g.prototype._number_to_binary_number=function(t){if(4294967295<t)return this._string_to_binary_number(t.toFixed(),10);for(var e=[];0!==t;)e[e.length]=1&t,t>>>=1;t=[];for(var r=0;r<e.length;r++)t[r>>>4]|=e[r]<<(15&r);return t},g.prototype._string_to_binary_number=function(t,e){for(var r=Math.floor(Math.log(1073741823)/Math.log(e)),n=Math.round(Math.pow(e,r)),i=[],o=[],a=Math.ceil(t.length/r),s=t.length,h=0;h<a;h++)s-=r,i[h]=0<=s?parseInt(t.substring(s,s+r),e):parseInt(t.substring(0,s+r),e);for(e=n;0!==i.length;){for(var u=0,l=i.length-1;0<=l;l--){var c=i[l]+u*e;i[l]=c>>>1,u=1&c}o[o.length]=u,0===i[i.length-1]&&i.pop()}i=[];for(var f=0;f<o.length;f++)i[f>>>4]|=o[f]<<(15&f);return i},g.prototype._binary_number_to_string=function(t,a){for(var e=function(t,e,r){for(var n=t.length,i=0,o=0;o<n;o++)r[o]=t[o]+(e.length>=o+1?e[o]:0)+i,r[o]>=a?(i=1,r[o]-=a):i=0;1===i&&(r[n]=1)},r=[0],n=[1],i=0;i<t.length;i++)for(var o=0;o<16;o++)t[i]>>>o&1&&e(n,r,r),e(n,n,n);return r},g.prototype._memory_allocation=function(t){var e=this.element.length<<4;if(e<t)for(var r=1+((t-e-1&4294967280)>>>4),n=0;n<r;n++)this.element[this.element.length]=0},g.prototype._memory_reduction=function(){for(var t=this.element.length-1;0<=t;t--)if(0!==this.element[t])return void(t<this.element.length-1&&this.element.splice(t+1,this.element.length-t-1));this.sign=0,this.element=[]},g.prototype.gcd=function(t){t instanceof g||(t=new g(t));for(var e,r=this,n=t;0!==n.signum();)e=r.remainder(n),r=n,n=e;return r},g.prototype.extgcd=function(t){t instanceof g||(t=new g(t));for(var e,r,n,i,o=new g(1),a=new g(0),s=this,h=t,u=o,l=a,c=a,f=o;0!==h.signum();){var m=s.divideAndRemainder(h);r=m[0],e=m[1],n=u.subtract(r.multiply(l)),i=c.subtract(r.multiply(f)),u=l,l=n,c=f,f=i,s=h,h=e}return[u,c,s]},g.prototype._abs=function(){return this.sign*=this.sign,this},g.prototype.abs=function(){return this.clone()._abs()},g.prototype._negate=function(){return this.sign*=-1,this},g.prototype.negate=function(){return this.clone()._negate()},g.prototype.signum=function(){return 0===this.element.length?0:this.sign},g.prototype.compareToAbs=function(t){if(t instanceof g||(t=new g(t)),this.element.length<t.element.length)return-1;if(this.element.length>t.element.length)return 1;for(var e=this.element.length-1;0<=e;e--)if(this.element[e]!==t.element[e]){var r=this.element[e]-t.element[e];return 0===r?0:0<r?1:-1}return 0},g.prototype.compareTo=function(t){return t instanceof g||(t=new g(t)),this.signum()!==t.signum()?this.sign>t.sign?1:-1:0===this.signum()?0:this.compareToAbs(t)*this.sign},g.prototype.max=function(t){return 0<=this.compareTo(t)?this.clone():t.clone()},g.prototype.min=function(t){return 0<=this.compareTo(t)?t.clone():this.clone()},g.prototype._shift=function(t){if(0===t)return this;var e=this.element;if(1===t){var r=e.length-1;for(0!=(32768&e[r])&&(e[e.length]=1);0<=r;r--)e[r]<<=1,e[r]&=65535,0<r&&0!=(32768&e[r-1])&&(e[r]+=1)}else if(-1===t){for(var n=0;n<e.length;n++)e[n]>>>=1,n<e.length-1&&0!=(1&e[n+1])&&(e[n]|=32768);0===e[e.length-1]&&e.pop()}else{if(16<=t){for(var i=t>>>4,o=e.length-1;0<=o;o--)e[o+i]=e[o];for(var a=i-1;0<=a;a--)e[a]=0;t&=15}else if(t<=-16){var s=-t>>>4;e.splice(0,s),t+=s<<4}if(0!==t)if(0<t){for(var h=0,u=0;u<e.length;u++)e[u]=(e[u]<<t)+h,65535<e[u]?(h=e[u]>>>16,e[u]&=65535):h=0;0!==h&&(e[e.length]=h)}else{t=-t;for(var l=0;l<e.length;l++)l!==e.length-1?(e[l]+=e[l+1]<<16,e[l]>>>=t,e[l]&=65535):e[l]>>>=t;0===e[e.length-1]&&e.pop()}}return this},g.prototype.shift=function(t){return this.clone()._shift(t)},g.prototype.shiftLeft=function(t){return this.shift(t)},g.prototype.shiftRight=function(t){return this.shift(-t)},g.prototype._add=function(t){t instanceof g||(t=new g(t));var e=t,r=this.element,n=e.element;if(this.sign===e.sign){this._memory_allocation(n.length<<4);for(var i=0,o=0;o<r.length;o++)r[o]+=(n.length>=o+1?n[o]:0)+i,65535<r[o]?(i=1,r[o]&=65535):i=0;0!==i&&(r[r.length]=i)}else{var a=this.compareToAbs(e);if(0===a)return this.element=[],this.sign=1,this;if(-1===a){this.sign=e.sign;var s=r;r=n.slice(0),n=s}for(var h=0,u=0;u<r.length;u++)r[u]-=(n.length>=u+1?n[u]:0)+h,h=r[u]<0?(r[u]+=65536,1):0;this.element=r,this._memory_reduction()}return this},g.prototype.add=function(t){return this.clone()._add(t)},g.prototype._subtract=function(t){t instanceof g||(t=new g(t));var e=t.sign,r=this._add(t._negate());return t.sign=e,r},g.prototype.subtract=function(t){return this.clone()._subtract(t)},g.prototype._multiply=function(t){var e=this.multiply(t);return this.element=e.element,this.sign=e.sign,this},g.prototype.multiply=function(t){t instanceof g||(t=new g(t));for(var e=new g,r=new g,n=t,i=this.element,o=n.element,a=e.element,s=0;s<i.length;s++){r.element=[];for(var h=r.element,u=0,l=0;l<o.length;l++)h[l]=i[s]*o[l]+u,65535<h[l]?(u=h[l]>>>16,h[l]&=65535):u=0;0!==u&&(h[h.length]=u);for(var c=h.length-1;0<=c;c--)h[c+s]=h[c];for(var f=s-1;0<=f;f--)h[f]=0;u=0,e._memory_allocation(h.length<<4);for(var m=s;m<a.length;m++)a[m]+=(h.length>=m+1?h[m]:0)+u,65535<a[m]?(u=1,a[m]&=65535):u=0;0!==u&&(a[a.length]=u)}return e.sign=this.sign*t.sign,e},g.prototype._divideAndRemainder=function(t){t instanceof g||(t=new g(t));var e=[];if(0===t.signum())return e[0]=1/0,e[1]=NaN,e;var r=this.compareToAbs(t);if(r<0)return e[0]=new g(0),e[1]=this.clone(),e;if(0===r)return e[0]=new g(1),e[0].sign=this.sign*t.sign,e[1]=new g(0),e;for(var n=new g(1),i=this.bitLength()-t.bitLength(),o=this.clone()._abs(),a=t.shift(i)._abs(),s=new g,h=0;h<=i&&(0<=o.compareToAbs(a)&&(o._subtract(a),s._add(n)),h!==i);h++)a._shift(-1),s._shift(1);return e[0]=s,e[0].sign=this.sign*t.sign,e[1]=o,e[1].sign=this.sign,e},g.prototype.divideAndRemainder=function(t){return this.clone()._divideAndRemainder(t)},g.prototype._divide=function(t){return this._divideAndRemainder(t)[0]},g.prototype.divide=function(t){return this.clone()._divide(t)},g.prototype._remainder=function(t){return this._divideAndRemainder(t)[1]},g.prototype.remainder=function(t){return this.clone()._remainder(t)},g.prototype._mod=function(t){if(t instanceof g||(t=new g(t)),t.signum()<0)return null;var e=this._divideAndRemainder(t);return e[1]instanceof g?0<=e[1].signum()?e[1]:e[1]._add(t):null},g.prototype.mod=function(t){return this.clone()._mod(t)},g.prototype._setBit=function(t){return this._memory_allocation(t+1),this.element[t>>>4]|=1<<(15&t),this},g.prototype.setBit=function(t){return this.clone()._setBit(t)},g.prototype._flipBit=function(t){return this._memory_allocation(t+1),this.element[t>>>4]^=1<<(15&t),this},g.prototype.flipBit=function(t){return this.clone()._flipBit(t)},g.prototype.clearBit=function(t){var e=this.clone();return e.element[t>>>4]&=~(1<<(15&t)),e._memory_reduction(),e},g.prototype.testBit=function(t){return this.element[t>>>4]>>>(15&t)&1},g.prototype.pow=function(t){var e,r;for(e=new g(this),r=new g(1);0!==t;)0!=(1&t)&&(r=r.multiply(e)),e=e.multiply(e),t>>>=1;return r},g.prototype.modPow=function(t,e){e=new g(e);for(var r=new g(this),n=new g(1),i=new g(t);0!==i.element.length;)0!=(1&i.element[0])&&(n=n.multiply(r).mod(e)),r=r.multiply(r).mod(e),i._shift(-1);return n},g.prototype.modInverse=function(t){t=new g(t);var e=this.extgcd(t),r=new g(1);return 0!==e[2].compareTo(r)?null:e[0]._add(t)._mod(t)},g.prototype.isProbablePrime=function(t){var e=this.element;if(0===e.length||1===e.length&&e[0]<=2)return!0;if(0==(1&e[0])||t<=0)return!1;if(void 0===_)return!1;t>>=1;for(var r,n,i=new g(0),o=new g(1),a=this,s=a.bitLength(),h=a.subtract(o),u=h.getLowestSetBit(),l=h.shift(-u),c=new _,f=0;f<t;f++){for(;0===(r=new g(s,c)).compareTo(i)||-1!==r.compareTo(a););if(0!==(r=r.modPow(l,a)).compareTo(o)){n=!0;for(var m=0;m<=u;m++){if(0===r.compareTo(h)){n=!1;break}m<u&&(r=r.multiply(r)._mod(a))}if(n)return!1}}return!0},g.prototype.nextProbablePrime=function(){if(void 0===_)return new g(0);for(var t=this.clone(),e=new g(1);t._add(e),!t.isProbablePrime(100););return t},g.valueOf=function(t){return new g(t)},g.probablePrime=function(t,e){return new g(t,100,e)},g.ONE=new g(1),g.TEN=new g(10),g.ZERO=new g(0);var x=function t(){this.integer=0;var e=this._scale=0,r=0,n=null;if(1<=arguments.length&&(e=arguments[0]),2<=arguments.length&&(r=arguments[1]),3<=arguments.length&&(n=arguments[2]),r instanceof y&&(n=r),e instanceof t)this.integer=e.integer.clone(),this._scale=e._scale,this.int_string=e.int_string;else if(e instanceof g)this.integer=e.clone(),this._scale=r;else if("number"==typeof e)if(e===Math.floor(e))this.integer=new g(e),this._scale=0;else{for(this._scale=0;e*=10,this._scale=this._scale+1,e!==Math.floor(e););this.integer=new g(e)}else if("string"==typeof e){var i;this._scale=0;var o=e.replace(/\s/g,"").toLowerCase(),a="";null!==(i=o.match(/^[+-]+/))&&(i=i[0],o=o.substr(i.length),-1!==i.indexOf("-")&&(a+="-")),null!==(i=o.match(/^[0-9]+/))&&(i=i[0],o=o.substr(i.length),a+=i),null!==(i=o.match(/^\.[0-9]+/))&&(i=i[0],o=o.substr(i.length),i=i.substr(1),this._scale=this._scale+i.length,a+=i),null!==(i=o.match(/^e[+-]?[0-9]+/))&&(i=i[0].substr(1),this._scale=this._scale-parseInt(i,10)),this.integer=new g(a,10)}if(n instanceof y){var s=this.round(n);this.integer=s.integer,this._scale=s._scale}};x.prototype._getUnsignedIntegerString=function(){return void 0===this.int_string&&(this.int_string=this.integer.toString(10).replace(/^-/,"")),this.int_string},x.prototype.clone=function(){return new x(this)},x.prototype.scale=function(){return this._scale},x.prototype.signum=function(){return this.integer.signum()},x.prototype.precision=function(){return this._getUnsignedIntegerString().length},x.prototype.unscaledValue=function(){return new g(this.integer)},x.prototype.toScientificNotation=function(t){var e,r,n=this._getUnsignedIntegerString(),i=this.scale(),o=[];if(-1===this.signum()&&(o[o.length]="-"),0<=(i=-t-i))for(o[o.length]=n,e=0;e<i;e++)o[o.length]="0";else if(0<(r=this.precision()+i))o[o.length]=n.substring(0,r),o[o.length]=".",o[o.length]=n.substring(r,n.length);else{for(r=-r,o[o.length]="0.",e=0;e<r;e++)o[o.length]="0";o[o.length]=n}return o[o.length]="E",0<=t&&(o[o.length]="+"),o[o.length]=t,o.join("")},x.prototype.toString=function(){var t=-this.scale()+(this.precision()-1);return 0<=this.scale()&&-6<=t?this.toPlainString():this.toScientificNotation(t)},x.prototype.toEngineeringString=function(){var t=-this.scale()+(this.precision()-1);return 0<=this.scale()&&-6<=t?this.toPlainString():this.toScientificNotation(3*Math.floor(t/3))},x.prototype.toPlainString=function(){return 0===this.scale()?this.signum()<0?"-"+this._getUnsignedIntegerString():this._getUnsignedIntegerString():this.toScientificNotation(0).match(/^[^E]*/)[0]},x.prototype.ulp=function(){return new x(g.ONE,this.scale())},x.prototype.setScale=function(t,e){if(this.scale()===t)return this.clone();e=1===arguments.length?w.UNNECESSARY:w.getRoundingMode(e);var r=this._getUnsignedIntegerString(),n=this.signum(),i=0<=n?"":"-",o=t-this.scale();if(0<=o){var a;for(a=0;a<o;a++)r+="0";return new x(new g(i+r),t)}var s=r.length+o,h=s+1;if(s<=0){var u=(n+e.getAddNumber(n))/10;return new x(new g(u),t)}var l=r.match(/0+$/);if(0<=(null!==l?l[0].length:0)+o||e===w.DOWN)return new x(new g(i+r.substring(0,s)),t);var c=1<(r=r.substring(0,h)).length?2:1,f=parseInt(r.substring(r.length-c,r.length))*n,m=new g(i+r),p=new g(e.getAddNumber(f));return r=m.add(p).toString(),new x(new g(r.substring(0,r.length-1)),t)},x.prototype.round=function(t){if(!(t instanceof y))throw"not MathContext";var e=t.getPrecision(),r=e-this.precision();if(0===r||0===e)return this.clone();var n=this.setScale(this.scale()+r,t.getRoundingMode());if(0<r)return n;if(n.precision()===t.getPrecision())return n;var i=0<=n.integer.signum()?"":"-",o=n._getUnsignedIntegerString(),a=i+o.substring(0,o.length-1);return new x(new g(a),n.scale()-1)},x.prototype.abs=function(t){var e=this.clone();if(e.integer=e.integer.abs(),1===arguments.length)return e;if(!(t instanceof y))throw"not MathContext";return e.round(t)},x.prototype.plus=function(t){var e=this.clone();if(1===arguments.length)return e;if(!(t instanceof y))throw"not MathContext";return e.round(t)},x.prototype.negate=function(t){var e=this.clone();if(e.integer=e.integer.negate(),1===arguments.length)return e;if(!(t instanceof y))throw"not MathContext";return e.round(t)},x.prototype.compareTo=function(t){if(!(t instanceof x))throw"not BigDecimal";var e=this,r=t,n=e.signum(),i=r.signum();if(0===n&&n===i)return 0;if(0===n)return-i;if(0===i)return n;if(e._scale===r._scale)return e.integer.compareTo(r.integer);if(e._scale>r._scale){var o=r.setScale(e._scale);return e.integer.compareTo(o.integer)}return e.setScale(r._scale).integer.compareTo(r.integer)},x.prototype.equals=function(t){if(!(t instanceof x))throw"not BigDecimal";return this._scale===t._scale&&this.integer.equals(t.integer)},x.prototype.min=function(t){if(!(t instanceof x))throw"not BigDecimal";return this.compareTo(t)<=0?this.clone():t.clone()},x.prototype.max=function(t){if(!(t instanceof x))throw"not BigDecimal";return 0<=this.compareTo(t)?this.clone():t.clone()},x.prototype.movePointLeft=function(t){var e=this.scaleByPowerOfTen(-t);return e=e.setScale(Math.max(this.scale()+t,0))},x.prototype.movePointRight=function(t){var e=this.scaleByPowerOfTen(t);return e=e.setScale(Math.max(this.scale()-t,0))},x.prototype.scaleByPowerOfTen=function(t){var e=this.clone();return e._scale=this.scale()-t,e},x.prototype.stripTrailingZeros=function(){var t=0<=this.signum()?"":"-",e=this.integer.toString(10).replace(/^-/,""),r=e.match(/0+$/),n=null!==r?r[0].length:0;n===e.length&&(n=e.length-1);var i=this.scale()-n;return new x(new g(t+e.substring(0,e.length-n)),i)},x.prototype.add=function(t,e){if(1===arguments.length&&(e=y.UNLIMITED),!(t instanceof x))throw"not BigDecimal";if(!(e instanceof y))throw"not MathContext";var r=this,n=t,i=Math.max(r._scale,n._scale);if(r._scale===n._scale)return new x(r.integer.add(n.integer),i,e);if(r._scale>n._scale){var o=n.setScale(r._scale);return new x(r.integer.add(o.integer),i,e)}var a=r.setScale(n._scale);return new x(a.integer.add(n.integer),i,e)},x.prototype.subtract=function(t,e){if(1===arguments.length&&(e=y.UNLIMITED),!(t instanceof x))throw"not BigDecimal";if(!(e instanceof y))throw"not MathContext";var r=this,n=t,i=Math.max(r._scale,n._scale);if(r._scale===n._scale)return new x(r.integer.subtract(n.integer),i,e);if(r._scale>n._scale){var o=n.setScale(r._scale);return new x(r.integer.subtract(o.integer),i,e)}var a=r.setScale(n._scale);return new x(a.integer.subtract(n.integer),i,e)},x.prototype.multiply=function(t,e){if(1===arguments.length&&(e=y.UNLIMITED),!(t instanceof x))throw"not BigDecimal";if(!(e instanceof y))throw"not MathContext";var r=t,n=this.integer.multiply(r.integer),i=this._scale+r._scale;return new x(n,i,e)},x.prototype.divideToIntegralValue=function(t,e){if(1===arguments.length&&(e=y.UNLIMITED),!(t instanceof x))throw"not BigDecimal";if(!(e instanceof y))throw"not MathContext";var r=function(t){var e,r="1";for(e=0;e<t;e++)r+="0";return new g(r)};if(0===t.compareTo(x.ZERO))throw"ArithmeticException";var n=t,i=this.integer,o=n.integer,a=this._scale-n._scale;this._scale>n._scale?o=o.multiply(r(a)):this._scale<n._scale&&(i=i.multiply(r(-a)));var s=i.divide(o),h=s.signum();if(0!==h){var u=s.toString(10).replace(/^-/,"");if(0!==e.getPrecision()&&u.length>e.getPrecision())throw"ArithmeticException";if(u.length<=-a){var l=u.match(/0+$/),c=null!==l?l[0].length:0;return new x(new g((0<=h?"":"-")+u.substring(0,u.length-c)),-c)}}var f=new x(s);return f=(f=f.setScale(a,w.UP)).round(e)},x.prototype.divideAndRemainder=function(t,e){if(1===arguments.length&&(e=y.UNLIMITED),!(t instanceof x))throw"not BigDecimal";if(!(e instanceof y))throw"not MathContext";var r=this.divideToIntegralValue(t,e),n=this.subtract(r.multiply(t,e),e);return[r,n]},x.prototype.divide=function(t,e,r){if(!(t instanceof x))throw"not BigDecimal";var n,i,o=t,a=null,s=y.UNLIMITED,h=0,u=!1;if(1===arguments.length)h=this.scale()-o.scale(),u=!0;else if(2===arguments.length)n=e,h=this.scale(),u=!0,a=n instanceof y?(s=n).getRoundingMode():w.getRoundingMode(t);else{if(3!==arguments.length)throw"The argument is over.";if(!("number"==typeof e||e instanceof Number))throw"scale is not Integer";h=e,a=(n=r)instanceof y?(s=n).getRoundingMode():w.getRoundingMode(t)}if(0===o.compareTo(x.ZERO))throw"ArithmeticException";var l,c,f,m,p=this,g=[];m=x.ZERO;var _=s.getPrecision(),v=0!==_?_+8:262143;for(i=0;i<v&&(c=(l=p.divideAndRemainder(o,y.UNLIMITED))[0],f=l[1],m=m.add(c.scaleByPowerOfTen(-i),y.UNLIMITED),0!==f.compareTo(x.ZERO));i++){if(0===_){if(g[f._getUnsignedIntegerString()])throw"ArithmeticException "+m+"["+f._getUnsignedIntegerString()+"]";g[f._getUnsignedIntegerString()]=!0}p=f.scaleByPowerOfTen(1)}if(u)try{m=m.setScale(h,a)}catch(t){}else m=m.setScale(h,a);return m=m.round(s)},x.prototype.toBigInteger=function(){var t=this.toPlainString().replace(/\.\d*$/,"");return new g(t.toPlainString())},x.prototype.toBigIntegerExact=function(){var t=this.setScale(0,w.UNNECESSARY);return new g(t.toPlainString())},x.prototype.longValue=function(){var t=this.toBigInteger();return t=t.longValue()},x.prototype.longValueExact=function(){var t=this.toBigIntegerExact();return t=t.longValue()},x.prototype.intValue=function(){var t=this.toBigInteger();return 4294967295&(t=t.intValue())},x.prototype.intValueExact=function(){var t=this.toBigIntegerExact();if((t=t.longValue())<-2147483648||2147483647<t)throw"ArithmeticException";return t},x.prototype.floatValue=function(){var t=this.precision();return y.DECIMAL32.getPrecision()<t?0<=this.signum()?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:parseFloat(t.toEngineeringString())},x.prototype.doubleValue=function(){var t=this.precision();return y.DECIMAL64.getPrecision()<t?0<=this.signum()?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:parseFloat(t.toEngineeringString())},x.prototype.pow=function(t,e){if(999999999<Math.abs(t))throw"ArithmeticException";if(1===arguments.length&&(e=y.UNLIMITED),!(e instanceof y))throw"not MathContext";if(0===e.getPrecision()&&t<0)throw"ArithmeticException";if(0<e.getPrecision()&&t>e.getPrecision())throw"ArithmeticException";var r,n;for(r=this.clone(),n=x.ONE;0!==t;)0!=(1&t)&&(n=n.multiply(r,y.UNLIMITED)),r=r.multiply(r,y.UNLIMITED),t>>>=1;return n.round(e)},x.valueOf=function(t,e){if(1===arguments.length)return new x(t);if(2!==arguments.length)throw"IllegalArgumentException";if("number"==typeof t&&t===Math.floor(t))return new x(new g(t),e);throw"IllegalArgumentException"};var w={UP:{toString:function(){return"UP"},getAddNumber:function(t){return 0===(t%=10)?0:0<t?10-t:-(10+t)}},DOWN:{toString:function(){return"DOWN"},getAddNumber:function(t){return-(t%=10)}},CEILING:{toString:function(){return"CEILING"},getAddNumber:function(t){return 0===(t%=10)?0:0<t?10-t:-t}},FLOOR:{toString:function(){return"FLOOR"},getAddNumber:function(t){return 0===(t%=10)?0:0<t?-t:-(10+t)}},HALF_UP:{toString:function(){return"HALF_UP"},getAddNumber:function(t){var e=0<=(t%=10)?1:-1;return Math.abs(t)<5?-1*t:e*(10-Math.abs(t))}},HALF_DOWN:{toString:function(){return"HALF_DOWN"},getAddNumber:function(t){var e=0<=(t%=10)?1:-1;return Math.abs(t)<6?-1*t:e*(10-Math.abs(t))}},HALF_EVEN:{toString:function(){return"HALF_EVEN"},getAddNumber:function(t){var e,r;return r=1===((t%=100)<0?(e=-1,1&Math.ceil(t/10)):(e=1)&Math.floor(t/10))?5:6,t%=10,Math.abs(t)<r?-1*t:e*(10-Math.abs(t))}},UNNECESSARY:{toString:function(){return"UNNECESSARY"},getAddNumber:function(t){if(0===(t%=10))return 0;throw"ArithmeticException"}},valueOf:function(t){if(null===t)throw"NullPointerException";for(var e=w.values,r=0;r<e.length;r++)if(e[r].toString()===t)return e[r];throw"IllegalArgumentException"},getRoundingMode:function(t){var e;switch(t){case w.CEILING:case w.DOWN:case w.FLOOR:case w.HALF_DOWN:case w.HALF_EVEN:case w.HALF_UP:case w.UNNECESSARY:case w.UP:e=t;break;default:"number"==typeof t||t instanceof Number?e=w.values[t]:("string"==typeof t||t instanceof String)&&(e=w.valueOf(t))}if(!e)throw"Not RoundingMode";return e}};w.values={0:w.CEILING,1:w.DOWN,2:w.FLOOR,3:w.HALF_DOWN,4:w.HALF_EVEN,5:w.HALF_UP,6:w.UNNECESSARY,7:w.UP};var y=function(){this.precision=0,this.roundingMode=w.HALF_UP;var t,e=0,r=0;if(1<=arguments.length&&(e=arguments[0]),2<=arguments.length&&(r=arguments[1]),"string"==typeof e||e instanceof String?(null!==(t=e.match(/precision=\d+/))&&(t=t[0].substring("precision=".length,t[0].length),this.precision=parseInt(t,10)),null!==(t=e.match(/roundingMode=\w+/))&&(t=t[0].substring("roundingMode=".length,t[0].length),this.roundingMode=w.valueOf(t))):1===arguments.length?this.precision=e:2===arguments.length&&(this.precision=e,this.roundingMode=r),this.precision<0)throw"IllegalArgumentException"};y.prototype.getPrecision=function(){return this.precision},y.prototype.getRoundingMode=function(){return this.roundingMode},y.prototype.equals=function(t){return t instanceof y&&t.toString()===this.toString()},y.prototype.toString=function(){return"precision="+this.precision+" roundingMode="+this.roundingMode.toString()},y.UNLIMITED=new y(0,w.HALF_UP),y.DECIMAL32=new y(7,w.HALF_EVEN),y.DECIMAL64=new y(16,w.HALF_EVEN),y.DECIMAL128=new y(34,w.HALF_EVEN),x.RoundingMode=w,x.MathContext=y,x.ZERO=new x(0),x.ONE=new x(1),x.TEN=new x(10),x.ROUND_CEILING=w.CEILING,x.ROUND_DOWN=w.DOWN,x.ROUND_FLOOR=w.FLOOR,x.ROUND_HALF_DOWN=w.HALF_DOWN,x.ROUND_HALF_EVEN=w.HALF_EVEN,x.ROUND_HALF_UP=w.HALF_UP,x.ROUND_UNNECESSARY=w.UNNECESSARY,x.ROUND_UP=w.UP;var l=function(){};l.gammaln=function(t){for(var e=Math.log(2*Math.PI),r=[-15238221.539407417,691472.268851313,-36108.77125372499,8553103/6/650,-156.84828462600203,854513/138/462,-174611/330/380,43867/798/306,-3617/510/240,7/6/182,-691/2730/132,5/66/90,-1/30/56,1/42/30,-1/30/12,1/6/2],n=1;t<r.length;)n*=t,t++;for(var i=1/(t*t),o=r[0],a=1;a<r.length;a++)o*=i,o+=r[a];return o/=t,o+=.5*e,o+=-Math.log(n)-t+(t-.5)*Math.log(t)},l.q_gamma=function(t,e,r){var n,i,o,a,s,h=1,u=1+t-e;if(t<1+e)return 1-l.p_gamma(t,e,r);for(i=(o=Math.exp(e*Math.log(t)-t-r))/u,n=2;n<1e3;n++)if(a=((n-1-e)*(u-h)+(n+t)*u)/n,s=i,(i+=a=(o*=(n-1-e)/n)/((h=u)*(u=a)))==s)return i;return Number.NaN},l.p_gamma=function(t,e,r){var n,i,o,a;if(1+e<=t)return 1-l.q_gamma(t,e,r);if(0===t)return 0;for(i=o=Math.exp(e*Math.log(t)-t-r)/e,n=1;n<1e3;n++)if(a=i,(i+=o*=t/(e+n))==a)return i;return Number.NaN},l.gamma=function(t){return t<0?Math.PI/(Math.sin(Math.PI*t)*Math.exp(l.gammaln(1-t))):Math.exp(l.gammaln(t))},l.gammainc=function(t,e,r){if("lower"===r)return l.p_gamma(t,e,l.gammaln(e));if("upper"===r)return l.q_gamma(t,e,l.gammaln(e));if(2===arguments.length)return l.gammainc(t,e,"lower");throw"gammainc unsupported argument ["+r+"]"},l.gampdf=function(t,e,r){var n=1/(l.gamma(e)*Math.pow(r,e));return n*=Math.pow(t,e-1),n*=Math.exp(-t/r)},l.gamcdf=function(t,e,r){return l.gammainc(t/r,e)},l.gaminv=function(t,e,r){if(t<0||1<t)return Number.NaN;if(0==t)return 0;if(1==t)return Number.POSITIVE_INFINITY;for(var n,i,o=e*r,a=0;a<100&&(n=(i=o-(l.gamcdf(o,e,r)-t)/l.gampdf(o,e,r))-o,!(Math.abs(n)<=1e-12));a++)o=i;return o},l.beta=function(t,e){return Math.exp(l.gammaln(t)+l.gammaln(e)-l.gammaln(t+e))},l.p_beta=function(t,e,r){var n,i,o,a;if(e<=0)return Number.POSITIVE_INFINITY;if(r<=0)return t<1?0:1===t?1:Number.POSITIVE_INFINITY;if((e+1)/(e+r+2)<t)return 1-l.p_beta(1-t,r,e);if(t<=0)return 0;for(o=e*Math.log(t),o+=r*Math.log(1-t),o+=l.gammaln(e+r),o-=l.gammaln(e)+l.gammaln(r),o=Math.exp(o),i=o/=e,n=1;n<1e3;n++)if(o*=e+r+n-1,o*=t,a=i,(i+=o/=e+n)===a)return i;return Number.NaN},l.q_beta=function(t,e,r){return 1-l.p_beta(t,e,r)},l.betainc=function(t,e,r,n){if("lower"===n)return l.p_beta(t,e,r);if("upper"===n)return l.q_beta(t,e,r);if(3===arguments.length)return l.betainc(t,e,r,"lower");throw"betainc unsupported argument ["+n+"]"},l.betapdf=function(t,e,r){return Math.pow(t,e-1)*Math.pow(1-t,r-1)/l.beta(e,r)},l.betacdf=function(t,e,r){return l.betainc(t,e,r)},l.betainv=function(t,e,r){if(t<0||1<t)return Number.NaN;if(1==t&&0<e&&0<r)return 1;var n,i,o;n=0==r?1-1e-14:0==e?1e-14:e/(e+r);for(var a=0;a<100&&(i=(o=n-(l.betacdf(n,e,r)-t)/l.betapdf(n,e,r))-n,!(Math.abs(i)<=1e-14));a++)n=o;return n},l.factorial=function(t){var e=l.gamma(t+1);return(0|t)===t?Math.round(e):e},l.nchoosek=function(t,e){return Math.round(l.factorial(t)/(l.factorial(t-e)*l.factorial(e)))},l.erf=function(t){return l.p_gamma(t*t,.5,.5*Math.log(Math.PI))*(0<=t?1:-1)},l.erfc=function(t){return 1-l.erf(t)},l.normpdf=function(t,e,r){var n="number"==typeof e?e:0,i="number"==typeof r?r:1,o=1/Math.sqrt(2*Math.PI*i*i);return o*=Math.exp(-(t-n)*(t-n)/(2*i*i))},l.normcdf=function(t,e,r){return(1+l.erf((t-("number"==typeof e?e:0))/(("number"==typeof r?r:1)*Math.sqrt(2))))/2},l.norminv=function(t,e,r){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;for(var n,i,o="number"==typeof e?e:0,a="number"==typeof r?r:1,s=o,h=0;h<200&&(n=(i=s-(l.normcdf(s,o,a)-t)/l.normpdf(s,o,a))-s,!(Math.abs(n)<=1e-12));h++)s=i;return s},l.tpdf=function(t,e){var r=1/(Math.sqrt(e)*l.beta(.5,.5*e));return r*=Math.pow(1+t*t/e,.5*-(e+1))},l.tcdf=function(t,e,r){if("lower"===r)return.5*(1+l.betainc(t*t/(e+t*t),.5,.5*e)*(t<0?-1:1));if("upper"===r)return 1-l.tcdf(t,e);if(2===arguments.length)return l.tcdf(t,e,"lower");throw"tcdf unsupported argument ["+r+"]"},l.tinv=function(t,e){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;if(t<.5){var r=l.betainv(2*t,.5*e,.5);return-Math.sqrt(e/r-e)}var n=l.betainv(2*(1-t),.5*e,.5);return Math.sqrt(e/n-e)},l.etdist=function(t,e,r){return l.tcdf(t,e,"upper")*r},l.etinv=function(t,e){return l.tinv(1-t/2,e)},l.chi2pdf=function(t,e){if(t<=0)return 0;var r=Math.pow(t,e/2-1)*Math.exp(-t/2);return r/=Math.pow(2,e/2)*l.gamma(e/2)},l.chi2cdf=function(t,e){return l.gammainc(t/2,e/2)},l.chi2inv=function(t,e){return l.gaminv(t,e/2,2)},l.fpdf=function(t,e,r){var n=1;return n*=Math.pow(e*t/(e*t+r),e/2),n*=Math.pow(1-e*t/(e*t+r),r/2),n/=t*l.beta(e/2,r/2)},l.fcdf=function(t,e,r){return l.betacdf(e*t/(e*t+r),e/2,r/2)},l.finv=function(t,e,r){return(1/l.betainv(1-t,r/2,e/2)-1)*r/e};var t=new _,n=function(t,e){var r=t.replace(/\s/g,"").toLowerCase();if(!/[ij]/.test(r))return e._re=parseFloat(r),void(e._im=0);var n,i=0,o=0;(n=r.match(/[+-]?[0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?($|[+-])/))&&(i=parseFloat(n[0])),(n=r.match(/[+-]?([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)?[ij]/))&&(n=n[0].substring(0,n[0].length-1),o=/^[-+]$/.test(n)||0===n.length?"-"===n?-1:1:parseFloat(n)),e._re=i,e._im=o},O=function t(e){if(1!==arguments.length)throw"Many arguments : "+arguments.length;var r=e;if(r instanceof t||r instanceof Object&&r._re&&r._im)this._re=r._re,this._im=r._im;else if("number"==typeof r||r instanceof Number)this._re=r,this._im=0;else if(r instanceof Array&&2===r.length)this._re=r[0],this._im=r[1];else if("string"==typeof r||r instanceof String)n(r,this);else{if(!(r instanceof Object&&r.toString))throw"Unsupported argument";n(r.toString(),this)}},e={real:{configurable:!0},imag:{configurable:!0},norm:{configurable:!0},angle:{configurable:!0}};O.prototype.clone=function(){return this},O.prototype.toString=function(){var t=function(t){var e=t.toPrecision(6);return-1!==e.indexOf(".")&&(e=(e=e.replace(/\.?0+$/,"")).replace(/\.?0+e/,"e")),e};return this.isReal()?t(this._re):0===this._re?t(this._im)+"i":0<=this._im?t(this._re)+" + "+t(this._im)+"i":t(this._re)+" - "+t(-this._im)+"i"},O.createConstComplex=function(t){return t instanceof O?t:new O(t)},O.rand=function(){return new O(t.nextDouble())},O.randn=function(){return new O(t.nextGaussian())},O.prototype.equals=function(t,e){var r=O.createConstComplex(t),n=e||Number.EPSILON;return Math.abs(this._re-r._re)<n&&Math.abs(this._im-r._im)<n},e.real.get=function(){return this._re},e.imag.get=function(){return this._im},e.norm.get=function(){return 0===this._im?Math.abs(this._re):0===this._re?Math.abs(this._im):Math.sqrt(this._re*this._re+this._im*this._im)},e.angle.get=function(){return 0===this._im?0:0===this._re?Math.PI*(0<=this._im?.5:-.5):Math.atan2(this._im,this._re)},O.prototype.getDecimalPosition=function(){for(var t=0,e=this,r=0;r<20&&!e.isComplexInteger();r++)e=e.mul(O.TEN),t++;return t},O.prototype.add=function(t){var e=new O(t);return e._re=this._re+e._re,e._im=this._im+e._im,e},O.prototype.sub=function(t){var e=new O(t);return e._re=this._re-e._re,e._im=this._im-e._im,e},O.prototype.mul=function(t){var e=new O(t);if(0===this._im&&0===e._im)return e._re=this._re*e._re,e;if(0===this._re&&0===e._re)return e._re=-this._im*e._im,e._im=0,e;var r=this._re*e._re-this._im*e._im,n=this._im*e._re+this._re*e._im;return e._re=r,e._im=n,e},O.prototype.dot=function(t){var e=new O(t);if(0===this._im&&0===e._im)return e._re=this._re*e._re,e;if(0===this._re&&0===e._re)return e._re=this._im*e._im,e._im=0,e;var r=this._re*e._re+this._im*e._im,n=-this._im*e._re+this._re*e._im;return e._re=r,e._im=n,e},O.prototype.div=function(t){var e=new O(t);if(0===this._im&&0===e._im)return e._re=this._re/e._re,e;if(0===this._re&&0===e._re)return e._re=this._im/e._im,e._im=0,e;var r=this._re*e._re+this._im*e._im,n=this._im*e._re-this._re*e._im,i=1/(e._re*e._re+e._im*e._im);return e._re=r*i,e._im=n*i,e},O.prototype.mod=function(t){var e=new O(t);if(0!==this._im||0!==e._im)throw"calculation method is undefined.";var r=this._re-e._re*(0|this._re/e._re);return r<0&&(r+=e._re),e._re=r,e},O.prototype.inv=function(){return 0===this._im?new O(1/this._re):0===this._re?new O([0,-1/this._im]):O.ONE.div(this)},O.prototype.sign=function(){return 0===this._im?0===this._re?new O(0):new O(0<this._re?1:-1):this.div(this.norm)},O.prototype.max=function(t,e){var r=O.createConstComplex(t);return this.compareTo(r,e)<=0?this:r},O.prototype.min=function(t,e){var r=O.createConstComplex(t);return 0<=this.compareTo(r,e)?this:r},O.prototype.compareTo=function(t,e){var r=O.createConstComplex(t);return this.equals(r,e)?0:this.real+this.imag<r.real+r.imag?1:-1},O.prototype.isInteger=function(t){var e=t||Number.EPSILON;return this.isReal()&&Math.abs(this._re-(0|this._re))<e},O.prototype.isComplexInteger=function(t){var e=t||Number.EPSILON;return Math.abs(this._re-(0|this._re))<e&&Math.abs(this._im-(0|this._im))<e},O.prototype.isZero=function(t){var e=t||Number.EPSILON;return Math.abs(this._re)<e&&Math.abs(this._im)<e},O.prototype.isOne=function(t){var e=t||Number.EPSILON;return Math.abs(this._re-1)<e&&Math.abs(this._im)<e},O.prototype.isComplex=function(t){var e=t||Number.EPSILON;return Math.abs(this._im)>=e},O.prototype.isReal=function(t){var e=t||Number.EPSILON;return Math.abs(this._im)<e},O.prototype.isNaN=function(){return Math.isNaN(this._re)||Math.isNaN(this._im)},O.prototype.isPositive=function(){return 0<this._re},O.prototype.isNegative=function(){return this._re<0},O.prototype.isNotNegative=function(){return 0<=this._re},O.prototype.isInfinite=function(){return this._re===Number.POSITIVE_INFINITY||this._im===Number.POSITIVE_INFINITY||this._re===Number.NEGATIVE_INFINITY||this._im===Number.NEGATIVE_INFINITY},O.prototype.isFinite=function(){return!this.isNaN()&&!this.isInfinite()},O.prototype.abs=function(){return new O(this.norm)},O.prototype.conj=function(){return 0===this._im?this:new O([this._re,-this._im])},O.prototype.negate=function(){return new O([-this._re,-this._im])},O.prototype.pow=function(t){var e=new O(t);if(this.isReal()&&e.isReal()&&this.isNotNegative())return e._re=Math.pow(this._re,e._re),e;if(e.isReal()){var r=Math.pow(this.norm,e._re),n=this.angle*e._re;return e._re=r*Math.cos(n),e._im=r*Math.sin(n),e}return e.mul(this.log()).exp()},O.prototype.square=function(){return new O(this._re*this._re+this._im*this._im)},O.prototype.sqrt=function(){if(this.isReal())return this.isNotNegative()?new O(Math.sqrt(this._re)):new O([0,Math.sqrt(this._re)]);var t=Math.sqrt(this.norm),e=.5*this.angle;return new O([t*Math.cos(e),t*Math.sin(e)])},O.prototype.log=function(){return this.isReal()&&this.isNotNegative()?new O(Math.log(this._re)):new O([Math.log(this.norm),this.angle])},O.prototype.exp=function(){if(this.isReal())return new O(Math.exp(this._re));var t=Math.exp(this._re);return new O([t*Math.cos(this._im),t*Math.sin(this._im)])},O.prototype.sin=function(){if(this.isReal())return new O(Math.sin(this._re));var t=this.mul(O.I).exp(),e=this.mul(O.I.negate()).exp();return t.sub(e).div([0,2])},O.prototype.cos=function(){if(this.isReal())return new O(Math.cos(this._re));var t=this.mul(O.I).exp(),e=this.mul(O.I.negate()).exp();return t.add(e).div(2)},O.prototype.tan=function(){return this.isReal()?new O(Math.tan(this._re)):this.sin().div(this.cos())},O.prototype.atan=function(){return this.isReal()?new O(Math.atan(this._re)):O.I.div(O.TWO).mul(O.I.add(this).div(O.I.sub(this)).log())},O.prototype.atan2=function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];if(0===arguments.length)return new O(this.angle);var r=new(Function.prototype.bind.apply(O,[null].concat(e)));if(this.isReal()&&r.isReal())return new O(Math.atan2(this._re,r._re));throw"calculation method is undefined."},O.prototype.floor=function(){return new O([Math.floor(this._re),Math.floor(this._im)])},O.prototype.ceil=function(){return new O([Math.ceil(this._re),Math.ceil(this._im)])},O.prototype.round=function(){return new O([Math.round(this._re),Math.round(this._im)])},O.prototype.fix=function(){return new O([0|this._re,0|this._im])},O.prototype.fract=function(){return new O([this._re-(0|this._re),this._im-(0|this._im)])},O.prototype.gammaln=function(){if(this.isComplex())throw"gammaln don't support complex numbers.";return new O(l.gammaln(this._re))},O.prototype.gamma=function(){if(this.isComplex())throw"gamma don't support complex numbers.";return new O(l.gamma(this._re))},O.prototype.gammainc=function(t,e){var r=O.createConstComplex(t);if(this.isComplex()||r.isComplex())throw"gammainc don't support complex numbers.";var n=2===arguments.length?e:"lower";return new O(l.gammainc(this._re,r._re,n))},O.prototype.gampdf=function(t,e){var r=O.createConstComplex(t),n=O.createConstComplex(e);if(this.isComplex()||r.isComplex()||n.isComplex())throw"gampdf don't support complex numbers.";return new O(l.gampdf(this._re,r._re,n._re))},O.prototype.gamcdf=function(t,e){var r=O.createConstComplex(t),n=O.createConstComplex(e);if(this.isComplex()||r.isComplex()||n.isComplex())throw"gamcdf don't support complex numbers.";return new O(l.gamcdf(this._re,r._re,n._re))},O.prototype.gaminv=function(t,e){var r=O.createConstComplex(t),n=O.createConstComplex(e);if(this.isComplex()||r.isComplex()||n.isComplex())throw"gaminv don't support complex numbers.";return new O(l.gaminv(this._re,r._re,n._re))},O.prototype.beta=function(t){var e=O.createConstComplex(t);if(this.isComplex()||e.isComplex())throw"beta don't support complex numbers.";return new O(l.beta(this._re,e._re))},O.prototype.betainc=function(t,e,r){var n=O.createConstComplex(t),i=O.createConstComplex(e);if(this.isComplex()||n.isComplex()||i.isComplex())throw"betainc don't support complex numbers.";var o=2===arguments.length?r:"lower";return new O(l.betainc(this._re,n._re,i._re,o))},O.prototype.betapdf=function(t,e){var r=O.createConstComplex(t),n=O.createConstComplex(e);if(this.isComplex()||r.isComplex()||n.isComplex())throw"betapdf don't support complex numbers.";return new O(l.betapdf(this._re,r._re,n._re))},O.prototype.betacdf=function(t,e){var r=O.createConstComplex(t),n=O.createConstComplex(e);if(this.isComplex()||r.isComplex()||n.isComplex())throw"betacdf don't support complex numbers.";return new O(l.betacdf(this._re,r._re,n._re))},O.prototype.betainv=function(t,e){var r=O.createConstComplex(t),n=O.createConstComplex(e);if(this.isComplex()||r.isComplex()||n.isComplex())throw"betainv don't support complex numbers.";return new O(l.betainv(this._re,r._re,n._re))},O.prototype.factorial=function(){if(this.isComplex())throw"factorial don't support complex numbers.";return new O(l.factorial(this._re))},O.prototype.nchoosek=function(t){var e=O.createConstComplex(t);if(this.isComplex()||e.isComplex())throw"nchoosek don't support complex numbers.";return new O(l.nchoosek(this._re,e._re))},O.prototype.erf=function(){if(this.isComplex())throw"erf don't support complex numbers.";return new O(l.erf(this._re))},O.prototype.erfc=function(){if(this.isComplex())throw"erfc don't support complex numbers.";return new O(l.erfc(this._re))},O.prototype.normpdf=function(t,e){var r=arguments.length<=0?O.createConstComplex(t):O.ZERO,n=arguments.length<=1?O.createConstComplex(e):O.ONE;if(this.isComplex()||r.isComplex()||n.isComplex())throw"normpdf don't support complex numbers.";return new O(l.normpdf(this._re,r._re,n._re))},O.prototype.normcdf=function(t,e){var r=arguments.length<=0?O.createConstComplex(t):O.ZERO,n=arguments.length<=1?O.createConstComplex(e):O.ONE;if(this.isComplex()||r.isComplex()||n.isComplex())throw"normcdf don't support complex numbers.";return new O(l.normcdf(this._re,r._re,n._re))},O.prototype.norminv=function(t,e){var r=arguments.length<=0?O.createConstComplex(t):O.ZERO,n=arguments.length<=1?O.createConstComplex(e):O.ONE;if(this.isComplex()||r.isComplex()||n.isComplex())throw"norminv don't support complex numbers.";return new O(l.norminv(this._re,r._re,n._re))},O.prototype.tpdf=function(t){var e=O.createConstComplex(t);if(this.isComplex()||e.isComplex())throw"tpdf don't support complex numbers.";return new O(l.tpdf(this._re,e._re))},O.prototype.tcdf=function(t,e){var r=O.createConstComplex(t);if(this.isComplex()||r.isComplex())throw"tcdf don't support complex numbers.";var n=2===arguments.length?e:"lower";return new O(l.tcdf(this._re,r._re,n))},O.prototype.tinv=function(t){var e=O.createConstComplex(t);if(this.isComplex()||e.isComplex())throw"tinv don't support complex numbers.";return new O(l.tinv(this._re,e._re))},O.prototype.chi2pdf=function(t){var e=O.createConstComplex(t);if(this.isComplex()||e.isComplex())throw"chi2pdf don't support complex numbers.";return new O(l.chi2pdf(this._re,e._re))},O.prototype.chi2cdf=function(t){var e=O.createConstComplex(t);if(this.isComplex()||e.isComplex())throw"chi2cdf don't support complex numbers.";return new O(l.chi2cdf(this._re,e._re))},O.prototype.chi2inv=function(t){var e=O.createConstComplex(t);if(this.isComplex()||e.isComplex())throw"chi2inv don't support complex numbers.";return new O(l.chi2inv(this._re,e._re))},O.prototype.fpdf=function(t,e){var r=O.createConstComplex(t),n=O.createConstComplex(e);if(this.isComplex()||r.isComplex()||n.isComplex())throw"fpdf don't support complex numbers.";return new O(l.fpdf(this._re,r._re,n._re))},O.prototype.fcdf=function(t,e){var r=O.createConstComplex(t),n=O.createConstComplex(e);if(this.isComplex()||r.isComplex()||n.isComplex())throw"fcdf don't support complex numbers.";return new O(l.fcdf(this._re,r._re,n._re))},O.prototype.finv=function(t,e){var r=O.createConstComplex(t),n=O.createConstComplex(e);if(this.isComplex()||r.isComplex()||n.isComplex())throw"finv don't support complex numbers.";return new O(l.finv(this._re,r._re,n._re))},Object.defineProperties(O.prototype,e),O.I=new O([0,1]),O.PI=new O(Math.PI),O.ZERO=new O(0),O.HALF=new O(.5),O.ONE=new O(1),O.MINUS=new O(-1),O.TWO=new O(2),O.TEN=new O(10);var r=function(){};r.tridiagonalize=function(t){for(var e=t.getNumberMatrixArray(),l=function(t,e,r,n){for(var i=0,o=r||0,a=n||t.length,s=o;s<a;s++)i+=t[s]*e[s];return i},r=function(t,e,r){var n=e||0,i=r||t.length,o=Math.sqrt(l(t,t,n,i)),a=[];if(1e-10<=Math.abs(o)){var s;t[n]<0&&(o=-o);for(var h=n,u=0;h<i;h++,u++)a[u]=h===n?(a[u]=t[h]+o,s=1/Math.sqrt(a[u]*o),a[u]*s):t[h]*s}return{y1:-o,v:a}},n=e.length,i=[],o=[],a=0;a<n-2;a++){var s=e[a];i[a]=s[a];var h=r(s,a+1,n);o[a]=h.y1;for(var u=0;u<h.v.length;u++)s[a+1+u]=h.v[u];if(!(Math.abs(o[a])<1e-10)){for(var c=a+1;c<n;c++){for(var f=0,m=a+1;m<c;m++)f+=e[m][c]*s[m];for(var p=c;p<n;p++)f+=e[c][p]*s[p];i[c]=f}for(var g=l(s,i,a+1,n)/2,_=n-1;a<_;_--){var v=s[_],x=i[_]-g*v;i[_]=x;for(var w=_;w<n;w++){var y=v*i[w]+x*s[w];e[_][w]=e[_][w]-y}}}}2<=n&&(i[n-2]=e[n-2][n-2],o[n-2]=e[n-2][n-1]),1<=n&&(i[n-1]=e[n-1][n-1]);for(var d=n-1;0<=d;d--){var M=e[d];if(d<n-2)for(var b=d+1;b<n;b++)for(var C=e[b],E=l(M,C,d+1,n),N=d+1;N<n;N++)C[N]-=E*M[N];for(var I=0;I<n;I++)M[I]=0;M[d]=1}var S=D.createMatrixDoEachCalculation(function(t,e){return t===e?new O(i[t]):1===Math.abs(t-e)?new O(o[.5*(t+e)|0]):O.ZERO},n,n);return{P:new D(e).T(),H:S}},r.eig=function(t){for(var e=!1,r=t.tridiagonalize(),n=r.P.getNumberMatrixArray(),i=r.H.getNumberMatrixArray(),o=t.row_length,a=[],s=[],h=0;h<o;h++)a[h]=i[h][h],s[h]=0===h?0:i[h][h-1];for(var u=o-1;0<u;u--){var l=u;for(l=u;1<=l&&!(Math.abs(s[l])<=1e-10*(Math.abs(a[l-1])+Math.abs(a[l])));l--);if(l!=u){for(var c=0;;){if(100<++c){e=!0;break}var f=(a[u-1]-a[u])/2,m=s[u]*s[u],p=Math.sqrt(f*f+m);f<0&&(p=-p);for(var g=a[l]-a[u]+m/(f+p),_=s[l+1],v=l;v<u;v++){var x=void 0,w=void 0;Math.abs(g)>=Math.abs(_)?w=(m=-_/g)*(x=1/Math.sqrt(m*m+1)):x=(m=-g/_)*(w=1/Math.sqrt(m*m+1)),m=((f=a[v]-a[v+1])*w+2*x*s[v+1])*w,a[v]-=m,a[v+1]+=m,l<v&&(s[v]=x*s[v]-w*_),s[v+1]+=w*(x*f-2*w*s[v+1]);for(var y=0;y<o;y++)g=n[y][v],_=n[y][v+1],n[y][v]=x*g-w*_,n[y][v+1]=w*g+x*_;v<u-1&&(g=s[v+1],_=-w*s[v+2],s[v+2]*=x)}if(Math.abs(s[u])<=1e-10*(Math.abs(a[u-1])+Math.abs(a[u])))break}if(e)break}}return function(t,e){for(var r=e.length,n=[],i=0;i<r;i++)n[i]={sigma:e[i],index:i};n.sort(function(t,e){return t===e?0:t<e?-1:1});for(var o=D.zeros(r),a=D.zeros(r),s=0;s<r;s++)a.matrix_array[s][s]=new O(n[s].sigma),o.matrix_array[s][n[s].index]=O.ONE;return{V:t.mul(o),D:a}}(new D(n),a)};var m={match2:function(t,e){for(var r=[],n=t,i=!0,o=0;o<1e3;o++){if(null===(i=n.match(e))){n.length&&r.push([!1,n]);break}0<i.index&&r.push([!1,n.substr(0,i.index)]),r.push([!0,i[0]]),n=n.substr(i.index+i[0].length)}return r},trimBracket:function(t){return/^\[/.test(t)&&/\]$/.test(t)?t.substring(1,t.length-1):null},toMatrixFromStringForArrayJSON:function(t){var e=[],r=t.match(/\[[^\]]+\]/g);null===r&&(r=[t]);for(var n=0;n<r.length;n++){for(var i=r[n],o=i.substring(1,i.length-1).split(","),a=[],s=0;s<o.length;s++){var h=o[s];a[s]=new O(h)}e[n]=a}return e},InterpolationCalculation:function(t,e,r){var n=r.compareTo(t);if(0===n)return t;if(e.isZero())throw"IllegalArgumentException";if(e.isNegative()&&-1===n)throw"IllegalArgumentException";var i=[],o=t;i[0]=o;for(var a=1;a<65536&&(o=o.add(e)).compareTo(r)!==n;a++)i[a]=o;return i},toArrayFromString:function(t){if(":"===t.trim())return":";for(var e=new RegExp("("+/[+-]? *([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)?[ij]( *[+] *[- ]?([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)?)?/.source+")|("+/[+-]? *[0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?( *[+-] *[- ]?([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)?[ij])?/.source+")","i"),r=m.match2(t,e),n=[],i=0;i<r.length;i++){var o=r[i];if(o[0])if(i<r.length-2&&!r[i+1][0]&&/:/.test(r[i+1][1])){var a=void 0,s=void 0,h=void 0;i<r.length-4&&!r[i+3][0]&&/:/.test(r[i+3][1])?(a=new O(o[1]),s=new O(r[i+2][1]),h=new O(r[i+4][1]),i+=4):(a=new O(o[1]),s=O.ONE,h=new O(r[i+2][1]),i+=2);for(var u=m.InterpolationCalculation(a,s,h),l=0;l<u.length;l++)n.push(u[l])}else n.push(new O(o[1]))}return n},toMatrixFromStringForArrayETC:function(t){for(var e=[],r=t.split(";"),n=0;n<r.length;n++)e[n]=m.toArrayFromString(r[n]);return e},toMatrixFromStringForArray:function(t){return/[[\],]/.test(t)?m.toMatrixFromStringForArrayJSON(t):m.toMatrixFromStringForArrayETC(t)},toMatrixFromString:function(t){var e=t.replace(/^\s*|\s*$/g,""),r=m.trimBracket(e);return r?m.toMatrixFromStringForArray(r):[[new O(t)]]},isCorrectMatrixArray:function(t){if(0===t.length)return!1;var e=t[0].length;if(0===e)return!1;for(var r=1;r<t.length;r++)if(t[r].length!==e)return!1;return!0}},D=function t(e){var r=null,n=!1;if(1!==arguments.length)throw"Many arguments : "+arguments.length;var i=e;if(i instanceof t){r=[];for(var o=0;o<i.row_length;o++){r[o]=[];for(var a=0;a<i.column_length;a++)r[o][a]=i.matrix_array[o][a]}}else if(i instanceof O)r=[[i]];else if(i instanceof Array){r=[];for(var s=0;s<i.length;s++){var h=i[s];if(h instanceof Array){for(var u=[],l=0;l<h.length;l++){var c=h[l];if(c instanceof O)u[l]=c;else if(c instanceof t){if(!c.isScalar())throw"Matrix in matrix";u[l]=c.scalar}else u[l]=new O(c)}r[s]=u}else if(0===s&&(r[0]=[]),h instanceof O)r[0][s]=h;else if(h instanceof t){if(!h.isScalar())throw"Matrix in matrix";r[0][s]=h.scalar}else r[0][s]=new O(h)}}else r="string"==typeof i||i instanceof String?(n=!0,m.toMatrixFromString(i)):i instanceof Object&&i.toString?(n=!0,m.toMatrixFromString(i.toString())):[[new O(i)]];if(n)for(var f=0;f<r.length;f++)":"===r[f]&&r.splice(f--,1);if(!m.isCorrectMatrixArray(r))throw"new Matrix IllegalArgumentException";this.matrix_array=r,this.row_length=this.matrix_array.length,this.column_length=this.matrix_array[0].length,this.string_cash=null},i={scalar:{configurable:!0},length:{configurable:!0},norm1:{configurable:!0},norm2:{configurable:!0}};return D.prototype.clone=function(){return new D(this.matrix_array)},D.prototype.toString=function(){if(this.string_cash)return this.string_cash;var e=Math.pow(10,9),o=!1,n=!1,i=0;this._each(function(t){t.isReal()||(o=!0),Math.abs(t.real)>=e&&(n=!0),Math.abs(t.imag)>=e&&(n=!0),i=Math.max(i,t.getDecimalPosition())}),0<i&&(i=4);var a=0,s=[],h=function(t){if(!n)return t.toFixed(i);var e=t.toExponential(4).split("e"),r=e[1];return 2===r.length?r=r.substr(0,1)+"00"+r.substr(1):3===r.length&&(r=r.substr(0,1)+"0"+r.substr(1)),e[0]+"e"+r};this._each(function(t){var e={},r=t.real;if(e.re_sign=r<0?"-":" ",r=Math.abs(r),e.re_str=h(r),a=Math.max(a,e.re_str.length+1),o){var n=t.imag;e.im_sign=n<0?"-":"+",n=Math.abs(n),e.im_str=h(n),a=Math.max(a,e.im_str.length+1)}s.push(e)});var u=function(t,e){return"                                        ".substr(0,e-t.length)+t},l=[],c=this;return this._each(function(t,e,r){var n=s.shift(),i=u(n.re_sign+n.re_str,a);o&&(i+=" "+n.im_sign+u(n.im_str,a)+"i"),l.push(i),l.push(r<c.column_length-1?" ":"\n")}),this.string_cash=l.join(""),this.string_cash},D.prototype.equals=function(t,e){var r=this,n=D.createConstMatrix(t);if(r.row_length!==n.row_length||r.column_length!==n.column_length)return!1;if(1===r.row_length||1===r.column_length)return r.scalar.equals(n.scalar);for(var i=r.matrix_array,o=n.matrix_array,a=0;a<this.row_length;a++)for(var s=0;s<this.column_length;s++)if(!i[a][s].equals(o[a][s],e))return!1;return!0},D.prototype.getNumberMatrixArray=function(){for(var t=[],e=0;e<this.row_length;e++){t[e]=[];for(var r=0;r<this.column_length;r++)t[e][r]=this.matrix_array[e][r].real}return t},D.createConstMatrix=function(t){return 1===arguments.length&&t instanceof D?t:new D(t)},D.prototype._clearCash=function(){this.string_cash&&delete this.string_cash},D.prototype._each=function(t){for(var e=!1,r=0;r<this.row_length;r++)for(var n=0;n<this.column_length;n++){var i=t(this.matrix_array[r][n],r,n);void 0!==i&&(this.matrix_array[r][n]=i instanceof O?i:i instanceof D?i.scalar:new O(i),e=!0)}return e&&this._clearCash(),this},D.createMatrixDoEachCalculation=function(t,e,r){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";for(var n=[],i=e,o=r||e,a=0;a<i;a++){n[a]=[];for(var s=0;s<o;s++){var h=t(a,s);void 0!==h&&(n[a][s]=h instanceof O?h:h instanceof D?h.scalar:new O(h))}}return new D(n)},D.prototype.cloneMatrixDoEachCalculation=function(t){return this.clone()._each(t)},D.prototype._column_oriented_1_dimensional_processing=function(t,e,r){var n;if(this.isRow()){t(this.matrix_array[0][0],0,0);for(var i=0;i<this.column_length;i++)e(this.matrix_array[0][i],0,i);return n=r(this.matrix_array[0][this.column_length-1],0,this.column_length-1),new D(n)}var o=[];o[0]=[];for(var a=0;a<this.column_length;a++){t(this.matrix_array[0][a],0,a);for(var s=0;s<this.row_length;s++)e(this.matrix_array[s][a],s,a);o[a]=r(this.matrix_array[this.row_length-1][a],this.row_length-1,a)}var h=new D(o);return h.isMatrix()?h.transpose():h},i.scalar.get=function(){return this.matrix_array[0][0]},i.length.get=function(){return this.row_length>this.column_length?this.row_length:this.column_length},i.norm1.get=function(){var t=this.matrix_array;if(this.isRow()){for(var e=0,r=0;r<this.column_length;r++)e+=t[0][r].norm;return e}if(this.isColumn()){for(var n=0,i=0;i<this.row_length;i++)n=t[i][0].norm;return n}for(var o=0,a=0;a<this.column_length;a++){for(var s=0,h=0;h<this.row_length;h++)s+=t[h][a].norm;o<s&&(o=s)}return o},i.norm2.get=function(){var t=this.matrix_array;if(this.isRow()){for(var e=0,r=0;r<this.column_length;r++)e+=t[0][r].square().real;return Math.sqrt(e)}if(this.isColumn()){for(var n=0,i=0;i<this.row_length;i++)n=t[i][0].square().real;return Math.sqrt(n)}throw"norm2"},D.prototype.get=function(n,t){var e=null,r=null;e="string"==typeof n||n instanceof String?new D(n):n,2===arguments.length&&(r="string"==typeof t||t instanceof String?new D(t):t);var i=function(t){var e,r=!1;return"number"==typeof n||n instanceof Number?(e=Math.round(t),r=!0):n instanceof O?(e=Math.round(t.real),r=!0):n instanceof D&&n.isScalar()&&(e=Math.round(t.scalar.real),r=!0),{number:e,is_scalar:r}},o=!0,a=null,s=null;return 1===arguments.length?o&=(a=i(e)).is_scalar:2===arguments.length&&(o&=(a=i(e)).is_scalar,o&=(s=i(r)).is_scalar),o?this.isRow()?this.matrix_array[0][a.number]:this.isColumn()?this.matrix_array[a.number][0]:this.matrix_array[a.number][s.number]:null},D.eye=function(t,e){return D.createMatrixDoEachCalculation(function(t,e){return t===e?O.ONE:O.ZERO},t,e)},D.memset=function(t,e,r){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";if(t instanceof D&&!t.isScalar()){var n=t.matrix_array,i=t.row_length,o=t.column_length;return D.createMatrixDoEachCalculation(function(t,e){return n[t%i][e%o]},e,r)}var a=0;return a=t instanceof D&&t.isScalar()?t.scalar:O.createConstComplex(t),D.createMatrixDoEachCalculation(function(){return a},e,r)},D.zeros=function(t,e){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return D.memset(O.ZERO,t,e)},D.ones=function(t,e){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return D.memset(O.ONE,t,e)},D.rand=function(t,e){return D.createMatrixDoEachCalculation(function(){return O.rand()},t,e)},D.randn=function(t,e){return D.createMatrixDoEachCalculation(function(){return O.randn()},t,e)},D.prototype.isScalar=function(){return 1===this.row_length&&1==this.column_length},D.prototype.isRow=function(){return 1===this.row_length},D.prototype.isColumn=function(){return 1===this.column_length},D.prototype.isVector=function(){return 1===this.row_length||1===this.column_length},D.prototype.isMatrix=function(){return 1!==this.row_length&&1!==this.column_length},D.prototype.isSquare=function(){return this.row_length===this.column_length},D.prototype.isReal=function(e){var r=!0;return this._each(function(t){r&&t.isComplex(e)&&(r=!1)}),r},D.prototype.isComplex=function(e){var r=!0;return this._each(function(t){r&&t.isReal(e)&&(r=!1)}),r},D.prototype.isZero=function(t){var e=!0,r=t||1e-10;return this._each(function(t){e&&!t.isZero(r)&&(e=!1)}),e},D.prototype.isIdentity=function(t){if(!this.isDiagonal())return!1;for(var e=t||1e-10,r=0;r<this.row_length;r++)if(!this.matrix_array[r][r].isOne(e))return!1;return!0},D.prototype.isDiagonal=function(t){var n=!0,i=t||1e-10;return this._each(function(t,e,r){n&&e!==r&&!t.isZero(i)&&(n=!1)}),n},D.prototype.isTridiagonal=function(t){if(!this.isSquare())return!1;var n=!0,i=t||1e-10;return this._each(function(t,e,r){n&&1<Math.abs(e-r)&&!t.isZero(i)&&(n=!1)}),n},D.prototype.isRegular=function(t){if(!this.isSquare())return!1;var e=t||1e-10;return this.rank(1e-10).equals(this.row_length,e)},D.prototype.isOrthogonal=function(t){if(!this.isSquare())return!1;var e=t||1e-10;return this.mul(this.transpose()).isIdentity(e)},D.prototype.isUnitary=function(t){if(!this.isSquare())return!1;var e=t||1e-10;return this.mul(this.ctranspose()).isIdentity(e)},D.prototype.isSymmetric=function(t){if(!this.isSquare())return!1;for(var e=t||1e-10,r=0;r<this.row_length;r++)for(var n=r+1;n<this.column_length;n++)if(!this.matrix_array[r][n].equals(this.matrix_array[n][r],e))return!1;return!0},D.prototype.isHermitian=function(t){if(!this.isSquare())return!1;for(var e=t||1e-10,r=0;r<this.row_length;r++)for(var n=r;n<this.column_length;n++)if(r===n){if(!this.matrix_array[r][n].isReal(e))return!1}else if(!this.matrix_array[r][n].equals(this.matrix_array[n][r].conj(),e))return!1;return!0},D.prototype.size=function(){return new D([[this.row_length,this.column_length]])},D.prototype.max=function(e){var r;return this._column_oriented_1_dimensional_processing(function(t){r=t},function(t){0<r.compareTo(t,e)&&(r=t)},function(){return r})},D.prototype.min=function(e){var r;return this._column_oriented_1_dimensional_processing(function(t){r=t},function(t){r.compareTo(t,e)<0&&(r=t)},function(){return r})},D.prototype.add=function(t){var r=this,n=D.createConstMatrix(t);if(!(r.row_length%n.row_length!=0&&n.row_length%r.row_length!=0||r.column_length%n.column_length!=0&&n.column_length%r.column_length!=0))throw"Matrix size does not match";var i=r.matrix_array,o=n.matrix_array,e=Math.max(r.row_length,n.row_length),a=Math.max(r.column_length,n.column_length);return D.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].add(o[t%n.row_length][e%n.column_length])},e,a)},D.prototype.sub=function(t){var r=this,n=D.createConstMatrix(t);if(!(r.row_length%n.row_length!=0&&n.row_length%r.row_length!=0||r.column_length%n.column_length!=0&&n.column_length%r.column_length!=0))throw"Matrix size does not match";var i=r.matrix_array,o=n.matrix_array,e=Math.max(r.row_length,n.row_length),a=Math.max(r.column_length,n.column_length);return D.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].sub(o[t%n.row_length][e%n.column_length])},e,a)},D.prototype.mul=function(t){var e=this,r=D.createConstMatrix(t),n=e.matrix_array,i=r.matrix_array;if(e.isScalar()&&r.isScalar())return new D(n.scalar.mul(i.scalar));var o=[];if(e.isScalar()){for(var a=0;a<r.row_length;a++){o[a]=[];for(var s=0;s<r.column_length;s++)o[a][s]=e.scalar.mul(i[a][s])}return new D(o)}if(r.isScalar()){for(var h=0;h<e.row_length;h++){o[h]=[];for(var u=0;u<e.column_length;u++)o[h][u]=n[h][u].mul(r.scalar)}return new D(o)}if(e.column_length!==r.row_length)throw"Matrix size does not match";for(var l=0;l<e.row_length;l++){o[l]=[];for(var c=0;c<r.column_length;c++){for(var f=O.ZERO,m=0;m<e.column_length;m++)f=f.add(n[l][m].mul(i[m][c]));o[l][c]=f}}return new D(o)},D.prototype.inv=function(){if(this.isScalar())return new D(O.ONE.div(this.scalar));if(!this.isSquare())throw"not square";if(this.isDiagonal()){for(var t=this.T(),e=Math.min(t.row_length,t.column_length),r=0;r<e;r++)t.matrix_array[r][r]=t.matrix_array[r][r].inv();return t}var n=this.column_length,i=new D(this);i._concat_left(D.eye(n));for(var o=i.matrix_array,a=i.column_length,s=0;s<n;s++){var h=i._max_row_number(s,s).index;i._exchange_row(s,h);for(var u=o[s][s].inv(),l=s,c=s;c<a;c++)o[l][c]=o[l][c].mul(u);for(var f=0;f<n;f++)if(f!==s)for(var m=o[f][s],p=s;p<a;p++)o[f][p]=o[f][p].sub(o[s][p].mul(m))}for(var g=[],_=0;_<n;_++){g[_]=[];for(var v=0;v<n;v++)g[_][v]=o[_][n+v]}return new D(g)},D.prototype.div=function(t){var e=this,r=D.createConstMatrix(t),n=e.matrix_array,i=r.matrix_array;if(e.isScalar()&&r.isScalar())return new D(n.scalar.div(i.scalar));var o=[];if(r.isScalar()){for(var a=0;a<e.row_length;a++){o[a]=[];for(var s=0;s<e.column_length;s++)o[a][s]=n[a][s].div(r.scalar)}return new D(o)}if(r.row_length===r.column_length)return this.mul(r.inv());if(e.column_length!==r.column_length)throw"Matrix size does not match";throw"warning"},D.prototype.nmul=function(t){var r=this,n=D.createConstMatrix(t);if(!(r.row_length%n.row_length!=0&&n.row_length%r.row_length!=0||r.column_length%n.column_length!=0&&n.column_length%r.column_length!=0))throw"Matrix size does not match";var i=r.matrix_array,o=n.matrix_array,e=Math.max(r.row_length,n.row_length),a=Math.max(r.column_length,n.column_length);return D.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].mul(o[t%n.row_length][e%n.column_length])},e,a)},D.prototype.ndiv=function(t){var r=this,n=D.createConstMatrix(t);if(!(r.row_length%n.row_length!=0&&n.row_length%r.row_length!=0||r.column_length%n.column_length!=0&&n.column_length%r.column_length!=0))throw"Matrix size does not match";var i=r.matrix_array,o=n.matrix_array,e=Math.max(r.row_length,n.row_length),a=Math.max(r.column_length,n.column_length);return D.createMatrixDoEachCalculation(function(t,e){return i[t%r.row_length][e%r.column_length].div(o[t%n.row_length][e%n.column_length])},e,a)},D.prototype.real=function(){return this.cloneMatrixDoEachCalculation(function(t){return new O(t.real)})},D.prototype.imag=function(){return this.cloneMatrixDoEachCalculation(function(t){return new O(t.imag)})},D.prototype.angle=function(){return this.cloneMatrixDoEachCalculation(function(t){return new O(t.angle)})},D.prototype.sign=function(){return this.cloneMatrixDoEachCalculation(function(t){return new O(t.sign())})},D.prototype.testInteger=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isInteger(e)?O.ONE:O.ZERO})},D.prototype.testComplexInteger=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplexInteger(e)?O.ONE:O.ZERO})},D.prototype.testZero=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isZero(e)?O.ONE:O.ZERO})},D.prototype.testOne=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isOne(e)?O.ONE:O.ZERO})},D.prototype.testComplex=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplex(e)?O.ONE:O.ZERO})},D.prototype.testReal=function(e){return this.cloneMatrixDoEachCalculation(function(t){return t.isReal(e)?O.ONE:O.ZERO})},D.prototype.testNaN=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNaN()?O.ONE:O.ZERO})},D.prototype.testPositive=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isPositive()?O.ONE:O.ZERO})},D.prototype.testNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNegative()?O.ONE:O.ZERO})},D.prototype.testNotNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNotNegative()?O.ONE:O.ZERO})},D.prototype.testInfinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isInfinite()?O.ONE:O.ZERO})},D.prototype.testFinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isFinite()?O.ONE:O.ZERO})},D.prototype.abs=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.abs()})},D.prototype.conj=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.conj()})},D.prototype.negate=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.negate()})},D.prototype.sqrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sqrt()})},D.prototype.pow=function(t){var e=D.createConstMatrix(t);if(!e.isScalar())throw"not set Scalar";return this.cloneMatrixDoEachCalculation(function(t){return t.pow(e.scalar)})},D.prototype.log=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log()})},D.prototype.exp=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.exp()})},D.prototype.sin=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sin()})},D.prototype.cos=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cos()})},D.prototype.tan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.tan()})},D.prototype.atan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.atan()})},D.prototype.atan2=function(t){var e=D.createConstMatrix(t);if(!e.isScalar)throw"not set Scalar";return this.cloneMatrixDoEachCalculation(function(t){return t.atan2(e.scalar)})},D.prototype.floor=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.floor()})},D.prototype.ceil=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.ceil()})},D.prototype.round=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.round()})},D.prototype.fix=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fix()})},D.prototype.fract=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fract()})},D.prototype._rot90=function(t){var e=1;if(1===arguments.length&&(e=(t%4+4)%4),0===e)return this;for(var r=[],n=0;n<this.row_length;n++){r[n]=[];for(var i=0;i<this.column_length;i++)r[n][i]=this.matrix_array[n][i]}var o=this.matrix_array;if(1===e){o.splice(this.column_length);for(var a=0;a<this.column_length;a++){a<this.row_length?o[a].splice(this.row_length):o[a]=[];for(var s=0;s<this.row_length;s++)o[a][s]=r[this.row_length-s-1][a]}}else if(2===e)for(var h=0;h<this.row_length;h++)for(var u=0;u<this.column_length;u++)o[h][u]=r[this.row_length-h-1][this.column_length-u-1];else if(3===e){o.splice(this.column_length);for(var l=0;l<this.column_length;l++){l<this.row_length?o[l].splice(this.row_length):o[l]=[];for(var c=0;c<this.row_length;c++)o[l][c]=r[c][this.column_length-l-1]}}return this.row_length=o.length,this.column_length=o[0].length,this._clearCash(),this},D.prototype._resize=function(t,e){if(t===this.row_length&&e===this.column_length)return this;if(t<=0||e<=0)throw"_resize";for(var r=Math.max(this.row_length,t),n=Math.max(this.column_length,e),i=this.matrix_array,o=0;o<r;o++){o>=this.row_length&&(i[o]=[]);for(var a=0;a<n;a++)(o>=this.row_length||a>=this.column_length)&&(i[o][a]=O.ZERO)}if(this.row_length>t&&i.splice(t),this.column_length>e)for(var s=0;s<i.length;s++)i[s].splice(e);return this.row_length=t,this.column_length=e,this._clearCash(),this},D.prototype._delete_row=function(t){if(1===this.row_length||this.row_length<=t)throw"_delete_row";return this.matrix_array.splice(t,1),this.row_length--,this._clearCash(),this},D.prototype._delete_column=function(t){if(1===this.column_length||this.column_length<=t)throw"_delete_column";for(var e=0;e<this.row_length;e++)this.matrix_array[e].splice(t,1);return this.column_length--,this._clearCash(),this},D.prototype._exchange_row=function(t,e){if(1===this.row_length||this.row_length<=t||this.row_length<=e)throw"_exchange_row";if(t===e)return this;var r=this.matrix_array[t];return this.matrix_array[t]=this.matrix_array[e],this.matrix_array[e]=r,this._clearCash(),this},D.prototype._exchange_column=function(t,e){if(1===this.column_length||this.column_length<=t||this.column_length<=e)throw"_exchange_column";if(t===e)return this;for(var r=0;r<this.row_length;r++){var n=this.matrix_array[r][t];this.matrix_array[r][t]=this.matrix_array[r][e],this.matrix_array[r][e]=n}return this._clearCash(),this},D.prototype._concat_left=function(t){for(var e=0;e<this.row_length;e++)for(var r=0;r<t.column_length;r++)this.matrix_array[e].push(t.matrix_array[e][r]);return this.column_length+=t.column_length,this._clearCash(),this},D.prototype._concat_bottom=function(t){for(var e=0;e<t.row_length;e++)this.matrix_array.push(t.matrix_array[e]);return this.row_length+=t.row_length,this._clearCash(),this},D.prototype._max_row_number=function(t,e,r){for(var n=0,i=0,o=e||0,a=r||this.row_length;o<a;o++){var s=this.matrix_array[o][t].norm;i<s&&(i=s,n=o)}return{index:n,max:i}},D.prototype._get_linear_dependence_vector=function(t){for(var e=new D(this),r=e.matrix_array,n=t||1e-10,i=[],o=0;o<this.row_length;o++)i[o]=o;for(var a=0;a<e.column_length;a++){var s=0,h=0,u=0;for(var l in i){var c=i[l],f=r[c][a].norm;h<f&&(h=f,u=l,s=c)}if(!(h<=n)){if(i.splice(u,1),a===e.column_length-1)break;for(var m in i)for(var p=i[m],g=r[p][a].div(r[s][a]),_=a;_<e.column_length;_++)r[p][_]=r[p][_].sub(r[s][_].mul(g))}}return i},D._gram_schmidt_orthonormalization=function(t){for(var e=t.column_length,r=t.matrix_array,n=D.zeros(e),i=D.zeros(e),o=n.matrix_array,a=i.matrix_array,s=[],h=[],u=0;u<e;u++){for(var l=0;l<e;l++)h[l]=r[l][u];if(0<u){for(var c=0;c<u;c++)for(var f=0;f<e;f++)a[c][u]=a[c][u].add(r[f][u].dot(o[f][c]));for(var m=0;m<u;m++)for(var p=0;p<e;p++)h[p]=h[p].sub(a[m][u].mul(o[p][m]))}for(var g=0;g<e;g++)a[u][u]=a[u][u].add(h[g].mul(h[g]));if(a[u][u]=a[u][u].sqrt(),a[u][u].isZero(1e-10)){s.push(u);for(var _=0;_<e;_++)o[_][u]=O.ZERO}else for(var v=0;v<e;v++)o[v][u]=h[v].div(a[u][u])}return{Q:n,R:i,non_orthogonalized:s}},D.prototype._createOrthogonalVector=function(t){for(var e=new D(this),r=e.matrix_array,n=t||1e-10,i=e._get_linear_dependence_vector(n),o=i.length-1;0<=o;o--)r.splice(i[o],1),e.row_length--;var a=this.column_length-r.length;if(a<=0)return null;for(var s=new _(0),h=null,u=0;u<100;u++){var l=e.T(),c=D.createMatrixDoEachCalculation(function(){return new O(s.nextGaussian())},l.row_length,a);if(l._concat_left(c),0===(h=D._gram_schmidt_orthonormalization(l)).non_orthogonalized.length)break}if(0!==h.non_orthogonalized.length)return console.log("miss"),null;for(var f=[],m=h.Q.matrix_array,p=0;p<a;p++){f[p]=[];for(var g=0;g<this.column_length;g++)f[p][g]=m[g][this.column_length-a+p]}return new D(f)},D.prototype.norm=function(t){if(0===arguments.length)return this.norm2;if(1===t)return this.norm1;if(2===t)return this.norm2;if(t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY){for(var e=this.matrix_array,r=t===Number.POSITIVE_INFINITY?0:Number.POSITIVE_INFINITY,n=0;n<this.row_length;n++){for(var i=0,o=0;o<this.column_length;o++)i+=e[n][o].norm;r=t===Number.POSITIVE_INFINITY?Math.max(r,i):Math.min(r,i)}return r}if(this.isVector()){for(var a=0,s=0;s<this.length;s++)a=Math.pow(this.get(s).norm,t);return Math.pow(a,1/t)}throw"norm"},D.prototype.inner=function(t,e){var r=this,n=D.createConstMatrix(t),i=r.matrix_array,o=n.matrix_array,a=e||1;if(r.isScalar()&&n.isScalar())return new D(r.scalar.dot(n.scalar));if(r.isVector()&&n.isVector()){for(var s=O.ZERO,h=0;h<r.length;h++)s=s.add(r.get(h).dot(n.get(h)));return new D(s)}if(r.row_length!==n.row_length||r.column_length!==n.column_length)throw"Matrix size does not match";if(1===a){var u=[];u[0]=[];for(var l=0;l<r.column_length;l++){for(var c=O.ZERO,f=0;f<r.row_length;f++)c=c.add(i[f][l].dot(o[f][l]));u[0][l]=c}return new D(u)}if(2!==a)throw"dim";for(var m=[],p=0;p<r.row_length;p++){for(var g=O.ZERO,_=0;_<r.column_length;_++)g=g.add(i[p][_].dot(o[p][_]));m[p]=[g]}return new D(m)},D.prototype.rank=function(t){return Math.abs(this.row_length,this.column_length)-this._get_linear_dependence_vector(t).length},D.prototype.transpose=function(){for(var t=[],e=0;e<this.column_length;e++){t[e]=[];for(var r=0;r<this.row_length;r++)t[e][r]=this.matrix_array[r][e]}return new D(t)},D.prototype.ctranspose=function(){return this.transpose().conj()},D.prototype.T=function(){return this.ctranspose()},D.prototype.det=function(){if(!this.isSquare())throw"not square";var t=this.matrix_array,u=function(t){if(2===t.length)return t[0][0].mul(t[1][1]).sub(t[0][1].mul(t[1][0]));for(var e=O.ZERO,r=0;r<t.length;r++){for(var n=[],i=t[r][0],o=0,a=0;o<t.length;o++)if(r!==o){n[a]=[];for(var s=1,h=0;s<t.length;s++,h++)n[a][h]=t[o][s];a++}e=r%2==0?e.add(i.mul(u(n))):e.sub(i.mul(u(n)))}return e};return new D(u(t))},D.prototype.lup=function(){for(var t=D.zeros(this.row_length),e=new D(this),r=D.eye(this.row_length),n=t.matrix_array,i=e.matrix_array,o=0;o<this.column_length;o++){var a,s=e._max_row_number(o,o);if(a=s.index,0!==s.max){o!==a&&(t._exchange_row(o,a),e._exchange_row(o,a),r._exchange_row(o,a));for(var h=o+1;h<this.row_length;h++){var u=i[h][o].div(i[o][o]);n[h][o]=u;for(var l=o;l<this.column_length;l++)i[h][l]=i[h][l].sub(i[o][l].mul(u))}}}return t._resize(this.row_length,Math.min(this.row_length,this.column_length)),e._resize(Math.min(this.row_length,this.column_length),this.column_length),t._each(function(t,e,r){return e===r?O.ONE:t}),{L:t,U:e,P:r}},D.prototype.linsolve=function(t){if(!this.isSquare())throw"Matrix size does not match";var e=this.column_length,r=D.createConstMatrix(t);if(r.row_length!==this.row_length||1<r.column_length)throw"Matrix size does not match";var n=new D(this);n._concat_left(r);for(var i=n.matrix_array,o=n.column_length,a=0;a<e-1;a++){var s=n._max_row_number(a,a).index;n._exchange_row(a,s);for(var h=i[a][a].inv(),u=a,l=a;l<o;l++)i[u][l]=i[u][l].mul(h);for(var c=a+1;c<e;c++)for(var f=i[c][a],m=a;m<o;m++)i[c][m]=i[c][m].sub(i[a][m].mul(f))}var p=[];p[e-1]=i[e-1][e].div(i[e-1][e-1]);for(var g=e-2;0<=g;g--){p[g]=i[g][o-1];for(var _=g+1;_<e;_++)p[g]=p[g].sub(i[g][_]*p[_]);p[g]=p[g].div(i[g][g])}for(var v=[],x=0;x<this.row_length;x++)v[x]=[p[x]];return new D(v)},D.prototype.qr=function(){var t=new D(this),e=this.row_length,r=this.row_length,n=this.row_length,i=this.column_length,o=Math.max(this.row_length,this.column_length);t._resize(o,o);var a=D._gram_schmidt_orthonormalization(t),s=a.Q,h=a.R,u=a.non_orthogonalized;if(0!==u.length){for(var l={},c=0;c<u.length;c++)l[u[c]]=1;for(var f=[],m=0;m<o;m++)if(!l[m]){for(var p=[],g=0;g<o;g++)p[g]=s.matrix_array[g][m];f.push(p)}for(var _=new D(f)._createOrthogonalVector(),v=0;v<u.length;v++)for(var x=u[v],w=0;w<o;w++)s.matrix_array[w][x]=_.matrix_array[v][w]}return s._resize(e,r),h._resize(n,i),{Q:s,R:h}},D.prototype.tridiagonalize=function(){if(!this.isSquare())throw"not square matrix";if(!this.isSymmetric())throw"not Symmetric";if(this.isComplex())throw"not Real Matrix";return r.tridiagonalize(this)},D.prototype.eig=function(){if(!this.isSquare())throw"not square matrix";if(!this.isSymmetric())throw"not Symmetric";if(this.isComplex())throw"not Real Matrix";return r.eig(this)},D.prototype.svd=function(){if(this.isComplex())throw"Unimplemented";var n=this.rank(),i=this.T().mul(this).eig(),r=D.zeros(this.row_length,this.column_length);r._each(function(t,e,r){if(e===r&&e<n)return i.D.get(e,e).sqrt()});var t=D.createMatrixDoEachCalculation(function(t,e){return t===e?r.matrix_array[t][t].inv():O.ZERO},n),e=new D(i.V)._resize(i.V.row_length,n);return{U:this.mul(e).mul(t).qr().Q,S:r,V:i.V}},D.prototype.pinv=function(){var t=this.svd(),e=t.U,n=t.S,r=t.V,i=D.createMatrixDoEachCalculation(function(t,e){if(t!==e)return O.ZERO;var r=n.matrix_array[t][t];return r.isZero()?O.ZERO:r.inv()},this.column_length,this.row_length);return r.mul(i).mul(e.T())},D.prototype.gammaln=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.gammaln()})},D.prototype.gamma=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.gamma()})},D.prototype.gammainc=function(t,e){var r=D.createConstMatrix(t).scalar,n=1===arguments.length?e:"lower";return this.cloneMatrixDoEachCalculation(function(t){return t.gammainc(r,n)})},D.prototype.gampdf=function(t,e){var r=D.createConstMatrix(t).scalar,n=D.createConstMatrix(e).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.gampdf(r,n)})},D.prototype.gamcdf=function(t,e){var r=D.createConstMatrix(t).scalar,n=D.createConstMatrix(e).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.gamcdf(r,n)})},D.prototype.gaminv=function(t,e){var r=D.createConstMatrix(t).scalar,n=D.createConstMatrix(e).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.gaminv(r,n)})},D.prototype.beta=function(t){var e=D.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.beta(e)})},D.prototype.betainc=function(t,e,r){var n=D.createConstMatrix(t).scalar,i=D.createConstMatrix(e).scalar,o=2===arguments.length?r:"lower";return this.cloneMatrixDoEachCalculation(function(t){return t.betainc(n,i,o)})},D.prototype.betacdf=function(t,e){var r=D.createConstMatrix(t).scalar,n=D.createConstMatrix(e).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.betacdf(r,n)})},D.prototype.betapdf=function(t,e){var r=D.createConstMatrix(t).scalar,n=D.createConstMatrix(e).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.betapdf(r,n)})},D.prototype.betainv=function(t,e){var r=D.createConstMatrix(t).scalar,n=D.createConstMatrix(e).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.betainv(r,n)})},D.prototype.factorial=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.factorial()})},D.prototype.nchoosek=function(t){var e=D.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.nchoosek(e)})},D.prototype.erf=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erf()})},D.prototype.erfc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erfc()})},D.prototype.normpdf=function(t,e){var r=arguments.length<=0?O.createConstMatrix(t).scalar:O.ZERO,n=arguments.length<=1?O.createConstMatrix(e).scalar:O.ONE;return this.cloneMatrixDoEachCalculation(function(t){return t.normpdf(r,n)})},D.prototype.normcdf=function(t,e){var r=arguments.length<=0?O.createConstMatrix(t).scalar:O.ZERO,n=arguments.length<=1?O.createConstMatrix(e).scalar:O.ONE;return this.cloneMatrixDoEachCalculation(function(t){return t.normcdf(r,n)})},D.prototype.norminv=function(t,e){var r=arguments.length<=0?O.createConstMatrix(t).scalar:O.ZERO,n=arguments.length<=1?O.createConstMatrix(e).scalar:O.ONE;return this.cloneMatrixDoEachCalculation(function(t){return t.norminv(r,n)})},D.prototype.tpdf=function(t){var e=D.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.tpdf(e)})},D.prototype.tcdf=function(t,e){var r=D.createConstMatrix(t).scalar,n=2===arguments.length?e:"lower";return this.cloneMatrixDoEachCalculation(function(t){return t.tcdf(r,n)})},D.prototype.tinv=function(t){var e=D.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.tinv(e)})},D.prototype.chi2pdf=function(t){var e=D.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.chi2pdf(e)})},D.prototype.chi2cdf=function(t){var e=D.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.chi2cdf(e)})},D.prototype.chi2inv=function(t){var e=D.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.chi2inv(e)})},D.prototype.fpdf=function(t,e){var r=D.createConstMatrix(t).scalar,n=D.createConstMatrix(e).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.fpdf(r,n)})},D.prototype.fcdf=function(t,e){var r=D.createConstMatrix(t).scalar,n=D.createConstMatrix(e).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.fcdf(r,n)})},D.prototype.finv=function(t,e){var r=D.createConstMatrix(t).scalar,n=D.createConstMatrix(e).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.finv(r,n)})},D.prototype.mean=function(){var e,r;return this._column_oriented_1_dimensional_processing(function(){e=O.ZERO,r=0},function(t){e=e.add(t),r++},function(){return e.div(r)})},D.prototype.geomean=function(){var e;return this._column_oriented_1_dimensional_processing(function(){e=Number.ONE},function(t){e=e.mul(t)},function(){return e.sqrt()})},D.prototype.var=function(t){var e,r,n,i=this.mean(),o=0,a=0===arguments.length?0:D.createConstMatrix(t).scalar.real;return this._column_oriented_1_dimensional_processing(function(){e=O.ZERO,n=0,r=i.isScalar()?i.scalar:i.get(o)},function(t){e=e.add(t.sub(r).square()),n++},function(){return o++,1===n&&(a=1),e.div(n-1+a)})},D.prototype.std=function(t){var e=0===arguments.length?0:D.createConstMatrix(t).scalar.real,r=this.var(e);return r._each(function(t){return t.sqrt()}),r},Object.defineProperties(D.prototype,i),{BigDecimal:x,BigInteger:g,Random:_,SMath:{Complex:O,Matrix:D}}});
