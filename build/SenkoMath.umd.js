/*!
 * SenkoJS
 * https://github.com/natade-jp/SenkoJS
 * Copyright 2013-2019 natade
 *
 * The MIT license.
 * https://opensource.org/licenses/MIT
 */
!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.SenkoMath=r()}(this,function(){"use strict";var _=function t(){this.x=[];for(var r=0;r<521;r++)this.x[r]=0;if(1<=arguments.length)this.setSeed(arguments[0]);else{var e=(new Date).getTime()+t.seedUniquifier&4294967295;t.seedUniquifier=t.seedUniquifier+1&4294967295,this.setSeed(e)}};_._unsigned32=function(t){return t<0?2147483648+(2147483647&t):t},_.prototype._multiplication32=function(t,r){var e=(65535&t)*(65535&r),n=_._unsigned32(e);return n=_._unsigned32(n+((65535&(e=(65535&t)*(r>>>16)))<<16)),4294967295&(n=_._unsigned32(n+((65535&(e=(t>>>16)*(65535&r)))<<16)))},_.prototype._rnd521=function(){for(var t=this.x,r=0;r<32;r++)t[r]^=t[r+489];for(var e=32;e<521;e++)t[e]^=t[e-32]},_.prototype.setSeed=function(t){for(var r=0,e=this.x,n=0;n<=16;n++){for(var i=0;i<32;i++)r=(r>>>1)+((t=this._multiplication32(t,1566083941)+1)<0?2147483648:0);e[n]=r}for(var o=16;o<521;o++)r=16===o?o:o-17,e[o]=e[r]<<23&4294967295^e[o-16]>>>9^e[o-1];for(var a=0;a<4;a++)this._rnd521();this.xi=0,this.haveNextNextGaussian=!1,this.nextNextGaussian=0},_.prototype.genrand_int32=function(){521===this.xi&&(this._rnd521(),this.xi=0);var t=_._unsigned32(this.x[this.xi]);return this.xi=this.xi+1,t},_.prototype.next=function(t){return 0===t?0:32===t?this.genrand_int32():t<32?this.genrand_int32()>>>32-t:63===t?2147483648*this.next(32)+this.next(32):64===t?4294967296*this.next(32)+this.next(32):t<64?this.genrand_int32()*(1<<t-32)+(this.genrand_int32()>>>64-t):void 0},_.prototype.nextBytes=function(t){for(var r=0;r<t.length;r++)t[r]=this.next(8)},_.prototype.nextInt=function(){if(1!==arguments.length)return 4294967295&this.next(32);for(var t,r,e=arguments[0];r=(t=_._unsigned32(this.genrand_int32()))%e,4294967296<t-r+e;);return r},_.prototype.nextLong=function(){return this.next(64)},_.prototype.nextBoolean=function(){return 0!==this.next(1)},_.prototype.nextFloat=function(){return this.next(24)/16777216},_.prototype.nextDouble=function(){return(134217728*this.next(26)+this.next(27))/9007199254740992},_.prototype.nextGaussian=function(){if(this.haveNextNextGaussian)return this.haveNextNextGaussian=!1,this.nextNextGaussian;var t=Math.sqrt(-2*Math.log(this.nextDouble())),r=2*Math.PI*this.nextDouble(),e=t*Math.sin(r);return this.nextNextGaussian=t*Math.cos(r),this.haveNextNextGaussian=!0,e},_.seedUniquifier=2271560481;var p=function t(){var r=arguments;if(this.element=[],this.sign=0,2===arguments.length&&void 0!==_&&arguments[1]instanceof _){this.sign=1;var e,n=arguments[0],i=arguments[1],o=1+(n-1>>4);if(0===n)return;for(var a=0,s=0;a<o;a++)s=0===s?(e=i.nextInt(),this.element[a]=65535&e,1):(this.element[a]=e>>>16&65535,0);n%16!=0&&(this.element[this.element.length-1]&=(1<<n%16)-1),this._memory_reduction()}else if(3===arguments.length){if(void 0===_)return;for(;;){var h=new t(r[0],r[2]);if(h.isProbablePrime(r[1])){this.element=h.element,this.sign=h.sign;break}}}else if(1<=arguments.length){this.sign=1;var l=arguments[0];if(l instanceof t){for(var u=0;u<arguments[0].element.length;u++)this.element[u]=r[0].element[u];this.sign=arguments[0].sign}else if("number"==typeof l||l instanceof Number){var c=arguments[0];c<0&&(this.sign=-1,c=-c),this.element=this._number_to_binary_number(c)}else if("string"==typeof l||l instanceof String){var f=arguments[0].replace(/\s/g,"").toLowerCase(),m=f.match(/^[-+]+/);null!==m&&(m=m[0],f=f.substring(m.length,f.length),-1!==m.indexOf("-")&&(this.sign=-1)),2===arguments.length?this.element=this._string_to_binary_number(f,arguments[1]):/^0x/.test(f)?this.element=this._string_to_binary_number(f.substring(2,f.length),16):/^0b/.test(f)?this.element=this._string_to_binary_number(f.substring(2,f.length),2):/^0/.test(f)?this.element=this._string_to_binary_number(f.substring(1,f.length),8):this.element=this._string_to_binary_number(f,10),1===this.element.length&&0===this.element[0]&&(this.element=[])}}};p.prototype.equals=function(t){if(t instanceof p||(t=new p(t)),this.signum()!==t.signum())return!1;if(this.element.length!==t.element.length)return!1;for(var r=0;r<t.element.length;r++)if(this.element[r]!==t.element[r])return!1;return!0},p.prototype.toString=function(t){0===arguments.length&&(t=10);var r,e=Math.floor(Math.log(1073741823)/Math.log(t)),n=Math.round(Math.pow(t,e)),i=[];for(r=0;r<e;r++)i[r]="0";i=i.join("");var o=this._binary_number_to_string(this.element,n),a=[],s="";for(this.signum()<0&&(a[a.length]="-"),r=o.length-1;0<=r;r--)s=o[r].toString(t),r<o.length-1&&(a[a.length]=i.substring(0,e-s.length)),a[a.length]=s;return a.join("")},p.prototype.getShort=function(t){return t<0||this.element.length<=t?0:this.element[t]},p.prototype.byteValue=function(){var t=this.getShort(0);return 0<(t&=255)&&this.sign<0&&(t=-t),t},p.prototype.shortValue=function(){var t=this.getShort(0);return 0<(t&=65535)&&this.sign<0&&(t=-t),t},p.prototype.intValue=function(){var t=this.getShort(0)+(this.getShort(1)<<16);return 0<(t&=4294967295)&&this.sign<0&&(t=-t),t},p.prototype.longValue=function(){for(var t=0,r=3;0<=r;r--)t*=65536,t+=this.getShort(r);return this.sign<0&&(t=-t),t},p.prototype.floatValue=function(){return parseFloat(this.toString())},p.prototype.doubleValue=function(){return parseFloat(this.toString())},p.prototype.clone=function(){var t=new p;return t.element=this.element.slice(0),t.sign=this.sign,t},p.prototype.getLowestSetBit=function(){for(var t=0;t<this.element.length;t++)if(0!==this.element[t])for(var r=this.element[t],e=0;e<16;e++)if(0!=(r>>>e&1))return 16*t+e;return-1},p.prototype.bitLength=function(){for(var t=this.element.length-1;0<=t;t--)if(0!==this.element[t])for(var r=this.element[t],e=15;0<=e;e--)if(0!=(r>>>e&1))return 16*t+e+1;return 0},p.prototype.bitCount=function(){for(var t,r=(t=0<=this.sign?this:this.add(new p(1))).bitLength(),e=0,n=0,i=0;e<r;i++)for(var o=t.element[i],a=0;a<16&&e<r;a++,e++)0!=(o>>>a&1)&&(n+=1);return n},p.prototype.getTwosComplement=function(t){var r=this.clone();if(0<=r.sign)return r;r.sign=1,0===arguments.length&&(t=r.bitLength());for(var e=r.element,n=0;n<e.length;n++)e[n]^=65535;return t%16!=0&&(e[e.length-1]&=(1<<t%16)-1),r._add(new p(1)),r},p.prototype._and=function(t){t instanceof p||(t=new p(t));var r=this,e=t,n=r.signum(),i=e.signum(),o=Math.max(r.bitLength(),e.bitLength());r=r.getTwosComplement(o).element,e=e.getTwosComplement(o).element;var a=Math.max(r.length,e.length);this.element=[];for(var s=0;s<a;s++){var h=s>=r.length?0:r[s],l=s>=e.length?0:e[s];this.element[s]=h&l}return 0===this.bitLength()&&(this.element=[],this.sign=0),1===n||1===i?this.sign=1:-1===this.sign&&(this.element=this.getTwosComplement(o).element),this},p.prototype.and=function(t){return this.clone()._and(t)},p.prototype._or=function(t){t instanceof p||(t=new p(t));var r=this,e=t,n=r.signum(),i=e.signum(),o=Math.max(r.bitLength(),e.bitLength());r=r.getTwosComplement(o).element,e=e.getTwosComplement(o).element;var a=Math.max(r.length,e.length);this.element=[];for(var s=0;s<a;s++){var h=s>=r.length?0:r[s],l=s>=e.length?0:e[s];this.element[s]=h|l}return this.sign=-1===n||-1===i?-1:Math.max(n,i),-1===this.sign&&(this.element=this.getTwosComplement(o).element),this},p.prototype.or=function(t){return this.clone()._or(t)},p.prototype._xor=function(t){t instanceof p||(t=new p(t));var r=this,e=t,n=r.signum(),i=e.signum(),o=Math.max(r.bitLength(),e.bitLength());r=r.getTwosComplement(o).element,e=e.getTwosComplement(o).element;var a=Math.max(r.length,e.length);this.element=[];for(var s=0;s<a;s++){var h=s>=r.length?0:r[s],l=s>=e.length?0:e[s];this.element[s]=h^l}return this.sign=0!==n&&n!==i?-1:1,-1===this.sign&&(this.element=this.getTwosComplement(o).element),this},p.prototype.xor=function(t){return this.clone()._xor(t)},p.prototype._not=function(){return this._add(new p(1))._negate()},p.prototype.not=function(){return this.clone()._not()},p.prototype._andNot=function(t){return t instanceof p||(t=new p(t)),this._and(t.not())},p.prototype.andNot=function(t){return this.clone()._andNot(t)},p.prototype._number_to_binary_number=function(t){if(4294967295<t)return this._string_to_binary_number(t.toFixed(),10);for(var r=[];0!==t;)r[r.length]=1&t,t>>>=1;t=[];for(var e=0;e<r.length;e++)t[e>>>4]|=r[e]<<(15&e);return t},p.prototype._string_to_binary_number=function(t,r){for(var e=Math.floor(Math.log(1073741823)/Math.log(r)),n=Math.round(Math.pow(r,e)),i=[],o=[],a=Math.ceil(t.length/e),s=t.length,h=0;h<a;h++)s-=e,i[h]=0<=s?parseInt(t.substring(s,s+e),r):parseInt(t.substring(0,s+e),r);for(r=n;0!==i.length;){for(var l=0,u=i.length-1;0<=u;u--){var c=i[u]+l*r;i[u]=c>>>1,l=1&c}o[o.length]=l,0===i[i.length-1]&&i.pop()}i=[];for(var f=0;f<o.length;f++)i[f>>>4]|=o[f]<<(15&f);return i},p.prototype._binary_number_to_string=function(t,a){for(var r=function(t,r,e){for(var n=t.length,i=0,o=0;o<n;o++)e[o]=t[o]+(r.length>=o+1?r[o]:0)+i,e[o]>=a?(i=1,e[o]-=a):i=0;1===i&&(e[n]=1)},e=[0],n=[1],i=0;i<t.length;i++)for(var o=0;o<16;o++)t[i]>>>o&1&&r(n,e,e),r(n,n,n);return e},p.prototype._memory_allocation=function(t){var r=this.element.length<<4;if(r<t)for(var e=1+((t-r-1&4294967280)>>>4),n=0;n<e;n++)this.element[this.element.length]=0},p.prototype._memory_reduction=function(){for(var t=this.element.length-1;0<=t;t--)if(0!==this.element[t])return void(t<this.element.length-1&&this.element.splice(t+1,this.element.length-t-1));this.sign=0,this.element=[]},p.prototype.gcd=function(t){t instanceof p||(t=new p(t));for(var r,e=this,n=t;0!==n.signum();)r=e.remainder(n),e=n,n=r;return e},p.prototype.extgcd=function(t){t instanceof p||(t=new p(t));for(var r,e,n,i,o=new p(1),a=new p(0),s=this,h=t,l=o,u=a,c=a,f=o;0!==h.signum();){var m=s.divideAndRemainder(h);e=m[0],r=m[1],n=l.subtract(e.multiply(u)),i=c.subtract(e.multiply(f)),l=u,u=n,c=f,f=i,s=h,h=r}return[l,c,s]},p.prototype._abs=function(){return this.sign*=this.sign,this},p.prototype.abs=function(){return this.clone()._abs()},p.prototype._negate=function(){return this.sign*=-1,this},p.prototype.negate=function(){return this.clone()._negate()},p.prototype.signum=function(){return 0===this.element.length?0:this.sign},p.prototype.compareToAbs=function(t){if(t instanceof p||(t=new p(t)),this.element.length<t.element.length)return-1;if(this.element.length>t.element.length)return 1;for(var r=this.element.length-1;0<=r;r--)if(this.element[r]!==t.element[r]){var e=this.element[r]-t.element[r];return 0===e?0:0<e?1:-1}return 0},p.prototype.compareTo=function(t){return t instanceof p||(t=new p(t)),this.signum()!==t.signum()?this.sign>t.sign?1:-1:0===this.signum()?0:this.compareToAbs(t)*this.sign},p.prototype.max=function(t){return 0<=this.compareTo(t)?this.clone():t.clone()},p.prototype.min=function(t){return 0<=this.compareTo(t)?t.clone():this.clone()},p.prototype._shift=function(t){if(0===t)return this;var r=this.element;if(1===t){var e=r.length-1;for(0!=(32768&r[e])&&(r[r.length]=1);0<=e;e--)r[e]<<=1,r[e]&=65535,0<e&&0!=(32768&r[e-1])&&(r[e]+=1)}else if(-1===t){for(var n=0;n<r.length;n++)r[n]>>>=1,n<r.length-1&&0!=(1&r[n+1])&&(r[n]|=32768);0===r[r.length-1]&&r.pop()}else{if(16<=t){for(var i=t>>>4,o=r.length-1;0<=o;o--)r[o+i]=r[o];for(var a=i-1;0<=a;a--)r[a]=0;t&=15}else if(t<=-16){var s=-t>>>4;r.splice(0,s),t+=s<<4}if(0!==t)if(0<t){for(var h=0,l=0;l<r.length;l++)r[l]=(r[l]<<t)+h,65535<r[l]?(h=r[l]>>>16,r[l]&=65535):h=0;0!==h&&(r[r.length]=h)}else{t=-t;for(var u=0;u<r.length;u++)u!==r.length-1?(r[u]+=r[u+1]<<16,r[u]>>>=t,r[u]&=65535):r[u]>>>=t;0===r[r.length-1]&&r.pop()}}return this},p.prototype.shift=function(t){return this.clone()._shift(t)},p.prototype.shiftLeft=function(t){return this.shift(t)},p.prototype.shiftRight=function(t){return this.shift(-t)},p.prototype._add=function(t){t instanceof p||(t=new p(t));var r=t,e=this.element,n=r.element;if(this.sign===r.sign){this._memory_allocation(n.length<<4);for(var i=0,o=0;o<e.length;o++)e[o]+=(n.length>=o+1?n[o]:0)+i,65535<e[o]?(i=1,e[o]&=65535):i=0;0!==i&&(e[e.length]=i)}else{var a=this.compareToAbs(r);if(0===a)return this.element=[],this.sign=1,this;if(-1===a){this.sign=r.sign;var s=e;e=n.slice(0),n=s}for(var h=0,l=0;l<e.length;l++)e[l]-=(n.length>=l+1?n[l]:0)+h,h=e[l]<0?(e[l]+=65536,1):0;this.element=e,this._memory_reduction()}return this},p.prototype.add=function(t){return this.clone()._add(t)},p.prototype._subtract=function(t){t instanceof p||(t=new p(t));var r=t.sign,e=this._add(t._negate());return t.sign=r,e},p.prototype.subtract=function(t){return this.clone()._subtract(t)},p.prototype._multiply=function(t){var r=this.multiply(t);return this.element=r.element,this.sign=r.sign,this},p.prototype.multiply=function(t){t instanceof p||(t=new p(t));for(var r=new p,e=new p,n=t,i=this.element,o=n.element,a=r.element,s=0;s<i.length;s++){e.element=[];for(var h=e.element,l=0,u=0;u<o.length;u++)h[u]=i[s]*o[u]+l,65535<h[u]?(l=h[u]>>>16,h[u]&=65535):l=0;0!==l&&(h[h.length]=l);for(var c=h.length-1;0<=c;c--)h[c+s]=h[c];for(var f=s-1;0<=f;f--)h[f]=0;l=0,r._memory_allocation(h.length<<4);for(var m=s;m<a.length;m++)a[m]+=(h.length>=m+1?h[m]:0)+l,65535<a[m]?(l=1,a[m]&=65535):l=0;0!==l&&(a[a.length]=l)}return r.sign=this.sign*t.sign,r},p.prototype._divideAndRemainder=function(t){t instanceof p||(t=new p(t));var r=[];if(0===t.signum())return r[0]=1/0,r[1]=NaN,r;var e=this.compareToAbs(t);if(e<0)return r[0]=new p(0),r[1]=this.clone(),r;if(0===e)return r[0]=new p(1),r[0].sign=this.sign*t.sign,r[1]=new p(0),r;for(var n=new p(1),i=this.bitLength()-t.bitLength(),o=this.clone()._abs(),a=t.shift(i)._abs(),s=new p,h=0;h<=i&&(0<=o.compareToAbs(a)&&(o._subtract(a),s._add(n)),h!==i);h++)a._shift(-1),s._shift(1);return r[0]=s,r[0].sign=this.sign*t.sign,r[1]=o,r[1].sign=this.sign,r},p.prototype.divideAndRemainder=function(t){return this.clone()._divideAndRemainder(t)},p.prototype._divide=function(t){return this._divideAndRemainder(t)[0]},p.prototype.divide=function(t){return this.clone()._divide(t)},p.prototype._remainder=function(t){return this._divideAndRemainder(t)[1]},p.prototype.remainder=function(t){return this.clone()._remainder(t)},p.prototype._mod=function(t){if(t instanceof p||(t=new p(t)),t.signum()<0)return null;var r=this._divideAndRemainder(t);return r[1]instanceof p?0<=r[1].signum()?r[1]:r[1]._add(t):null},p.prototype.mod=function(t){return this.clone()._mod(t)},p.prototype._setBit=function(t){return this._memory_allocation(t+1),this.element[t>>>4]|=1<<(15&t),this},p.prototype.setBit=function(t){return this.clone()._setBit(t)},p.prototype._flipBit=function(t){return this._memory_allocation(t+1),this.element[t>>>4]^=1<<(15&t),this},p.prototype.flipBit=function(t){return this.clone()._flipBit(t)},p.prototype.clearBit=function(t){var r=this.clone();return r.element[t>>>4]&=~(1<<(15&t)),r._memory_reduction(),r},p.prototype.testBit=function(t){return this.element[t>>>4]>>>(15&t)&1},p.prototype.pow=function(t){var r,e;for(r=new p(this),e=new p(1);0!==t;)0!=(1&t)&&(e=e.multiply(r)),r=r.multiply(r),t>>>=1;return e},p.prototype.modPow=function(t,r){r=new p(r);for(var e=new p(this),n=new p(1),i=new p(t);0!==i.element.length;)0!=(1&i.element[0])&&(n=n.multiply(e).mod(r)),e=e.multiply(e).mod(r),i._shift(-1);return n},p.prototype.modInverse=function(t){t=new p(t);var r=this.extgcd(t),e=new p(1);return 0!==r[2].compareTo(e)?null:r[0]._add(t)._mod(t)},p.prototype.isProbablePrime=function(t){var r=this.element;if(0===r.length||1===r.length&&r[0]<=2)return!0;if(0==(1&r[0])||t<=0)return!1;if(void 0===_)return!1;t>>=1;for(var e,n,i=new p(0),o=new p(1),a=this,s=a.bitLength(),h=a.subtract(o),l=h.getLowestSetBit(),u=h.shift(-l),c=new _,f=0;f<t;f++){for(;0===(e=new p(s,c)).compareTo(i)||-1!==e.compareTo(a););if(0!==(e=e.modPow(u,a)).compareTo(o)){n=!0;for(var m=0;m<=l;m++){if(0===e.compareTo(h)){n=!1;break}m<l&&(e=e.multiply(e)._mod(a))}if(n)return!1}}return!0},p.prototype.nextProbablePrime=function(){if(void 0===_)return new p(0);for(var t=this.clone(),r=new p(1);t._add(r),!t.isProbablePrime(100););return t},p.valueOf=function(t){return new p(t)},p.probablePrime=function(t,r){return new p(t,100,r)},p.ONE=new p(1),p.TEN=new p(10),p.ZERO=new p(0);var w=function t(){this.integer=0;var r=this._scale=0,e=0,n=null;if(1<=arguments.length&&(r=arguments[0]),2<=arguments.length&&(e=arguments[1]),3<=arguments.length&&(n=arguments[2]),e instanceof x&&(n=e),r instanceof t)this.integer=r.integer.clone(),this._scale=r._scale,this.int_string=r.int_string;else if(r instanceof p)this.integer=r.clone(),this._scale=e;else if("number"==typeof r)if(r===Math.floor(r))this.integer=new p(r),this._scale=0;else{for(this._scale=0;r*=10,this._scale=this._scale+1,r!==Math.floor(r););this.integer=new p(r)}else if("string"==typeof r){var i;this._scale=0;var o=r.replace(/\s/g,"").toLowerCase(),a="";null!==(i=o.match(/^[+-]+/))&&(i=i[0],o=o.substr(i.length),-1!==i.indexOf("-")&&(a+="-")),null!==(i=o.match(/^[0-9]+/))&&(i=i[0],o=o.substr(i.length),a+=i),null!==(i=o.match(/^\.[0-9]+/))&&(i=i[0],o=o.substr(i.length),i=i.substr(1),this._scale=this._scale+i.length,a+=i),null!==(i=o.match(/^e[+-]?[0-9]+/))&&(i=i[0].substr(1),this._scale=this._scale-parseInt(i,10)),this.integer=new p(a,10)}if(n instanceof x){var s=this.round(n);this.integer=s.integer,this._scale=s._scale}};w.prototype._getUnsignedIntegerString=function(){return void 0===this.int_string&&(this.int_string=this.integer.toString(10).replace(/^-/,"")),this.int_string},w.prototype.clone=function(){return new w(this)},w.prototype.scale=function(){return this._scale},w.prototype.signum=function(){return this.integer.signum()},w.prototype.precision=function(){return this._getUnsignedIntegerString().length},w.prototype.unscaledValue=function(){return new p(this.integer)},w.prototype.toScientificNotation=function(t){var r,e,n=this._getUnsignedIntegerString(),i=this.scale(),o=[];if(-1===this.signum()&&(o[o.length]="-"),0<=(i=-t-i))for(o[o.length]=n,r=0;r<i;r++)o[o.length]="0";else if(0<(e=this.precision()+i))o[o.length]=n.substring(0,e),o[o.length]=".",o[o.length]=n.substring(e,n.length);else{for(e=-e,o[o.length]="0.",r=0;r<e;r++)o[o.length]="0";o[o.length]=n}return o[o.length]="E",0<=t&&(o[o.length]="+"),o[o.length]=t,o.join("")},w.prototype.toString=function(){var t=-this.scale()+(this.precision()-1);return 0<=this.scale()&&-6<=t?this.toPlainString():this.toScientificNotation(t)},w.prototype.toEngineeringString=function(){var t=-this.scale()+(this.precision()-1);return 0<=this.scale()&&-6<=t?this.toPlainString():this.toScientificNotation(3*Math.floor(t/3))},w.prototype.toPlainString=function(){return 0===this.scale()?this.signum()<0?"-"+this._getUnsignedIntegerString():this._getUnsignedIntegerString():this.toScientificNotation(0).match(/^[^E]*/)[0]},w.prototype.ulp=function(){return new w(p.ONE,this.scale())},w.prototype.setScale=function(t,r){if(this.scale()===t)return this.clone();r=1===arguments.length?y.UNNECESSARY:y.getRoundingMode(r);var e=this._getUnsignedIntegerString(),n=this.signum(),i=0<=n?"":"-",o=t-this.scale();if(0<=o){var a;for(a=0;a<o;a++)e+="0";return new w(new p(i+e),t)}var s=e.length+o,h=s+1;if(s<=0){var l=(n+r.getAddNumber(n))/10;return new w(new p(l),t)}var u=e.match(/0+$/);if(0<=(null!==u?u[0].length:0)+o||r===y.DOWN)return new w(new p(i+e.substring(0,s)),t);var c=1<(e=e.substring(0,h)).length?2:1,f=parseInt(e.substring(e.length-c,e.length))*n,m=new p(i+e),g=new p(r.getAddNumber(f));return e=m.add(g).toString(),new w(new p(e.substring(0,e.length-1)),t)},w.prototype.round=function(t){if(!(t instanceof x))throw"not MathContext";var r=t.getPrecision(),e=r-this.precision();if(0===e||0===r)return this.clone();var n=this.setScale(this.scale()+e,t.getRoundingMode());if(0<e)return n;if(n.precision()===t.getPrecision())return n;var i=0<=n.integer.signum()?"":"-",o=n._getUnsignedIntegerString(),a=i+o.substring(0,o.length-1);return new w(new p(a),n.scale()-1)},w.prototype.abs=function(t){var r=this.clone();if(r.integer=r.integer.abs(),1===arguments.length)return r;if(!(t instanceof x))throw"not MathContext";return r.round(t)},w.prototype.plus=function(t){var r=this.clone();if(1===arguments.length)return r;if(!(t instanceof x))throw"not MathContext";return r.round(t)},w.prototype.negate=function(t){var r=this.clone();if(r.integer=r.integer.negate(),1===arguments.length)return r;if(!(t instanceof x))throw"not MathContext";return r.round(t)},w.prototype.compareTo=function(t){if(!(t instanceof w))throw"not BigDecimal";var r=this,e=t,n=r.signum(),i=e.signum();if(0===n&&n===i)return 0;if(0===n)return-i;if(0===i)return n;if(r._scale===e._scale)return r.integer.compareTo(e.integer);if(r._scale>e._scale){var o=e.setScale(r._scale);return r.integer.compareTo(o.integer)}return r.setScale(e._scale).integer.compareTo(e.integer)},w.prototype.equals=function(t){if(!(t instanceof w))throw"not BigDecimal";return this._scale===t._scale&&this.integer.equals(t.integer)},w.prototype.min=function(t){if(!(t instanceof w))throw"not BigDecimal";return this.compareTo(t)<=0?this.clone():t.clone()},w.prototype.max=function(t){if(!(t instanceof w))throw"not BigDecimal";return 0<=this.compareTo(t)?this.clone():t.clone()},w.prototype.movePointLeft=function(t){var r=this.scaleByPowerOfTen(-t);return r=r.setScale(Math.max(this.scale()+t,0))},w.prototype.movePointRight=function(t){var r=this.scaleByPowerOfTen(t);return r=r.setScale(Math.max(this.scale()-t,0))},w.prototype.scaleByPowerOfTen=function(t){var r=this.clone();return r._scale=this.scale()-t,r},w.prototype.stripTrailingZeros=function(){var t=0<=this.signum()?"":"-",r=this.integer.toString(10).replace(/^-/,""),e=r.match(/0+$/),n=null!==e?e[0].length:0;n===r.length&&(n=r.length-1);var i=this.scale()-n;return new w(new p(t+r.substring(0,r.length-n)),i)},w.prototype.add=function(t,r){if(1===arguments.length&&(r=x.UNLIMITED),!(t instanceof w))throw"not BigDecimal";if(!(r instanceof x))throw"not MathContext";var e=this,n=t,i=Math.max(e._scale,n._scale);if(e._scale===n._scale)return new w(e.integer.add(n.integer),i,r);if(e._scale>n._scale){var o=n.setScale(e._scale);return new w(e.integer.add(o.integer),i,r)}var a=e.setScale(n._scale);return new w(a.integer.add(n.integer),i,r)},w.prototype.subtract=function(t,r){if(1===arguments.length&&(r=x.UNLIMITED),!(t instanceof w))throw"not BigDecimal";if(!(r instanceof x))throw"not MathContext";var e=this,n=t,i=Math.max(e._scale,n._scale);if(e._scale===n._scale)return new w(e.integer.subtract(n.integer),i,r);if(e._scale>n._scale){var o=n.setScale(e._scale);return new w(e.integer.subtract(o.integer),i,r)}var a=e.setScale(n._scale);return new w(a.integer.subtract(n.integer),i,r)},w.prototype.multiply=function(t,r){if(1===arguments.length&&(r=x.UNLIMITED),!(t instanceof w))throw"not BigDecimal";if(!(r instanceof x))throw"not MathContext";var e=t,n=this.integer.multiply(e.integer),i=this._scale+e._scale;return new w(n,i,r)},w.prototype.divideToIntegralValue=function(t,r){if(1===arguments.length&&(r=x.UNLIMITED),!(t instanceof w))throw"not BigDecimal";if(!(r instanceof x))throw"not MathContext";var e=function(t){var r,e="1";for(r=0;r<t;r++)e+="0";return new p(e)};if(0===t.compareTo(w.ZERO))throw"ArithmeticException";var n=t,i=this.integer,o=n.integer,a=this._scale-n._scale;this._scale>n._scale?o=o.multiply(e(a)):this._scale<n._scale&&(i=i.multiply(e(-a)));var s=i.divide(o),h=s.signum();if(0!==h){var l=s.toString(10).replace(/^-/,"");if(0!==r.getPrecision()&&l.length>r.getPrecision())throw"ArithmeticException";if(l.length<=-a){var u=l.match(/0+$/),c=null!==u?u[0].length:0;return new w(new p((0<=h?"":"-")+l.substring(0,l.length-c)),-c)}}var f=new w(s);return f=(f=f.setScale(a,y.UP)).round(r)},w.prototype.divideAndRemainder=function(t,r){if(1===arguments.length&&(r=x.UNLIMITED),!(t instanceof w))throw"not BigDecimal";if(!(r instanceof x))throw"not MathContext";var e=this.divideToIntegralValue(t,r),n=this.subtract(e.multiply(t,r),r);return[e,n]},w.prototype.divide=function(t,r,e){if(!(t instanceof w))throw"not BigDecimal";var n,i,o=t,a=null,s=x.UNLIMITED,h=0,l=!1;if(1===arguments.length)h=this.scale()-o.scale(),l=!0;else if(2===arguments.length)n=r,h=this.scale(),l=!0,a=n instanceof x?(s=n).getRoundingMode():y.getRoundingMode(t);else{if(3!==arguments.length)throw"The argument is over.";if(!("number"==typeof r||r instanceof Number))throw"scale is not Integer";h=r,a=(n=e)instanceof x?(s=n).getRoundingMode():y.getRoundingMode(t)}if(0===o.compareTo(w.ZERO))throw"ArithmeticException";var u,c,f,m,g=this,p=[];m=w.ZERO;var _=s.getPrecision(),v=0!==_?_+8:262143;for(i=0;i<v&&(c=(u=g.divideAndRemainder(o,x.UNLIMITED))[0],f=u[1],m=m.add(c.scaleByPowerOfTen(-i),x.UNLIMITED),0!==f.compareTo(w.ZERO));i++){if(0===_){if(p[f._getUnsignedIntegerString()])throw"ArithmeticException "+m+"["+f._getUnsignedIntegerString()+"]";p[f._getUnsignedIntegerString()]=!0}g=f.scaleByPowerOfTen(1)}if(l)try{m=m.setScale(h,a)}catch(t){}else m=m.setScale(h,a);return m=m.round(s)},w.prototype.toBigInteger=function(){var t=this.toPlainString().replace(/\.\d*$/,"");return new p(t.toPlainString())},w.prototype.toBigIntegerExact=function(){var t=this.setScale(0,y.UNNECESSARY);return new p(t.toPlainString())},w.prototype.longValue=function(){var t=this.toBigInteger();return t=t.longValue()},w.prototype.longValueExact=function(){var t=this.toBigIntegerExact();return t=t.longValue()},w.prototype.intValue=function(){var t=this.toBigInteger();return 4294967295&(t=t.intValue())},w.prototype.intValueExact=function(){var t=this.toBigIntegerExact();if((t=t.longValue())<-2147483648||2147483647<t)throw"ArithmeticException";return t},w.prototype.floatValue=function(){var t=this.precision();return x.DECIMAL32.getPrecision()<t?0<=this.signum()?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:parseFloat(t.toEngineeringString())},w.prototype.doubleValue=function(){var t=this.precision();return x.DECIMAL64.getPrecision()<t?0<=this.signum()?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:parseFloat(t.toEngineeringString())},w.prototype.pow=function(t,r){if(999999999<Math.abs(t))throw"ArithmeticException";if(1===arguments.length&&(r=x.UNLIMITED),!(r instanceof x))throw"not MathContext";if(0===r.getPrecision()&&t<0)throw"ArithmeticException";if(0<r.getPrecision()&&t>r.getPrecision())throw"ArithmeticException";var e,n;for(e=this.clone(),n=w.ONE;0!==t;)0!=(1&t)&&(n=n.multiply(e,x.UNLIMITED)),e=e.multiply(e,x.UNLIMITED),t>>>=1;return n.round(r)},w.valueOf=function(t,r){if(1===arguments.length)return new w(t);if(2!==arguments.length)throw"IllegalArgumentException";if("number"==typeof t&&t===Math.floor(t))return new w(new p(t),r);throw"IllegalArgumentException"};var y={UP:{toString:function(){return"UP"},getAddNumber:function(t){return 0===(t%=10)?0:0<t?10-t:-(10+t)}},DOWN:{toString:function(){return"DOWN"},getAddNumber:function(t){return-(t%=10)}},CEILING:{toString:function(){return"CEILING"},getAddNumber:function(t){return 0===(t%=10)?0:0<t?10-t:-t}},FLOOR:{toString:function(){return"FLOOR"},getAddNumber:function(t){return 0===(t%=10)?0:0<t?-t:-(10+t)}},HALF_UP:{toString:function(){return"HALF_UP"},getAddNumber:function(t){var r=0<=(t%=10)?1:-1;return Math.abs(t)<5?-1*t:r*(10-Math.abs(t))}},HALF_DOWN:{toString:function(){return"HALF_DOWN"},getAddNumber:function(t){var r=0<=(t%=10)?1:-1;return Math.abs(t)<6?-1*t:r*(10-Math.abs(t))}},HALF_EVEN:{toString:function(){return"HALF_EVEN"},getAddNumber:function(t){var r,e;return e=1===((t%=100)<0?(r=-1,1&Math.ceil(t/10)):(r=1)&Math.floor(t/10))?5:6,t%=10,Math.abs(t)<e?-1*t:r*(10-Math.abs(t))}},UNNECESSARY:{toString:function(){return"UNNECESSARY"},getAddNumber:function(t){if(0===(t%=10))return 0;throw"ArithmeticException"}},valueOf:function(t){if(null===t)throw"NullPointerException";for(var r=y.values,e=0;e<r.length;e++)if(r[e].toString()===t)return r[e];throw"IllegalArgumentException"},getRoundingMode:function(t){var r;switch(t){case y.CEILING:case y.DOWN:case y.FLOOR:case y.HALF_DOWN:case y.HALF_EVEN:case y.HALF_UP:case y.UNNECESSARY:case y.UP:r=t;break;default:"number"==typeof t||t instanceof Number?r=y.values[t]:("string"==typeof t||t instanceof String)&&(r=y.valueOf(t))}if(!r)throw"Not RoundingMode";return r}};y.values={0:y.CEILING,1:y.DOWN,2:y.FLOOR,3:y.HALF_DOWN,4:y.HALF_EVEN,5:y.HALF_UP,6:y.UNNECESSARY,7:y.UP};var x=function(){this.precision=0,this.roundingMode=y.HALF_UP;var t,r=0,e=0;if(1<=arguments.length&&(r=arguments[0]),2<=arguments.length&&(e=arguments[1]),"string"==typeof r||r instanceof String?(null!==(t=r.match(/precision=\d+/))&&(t=t[0].substring("precision=".length,t[0].length),this.precision=parseInt(t,10)),null!==(t=r.match(/roundingMode=\w+/))&&(t=t[0].substring("roundingMode=".length,t[0].length),this.roundingMode=y.valueOf(t))):1===arguments.length?this.precision=r:2===arguments.length&&(this.precision=r,this.roundingMode=e),this.precision<0)throw"IllegalArgumentException"};x.prototype.getPrecision=function(){return this.precision},x.prototype.getRoundingMode=function(){return this.roundingMode},x.prototype.equals=function(t){return t instanceof x&&t.toString()===this.toString()},x.prototype.toString=function(){return"precision="+this.precision+" roundingMode="+this.roundingMode.toString()},x.UNLIMITED=new x(0,y.HALF_UP),x.DECIMAL32=new x(7,y.HALF_EVEN),x.DECIMAL64=new x(16,y.HALF_EVEN),x.DECIMAL128=new x(34,y.HALF_EVEN),w.RoundingMode=y,w.MathContext=x,w.ZERO=new w(0),w.ONE=new w(1),w.TEN=new w(10),w.ROUND_CEILING=y.CEILING,w.ROUND_DOWN=y.DOWN,w.ROUND_FLOOR=y.FLOOR,w.ROUND_HALF_DOWN=y.HALF_DOWN,w.ROUND_HALF_EVEN=y.HALF_EVEN,w.ROUND_HALF_UP=y.HALF_UP,w.ROUND_UNNECESSARY=y.UNNECESSARY,w.ROUND_UP=y.UP;var u=function(){};u.gammaln=function(t){for(var r=Math.log(2*Math.PI),e=[-15238221.539407417,691472.268851313,-36108.77125372499,8553103/6/650,-156.84828462600203,854513/138/462,-174611/330/380,43867/798/306,-3617/510/240,7/6/182,-691/2730/132,5/66/90,-1/30/56,1/42/30,-1/30/12,1/6/2],n=1;t<e.length;)n*=t,t++;for(var i=1/(t*t),o=e[0],a=1;a<e.length;a++)o*=i,o+=e[a];return o/=t,o+=.5*r,o+=-Math.log(n)-t+(t-.5)*Math.log(t)},u.q_gamma=function(t,r,e){var n,i,o,a,s,h=1,l=1+t-r;if(t<1+r)return 1-u.p_gamma(t,r,e);for(i=(o=Math.exp(r*Math.log(t)-t-e))/l,n=2;n<1e3;n++)if(a=((n-1-r)*(l-h)+(n+t)*l)/n,s=i,(i+=a=(o*=(n-1-r)/n)/((h=l)*(l=a)))==s)return i;return Number.NaN},u.p_gamma=function(t,r,e){var n,i,o,a;if(1+r<=t)return 1-u.q_gamma(t,r,e);if(0===t)return 0;for(i=o=Math.exp(r*Math.log(t)-t-e)/r,n=1;n<1e3;n++)if(a=i,(i+=o*=t/(r+n))==a)return i;return Number.NaN},u.gamma=function(t){return t<0?Math.PI/(Math.sin(Math.PI*t)*Math.exp(u.gammaln(1-t))):Math.exp(u.gammaln(t))},u.gammainc=function(t,r,e){if("lower"===e)return u.p_gamma(t,r,u.gammaln(r));if("upper"===e)return u.q_gamma(t,r,u.gammaln(r));if(2===arguments.length)return u.gammainc(t,r,"lower");throw"gammainc unsupported argument ["+e+"]"},u.gampdf=function(t,r,e){var n=1/(u.gamma(r)*Math.pow(e,r));return n*=Math.pow(t,r-1),n*=Math.exp(-t/e)},u.gamcdf=function(t,r,e){return u.gammainc(t/e,r)},u.gaminv=function(t,r,e){if(t<0||1<t)return Number.NaN;if(0==t)return 0;if(1==t)return Number.POSITIVE_INFINITY;for(var n,i,o=r*e,a=0;a<100&&(n=(i=o-(u.gamcdf(o,r,e)-t)/u.gampdf(o,r,e))-o,!(Math.abs(n)<=1e-12));a++)o=i;return o},u.beta=function(t,r){return Math.exp(u.gammaln(t)+u.gammaln(r)-u.gammaln(t+r))},u.p_beta=function(t,r,e){var n,i,o,a;if(r<=0)return Number.POSITIVE_INFINITY;if(e<=0)return t<1?0:1===t?1:Number.POSITIVE_INFINITY;if((r+1)/(r+e+2)<t)return 1-u.p_beta(1-t,e,r);if(t<=0)return 0;for(o=r*Math.log(t),o+=e*Math.log(1-t),o+=u.gammaln(r+e),o-=u.gammaln(r)+u.gammaln(e),o=Math.exp(o),i=o/=r,n=1;n<1e3;n++)if(o*=r+e+n-1,o*=t,a=i,(i+=o/=r+n)===a)return i;return Number.NaN},u.q_beta=function(t,r,e){return 1-u.p_beta(t,r,e)},u.betainc=function(t,r,e,n){if("lower"===n)return u.p_beta(t,r,e);if("upper"===n)return u.q_beta(t,r,e);if(3===arguments.length)return u.betainc(t,r,e,"lower");throw"betainc unsupported argument ["+n+"]"},u.betapdf=function(t,r,e){return Math.pow(t,r-1)*Math.pow(1-t,e-1)/u.beta(r,e)},u.betacdf=function(t,r,e){return u.betainc(t,r,e)},u.betainv=function(t,r,e){if(t<0||1<t)return Number.NaN;if(1==t&&0<r&&0<e)return 1;var n,i,o;n=0==e?1-1e-14:0==r?1e-14:r/(r+e);for(var a=0;a<100&&(i=(o=n-(u.betacdf(n,r,e)-t)/u.betapdf(n,r,e))-n,!(Math.abs(i)<=1e-14));a++)n=o;return n},u.factorial=function(t){var r=u.gamma(t+1);return(0|t)===t?Math.round(r):r},u.nchoosek=function(t,r){return Math.round(u.factorial(t)/(u.factorial(t-r)*u.factorial(r)))},u.erf=function(t){return u.p_gamma(t*t,.5,.5*Math.log(Math.PI))*(0<=t?1:-1)},u.erfc=function(t){return 1-u.erf(t)},u.normpdf=function(t,r,e){var n="number"==typeof r?r:0,i="number"==typeof e?e:1,o=1/Math.sqrt(2*Math.PI*i*i);return o*=Math.exp(-(t-n)*(t-n)/(2*i*i))},u.normcdf=function(t,r,e){return(1+u.erf((t-("number"==typeof r?r:0))/(("number"==typeof e?e:1)*Math.sqrt(2))))/2},u.norminv=function(t,r,e){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;for(var n,i,o="number"==typeof r?r:0,a="number"==typeof e?e:1,s=o,h=0;h<200&&(n=(i=s-(u.normcdf(s,o,a)-t)/u.normpdf(s,o,a))-s,!(Math.abs(n)<=1e-12));h++)s=i;return s},u.tpdf=function(t,r){var e=1/(Math.sqrt(r)*u.beta(.5,.5*r));return e*=Math.pow(1+t*t/r,.5*-(r+1))},u.tcdf=function(t,r){return.5*(1+u.betainc(t*t/(r+t*t),.5,.5*r)*(t<0?-1:1))},u.tinv=function(t,r){if(t<0||1<t)return Number.NaN;if(0==t)return Number.NEGATIVE_INFINITY;if(1==t)return Number.POSITIVE_INFINITY;if(t<.5){var e=u.betainv(2*t,.5*r,.5);return-Math.sqrt(r/e-r)}var n=u.betainv(2*(1-t),.5*r,.5);return Math.sqrt(r/n-r)},u.tdist=function(t,r,e){return(1-u.tcdf(t,r))*e},u.tinv2=function(t,r){return-u.tinv(.5*t,r)},u.chi2pdf=function(t,r){if(t<=0)return 0;var e=Math.pow(t,r/2-1)*Math.exp(-t/2);return e/=Math.pow(2,r/2)*u.gamma(r/2)},u.chi2cdf=function(t,r){return u.gammainc(t/2,r/2)},u.chi2inv=function(t,r){return u.gaminv(t,r/2,2)},u.fpdf=function(t,r,e){var n=1;return n*=Math.pow(r*t/(r*t+e),r/2),n*=Math.pow(1-r*t/(r*t+e),e/2),n/=t*u.beta(r/2,e/2)},u.fcdf=function(t,r,e){return u.betacdf(r*t/(r*t+e),r/2,e/2)},u.finv=function(t,r,e){return(1/u.betainv(1-t,e/2,r/2)-1)*e/r};var t=new _,n=function(t,r){var e=t.replace(/\s/g,"").toLowerCase();if(!/[ij]/.test(e))return r._re=parseFloat(e),void(r._im=0);var n,i=0,o=0;(n=e.match(/[+-]?[0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?($|[+-])/))&&(i=parseFloat(n[0])),(n=e.match(/[+-]?([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)?[ij]/))&&(n=n[0].substring(0,n[0].length-1),o=/^[-+]$/.test(n)||0===n.length?"-"===n?-1:1:parseFloat(n)),r._re=i,r._im=o},S=function t(r){if(1!==arguments.length)throw"Complex Many arguments : "+arguments.length;var e=r;if(e instanceof t||e instanceof Object&&e._re&&e._im)this._re=e._re,this._im=e._im;else if("number"==typeof e||e instanceof Number)this._re=e,this._im=0;else if(e instanceof Array&&2===e.length)this._re=e[0],this._im=e[1];else if("string"==typeof e||e instanceof String)n(e,this);else{if(!(e instanceof Object&&e.toString))throw"Complex Unsupported argument";n(e.toString(),this)}},r={real:{configurable:!0},imag:{configurable:!0},norm:{configurable:!0},angle:{configurable:!0}};S.prototype.clone=function(){return this},S.prototype.toString=function(){var t=function(t){var r=t.toPrecision(6);return-1!==r.indexOf(".")&&(r=(r=r.replace(/\.?0+$/,"")).replace(/\.?0+e/,"e")),r};return this.isReal()?t(this._re):0===this._re?t(this._im)+"i":0<=this._im?t(this._re)+" + "+t(this._im)+"i":t(this._re)+" - "+t(-this._im)+"i"},S.createConstComplex=function(t){return t instanceof S?t:new S(t)},S.rand=function(){return new S(t.nextDouble())},S.randn=function(){return new S(t.nextGaussian())},S.prototype.equals=function(t,r){var e=S.createConstComplex(t),n=r||Number.EPSILON;return Math.abs(this._re-e._re)<n&&Math.abs(this._im-e._im)<n},r.real.get=function(){return this._re},r.imag.get=function(){return this._im},r.norm.get=function(){return 0===this._im?Math.abs(this._re):0===this._re?Math.abs(this._im):Math.sqrt(this._re*this._re+this._im*this._im)},r.angle.get=function(){return 0===this._im?0:0===this._re?Math.PI*(0<=this._im?.5:-.5):Math.atan2(this._im,this._re)},S.prototype.getDecimalPosition=function(){for(var t=0,r=this,e=0;e<20&&!r.isComplexInteger();e++)r=r.mul(S.TEN),t++;return t},S.prototype.add=function(t){var r=new S(t);return r._re=this._re+r._re,r._im=this._im+r._im,r},S.prototype.sub=function(t){var r=new S(t);return r._re=this._re-r._re,r._im=this._im-r._im,r},S.prototype.mul=function(t){var r=new S(t);if(0===this._im&&0===r._im)return r._re=this._re*r._re,r;if(0===this._re&&0===r._re)return r._re=-this._im*r._im,r._im=0,r;var e=this._re*r._re-this._im*r._im,n=this._im*r._re+this._re*r._im;return r._re=e,r._im=n,r},S.prototype.dot=function(t){var r=new S(t);if(0===this._im&&0===r._im)return r._re=this._re*r._re,r;if(0===this._re&&0===r._re)return r._re=this._im*r._im,r._im=0,r;var e=this._re*r._re+this._im*r._im,n=-this._im*r._re+this._re*r._im;return r._re=e,r._im=n,r},S.prototype.div=function(t){var r=new S(t);if(0===this._im&&0===r._im)return r._re=this._re/r._re,r;if(0===this._re&&0===r._re)return r._re=this._im/r._im,r._im=0,r;var e=this._re*r._re+this._im*r._im,n=this._im*r._re-this._re*r._im,i=1/(r._re*r._re+r._im*r._im);return r._re=e*i,r._im=n*i,r},S.prototype.mod=function(t){var r=new S(t);if(0!==this._im||0!==r._im)throw"calculation method is undefined.";var e=this._re-r._re*(0|this._re/r._re);return e<0&&(e+=r._re),r._re=e,r},S.prototype.inv=function(){return 0===this._im?new S(1/this._re):0===this._re?new S([0,-1/this._im]):S.ONE.div(this)},S.prototype.sign=function(){return 0===this._im?0===this._re?new S(0):new S(0<this._re?1:-1):this.div(this.norm)},S.prototype.max=function(t,r){var e=S.createConstComplex(t);return this.compareTo(e,r)<=0?this:e},S.prototype.min=function(t,r){var e=S.createConstComplex(t);return 0<=this.compareTo(e,r)?this:e},S.prototype.compareTo=function(t,r){var e=S.createConstComplex(t);return this.equals(e,r)?0:this.real+this.imag<e.real+e.imag?1:-1},S.prototype.isInteger=function(t){var r=t||Number.EPSILON;return this.isReal()&&Math.abs(this._re-(0|this._re))<r},S.prototype.isComplexInteger=function(t){var r=t||Number.EPSILON;return Math.abs(this._re-(0|this._re))<r&&Math.abs(this._im-(0|this._im))<r},S.prototype.isZero=function(t){var r=t||Number.EPSILON;return Math.abs(this._re)<r&&Math.abs(this._im)<r},S.prototype.isOne=function(t){var r=t||Number.EPSILON;return Math.abs(this._re-1)<r&&Math.abs(this._im)<r},S.prototype.isComplex=function(t){var r=t||Number.EPSILON;return Math.abs(this._im)>=r},S.prototype.isReal=function(t){var r=t||Number.EPSILON;return Math.abs(this._im)<r},S.prototype.isNaN=function(){return Math.isNaN(this._re)||Math.isNaN(this._im)},S.prototype.isPositive=function(){return 0<this._re},S.prototype.isNegative=function(){return this._re<0},S.prototype.isNotNegative=function(){return 0<=this._re},S.prototype.isInfinite=function(){return this._re===Number.POSITIVE_INFINITY||this._im===Number.POSITIVE_INFINITY||this._re===Number.NEGATIVE_INFINITY||this._im===Number.NEGATIVE_INFINITY},S.prototype.isFinite=function(){return!this.isNaN()&&!this.isInfinite()},S.prototype.abs=function(){return new S(this.norm)},S.prototype.conj=function(){return 0===this._im?this:new S([this._re,-this._im])},S.prototype.negate=function(){return new S([-this._re,-this._im])},S.prototype.pow=function(t){var r=new S(t);if(this.isReal()&&r.isReal()&&this.isNotNegative())return r._re=Math.pow(this._re,r._re),r;if(r.isReal()){var e=Math.pow(this.norm,r._re),n=this.angle*r._re;return r._re=e*Math.cos(n),r._im=e*Math.sin(n),r}return r.mul(this.log()).exp()},S.prototype.square=function(){return new S(this._re*this._re+this._im*this._im)},S.prototype.sqrt=function(){if(this.isReal())return this.isNotNegative()?new S(Math.sqrt(this._re)):new S([0,Math.sqrt(this._re)]);var t=Math.sqrt(this.norm),r=.5*this.angle;return new S([t*Math.cos(r),t*Math.sin(r)])},S.prototype.log=function(){return this.isReal()&&this.isNotNegative()?new S(Math.log(this._re)):new S([Math.log(this.norm),this.angle])},S.prototype.exp=function(){if(this.isReal())return new S(Math.exp(this._re));var t=Math.exp(this._re);return new S([t*Math.cos(this._im),t*Math.sin(this._im)])},S.prototype.sin=function(){if(this.isReal())return new S(Math.sin(this._re));var t=this.mul(S.I).exp(),r=this.mul(S.I.negate()).exp();return t.sub(r).div([0,2])},S.prototype.cos=function(){if(this.isReal())return new S(Math.cos(this._re));var t=this.mul(S.I).exp(),r=this.mul(S.I.negate()).exp();return t.add(r).div(2)},S.prototype.tan=function(){return this.isReal()?new S(Math.tan(this._re)):this.sin().div(this.cos())},S.prototype.atan=function(){return this.isReal()?new S(Math.atan(this._re)):S.I.div(S.TWO).mul(S.I.add(this).div(S.I.sub(this)).log())},S.prototype.atan2=function(){for(var t=arguments.length,r=Array(t);t--;)r[t]=arguments[t];if(0===arguments.length)return new S(this.angle);var e=new(Function.prototype.bind.apply(S,[null].concat(r)));if(this.isReal()&&e.isReal())return new S(Math.atan2(this._re,e._re));throw"calculation method is undefined."},S.prototype.floor=function(){return new S([Math.floor(this._re),Math.floor(this._im)])},S.prototype.ceil=function(){return new S([Math.ceil(this._re),Math.ceil(this._im)])},S.prototype.round=function(){return new S([Math.round(this._re),Math.round(this._im)])},S.prototype.fix=function(){return new S([0|this._re,0|this._im])},S.prototype.fract=function(){return new S([this._re-(0|this._re),this._im-(0|this._im)])},S.prototype.gammaln=function(){if(this.isComplex())throw"gammaln don't support complex numbers.";return new S(u.gammaln(this._re))},S.prototype.gamma=function(){if(this.isComplex())throw"gamma don't support complex numbers.";return new S(u.gamma(this._re))},S.prototype.gammainc=function(t,r){var e=S.createConstComplex(t);if(this.isComplex()||e.isComplex())throw"gammainc don't support complex numbers.";var n=2===arguments.length?r:"lower";return new S(u.gammainc(this._re,e._re,n))},S.prototype.gampdf=function(t,r){var e=S.createConstComplex(t),n=S.createConstComplex(r);if(this.isComplex()||e.isComplex()||n.isComplex())throw"gampdf don't support complex numbers.";return new S(u.gampdf(this._re,e._re,n._re))},S.prototype.gamcdf=function(t,r){var e=S.createConstComplex(t),n=S.createConstComplex(r);if(this.isComplex()||e.isComplex()||n.isComplex())throw"gamcdf don't support complex numbers.";return new S(u.gamcdf(this._re,e._re,n._re))},S.prototype.gaminv=function(t,r){var e=S.createConstComplex(t),n=S.createConstComplex(r);if(this.isComplex()||e.isComplex()||n.isComplex())throw"gaminv don't support complex numbers.";return new S(u.gaminv(this._re,e._re,n._re))},S.prototype.beta=function(t){var r=S.createConstComplex(t);if(this.isComplex()||r.isComplex())throw"beta don't support complex numbers.";return new S(u.beta(this._re,r._re))},S.prototype.betainc=function(t,r,e){var n=S.createConstComplex(t),i=S.createConstComplex(r);if(this.isComplex()||n.isComplex()||i.isComplex())throw"betainc don't support complex numbers.";var o=2===arguments.length?e:"lower";return new S(u.betainc(this._re,n._re,i._re,o))},S.prototype.betapdf=function(t,r){var e=S.createConstComplex(t),n=S.createConstComplex(r);if(this.isComplex()||e.isComplex()||n.isComplex())throw"betapdf don't support complex numbers.";return new S(u.betapdf(this._re,e._re,n._re))},S.prototype.betacdf=function(t,r){var e=S.createConstComplex(t),n=S.createConstComplex(r);if(this.isComplex()||e.isComplex()||n.isComplex())throw"betacdf don't support complex numbers.";return new S(u.betacdf(this._re,e._re,n._re))},S.prototype.betainv=function(t,r){var e=S.createConstComplex(t),n=S.createConstComplex(r);if(this.isComplex()||e.isComplex()||n.isComplex())throw"betainv don't support complex numbers.";return new S(u.betainv(this._re,e._re,n._re))},S.prototype.factorial=function(){if(this.isComplex())throw"factorial don't support complex numbers.";return new S(u.factorial(this._re))},S.prototype.nchoosek=function(t){var r=S.createConstComplex(t);if(this.isComplex()||r.isComplex())throw"nchoosek don't support complex numbers.";return new S(u.nchoosek(this._re,r._re))},S.prototype.erf=function(){if(this.isComplex())throw"erf don't support complex numbers.";return new S(u.erf(this._re))},S.prototype.erfc=function(){if(this.isComplex())throw"erfc don't support complex numbers.";return new S(u.erfc(this._re))},S.prototype.normpdf=function(t,r){var e=arguments.length<=0?S.createConstComplex(t):S.ZERO,n=arguments.length<=1?S.createConstComplex(r):S.ONE;if(this.isComplex()||e.isComplex()||n.isComplex())throw"normpdf don't support complex numbers.";return new S(u.normpdf(this._re,e._re,n._re))},S.prototype.normcdf=function(t,r){var e=arguments.length<=0?S.createConstComplex(t):S.ZERO,n=arguments.length<=1?S.createConstComplex(r):S.ONE;if(this.isComplex()||e.isComplex()||n.isComplex())throw"normcdf don't support complex numbers.";return new S(u.normcdf(this._re,e._re,n._re))},S.prototype.norminv=function(t,r){var e=arguments.length<=0?S.createConstComplex(t):S.ZERO,n=arguments.length<=1?S.createConstComplex(r):S.ONE;if(this.isComplex()||e.isComplex()||n.isComplex())throw"norminv don't support complex numbers.";return new S(u.norminv(this._re,e._re,n._re))},S.prototype.tcdf=function(t){var r=S.createConstComplex(t);if(this.isComplex()||r.isComplex())throw"tcdf don't support complex numbers.";return new S(u.tcdf(this._re,r._re))},S.prototype.tinv=function(t){var r=S.createConstComplex(t);if(this.isComplex()||r.isComplex())throw"tinv don't support complex numbers.";return new S(u.tinv(this._re,r._re))},S.prototype.tdist=function(t,r){var e=S.createConstComplex(t),n=S.createConstComplex(r);if(this.isComplex()||e.isComplex()||n.isComplex())throw"tcdf don't support complex numbers.";return new S(u.tdist(this._re,e._re,n._re))},S.prototype.tinv2=function(t){var r=S.createConstComplex(t);if(this.isComplex()||r.isComplex())throw"tinv don't support complex numbers.";return new S(u.tinv2(this._re,r._re))},S.tdist=function(t,r,e){return(1-u.tcdf(t,r))*e},S.prototype.chi2pdf=function(t){var r=S.createConstComplex(t);if(this.isComplex()||r.isComplex())throw"chi2pdf don't support complex numbers.";return new S(u.chi2pdf(this._re,r._re))},S.prototype.chi2cdf=function(t){var r=S.createConstComplex(t);if(this.isComplex()||r.isComplex())throw"chi2cdf don't support complex numbers.";return new S(u.chi2cdf(this._re,r._re))},S.prototype.chi2inv=function(t){var r=S.createConstComplex(t);if(this.isComplex()||r.isComplex())throw"chi2inv don't support complex numbers.";return new S(u.chi2inv(this._re,r._re))},S.prototype.fpdf=function(t,r){var e=S.createConstComplex(t),n=S.createConstComplex(r);if(this.isComplex()||e.isComplex()||n.isComplex())throw"fpdf don't support complex numbers.";return new S(u.fpdf(this._re,e._re,n._re))},S.prototype.fcdf=function(t,r){var e=S.createConstComplex(t),n=S.createConstComplex(r);if(this.isComplex()||e.isComplex()||n.isComplex())throw"fcdf don't support complex numbers.";return new S(u.fcdf(this._re,e._re,n._re))},S.prototype.finv=function(t,r){var e=S.createConstComplex(t),n=S.createConstComplex(r);if(this.isComplex()||e.isComplex()||n.isComplex())throw"finv don't support complex numbers.";return new S(u.finv(this._re,e._re,n._re))},Object.defineProperties(S.prototype,r),S.I=new S([0,1]),S.PI=new S(Math.PI),S.ZERO=new S(0),S.HALF=new S(.5),S.ONE=new S(1),S.MINUS=new S(-1),S.TWO=new S(2),S.TEN=new S(10);var i=function t(r){this.size=r,this.inv_size=1/this.size,this.bit_size=Math.round(Math.log(this.size)/Math.log(2)),this.is_fast=1<<this.bit_size===this.size,this.bitrv=null,this.fft_re=new Array(this.size),this.fft_im=new Array(this.size);for(var e=-2*Math.PI/this.size,n=0,i=0,o=0;i<this.size;i++){this.fft_re[i]=Math.cos(o),this.fft_im[i]=Math.sin(o);var a=e+n,s=o+a;n=s-o-a,o=s}this.is_fast&&(this.bitrv=t.create_bit_reverse_table(this.bit_size))};i.bit_reverse_32=function(t){var r=4294967295&t;return r=(65535&(r=(16711935&(r=(252645135&(r=(858993459&(r=(1431655765&r)<<1|r>>1&1431655765))<<2|r>>2&858993459))<<4|r>>4&252645135))<<8|r>>8&16711935))<<16|r>>16&65535},i.create_bit_reverse_table=function(t){for(var r=1<<t,e=[],n=0;n<r;n++)e[n]=i.bit_reverse_32(n)>>>32-t;return e},i.prototype.delete=function(){delete this.size,delete this.inv_size,delete this.bit_size,delete this.is_fast,delete this.bitrv,delete this.fft_re,delete this.fft_im},i.prototype.fft=function(t,r){var e=new Array(this.size),n=new Array(this.size);if(this.is_fast){for(var i=0;i<this.size;i++)e[i]=t[this.bitrv[i]],n[i]=r[this.bitrv[i]];for(var o=1,a=this.size/2,s=2,h=1<<this.bit_size-1;0<h;h>>=1){for(var l=0;l<a;l++)for(var u=l*s,c=0,f=0;c<o;c++,u++,f+=h){var m=e[u+o]*this.fft_re[f]-n[u+o]*this.fft_im[f],g=n[u+o]*this.fft_re[f]+e[u+o]*this.fft_im[f];e[u+o]=e[u]-m,n[u+o]=n[u]-g,e[u]+=m,n[u]+=g}a/=2,s*=2,o*=2}}else if(V.isContainsZero(r))for(var p=0;p<this.size;p++){e[p]=0;for(var _=n[p]=0,v=0;_<this.size;v=++_*p%this.size)e[p]+=t[_]*this.fft_re[v]-r[_]*this.fft_im[v],n[p]+=t[_]*this.fft_im[v]+r[_]*this.fft_re[v]}else for(var w=0;w<this.size;w++){e[w]=0;for(var y=n[w]=0,x=0;y<this.size;x=++y*w%this.size)e[w]+=t[y]*this.fft_re[x],n[w]+=t[y]*this.fft_im[x]}return{real:e,imag:n}},i.prototype.ifft=function(t,r){var e=new Array(this.size),n=new Array(this.size);if(this.is_fast){for(var i=0;i<this.size;i++)e[i]=t[this.bitrv[i]],n[i]=r[this.bitrv[i]];for(var o,a,s=1,h=this.size/2,l=2,u=1<<this.bit_size-1;0<u;u>>=1){for(var c=0;c<h;c++)for(var f=c*l,m=0,g=0;m<s;m++,f++,g+=u)o=e[f+s]*this.fft_re[g]+n[f+s]*this.fft_im[g],a=n[f+s]*this.fft_re[g]-e[f+s]*this.fft_im[g],e[f+s]=e[f]-o,n[f+s]=n[f]-a,e[f]+=o,n[f]+=a;h/=2,l*=2,s*=2}}else if(V.isContainsZero(r))for(var p=0;p<this.size;p++){e[p]=0;for(var _=n[p]=0,v=0;_<this.size;v=p*++_%this.size)e[p]+=t[_]*this.fft_re[v]+r[_]*this.fft_im[v],n[p]+=-t[_]*this.fft_im[v]+r[_]*this.fft_re[v]}else for(var w=0;w<this.size;w++){e[w]=0;for(var y=n[w]=0,x=0;y<this.size;x=w*++y%this.size)e[w]+=t[y]*this.fft_re[x],n[w]+=-t[y]*this.fft_im[x]}for(var d=0;d<this.size;d++)e[d]*=this.inv_size,n[d]*=this.inv_size;return{real:e,imag:n}};var e=function(t,r){this.object=r,this.table_max=t,this.table_size=0,this.table=[]};e.prototype.get=function(t){for(var r=0;r<this.table_size;r++)if(this.table[r].size===t){var e=this.table.splice(r,1);return this.table.unshift(e),e}var n=new this.object(t);this.table_size===this.table_max&&this.table.pop().delete();return this.table.unshift(n),n};var a=new e(4,i),o=function(t){this.size=t,this.dct_size=2*t,this.dct_re=new Array(this.size),this.dct_im=new Array(this.size);for(var r=1/Math.sqrt(this.size),e=r*Math.sqrt(2),n=0;n<this.size;n++){var i=-Math.PI*n/this.dct_size;this.dct_re[n]=Math.cos(i)*(0===n?r:e),this.dct_im[n]=Math.sin(i)*(0===n?r:e)}};o.prototype.delete=function(){delete this.size,delete this.dct_size,delete this.dct_re,delete this.dct_im},o.prototype.dct=function(t){for(var r=new Array(this.dct_size),e=new Array(this.dct_size),n=0;n<this.dct_size;n++)r[n]=n<this.size?t[n]:0,e[n]=0;for(var i=a.get(this.dct_size).fft(r,e),o=0;o<this.size;o++)r[o]=i.real[o]*this.dct_re[o]-i.imag[o]*this.dct_im[o];return r.splice(this.size),r},o.prototype.idct=function(t){for(var r=new Array(this.dct_size),e=new Array(this.dct_size),n=2*this.size,i=0;i<this.dct_size;i++)r[i]=i<this.size?n*t[i]*this.dct_re[i]:0,e[i]=i<this.size?n*t[i]*-this.dct_im[i]:0;var o=a.get(this.dct_size).ifft(r,e);return o.real.splice(this.size),o.real};var s=new e(4,o),V=function(){};V.isContainsZero=function(t){for(var r=0;r<t.length;r++)if(0!==t[r])return!0;return!1},V.sinc=function(t){return 0===t?1:Math.sin(t)/t},V.fft=function(t,r){return a.get(t.length).fft(t,r)},V.ifft=function(t,r){return a.get(t.length).ifft(t,r)},V.dct=function(t){return s.get(t.length).dct(t)},V.idct=function(t){return s.get(t.length).idct(t)},V.powerfft=function(t,r){for(var e=t.length,n=V.fft(t,r),i=new Array(e),o=0;o<e;o++)i[o]=n.real[o]*n.real[o]+n.imag[o]*n.imag[o];return i},V.conv=function(t,r,e,n){var i=!1;if(t.length===e.length){i=!0;for(var o=0;o<t.length;o++)if(t[o]!==e[o]||r[o]!==n[o]){i=!1;break}}var a=t.length,s=2*a;if(1<<Math.round(Math.log(a)/Math.log(2))===a){if(i){for(var h=t.length,l=new Array(s),u=new Array(s),c=0;c<s;c++)l[c]=c<h?t[c]:0,u[c]=c<h?r[c]:0;for(var f=V.fft(l,u),m=0;m<s;m++)l[m]=f.real[m]*f.real[m]-f.imag[m]*f.imag[m],u[m]=f.real[m]*f.imag[m]+f.imag[m]*f.real[m];var g=V.ifft(l,u);return g.real.splice(s-1),g.imag.splice(s-1),g}if(t.length===e.length){for(var p=t.length,_=new Array(s),v=new Array(s),w=new Array(s),y=new Array(s),x=0;x<s;x++)_[x]=x<p?t[x]:0,v[x]=x<p?r[x]:0,w[x]=x<p?e[x]:0,y[x]=x<p?n[x]:0;for(var d=V.fft(_,v),M=V.fft(w,y),b=new Array(s),C=new Array(s),E=0;E<s;E++)b[E]=d.real[E]*M.real[E]-d.imag[E]*M.imag[E],C[E]=d.real[E]*M.imag[E]+d.imag[E]*M.real[E];var N=V.ifft(b,C);return N.real.splice(s-1),N.imag.splice(s-1),N}}var I=!V.isContainsZero(r);I&&(I=!V.isContainsZero(n));for(var A=new Array(t.length+e.length-1),S=new Array(t.length+e.length-1),O=0;O<A.length;O++)A[O]=0,S[O]=0;if(I)for(var D=0;D<e.length;D++)for(var R=0;R<t.length;R++)A[D+R]+=t[R]*e[D];else for(var T=0;T<e.length;T++)for(var z=0;z<t.length;z++)A[T+z]+=t[z]*e[T]-r[z]*n[T],S[T+z]+=t[z]*n[T]+r[z]*e[T];return{real:A,imag:S}},V.xcorr=function(t,r,e,n){var i=!1;if(t.length===e.length){i=!0;for(var o=0;o<t.length;o++)if(t[o]!==e[o]||r[o]!==n[o]){i=!1;break}}if(t.length===e.length){var a=t.length,s=2*a;if(1<<Math.round(Math.log(a)/Math.log(2))===a){var h=null;if(i){for(var l=new Array(s),u=new Array(s),c=0;c<s;c++)l[c]=c<a?t[c]:0,u[c]=c<a?r[c]:0;var f=V.powerfft(l,u);h=V.ifft(f,u),l.pop(),u.pop();for(var m=0,g=a+1;m<l.length;m++,g++)s<=g&&(g=0),l[m]=h.real[g],u[m]=h.imag[g];return{real:l,imag:u}}for(var p=new Array(s),_=new Array(s),v=new Array(s),w=new Array(s),y=0;y<s;y++)p[y]=y<a?t[y]:0,_[y]=y<a?r[y]:0,v[y]=y<a?e[a-y-1]:0,w[y]=y<a?-n[a-y-1]:0;for(var x=V.fft(p,_),d=V.fft(v,w),M=new Array(s),b=new Array(s),C=0;C<s;C++)M[C]=x.real[C]*d.real[C]-x.imag[C]*d.imag[C],b[C]=x.real[C]*d.imag[C]+x.imag[C]*d.real[C];return(h=V.ifft(M,b)).real.splice(s-1),h.imag.splice(s-1),h}}var E=!V.isContainsZero(r);if(E&&(E=!V.isContainsZero(n)),i){var N=t.length,I=2*N;if(E){for(var A=new Array(N),S=0;S<N;S++)for(var O=N-S,D=A[S]=0;D<O;D++)A[S]+=t[D]*e[D+S];for(var R=new Array(I-1),T=new Array(I-1),z=0,P=N-1;z<N;z++,P--)R[z]=A[P],R[N+z-1]=A[z];for(var L=0;L<T.length;L++)T[L]=0;return{real:R,imag:T}}}for(var F=new Array(e.length),q=new Array(e.length),U=0;U<e.length;U++)F[U]=e[e.length-U-1],q[U]=-n[e.length-U-1];return V.conv(t,r,F,q)};var h=function(){};h.tridiagonalize=function(t){for(var r=t.getNumberMatrixArray(),u=function(t,r,e,n){for(var i=0,o=e||0,a=n||t.length,s=o;s<a;s++)i+=t[s]*r[s];return i},e=function(t,r,e){var n=r||0,i=e||t.length,o=Math.sqrt(u(t,t,n,i)),a=[];if(1e-10<=Math.abs(o)){var s;t[n]<0&&(o=-o);for(var h=n,l=0;h<i;h++,l++)a[l]=h===n?(a[l]=t[h]+o,s=1/Math.sqrt(a[l]*o),a[l]*s):t[h]*s}return{y1:-o,v:a}},n=r.length,i=[],o=[],a=0;a<n-2;a++){var s=r[a];i[a]=s[a];var h=e(s,a+1,n);o[a]=h.y1;for(var l=0;l<h.v.length;l++)s[a+1+l]=h.v[l];if(!(Math.abs(o[a])<1e-10)){for(var c=a+1;c<n;c++){for(var f=0,m=a+1;m<c;m++)f+=r[m][c]*s[m];for(var g=c;g<n;g++)f+=r[c][g]*s[g];i[c]=f}for(var p=u(s,i,a+1,n)/2,_=n-1;a<_;_--){var v=s[_],w=i[_]-p*v;i[_]=w;for(var y=_;y<n;y++){var x=v*i[y]+w*s[y];r[_][y]=r[_][y]-x}}}}2<=n&&(i[n-2]=r[n-2][n-2],o[n-2]=r[n-2][n-1]),1<=n&&(i[n-1]=r[n-1][n-1]);for(var d=n-1;0<=d;d--){var M=r[d];if(d<n-2)for(var b=d+1;b<n;b++)for(var C=r[b],E=u(M,C,d+1,n),N=d+1;N<n;N++)C[N]-=E*M[N];for(var I=0;I<n;I++)M[I]=0;M[d]=1}var A=O.createMatrixDoEachCalculation(function(t,r){return t===r?new S(i[t]):1===Math.abs(t-r)?new S(o[.5*(t+r)|0]):S.ZERO},n,n);return{P:new O(r).T(),H:A}},h.eig=function(t){for(var r=!1,e=t.tridiagonalize(),n=e.P.getNumberMatrixArray(),i=e.H.getNumberMatrixArray(),o=t.row_length,a=[],s=[],h=0;h<o;h++)a[h]=i[h][h],s[h]=0===h?0:i[h][h-1];for(var l=o-1;0<l;l--){var u=l;for(u=l;1<=u&&!(Math.abs(s[u])<=1e-10*(Math.abs(a[u-1])+Math.abs(a[u])));u--);if(u!=l){for(var c=0;;){if(100<++c){r=!0;break}var f=(a[l-1]-a[l])/2,m=s[l]*s[l],g=Math.sqrt(f*f+m);f<0&&(g=-g);for(var p=a[u]-a[l]+m/(f+g),_=s[u+1],v=u;v<l;v++){var w=void 0,y=void 0;Math.abs(p)>=Math.abs(_)?y=(m=-_/p)*(w=1/Math.sqrt(m*m+1)):w=(m=-p/_)*(y=1/Math.sqrt(m*m+1)),m=((f=a[v]-a[v+1])*y+2*w*s[v+1])*y,a[v]-=m,a[v+1]+=m,u<v&&(s[v]=w*s[v]-y*_),s[v+1]+=y*(w*f-2*y*s[v+1]);for(var x=0;x<o;x++)p=n[x][v],_=n[x][v+1],n[x][v]=w*p-y*_,n[x][v+1]=y*p+w*_;v<l-1&&(p=s[v+1],_=-y*s[v+2],s[v+2]*=w)}if(Math.abs(s[l])<=1e-10*(Math.abs(a[l-1])+Math.abs(a[l])))break}if(r)break}}return function(t,r){for(var e=r.length,n=[],i=0;i<e;i++)n[i]={sigma:r[i],index:i};n.sort(function(t,r){return t===r?0:t<r?-1:1});for(var o=O.zeros(e),a=O.zeros(e),s=0;s<e;s++)a.matrix_array[s][s]=new S(n[s].sigma),o.matrix_array[s][n[s].index]=S.ONE;return{V:t.mul(o),D:a}}(new O(n),a)};var m={match2:function(t,r){for(var e=[],n=t,i=!0,o=0;o<1e3;o++){if(null===(i=n.match(r))){n.length&&e.push([!1,n]);break}0<i.index&&e.push([!1,n.substr(0,i.index)]),e.push([!0,i[0]]),n=n.substr(i.index+i[0].length)}return e},trimBracket:function(t){return/^\[/.test(t)&&/\]$/.test(t)?t.substring(1,t.length-1):null},toMatrixFromStringForArrayJSON:function(t){var r=[],e=t.match(/\[[^\]]+\]/g);null===e&&(e=[t]);for(var n=0;n<e.length;n++){for(var i=e[n],o=i.substring(1,i.length-1).split(","),a=[],s=0;s<o.length;s++){var h=o[s];a[s]=new S(h)}r[n]=a}return r},InterpolationCalculation:function(t,r,e){var n=e.compareTo(t);if(0===n)return t;if(r.isZero())throw"IllegalArgumentException";if(r.isNegative()&&-1===n)throw"IllegalArgumentException";var i=[],o=t;i[0]=o;for(var a=1;a<65536&&(o=o.add(r)).compareTo(e)!==n;a++)i[a]=o;return i},toArrayFromString:function(t){if(":"===t.trim())return":";for(var r=new RegExp("("+/[+-]? *([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)?[ij]( *[+] *[- ]?([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)?)?/.source+")|("+/[+-]? *[0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?( *[+-] *[- ]?([0-9]+(\.[0-9]+)?(e[+-]?[0-9]+)?)?[ij])?/.source+")","i"),e=m.match2(t,r),n=[],i=0;i<e.length;i++){var o=e[i];if(o[0])if(i<e.length-2&&!e[i+1][0]&&/:/.test(e[i+1][1])){var a=void 0,s=void 0,h=void 0;i<e.length-4&&!e[i+3][0]&&/:/.test(e[i+3][1])?(a=new S(o[1]),s=new S(e[i+2][1]),h=new S(e[i+4][1]),i+=4):(a=new S(o[1]),s=S.ONE,h=new S(e[i+2][1]),i+=2);for(var l=m.InterpolationCalculation(a,s,h),u=0;u<l.length;u++)n.push(l[u])}else n.push(new S(o[1]))}return n},toMatrixFromStringForArrayETC:function(t){for(var r=t.split(";"),e=new Array(r.length),n=0;n<r.length;n++)e[n]=m.toArrayFromString(r[n]);return e},toMatrixFromStringForArray:function(t){return/[[\],]/.test(t)?m.toMatrixFromStringForArrayJSON(t):m.toMatrixFromStringForArrayETC(t)},toMatrixFromString:function(t){var r=t.replace(/^\s*|\s*$/g,""),e=m.trimBracket(r);return e?m.toMatrixFromStringForArray(e):[[new S(t)]]},isCorrectMatrixArray:function(t){if(0===t.length)return!1;var r=t[0].length;if(0===r)return!1;for(var e=1;e<t.length;e++)if(t[e].length!==r)return!1;return!0}},O=function t(r){var e=null,n=!1;if(1!==arguments.length)throw"Many arguments : "+arguments.length;var i=r;if(i instanceof t){e=new Array(i.row_length);for(var o=0;o<i.row_length;o++){e[o]=new Array(i.column_length);for(var a=0;a<i.column_length;a++)e[o][a]=i.matrix_array[o][a]}}else if(i instanceof S)e=[[i]];else if(i instanceof Array){e=[];for(var s=0;s<i.length;s++){var h=i[s];if(h instanceof Array){for(var l=new Array(h.length),u=0;u<h.length;u++){var c=h[u];if(c instanceof S)l[u]=c;else if(c instanceof t){if(!c.isScalar())throw"Matrix in matrix";l[u]=c.scalar}else l[u]=new S(c)}e[s]=l}else if(0===s&&(e[0]=new Array(i.length)),h instanceof S)e[0][s]=h;else if(h instanceof t){if(!h.isScalar())throw"Matrix in matrix";e[0][s]=h.scalar}else e[0][s]=new S(h)}}else e="string"==typeof i||i instanceof String?(n=!0,m.toMatrixFromString(i)):i instanceof Object&&i.toString?(n=!0,m.toMatrixFromString(i.toString())):[[new S(i)]];if(n)for(var f=0;f<e.length;f++)":"===e[f]&&e.splice(f--,1);if(!m.isCorrectMatrixArray(e))throw"new Matrix IllegalArgumentException";this.matrix_array=e,this.row_length=this.matrix_array.length,this.column_length=this.matrix_array[0].length,this.string_cash=null},l={scalar:{configurable:!0},length:{configurable:!0},norm1:{configurable:!0},norm2:{configurable:!0}};return O.prototype.clone=function(){return new O(this.matrix_array)},O.prototype.toString=function(){if(this.string_cash)return this.string_cash;var r=Math.pow(10,9),o=!1,n=!1,i=0;this._each(function(t){t.isReal()||(o=!0),Math.abs(t.real)>=r&&(n=!0),Math.abs(t.imag)>=r&&(n=!0),i=Math.max(i,t.getDecimalPosition())}),0<i&&(i=4);var a=0,s=[],h=function(t){if(!n)return t.toFixed(i);var r=t.toExponential(4).split("e"),e=r[1];return 2===e.length?e=e.substr(0,1)+"00"+e.substr(1):3===e.length&&(e=e.substr(0,1)+"0"+e.substr(1)),r[0]+"e"+e};this._each(function(t){var r={},e=t.real;if(r.re_sign=e<0?"-":" ",e=Math.abs(e),r.re_str=h(e),a=Math.max(a,r.re_str.length+1),o){var n=t.imag;r.im_sign=n<0?"-":"+",n=Math.abs(n),r.im_str=h(n),a=Math.max(a,r.im_str.length+1)}s.push(r)});var l=function(t,r){return"                                        ".substr(0,r-t.length)+t},u=[],c=this;return this._each(function(t,r,e){var n=s.shift(),i=l(n.re_sign+n.re_str,a);o&&(i+=" "+n.im_sign+l(n.im_str,a)+"i"),u.push(i),u.push(e<c.column_length-1?" ":"\n")}),this.string_cash=u.join(""),this.string_cash},O.prototype.equals=function(t,r){var e=this,n=O.createConstMatrix(t);if(e.row_length!==n.row_length||e.column_length!==n.column_length)return!1;if(1===e.row_length||1===e.column_length)return e.scalar.equals(n.scalar);for(var i=e.matrix_array,o=n.matrix_array,a=0;a<this.row_length;a++)for(var s=0;s<this.column_length;s++)if(!i[a][s].equals(o[a][s],r))return!1;return!0},O.prototype.getNumberMatrixArray=function(){for(var t=new Array(this.row_length),r=0;r<this.row_length;r++){t[r]=new Array(this.column_length);for(var e=0;e<this.column_length;e++)t[r][e]=this.matrix_array[r][e].real}return t},O.prototype.getComplexMatrixArray=function(){for(var t=new Array(this.row_length),r=0;r<this.row_length;r++){t[r]=new Array(this.column_length);for(var e=0;e<this.column_length;e++)t[r][e]=this.matrix_array[r][e]}return t},O.createConstMatrix=function(t){return 1===arguments.length&&t instanceof O?t:new O(t)},O.prototype._clearCash=function(){this.string_cash&&delete this.string_cash},O.prototype._each=function(t){for(var r=!1,e=0;e<this.row_length;e++)for(var n=0;n<this.column_length;n++){var i=t(this.matrix_array[e][n],e,n);void 0!==i&&(this.matrix_array[e][n]=i instanceof S?i:i instanceof O?i.scalar:new S(i),r=!0)}return r&&this._clearCash(),this},O.createMatrixDoEachCalculation=function(t,r,e){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";for(var n=r,i=e||r,o=new Array(n),a=0;a<n;a++){o[a]=new Array(i);for(var s=0;s<i;s++){var h=t(a,s);void 0!==h&&(o[a][s]=h instanceof S?h:h instanceof O?h.scalar:new S(h))}}return new O(o)},O.prototype.cloneMatrixDoEachCalculation=function(t){return this.clone()._each(t)},O.prototype._column_oriented_1_dimensional_processing=function(t,r,e){var n;if(this.isRow()){t(this.matrix_array[0][0],0,0,this.column_length);for(var i=0;i<this.column_length;i++)r(this.matrix_array[0][i],0,i);return n=e(this.matrix_array[0][this.column_length-1],0,this.column_length-1),new O(n)}var o=[];o[0]=new Array(this.column_length);for(var a=0;a<this.column_length;a++){t(this.matrix_array[0][a],0,a,this.row_length);for(var s=0;s<this.row_length;s++)r(this.matrix_array[s][a],s,a);var h=e(this.matrix_array[this.row_length-1][a],this.row_length-1,a);if(h instanceof Array)for(var l=0;l<h.row_length;l++)o[l][a]=h[l];else o[0][a]=h}return new O(o)},O.prototype._column_oriented_2_dimensional_processing=function(t,r,e){for(var n=new Array(this.row_length),i=0;i<this.row_length;i++){t(this.matrix_array[i][0],i,0,this.column_length);for(var o=0;o<this.column_length;o++)r(this.matrix_array[i][o],i,o);n[i]=e(this.matrix_array[i][this.column_length-1],0,this.column_length-1)}for(var a=0;a<n[0].length;a++){t(n[0][a],0,a,n[0].length);for(var s=0;s<n.length;s++)r(n[s][a],s,a);for(var h=e(n[n.length-1][a],n.length-1,a),l=0;l<h.length;l++)n[l][a]=h[l]}return new O(n)},O.prototype.getComplex=function(n,t){var r=null,e=null;r="string"==typeof n||n instanceof String?new O(n):n,2===arguments.length&&(e="string"==typeof t||t instanceof String?new O(t):t);var i=function(t){var r,e=!1;return"number"==typeof n||n instanceof Number?(r=Math.round(t),e=!0):n instanceof S?(r=Math.round(t.real),e=!0):n instanceof O&&n.isScalar()&&(r=Math.round(t.scalar.real),e=!0),{number:r,is_scalar:e}},o=!0,a=null,s=null;if(1===arguments.length?o&=(a=i(r)).is_scalar:2===arguments.length&&(o&=(a=i(r)).is_scalar,o&=(s=i(e)).is_scalar),o)return this.isRow()?this.matrix_array[0][a.number]:this.isColumn()?this.matrix_array[a.number][0]:this.matrix_array[a.number][s.number];throw"getComplex not scalar : "+this},l.scalar.get=function(){return this.matrix_array[0][0]},l.length.get=function(){return this.row_length>this.column_length?this.row_length:this.column_length},l.norm1.get=function(){var t=this.matrix_array;if(this.isRow()){for(var r=0,e=0;e<this.column_length;e++)r+=t[0][e].norm;return r}if(this.isColumn()){for(var n=0,i=0;i<this.row_length;i++)n=t[i][0].norm;return n}for(var o=0,a=0;a<this.column_length;a++){for(var s=0,h=0;h<this.row_length;h++)s+=t[h][a].norm;o<s&&(o=s)}return o},l.norm2.get=function(){var t=this.matrix_array;if(this.isRow()){for(var r=0,e=0;e<this.column_length;e++)r+=t[0][e].square().real;return Math.sqrt(r)}if(this.isColumn()){for(var n=0,i=0;i<this.row_length;i++)n=t[i][0].square().real;return Math.sqrt(n)}return this.svd().S.diag().max().scalar.real},O.eye=function(t,r){return O.createMatrixDoEachCalculation(function(t,r){return t===r?S.ONE:S.ZERO},t,r)},O.memset=function(t,r,e){if(0===arguments.length||3<arguments.length)throw"IllegalArgumentException";if(t instanceof O&&!t.isScalar()){var n=t.matrix_array,i=t.row_length,o=t.column_length;return O.createMatrixDoEachCalculation(function(t,r){return n[t%i][r%o]},r,e)}var a=0;return a=t instanceof O&&t.isScalar()?t.scalar:S.createConstComplex(t),O.createMatrixDoEachCalculation(function(){return a},r,e)},O.zeros=function(t,r){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return O.memset(S.ZERO,t,r)},O.ones=function(t,r){if(0===arguments.length||2<arguments.length)throw"IllegalArgumentException";return O.memset(S.ONE,t,r)},O.rand=function(t,r){return O.createMatrixDoEachCalculation(function(){return S.rand()},t,r)},O.randn=function(t,r){return O.createMatrixDoEachCalculation(function(){return S.randn()},t,r)},O.prototype.diag=function(){if(this.isVector()){var e=this;return O.createMatrixDoEachCalculation(function(t,r){return t===r?e.getComplex(t):S.ZERO},this.length)}for(var t=Math.min(this.row_length,this.column_length),r=new Array(t),n=0;n<t;n++)r[n]=new Array(1),r[n][0]=this.matrix_array[n][n];return new O(r)},O.prototype.isScalar=function(){return 1===this.row_length&&1==this.column_length},O.prototype.isRow=function(){return 1===this.row_length},O.prototype.isColumn=function(){return 1===this.column_length},O.prototype.isVector=function(){return 1===this.row_length||1===this.column_length},O.prototype.isMatrix=function(){return 1!==this.row_length&&1!==this.column_length},O.prototype.isSquare=function(){return this.row_length===this.column_length},O.prototype.isReal=function(r){var e=!0;return this._each(function(t){e&&t.isComplex(r)&&(e=!1)}),e},O.prototype.isComplex=function(r){var e=!0;return this._each(function(t){e&&t.isReal(r)&&(e=!1)}),e},O.prototype.isZero=function(t){var r=!0,e=t||1e-10;return this._each(function(t){r&&!t.isZero(e)&&(r=!1)}),r},O.prototype.isIdentity=function(t){if(!this.isDiagonal())return!1;for(var r=t||1e-10,e=0;e<this.row_length;e++)if(!this.matrix_array[e][e].isOne(r))return!1;return!0},O.prototype.isDiagonal=function(t){var n=!0,i=t||1e-10;return this._each(function(t,r,e){n&&r!==e&&!t.isZero(i)&&(n=!1)}),n},O.prototype.isTridiagonal=function(t){if(!this.isSquare())return!1;var n=!0,i=t||1e-10;return this._each(function(t,r,e){n&&1<Math.abs(r-e)&&!t.isZero(i)&&(n=!1)}),n},O.prototype.isRegular=function(t){if(!this.isSquare())return!1;var r=t||1e-10;return this.rank(1e-10).equals(this.row_length,r)},O.prototype.isOrthogonal=function(t){if(!this.isSquare())return!1;var r=t||1e-10;return this.mul(this.transpose()).isIdentity(r)},O.prototype.isUnitary=function(t){if(!this.isSquare())return!1;var r=t||1e-10;return this.mul(this.ctranspose()).isIdentity(r)},O.prototype.isSymmetric=function(t){if(!this.isSquare())return!1;for(var r=t||1e-10,e=0;e<this.row_length;e++)for(var n=e+1;n<this.column_length;n++)if(!this.matrix_array[e][n].equals(this.matrix_array[n][e],r))return!1;return!0},O.prototype.isHermitian=function(t){if(!this.isSquare())return!1;for(var r=t||1e-10,e=0;e<this.row_length;e++)for(var n=e;n<this.column_length;n++)if(e===n){if(!this.matrix_array[e][n].isReal(r))return!1}else if(!this.matrix_array[e][n].equals(this.matrix_array[n][e].conj(),r))return!1;return!0},O.prototype.size=function(){return new O([[this.row_length,this.column_length]])},O.prototype.max=function(r){var e;return this._column_oriented_1_dimensional_processing(function(t){e=t},function(t){0<e.compareTo(t,r)&&(e=t)},function(){return e})},O.prototype.min=function(r){var e;return this._column_oriented_1_dimensional_processing(function(t){e=t},function(t){e.compareTo(t,r)<0&&(e=t)},function(){return e})},O.prototype.add=function(t){var e=this,n=O.createConstMatrix(t);if(e.row_length!==n.row_length&&e.column_length!==n.column_length)throw"Matrix size does not match";var i=e.matrix_array,o=n.matrix_array,r=Math.max(e.row_length,n.row_length),a=Math.max(e.column_length,n.column_length);return O.createMatrixDoEachCalculation(function(t,r){return i[t%e.row_length][r%e.column_length].add(o[t%n.row_length][r%n.column_length])},r,a)},O.prototype.sub=function(t){var e=this,n=O.createConstMatrix(t);if(e.row_length!==n.row_length&&e.column_length!==n.column_length)throw"Matrix size does not match";var i=e.matrix_array,o=n.matrix_array,r=Math.max(e.row_length,n.row_length),a=Math.max(e.column_length,n.column_length);return O.createMatrixDoEachCalculation(function(t,r){return i[t%e.row_length][r%e.column_length].sub(o[t%n.row_length][r%n.column_length])},r,a)},O.prototype.mul=function(t){var r=this,e=O.createConstMatrix(t),n=r.matrix_array,i=e.matrix_array;if(r.isScalar()&&e.isScalar())return new O(n.scalar.mul(i.scalar));if(r.isScalar()){for(var o=new Array(e.row_length),a=0;a<e.row_length;a++){o[a]=new Array(e.column_length);for(var s=0;s<e.column_length;s++)o[a][s]=r.scalar.mul(i[a][s])}return new O(o)}if(e.isScalar()){for(var h=new Array(r.row_length),l=0;l<r.row_length;l++){h[l]=new Array(r.column_length);for(var u=0;u<r.column_length;u++)h[l][u]=n[l][u].mul(e.scalar)}return new O(h)}if(r.column_length!==e.row_length)throw"Matrix size does not match";for(var c=new Array(r.row_length),f=0;f<r.row_length;f++){c[f]=new Array(e.column_length);for(var m=0;m<e.column_length;m++){for(var g=S.ZERO,p=0;p<r.column_length;p++)g=g.add(n[f][p].mul(i[p][m]));c[f][m]=g}}return new O(c)},O.prototype.inv=function(){if(this.isScalar())return new O(S.ONE.div(this.scalar));if(!this.isSquare())throw"not square";if(this.isDiagonal()){for(var t=this.T(),r=Math.min(t.row_length,t.column_length),e=0;e<r;e++)t.matrix_array[e][e]=t.matrix_array[e][e].inv();return t}var n=this.column_length,i=new O(this);i._concat_left(O.eye(n));for(var o=i.matrix_array,a=i.column_length,s=0;s<n;s++){var h=i._max_row_number(s,s).index;i._exchange_row(s,h);for(var l=o[s][s].inv(),u=s,c=s;c<a;c++)o[u][c]=o[u][c].mul(l);for(var f=0;f<n;f++)if(f!==s)for(var m=o[f][s],g=s;g<a;g++)o[f][g]=o[f][g].sub(o[s][g].mul(m))}for(var p=new Array(n),_=0;_<n;_++){p[_]=new Array(n);for(var v=0;v<n;v++)p[_][v]=o[_][n+v]}return new O(p)},O.prototype.div=function(t){var r=this,e=O.createConstMatrix(t),n=r.matrix_array,i=e.matrix_array;if(r.isScalar()&&e.isScalar())return new O(n.scalar.div(i.scalar));if(e.isScalar()){for(var o=new Array(r.row_length),a=0;a<r.row_length;a++){o[a]=new Array(r.column_length);for(var s=0;s<r.column_length;s++)o[a][s]=n[a][s].div(e.scalar)}return new O(o)}if(e.row_length===e.column_length)return this.mul(e.inv());if(r.column_length!==e.column_length)throw"Matrix size does not match";throw"warning"},O.prototype.nmul=function(t){var e=this,n=O.createConstMatrix(t);if(e.row_length!==n.row_length&&e.column_length!==n.column_length)throw"Matrix size does not match";var i=e.matrix_array,o=n.matrix_array,r=Math.max(e.row_length,n.row_length),a=Math.max(e.column_length,n.column_length);return O.createMatrixDoEachCalculation(function(t,r){return i[t%e.row_length][r%e.column_length].mul(o[t%n.row_length][r%n.column_length])},r,a)},O.prototype.ndiv=function(t){var e=this,n=O.createConstMatrix(t);if(e.row_length!==n.row_length&&e.column_length!==n.column_length)throw"Matrix size does not match";var i=e.matrix_array,o=n.matrix_array,r=Math.max(e.row_length,n.row_length),a=Math.max(e.column_length,n.column_length);return O.createMatrixDoEachCalculation(function(t,r){return i[t%e.row_length][r%e.column_length].div(o[t%n.row_length][r%n.column_length])},r,a)},O.prototype.real=function(){return this.cloneMatrixDoEachCalculation(function(t){return new S(t.real)})},O.prototype.imag=function(){return this.cloneMatrixDoEachCalculation(function(t){return new S(t.imag)})},O.prototype.angle=function(){return this.cloneMatrixDoEachCalculation(function(t){return new S(t.angle)})},O.prototype.sign=function(){return this.cloneMatrixDoEachCalculation(function(t){return new S(t.sign())})},O.prototype.testInteger=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isInteger(r)?S.ONE:S.ZERO})},O.prototype.testComplexInteger=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplexInteger(r)?S.ONE:S.ZERO})},O.prototype.testZero=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isZero(r)?S.ONE:S.ZERO})},O.prototype.testOne=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isOne(r)?S.ONE:S.ZERO})},O.prototype.testComplex=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isComplex(r)?S.ONE:S.ZERO})},O.prototype.testReal=function(r){return this.cloneMatrixDoEachCalculation(function(t){return t.isReal(r)?S.ONE:S.ZERO})},O.prototype.testNaN=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNaN()?S.ONE:S.ZERO})},O.prototype.testPositive=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isPositive()?S.ONE:S.ZERO})},O.prototype.testNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNegative()?S.ONE:S.ZERO})},O.prototype.testNotNegative=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isNotNegative()?S.ONE:S.ZERO})},O.prototype.testInfinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isInfinite()?S.ONE:S.ZERO})},O.prototype.testFinite=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.isFinite()?S.ONE:S.ZERO})},O.prototype.abs=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.abs()})},O.prototype.conj=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.conj()})},O.prototype.negate=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.negate()})},O.prototype.sqrt=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sqrt()})},O.prototype.pow=function(t){var r=O.createConstMatrix(t);if(!r.isScalar())throw"not set Scalar";return this.cloneMatrixDoEachCalculation(function(t){return t.pow(r.scalar)})},O.prototype.log=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.log()})},O.prototype.exp=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.exp()})},O.prototype.sin=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.sin()})},O.prototype.cos=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.cos()})},O.prototype.tan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.tan()})},O.prototype.atan=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.atan()})},O.prototype.atan2=function(t){var r=O.createConstMatrix(t);if(!r.isScalar)throw"not set Scalar";return this.cloneMatrixDoEachCalculation(function(t){return t.atan2(r.scalar)})},O.prototype.floor=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.floor()})},O.prototype.ceil=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.ceil()})},O.prototype.round=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.round()})},O.prototype.fix=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fix()})},O.prototype.fract=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.fract()})},O.prototype._rot90=function(t){var r=1;if(1===arguments.length&&(r=(t%4+4)%4),0===r)return this;for(var e=new Array(this.row_length),n=0;n<this.row_length;n++){e[n]=new Array(this.column_length);for(var i=0;i<this.column_length;i++)e[n][i]=this.matrix_array[n][i]}var o=this.matrix_array;if(1===r){o.splice(this.column_length);for(var a=0;a<this.column_length;a++){a<this.row_length?o[a].splice(this.row_length):o[a]=new Array(this.row_length);for(var s=0;s<this.row_length;s++)o[a][s]=e[this.row_length-s-1][a]}}else if(2===r)for(var h=0;h<this.row_length;h++)for(var l=0;l<this.column_length;l++)o[h][l]=e[this.row_length-h-1][this.column_length-l-1];else if(3===r){o.splice(this.column_length);for(var u=0;u<this.column_length;u++){u<this.row_length?o[u].splice(this.row_length):o[u]=new Array(this.row_length);for(var c=0;c<this.row_length;c++)o[u][c]=e[c][this.column_length-u-1]}}return this.row_length=o.length,this.column_length=o[0].length,this._clearCash(),this},O.prototype._resize=function(t,r){if(t===this.row_length&&r===this.column_length)return this;if(t<=0||r<=0)throw"_resize";for(var e=Math.max(this.row_length,t),n=Math.max(this.column_length,r),i=this.matrix_array,o=0;o<e;o++){o>=this.row_length&&(i[o]=new Array(n));for(var a=0;a<n;a++)(o>=this.row_length||a>=this.column_length)&&(i[o][a]=S.ZERO)}if(this.row_length>t&&i.splice(t),this.column_length>r)for(var s=0;s<i.length;s++)i[s].splice(r);return this.row_length=t,this.column_length=r,this._clearCash(),this},O.prototype._delete_row=function(t){if(1===this.row_length||this.row_length<=t)throw"_delete_row";return this.matrix_array.splice(t,1),this.row_length--,this._clearCash(),this},O.prototype._delete_column=function(t){if(1===this.column_length||this.column_length<=t)throw"_delete_column";for(var r=0;r<this.row_length;r++)this.matrix_array[r].splice(t,1);return this.column_length--,this._clearCash(),this},O.prototype._exchange_row=function(t,r){if(1===this.row_length||this.row_length<=t||this.row_length<=r)throw"_exchange_row";if(t===r)return this;var e=this.matrix_array[t];return this.matrix_array[t]=this.matrix_array[r],this.matrix_array[r]=e,this._clearCash(),this},O.prototype._exchange_column=function(t,r){if(1===this.column_length||this.column_length<=t||this.column_length<=r)throw"_exchange_column";if(t===r)return this;for(var e=0;e<this.row_length;e++){var n=this.matrix_array[e][t];this.matrix_array[e][t]=this.matrix_array[e][r],this.matrix_array[e][r]=n}return this._clearCash(),this},O.prototype._concat_left=function(t){for(var r=0;r<this.row_length;r++)for(var e=0;e<t.column_length;e++)this.matrix_array[r].push(t.matrix_array[r][e]);return this.column_length+=t.column_length,this._clearCash(),this},O.prototype._concat_bottom=function(t){for(var r=0;r<t.row_length;r++)this.matrix_array.push(t.matrix_array[r]);return this.row_length+=t.row_length,this._clearCash(),this},O.prototype._max_row_number=function(t,r,e){for(var n=0,i=0,o=r||0,a=e||this.row_length;o<a;o++){var s=this.matrix_array[o][t].norm;i<s&&(i=s,n=o)}return{index:n,max:i}},O.prototype._get_linear_dependence_vector=function(t){for(var r=new O(this),e=r.matrix_array,n=t||1e-10,i=new Array(this.row_length),o=0;o<this.row_length;o++)i[o]=o;for(var a=0;a<r.column_length;a++){var s=0,h=0,l=0;for(var u in i){var c=i[u],f=e[c][a].norm;h<f&&(h=f,l=u,s=c)}if(!(h<=n)){if(i.splice(l,1),a===r.column_length-1)break;for(var m in i)for(var g=i[m],p=e[g][a].div(e[s][a]),_=a;_<r.column_length;_++)e[g][_]=e[g][_].sub(e[s][_].mul(p))}}return i},O._gram_schmidt_orthonormalization=function(t){for(var r=t.column_length,e=t.matrix_array,n=O.zeros(r),i=O.zeros(r),o=n.matrix_array,a=i.matrix_array,s=[],h=new Array(r),l=0;l<r;l++){for(var u=0;u<r;u++)h[u]=e[u][l];if(0<l){for(var c=0;c<l;c++)for(var f=0;f<r;f++)a[c][l]=a[c][l].add(e[f][l].dot(o[f][c]));for(var m=0;m<l;m++)for(var g=0;g<r;g++)h[g]=h[g].sub(a[m][l].mul(o[g][m]))}for(var p=0;p<r;p++)a[l][l]=a[l][l].add(h[p].mul(h[p]));if(a[l][l]=a[l][l].sqrt(),a[l][l].isZero(1e-10)){s.push(l);for(var _=0;_<r;_++)o[_][l]=S.ZERO}else for(var v=0;v<r;v++)o[v][l]=h[v].div(a[l][l])}return{Q:n,R:i,non_orthogonalized:s}},O.prototype._createOrthogonalVector=function(t){for(var r=new O(this),e=r.matrix_array,n=t||1e-10,i=r._get_linear_dependence_vector(n),o=i.length-1;0<=o;o--)e.splice(i[o],1),r.row_length--;var a=this.column_length-e.length;if(a<=0)return null;for(var s=new _(0),h=null,l=0;l<100;l++){var u=r.T(),c=O.createMatrixDoEachCalculation(function(){return new S(s.nextGaussian())},u.row_length,a);if(u._concat_left(c),0===(h=O._gram_schmidt_orthonormalization(u)).non_orthogonalized.length)break}if(0!==h.non_orthogonalized.length)return console.log("miss"),null;for(var f=new Array(a),m=h.Q.matrix_array,g=0;g<a;g++){f[g]=new Array(this.column_length);for(var p=0;p<this.column_length;p++)f[g][p]=m[p][this.column_length-a+g]}return new O(f)},O.prototype.norm=function(t){if(0===arguments.length)return this.norm2;if(1===t)return this.norm1;if(2===t)return this.norm2;if(t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY){for(var r=this.matrix_array,e=t===Number.POSITIVE_INFINITY?0:Number.POSITIVE_INFINITY,n=0;n<this.row_length;n++){for(var i=0,o=0;o<this.column_length;o++)i+=r[n][o].norm;e=t===Number.POSITIVE_INFINITY?Math.max(e,i):Math.min(e,i)}return e}if(this.isVector()){for(var a=0,s=0;s<this.length;s++)a=Math.pow(this.getComplex(s).norm,t);return Math.pow(a,1/t)}throw"norm"},O.prototype.inner=function(t,r){var e=this,n=O.createConstMatrix(t),i=e.matrix_array,o=n.matrix_array,a=r||1;if(e.isScalar()&&n.isScalar())return new O(e.scalar.dot(n.scalar));if(e.isVector()&&n.isVector()){for(var s=S.ZERO,h=0;h<e.length;h++)s=s.add(e.getComplex(h).dot(n.getComplex(h)));return new O(s)}if(e.row_length!==n.row_length||e.column_length!==n.column_length)throw"Matrix size does not match";if(1===a){var l=new Array(1);l[0]=new Array(e.column_length);for(var u=0;u<e.column_length;u++){for(var c=S.ZERO,f=0;f<e.row_length;f++)c=c.add(i[f][u].dot(o[f][u]));l[0][u]=c}return new O(l)}if(2!==a)throw"dim";for(var m=new Array(e.row_length),g=0;g<e.row_length;g++){for(var p=S.ZERO,_=0;_<e.column_length;_++)p=p.add(i[g][_].dot(o[g][_]));m[g]=[p]}return new O(m)},O.prototype.rank=function(t){return Math.abs(this.row_length,this.column_length)-this._get_linear_dependence_vector(t).length},O.prototype.transpose=function(){for(var t=new Array(this.column_length),r=0;r<this.column_length;r++){t[r]=new Array(this.row_length);for(var e=0;e<this.row_length;e++)t[r][e]=this.matrix_array[e][r]}return new O(t)},O.prototype.ctranspose=function(){return this.transpose().conj()},O.prototype.T=function(){return this.ctranspose()},O.prototype.det=function(){if(!this.isSquare())throw"not square";var t=this.matrix_array,l=function(t){if(2===t.length)return t[0][0].mul(t[1][1]).sub(t[0][1].mul(t[1][0]));for(var r=S.ZERO,e=0;e<t.length;e++){for(var n=[],i=t[e][0],o=0,a=0;o<t.length;o++)if(e!==o){n[a]=[];for(var s=1,h=0;s<t.length;s++,h++)n[a][h]=t[o][s];a++}r=e%2==0?r.add(i.mul(l(n))):r.sub(i.mul(l(n)))}return r};return new O(l(t))},O.prototype.lup=function(){for(var t=O.zeros(this.row_length),r=new O(this),e=O.eye(this.row_length),n=t.matrix_array,i=r.matrix_array,o=0;o<this.column_length;o++){var a,s=r._max_row_number(o,o);if(a=s.index,0!==s.max){o!==a&&(t._exchange_row(o,a),r._exchange_row(o,a),e._exchange_row(o,a));for(var h=o+1;h<this.row_length;h++){var l=i[h][o].div(i[o][o]);n[h][o]=l;for(var u=o;u<this.column_length;u++)i[h][u]=i[h][u].sub(i[o][u].mul(l))}}}return t._resize(this.row_length,Math.min(this.row_length,this.column_length)),r._resize(Math.min(this.row_length,this.column_length),this.column_length),t._each(function(t,r,e){return r===e?S.ONE:t}),{L:t,U:r,P:e}},O.prototype.linsolve=function(t){if(!this.isSquare())throw"Matrix size does not match";var r=this.column_length,e=O.createConstMatrix(t);if(e.row_length!==this.row_length||1<e.column_length)throw"Matrix size does not match";var n=new O(this);n._concat_left(e);for(var i=n.matrix_array,o=n.column_length,a=0;a<r-1;a++){var s=n._max_row_number(a,a).index;n._exchange_row(a,s);for(var h=i[a][a].inv(),l=a,u=a;u<o;u++)i[l][u]=i[l][u].mul(h);for(var c=a+1;c<r;c++)for(var f=i[c][a],m=a;m<o;m++)i[c][m]=i[c][m].sub(i[a][m].mul(f))}var g=new Array(r);g[r-1]=i[r-1][r].div(i[r-1][r-1]);for(var p=r-2;0<=p;p--){g[p]=i[p][o-1];for(var _=p+1;_<r;_++)g[p]=g[p].sub(i[p][_]*g[_]);g[p]=g[p].div(i[p][p])}for(var v=new Array(this.row_length),w=0;w<this.row_length;w++)v[w]=[g[w]];return new O(v)},O.prototype.qr=function(){var t=new O(this),r=this.row_length,e=this.row_length,n=this.row_length,i=this.column_length,o=Math.max(this.row_length,this.column_length);t._resize(o,o);var a=O._gram_schmidt_orthonormalization(t),s=a.Q,h=a.R,l=a.non_orthogonalized;if(0!==l.length){for(var u={},c=0;c<l.length;c++)u[l[c]]=1;for(var f=[],m=0;m<o;m++)if(!u[m]){for(var g=[],p=0;p<o;p++)g[p]=s.matrix_array[p][m];f.push(g)}for(var _=new O(f)._createOrthogonalVector(),v=0;v<l.length;v++)for(var w=l[v],y=0;y<o;y++)s.matrix_array[y][w]=_.matrix_array[v][y]}return s._resize(r,e),h._resize(n,i),{Q:s,R:h}},O.prototype.tridiagonalize=function(){if(!this.isSquare())throw"not square matrix";if(!this.isSymmetric())throw"not Symmetric";if(this.isComplex())throw"not Real Matrix";return h.tridiagonalize(this)},O.prototype.eig=function(){if(!this.isSquare())throw"not square matrix";if(!this.isSymmetric())throw"not Symmetric";if(this.isComplex())throw"not Real Matrix";return h.eig(this)},O.prototype.svd=function(){if(this.isComplex())throw"Unimplemented";var n=this.rank(),i=this.T().mul(this).eig(),e=O.zeros(this.row_length,this.column_length);e._each(function(t,r,e){if(r===e&&r<n)return i.D.getComplex(r,r).sqrt()});var t=O.createMatrixDoEachCalculation(function(t,r){return t===r?e.matrix_array[t][t].inv():S.ZERO},n),r=new O(i.V)._resize(i.V.row_length,n);return{U:this.mul(r).mul(t).qr().Q,S:e,V:i.V}},O.prototype.pinv=function(){var t=this.svd(),r=t.U,n=t.S,e=t.V,i=O.createMatrixDoEachCalculation(function(t,r){if(t!==r)return S.ZERO;var e=n.matrix_array[t][t];return e.isZero()?S.ZERO:e.inv()},this.column_length,this.row_length);return e.mul(i).mul(r.T())},O.prototype.gammaln=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.gammaln()})},O.prototype.gamma=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.gamma()})},O.prototype.gammainc=function(t,r){var e=O.createConstMatrix(t).scalar,n=1===arguments.length?r:"lower";return this.cloneMatrixDoEachCalculation(function(t){return t.gammainc(e,n)})},O.prototype.gampdf=function(t,r){var e=O.createConstMatrix(t).scalar,n=O.createConstMatrix(r).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.gampdf(e,n)})},O.prototype.gamcdf=function(t,r){var e=O.createConstMatrix(t).scalar,n=O.createConstMatrix(r).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.gamcdf(e,n)})},O.prototype.gaminv=function(t,r){var e=O.createConstMatrix(t).scalar,n=O.createConstMatrix(r).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.gaminv(e,n)})},O.prototype.beta=function(t){var r=O.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.beta(r)})},O.prototype.betainc=function(t,r,e){var n=O.createConstMatrix(t).scalar,i=O.createConstMatrix(r).scalar,o=2===arguments.length?e:"lower";return this.cloneMatrixDoEachCalculation(function(t){return t.betainc(n,i,o)})},O.prototype.betacdf=function(t,r){var e=O.createConstMatrix(t).scalar,n=O.createConstMatrix(r).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.betacdf(e,n)})},O.prototype.betapdf=function(t,r){var e=O.createConstMatrix(t).scalar,n=O.createConstMatrix(r).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.betapdf(e,n)})},O.prototype.betainv=function(t,r){var e=O.createConstMatrix(t).scalar,n=O.createConstMatrix(r).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.betainv(e,n)})},O.prototype.factorial=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.factorial()})},O.prototype.nchoosek=function(t){var r=O.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.nchoosek(r)})},O.prototype.erf=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erf()})},O.prototype.erfc=function(){return this.cloneMatrixDoEachCalculation(function(t){return t.erfc()})},O.prototype.normpdf=function(t,r){var e=arguments.length<=0?S.createConstMatrix(t).scalar:S.ZERO,n=arguments.length<=1?S.createConstMatrix(r).scalar:S.ONE;return this.cloneMatrixDoEachCalculation(function(t){return t.normpdf(e,n)})},O.prototype.normcdf=function(t,r){var e=arguments.length<=0?S.createConstMatrix(t).scalar:S.ZERO,n=arguments.length<=1?S.createConstMatrix(r).scalar:S.ONE;return this.cloneMatrixDoEachCalculation(function(t){return t.normcdf(e,n)})},O.prototype.norminv=function(t,r){var e=arguments.length<=0?S.createConstMatrix(t).scalar:S.ZERO,n=arguments.length<=1?S.createConstMatrix(r).scalar:S.ONE;return this.cloneMatrixDoEachCalculation(function(t){return t.norminv(e,n)})},O.prototype.tpdf=function(t){var r=O.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.tpdf(r)})},O.prototype.tcdf=function(t){var r=O.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.tcdf(r)})},O.prototype.tinv=function(t){var r=O.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.tinv(r)})},O.prototype.tdist=function(t,r){var e=O.createConstMatrix(t).scalar,n=O.createConstMatrix(r).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.tdist(e,n)})},O.prototype.tinv2=function(t){var r=O.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.tinv2(r)})},O.prototype.chi2pdf=function(t){var r=O.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.chi2pdf(r)})},O.prototype.chi2cdf=function(t){var r=O.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.chi2cdf(r)})},O.prototype.chi2inv=function(t){var r=O.createConstMatrix(t).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.chi2inv(r)})},O.prototype.fpdf=function(t,r){var e=O.createConstMatrix(t).scalar,n=O.createConstMatrix(r).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.fpdf(e,n)})},O.prototype.fcdf=function(t,r){var e=O.createConstMatrix(t).scalar,n=O.createConstMatrix(r).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.fcdf(e,n)})},O.prototype.finv=function(t,r){var e=O.createConstMatrix(t).scalar,n=O.createConstMatrix(r).scalar;return this.cloneMatrixDoEachCalculation(function(t){return t.finv(e,n)})},O.prototype.sum=function(){var n,i;return this._column_oriented_1_dimensional_processing(function(){i=n=S.ZERO},function(t){var r=t.add(i),e=n.add(r);i=e.sub(n).sub(r),n=e},function(){return n})},O.prototype.mean=function(){var n,i,o;return this._column_oriented_1_dimensional_processing(function(){i=n=S.ZERO,o=0},function(t){var r=t.add(i),e=n.add(r);i=e.sub(n).sub(r),n=e,o++},function(){return n.div(o)})},O.prototype.geomean=function(){var r;return this._column_oriented_1_dimensional_processing(function(){r=Number.ONE},function(t){r=r.mul(t)},function(){return r.sqrt()})},O.prototype.var=function(t){var e,n,i,r=this.mean(),o=0,a=0===arguments.length?0:O.createConstMatrix(t).scalar.real;return this._column_oriented_1_dimensional_processing(function(){e=S.ZERO,i=0,n=r.isScalar()?r.scalar:r.getComplex(o)},function(t){var r=t.sub(n);e=e.add(r.dot(r)),i++},function(){return o++,1===i&&(a=1),e.div(i-1+a)})},O.prototype.std=function(t){var r=0===arguments.length?0:O.createConstMatrix(t).scalar.real,e=this.var(r);return e._each(function(t){return t.sqrt()}),e},O.prototype.cov=function(t){var r=0===arguments.length?0:O.createConstMatrix(t).scalar.real;if(this.isVector())return this.var(r);r=1===this.row_length?1:r;for(var e=this.matrix_array,n=this.mean().matrix_array[0],i=new Array(this.column_length),o=0;o<this.column_length;o++){var a=n[o];i[o]=new Array(this.column_length);for(var s=o;s<this.column_length;s++){for(var h=n[s],l=S.ZERO,u=0;u<this.row_length;u++)l=l.add(e[u][o].sub(a).dot(e[u][s].sub(h)));i[o][s]=l.div(this.row_length-1+r)}}for(var c=1;c<i[0].length;c++)for(var f=0;f<c;f++)i[c][f]=i[f][c];return new O(i)},O.prototype.normalize=function(){var t=this.sub(this.mean());return t.ndiv(t.std())},O.prototype.corrcoef=function(){return this.normalize().cov()},O.prototype.fft=function(t){var i,o,a;void 0===t&&(t=!1);var r=function(t,r,e,n){i=new Array(n),o=new Array(n),a=0},e=function(t){i[a]=t.real,o[a]=t.imag,a++},n=function(){for(var t=V.fft(i,o),r=new Array(a),e=0;e<a;e++)r[e]=new S([t.real[e],t.imag[e]]);return r};return t?this._column_oriented_2_dimensional_processing(r,e,n):this._column_oriented_1_dimensional_processing(r,e,n)},O.prototype.ifft=function(t){var i,o,a;void 0===t&&(t=!1);var r=function(t,r,e,n){i=new Array(n),o=new Array(n),a=0},e=function(t){i[a]=t.real,o[a]=t.imag,a++},n=function(){for(var t=V.ifft(i,o),r=new Array(a),e=0;e<a;e++)r[e]=new S([t.real[e],t.imag[e]]);return r};return t?this._column_oriented_2_dimensional_processing(r,e,n):this._column_oriented_1_dimensional_processing(r,e,n)},O.prototype.powerfft=function(){var i,o,a;return this._column_oriented_1_dimensional_processing(function(t,r,e,n){i=new Array(n),o=new Array(n),a=0},function(t){i[a]=t.real,o[a]=t.imag,a++},function(){for(var t=V.powerfft(i,o),r=new Array(a),e=0;e<a;e++)r[e]=new S(t[e]);return r})},O.prototype.dct=function(t){if(void 0===t&&(t=!1),this.isComplex())throw"dct don't support complex numbers.";var i,o,r=function(t,r,e,n){i=new Array(n),o=0},e=function(t){i[o]=t.real,o++},n=function(){for(var t=V.dct(i),r=new Array(o),e=0;e<o;e++)r[e]=new S(t[e]);return r};return t?this._column_oriented_2_dimensional_processing(r,e,n):this._column_oriented_1_dimensional_processing(r,e,n)},O.prototype.idct=function(t){if(void 0===t&&(t=!1),this.isComplex())throw"idct don't support complex numbers.";var i,o,r=function(t,r,e,n){i=new Array(n),o=0},e=function(t){i[o]=t.real,o++},n=function(){for(var t=V.idct(i),r=new Array(o),e=0;e<o;e++)r[e]=new S(t[e]);return r};return t?this._column_oriented_2_dimensional_processing(r,e,n):this._column_oriented_1_dimensional_processing(r,e,n)},O.prototype.fft2=function(){return this.fft(!0)},O.prototype.ifft2=function(){return this.ifft(!0)},O.prototype.dct2=function(){return this.dct2(!0)},O.prototype.idct2=function(){return this.idct(!0)},O.prototype.conv=function(t){var r=this,e=O.createConstMatrix(t);if(r.isMatrix()||e.isMatrix())throw"conv don't support matrix numbers.";var n=new Array(r.length),i=new Array(r.length),o=new Array(e.length),a=new Array(e.length);if(r.isRow())for(var s=0;s<r.column_length;s++)n[s]=r.matrix_array[0][s].real,i[s]=r.matrix_array[0][s].imag;else for(var h=0;h<r.row_length;h++)n[h]=r.matrix_array[h][0].real,i[h]=r.matrix_array[h][0].imag;if(e.isRow())for(var l=0;l<e.column_length;l++)o[l]=e.matrix_array[0][l].real,a[l]=e.matrix_array[0][l].imag;else for(var u=0;u<e.row_length;u++)o[u]=e.matrix_array[u][0].real,a[u]=e.matrix_array[u][0].imag;for(var c=V.conv(n,i,o,a),f=new Array(c.real.length),m=0;m<c.real.length;m++)f[m]=new S([c.real[m],c.imag[m]]);var g=new O([f]);return e.isRow()?g:g.transpose()},O.prototype.xcorr=function(t){if(!t)return this.xcorr(this);var r=this,e=O.createConstMatrix(t);if(r.isMatrix()||e.isMatrix())throw"conv don't support matrix numbers.";var n=new Array(r.length),i=new Array(r.length),o=new Array(e.length),a=new Array(e.length);if(r.isRow())for(var s=0;s<r.column_length;s++)n[s]=r.matrix_array[0][s].real,i[s]=r.matrix_array[0][s].imag;else for(var h=0;h<r.row_length;h++)n[h]=r.matrix_array[h][0].real,i[h]=r.matrix_array[h][0].imag;if(e.isRow())for(var l=0;l<e.column_length;l++)o[l]=e.matrix_array[0][l].real,a[l]=e.matrix_array[0][l].imag;else for(var u=0;u<e.row_length;u++)o[u]=e.matrix_array[u][0].real,a[u]=e.matrix_array[u][0].imag;for(var c=V.xcorr(n,i,o,a),f=new Array(c.real.length),m=0;m<c.real.length;m++)f[m]=new S([c.real[m],c.imag[m]]);var g=new O([f]);return r.isRow()?g:g.transpose()},Object.defineProperties(O.prototype,l),{BigDecimal:w,BigInteger:p,Random:_,SMath:{Complex:S,Matrix:O}}});
